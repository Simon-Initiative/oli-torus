{"version":3,"file":"mc_delivery_test.jsx","sourceRoot":"","sources":["../../../test/multiple_choice/mc_delivery_test.tsx"],"names":[],"mappings":"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","sourcesContent":["import { render, fireEvent, screen } from '@testing-library/react';\nimport React from 'react';\nimport { defaultDeliveryElementProps } from '../utils/activity_mocks';\nimport { act } from 'react-dom/test-utils';\nimport '@testing-library/jest-dom';\nimport { defaultMCModel } from 'components/activities/multiple_choice/utils';\nimport { MultipleChoiceComponent } from 'components/activities/multiple_choice/MultipleChoiceDelivery';\nimport { Provider } from 'react-redux';\nimport { configureStore } from 'state/store';\nimport { activityDeliverySlice } from 'data/activities/DeliveryState';\nimport { DeliveryElementProvider } from 'components/activities/DeliveryElement';\nimport { makeHint } from 'components/activities/types';\nimport { defaultActivityState } from 'data/activities/utils';\n\ndescribe('multiple choice delivery', () => {\n  it('renders ungraded correctly', async () => {\n    const model = defaultMCModel();\n    model.authoring.parts[0].hints.push(makeHint('Hint 1'));\n\n    const props = {\n      model,\n      activitySlug: 'activity-slug',\n      state: Object.assign(defaultActivityState(model), { hasMoreHints: false }),\n      graded: false,\n      preview: false,\n    };\n    const { onSaveActivity, onSubmitActivity } = defaultDeliveryElementProps;\n    const store = configureStore({}, activityDeliverySlice.reducer);\n\n    render(\n      <Provider store={store}>\n        <DeliveryElementProvider {...defaultDeliveryElementProps} {...props}>\n          <MultipleChoiceComponent />\n        </DeliveryElementProvider>\n      </Provider>,\n    );\n\n    // expect no hints displayed\n    expect(screen.queryAllByLabelText(/hint [0-9]/)).toHaveLength(0);\n\n    // expect hints button\n    const requestHintButton = screen.getByLabelText('request hint');\n    expect(requestHintButton).toBeTruthy();\n\n    // expect clicking request hint to display a hint\n    act(() => {\n      fireEvent.click(requestHintButton);\n    });\n    expect(await screen.findAllByLabelText(/hint [0-9]/)).toHaveLength(1);\n\n    // expect submit button\n    const submitButton = screen.queryByLabelText('submit');\n    expect(submitButton).toBeTruthy();\n    expect(submitButton).toBeDisabled();\n\n    // expect 2 choices\n    const choices = screen.queryAllByLabelText(/choice [0-9]/);\n    expect(choices).toHaveLength(2);\n\n    // expect clicking a choice to save but not submit the activity\n    act(() => {\n      fireEvent.click(choices[0]);\n    });\n    expect(onSaveActivity).toHaveBeenCalledTimes(1);\n    expect(onSaveActivity).toHaveBeenCalledWith(props.state.attemptGuid, [\n      {\n        attemptGuid: '1',\n        response: { input: model.choices.map((choice) => choice.id)[0] },\n      },\n    ]);\n    expect(onSubmitActivity).toHaveBeenCalledTimes(0);\n\n    expect(submitButton).toBeEnabled();\n\n    act(() => {\n      if (submitButton) {\n        fireEvent.click(submitButton);\n      }\n    });\n\n    expect(onSubmitActivity).toHaveBeenCalledTimes(1);\n    expect(onSubmitActivity).toHaveBeenCalledWith(props.state.attemptGuid, [\n      {\n        attemptGuid: '1',\n        response: { input: model.choices.map((choice) => choice.id)[0] },\n      },\n    ]);\n\n    // expect results to be displayed after submission\n    expect(await screen.findAllByLabelText('result')).toHaveLength(1);\n    expect(screen.getByLabelText('score')).toHaveTextContent('1');\n    expect(screen.getByLabelText('out of')).toHaveTextContent('1');\n  });\n});\n"]}