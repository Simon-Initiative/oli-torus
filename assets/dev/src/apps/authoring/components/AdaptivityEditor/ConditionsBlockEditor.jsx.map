{"version":3,"file":"ConditionsBlockEditor.jsx","sourceRoot":"","sources":["../../../../../../src/apps/authoring/components/AdaptivityEditor/ConditionsBlockEditor.tsx"],"names":[],"mappings":"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","sourcesContent":["import { CapiVariableTypes, JanusConditionProperties } from '../../../../adaptivity/capi';\nimport { isEqual } from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { OverlayTrigger, Tooltip } from 'react-bootstrap';\nimport { clone } from 'utils/common';\nimport guid from 'utils/guid';\nimport ConditionItemEditor from './ConditionItemEditor';\nimport ConfirmDelete from '../Modal/DeleteConfirmationModal';\n\ntype JanusNestedCondition = JanusConditionProperties | JanusTopLevelCondition;\ntype JanusAllConditions = { id: string; all: JanusNestedCondition[] };\ntype JanusAnyConditions = { id: string; any: JanusNestedCondition[] };\nexport type JanusTopLevelCondition = JanusAllConditions | JanusAnyConditions;\ntype AnyOrAll = 'any' | 'all';\n\nexport const findConditionById = (\n  id: string,\n  conditions: JanusNestedCondition[] | JanusTopLevelCondition[],\n): JanusNestedCondition | null => {\n  let found = conditions.find((condition) => condition.id === id) || null;\n  if (!found) {\n    // check if any of the conditions are blocks of any or all\n    const blocks = conditions.filter(\n      (condition) => (condition as JanusAllConditions).all || (condition as JanusAnyConditions).any,\n    );\n    if (blocks.length > 0) {\n      for (let i = 0; i < blocks.length; i++) {\n        found = findConditionById(\n          id,\n          (blocks[i] as JanusAnyConditions).any || (blocks[i] as JanusAllConditions).all,\n        );\n        if (found) {\n          break;\n        }\n      }\n    }\n  }\n  return found || null;\n};\n\nexport const forEachCondition = (\n  conditions: JanusNestedCondition[] | JanusTopLevelCondition[],\n  callback: (condition: JanusNestedCondition) => void,\n) => {\n  // clone so that callback can modify the original\n  const cloneConditions = clone(conditions);\n  for (let i = 0; i < cloneConditions.length; i++) {\n    const condition = cloneConditions[i];\n    callback(condition);\n    if (condition.all || condition.any) {\n      const isAll = !!condition.all;\n      const type = isAll ? 'all' : 'any';\n      condition[type] = forEachCondition(condition[type], callback);\n    }\n  }\n  return cloneConditions;\n};\n\nexport const deleteConditionById = (\n  id: string,\n  conditions: JanusNestedCondition[] | JanusTopLevelCondition[],\n) => {\n  const cloneConditions = clone(conditions);\n  // first check if it is one of this level's conditions\n  const condition = cloneConditions.find((condition: JanusNestedCondition) => condition.id === id);\n  if (condition) {\n    return cloneConditions.filter((condition: JanusNestedCondition) => condition.id !== id);\n  }\n  return forEachCondition(cloneConditions, (condition) => {\n    if ((condition as JanusAllConditions).all || (condition as JanusAnyConditions).any) {\n      const isAll = !!(condition as JanusAllConditions).all;\n      if (isAll) {\n        (condition as JanusAllConditions).all = deleteConditionById(\n          id,\n          (condition as JanusAllConditions).all,\n        );\n      } else {\n        (condition as JanusAnyConditions).any = deleteConditionById(\n          id,\n          (condition as JanusAnyConditions).any,\n        );\n      }\n    }\n  });\n};\n\ninterface CondtionsBlockEditorProps {\n  id: string;\n  type: AnyOrAll;\n  index: number;\n  rootConditions: JanusNestedCondition[];\n  onChange: (changes: Partial<JanusTopLevelCondition>) => void;\n}\n\nconst ConditionsBlockEditor: React.FC<CondtionsBlockEditorProps> = (props) => {\n  const { id, type, index, rootConditions, onChange } = props;\n  const [blockType, setBlockType] = useState<AnyOrAll>(type);\n  const [conditions, setConditions] = useState<JanusNestedCondition[]>(rootConditions || []);\n  const [loopIndex, setLoopIndex] = useState<number>(index);\n  const [showConfirmDelete, setShowConfirmDelete] = useState<boolean>(false);\n  const [conditionToDelete, setConditionToDelete] = useState<any>(undefined);\n  const [loopIndexToDelete, setLoopIndexToDelete] = useState<number | undefined>(undefined);\n\n  useEffect(() => {\n    setLoopIndex(index + 1);\n  }, []);\n\n  useEffect(() => {\n    /* console.log('CONDITIONS BLOCK ED', { type, rootConditions }); */\n    // this is just when the props change, only do it once?\n    if (type !== blockType) {\n      setBlockType(type);\n    }\n    if (!isEqual(conditions, rootConditions)) {\n      setConditions(rootConditions || []);\n    }\n  }, [type, rootConditions]);\n\n  useEffect(() => {\n    /* console.log('CONDITIONS/BT CHANGE EFFECT', { blockType, conditions }); */\n    onChange({ [blockType]: conditions });\n  }, [conditions, blockType]);\n\n  const handleBlockTypeChange = () => {\n    setBlockType(blockType === 'all' ? 'any' : 'all');\n  };\n\n  const handleAddCondition = () => {\n    // todo: support adding any/all sub chains?\n    const newCondition = {\n      id: `c:${guid()}`,\n      type: CapiVariableTypes.STRING,\n      fact: 'stage.',\n      operator: 'equal',\n      value: '',\n    };\n    setConditions([...conditions, newCondition]);\n  };\n\n  const handleAddConditionBlock = (newType: AnyOrAll = 'any') => {\n    const block = {\n      id: `b:${guid()}`,\n      [newType]: [\n        {\n          id: `c:${guid()}`,\n          fact: 'stage.',\n          type: CapiVariableTypes.STRING,\n          operator: 'equal',\n          value: '',\n        },\n      ],\n    } as JanusTopLevelCondition;\n    setConditions([...conditions, block]);\n  };\n\n  const handleDeleteCondition = (condition: Partial<JanusNestedCondition>, loopIndex?: number) => {\n    if (condition.id === 'root') {\n      const empty: JanusNestedCondition[] = [];\n      setConditions(empty);\n      if (loopIndex && loopIndex > 0) {\n        return onChange({});\n      } else {\n        return onChange({ [blockType]: empty });\n      }\n    }\n\n    const updatedConditions = deleteConditionById(condition.id as string, conditions);\n    setConditions(updatedConditions);\n  };\n\n  const handleConditionItemChange = (\n    condition: JanusConditionProperties,\n    changes: Partial<JanusConditionProperties>,\n  ) => {\n    const updatedConditions = forEachCondition(conditions, (c) => {\n      if (c.id === condition.id) {\n        if (changes.fact) {\n          (c as JanusConditionProperties).fact = changes.fact;\n        }\n        if (changes.type) {\n          (c as JanusConditionProperties).type = changes.type;\n        }\n        if (changes.operator) {\n          (c as JanusConditionProperties).operator = changes.operator;\n        }\n        if (changes.value !== undefined) {\n          (c as JanusConditionProperties).value = changes.value;\n        }\n      }\n    });\n    /* console.log('[handleConditionItemChange]', { changes, condition, updatedConditions }); */\n    setConditions(updatedConditions);\n  };\n\n  const handleSubBlockChange = (condition: any, changes: any) => {\n    const updatedConditions = forEachCondition(conditions, (c: any) => {\n      if (c.id === condition.id) {\n        // changes will be either any or all because that could change\n        if (changes.all) {\n          delete c.any;\n          c.all = changes.all;\n        } else {\n          delete c.all;\n          c.any = changes.any;\n        }\n      }\n    });\n    /* console.log('[handleSubBlockChange]', { condition, changes, updatedConditions }); */\n    setConditions(updatedConditions);\n  };\n\n  const AddConditionContextMenu = () => (\n    <>\n      <button\n        className=\"dropdown-item\"\n        onClick={() => {\n          handleAddCondition();\n        }}\n      >\n        <i className=\"fa fa-plus mr-2\" /> Single Condition\n      </button>\n      <button\n        className=\"dropdown-item\"\n        onClick={() => {\n          handleAddConditionBlock('any');\n        }}\n      >\n        <i className=\"fa fa-plus mr-2\" /> Any Block\n      </button>\n      <button\n        className=\"dropdown-item\"\n        onClick={() => {\n          handleAddConditionBlock('all');\n        }}\n      >\n        <i className=\"fa fa-plus mr-2\" /> All Block\n      </button>\n    </>\n  );\n\n  return (\n    <div className=\"aa-conditions d-flex w-100\">\n      <OverlayTrigger\n        placement=\"top\"\n        delay={{ show: 150, hide: 150 }}\n        overlay={\n          <Tooltip id=\"button-tooltip\" style={{ fontSize: '12px' }}>\n            New Condition\n          </Tooltip>\n        }\n      >\n        <button\n          className=\"dropdown-toggle aa-add-button btn btn-primary btn-sm mr-3\"\n          type=\"button\"\n          id={`rules-list-add-context-trigger`}\n          data-toggle=\"dropdown\"\n          aria-haspopup=\"true\"\n          aria-expanded=\"false\"\n          onClick={() => {\n            ($(`#cb-editor-add-context-trigger`) as any).dropdown('toggle');\n          }}\n        >\n          <i className=\"fa fa-plus\" />\n        </button>\n      </OverlayTrigger>\n      <div\n        id={`cb-editor-add-context-menu`}\n        className=\"dropdown-menu\"\n        aria-labelledby={`cb-editor-add-context-trigger`}\n      >\n        <AddConditionContextMenu />\n      </div>\n      <div className=\"d-flex flex-column w-100\">\n        <div className=\"aa-condition border rounded p-2 mt-4\">\n          <div className=\"aa-condition-header d-flex justify-content-between align-items-center\">\n            <div>CONDITIONS</div>\n            <div>\n              {loopIndex !== 0 && (\n                <OverlayTrigger\n                  placement=\"top\"\n                  delay={{ show: 150, hide: 150 }}\n                  overlay={\n                    <Tooltip id=\"button-tooltip\" style={{ fontSize: '12px' }}>\n                      {`Delete Group`}\n                    </Tooltip>\n                  }\n                >\n                  <span>\n                    <button\n                      className=\"btn btn-link p-0\"\n                      onClick={() => {\n                        setShowConfirmDelete(true);\n                        setConditionToDelete({ id: 'root' });\n                        setLoopIndexToDelete(loopIndex);\n                      }}\n                    >\n                      <i className=\"fa fa-trash-alt\" />\n                    </button>\n                  </span>\n                </OverlayTrigger>\n              )}\n              {loopIndex === 0 && conditions.length >= 1 && (\n                <OverlayTrigger\n                  placement=\"top\"\n                  delay={{ show: 150, hide: 150 }}\n                  overlay={\n                    <Tooltip id=\"button-tooltip\" style={{ fontSize: '12px' }}>\n                      {`Delete ${loopIndex === 0 ? 'All' : 'Group'}`}\n                    </Tooltip>\n                  }\n                >\n                  <span>\n                    <button\n                      className=\"btn btn-link p-0\"\n                      onClick={() => {\n                        setShowConfirmDelete(true);\n                        setConditionToDelete({ id: 'root' });\n                      }}\n                    >\n                      <i className=\"fa fa-trash-alt\" />\n                    </button>\n                  </span>\n                </OverlayTrigger>\n              )}\n              <OverlayTrigger\n                placement=\"top\"\n                delay={{ show: 150, hide: 150 }}\n                overlay={\n                  <Tooltip id=\"button-tooltip\" style={{ fontSize: '12px' }}>\n                    New Condition\n                  </Tooltip>\n                }\n              >\n                <button\n                  className=\"dropdown-toggle btn btn-link p-0 ml-1\"\n                  type=\"button\"\n                  id={`add-condition-${id}-context-trigger-${index}`}\n                  data-toggle=\"dropdown\"\n                  aria-haspopup=\"true\"\n                  aria-expanded=\"false\"\n                  onClick={() => {\n                    ($(`#add-condition-${id}-context-trigger-${index}`) as any).dropdown('toggle');\n                  }}\n                >\n                  <i className=\"fa fa-plus\" />\n                </button>\n              </OverlayTrigger>\n              <div\n                id={`add-condition-${id}-context-menu`}\n                className=\"dropdown-menu\"\n                aria-labelledby={`add-condition-${id}-context-trigger-${index}`}\n              >\n                <AddConditionContextMenu />\n              </div>\n            </div>\n          </div>\n          <div className=\"d-flex align-items-center flex-wrap\">\n            <span className=\"mr-2\">If</span>\n            <div className=\"form-check form-check-inline mr-1\">\n              <input\n                className=\"form-check-input\"\n                type=\"radio\"\n                name={`anyAllToggle-${id}`}\n                id={`anyCondition-${id}`}\n                defaultChecked={blockType === 'any'}\n                onChange={() => handleBlockTypeChange()}\n              />\n              <label className=\"form-check-label\" htmlFor=\"anyCondition-root\">\n                ANY\n              </label>\n            </div>\n            <div className=\"form-check form-check-inline mr-2\">\n              <input\n                className=\"form-check-input\"\n                type=\"radio\"\n                name={`anyAllToggle-${id}`}\n                id={`allCondition-${id}`}\n                defaultChecked={blockType === 'all'}\n                onChange={() => handleBlockTypeChange()}\n              />\n              <label className=\"form-check-label\" htmlFor=\"allCondition-root\">\n                ALL\n              </label>\n            </div>\n            of the following conditions are met\n          </div>\n          {conditions.length <= 0 && (\n            <div className=\"mt-2 text-danger\">No conditions. This rule will always fire.</div>\n          )}\n          {conditions.map((condition, index) =>\n            (condition as JanusAllConditions).all || (condition as JanusAnyConditions).any ? (\n              <ConditionsBlockEditor\n                key={condition.id || `cb-${index}`}\n                id={condition.id || `cb-${index}`}\n                type={(condition as JanusAllConditions).all ? 'all' : 'any'}\n                rootConditions={\n                  (condition as JanusAllConditions).all ||\n                  (condition as JanusAnyConditions).any ||\n                  []\n                }\n                onChange={(changes) =>\n                  handleSubBlockChange(condition as JanusTopLevelCondition, changes)\n                }\n                index={loopIndex}\n              />\n            ) : (\n              <ConditionItemEditor\n                key={condition.id || `ci-${index}`}\n                parentIndex={index}\n                condition={condition as JanusConditionProperties}\n                onChange={(changes) =>\n                  handleConditionItemChange(condition as JanusConditionProperties, changes)\n                }\n                onDelete={() => handleDeleteCondition(condition)}\n              />\n            ),\n          )}\n        </div>\n      </div>\n      {showConfirmDelete && (\n        <ConfirmDelete\n          show={showConfirmDelete}\n          elementType={`${loopIndexToDelete ? 'Condition Group' : 'All Conditions'}`}\n          elementName={`${loopIndexToDelete ? 'this condition group' : 'all conditions'}`}\n          deleteHandler={() => {\n            handleDeleteCondition(\n              conditionToDelete,\n              loopIndexToDelete ? loopIndexToDelete : undefined,\n            );\n            setShowConfirmDelete(false);\n            setConditionToDelete(undefined);\n            setLoopIndexToDelete(undefined);\n          }}\n          cancelHandler={() => {\n            setShowConfirmDelete(false);\n            setConditionToDelete(undefined);\n            setLoopIndexToDelete(undefined);\n          }}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default ConditionsBlockEditor;\n"]}