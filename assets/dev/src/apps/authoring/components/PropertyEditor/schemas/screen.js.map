{"version":3,"file":"screen.js","sourceRoot":"","sources":["../../../../../../../src/apps/authoring/components/PropertyEditor/schemas/screen.ts"],"names":[],"mappings":"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","sourcesContent":["import { UiSchema } from '@rjsf/core';\nimport { IActivity } from 'apps/delivery/store/features/activities/slice';\nimport chroma from 'chroma-js';\nimport { JSONSchema7 } from 'json-schema';\nimport ColorPickerWidget from '../custom/ColorPickerWidget';\nimport CustomFieldTemplate from '../custom/CustomFieldTemplate';\n\nexport interface ScreenModel {\n  title: string;\n  width: number;\n  height: number;\n  palette: any;\n  customCssClass: string;\n  combineFeedback: boolean;\n  showCheckButton: boolean;\n  checkButtonLabel: string;\n  [key: string]: any; // TODO\n}\n\nconst screenSchema: JSONSchema7 = {\n  type: 'object',\n  properties: {\n    title: {\n      type: 'string',\n      title: 'Title',\n    },\n    Size: {\n      type: 'object',\n      title: 'Dimensions',\n      properties: {\n        width: { type: 'number', title: 'Width' },\n        height: { type: 'number', title: 'Height' },\n      },\n    },\n    palette: {\n      type: 'object',\n      properties: {\n        backgroundColor: { type: 'string', title: 'Background Color' },\n        borderColor: { type: 'string', title: 'Border Color' },\n        borderRadius: { type: 'string', title: 'Border Radius' },\n        borderStyle: { type: 'string', title: 'Border Style' },\n        borderWidth: { type: 'string', title: 'Border Width' },\n      },\n    },\n    customCssClass: {\n      title: 'Custom CSS Class',\n      type: 'string',\n    },\n    combineFeedback: {\n      title: 'Combine Feedback',\n      type: 'boolean',\n      format: 'checkbox',\n      default: true,\n    },\n    checkButton: {\n      type: 'object',\n      properties: {\n        showCheckBtn: {\n          title: 'Show Check Button',\n          type: 'boolean',\n          format: 'checkbox',\n        },\n        checkButtonLabel: {\n          title: 'Check Button Label',\n          type: 'string',\n        },\n      },\n    },\n    max: {\n      type: 'object',\n      properties: {\n        maxAttempt: {\n          title: 'Max Attempts',\n          type: 'number',\n        },\n        maxScore: {\n          title: 'Max Score',\n          type: 'number',\n        },\n      },\n    },\n    trapStateScoreScheme: {\n      title: 'Trap State Scoring',\n      type: 'boolean',\n      format: 'checkbox',\n      default: true,\n    },\n    negativeScoreAllowed: {\n      title: 'Allow Negative Question Score',\n      type: 'boolean',\n      format: 'checkbox',\n      default: true,\n    },\n  },\n};\n\nexport const screenUiSchema: UiSchema = {\n  Size: {\n    'ui:ObjectFieldTemplate': CustomFieldTemplate,\n    'ui:title': 'Dimensions',\n    width: {\n      classNames: 'col-6',\n    },\n    height: {\n      classNames: 'col-6',\n    },\n  },\n  max: {\n    'ui:ObjectFieldTemplate': CustomFieldTemplate,\n    maxAttempt: {\n      classNames: 'col-6',\n    },\n    maxScore: {\n      classNames: 'col-6',\n    },\n  },\n  palette: {\n    'ui:ObjectFieldTemplate': CustomFieldTemplate,\n    'ui:title': 'Palette',\n    backgroundColor: {\n      'ui:widget': ColorPickerWidget,\n    },\n    borderColor: {\n      'ui:widget': ColorPickerWidget,\n    },\n    borderStyle: { classNames: 'col-6' },\n    borderWidth: { classNames: 'col-6' },\n  },\n  checkButton: {\n    'ui:ObjectFieldTemplate': CustomFieldTemplate,\n    showCheckBtn: {\n      classNames: 'col-12',\n    },\n    checkButtonLabel: {\n      classNames: 'col-12',\n    },\n  },\n};\n\nexport const transformScreenModeltoSchema = (activity?: IActivity) => {\n  if (activity) {\n    const data = activity?.content?.custom;\n    if (!data) {\n      console.warn('no custom??', { activity });\n      // this might have happened from a previous version that trashed the lesson data\n      // TODO: maybe look into validation / defaults\n      return;\n    }\n    const schemaPalette = {\n      ...data.palette,\n      borderWidth: `${data.palette.lineThickness ? data.palette.lineThickness + 'px' : '1px'}`,\n      borderRadius: '10px',\n      borderStyle: 'solid',\n      borderColor: `rgba(${\n        data.palette.lineColor || data.palette.lineColor === 0\n          ? chroma(data.palette.lineColor).rgb().join(',')\n          : '255, 255, 255'\n      },${data.palette.lineAlpha || '100'})`,\n      backgroundColor: `rgba(${\n        data.palette.fillColor || data.palette.fillColor === 0\n          ? chroma(data.palette.fillColor).rgb().join(',')\n          : '255, 255, 255'\n      },${data.palette.fillAlpha || '100'})`,\n    };\n    return {\n      ...data,\n      title: activity?.title || '',\n      Size: { width: data.width, height: data.height },\n      checkButton: { showCheckBtn: data.showCheckBtn, checkButtonLabel: data.checkButtonLabel },\n      max: { maxAttempt: data.maxAttempt, maxScore: data.maxScore },\n      palette: data.palette.useHtmlProps ? data.palette : schemaPalette,\n    };\n  }\n};\n\nexport const transformScreenSchematoModel = (schema: any): Partial<ScreenModel> => {\n  return {\n    title: schema.title,\n    width: schema.Size.width,\n    height: schema.Size.height,\n    customCssClass: schema.customCssClass,\n    combineFeedback: schema.combineFeedback,\n    showCheckBtn: schema.checkButton.showCheckBtn,\n    checkButtonLabel: schema.checkButton.checkButtonLabel,\n    maxAttempt: schema.max.maxAttempt,\n    maxScore: schema.max.maxScore,\n    palette: { ...schema.palette, useHtmlProps: true },\n    trapStateScoreScheme: schema.trapStateScoreScheme,\n    negativeScoreAllowed: schema.negativeScoreAllowed,\n  };\n};\n\nexport default screenSchema;\n"]}