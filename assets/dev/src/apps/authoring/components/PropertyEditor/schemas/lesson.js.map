{"version":3,"file":"lesson.js","sourceRoot":"","sources":["../../../../../../../src/apps/authoring/components/PropertyEditor/schemas/lesson.ts"],"names":[],"mappings":"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","sourcesContent":["import { UiSchema } from '@rjsf/core';\nimport { JSONSchema7 } from 'json-schema';\nimport AccordionTemplate from '../custom/AccordionTemplate';\nimport CustomFieldTemplate from '../custom/CustomFieldTemplate';\n\nconst lessonSchema: JSONSchema7 = {\n  type: 'object',\n  properties: {\n    Properties: {\n      type: 'object',\n      title: ' Properties',\n      properties: {\n        title: {\n          type: 'string',\n          title: 'Title',\n          readOnly: true,\n        },\n        Size: {\n          type: 'object',\n          title: 'Dimensions',\n          properties: {\n            width: { type: 'number' },\n            height: { type: 'number' },\n          },\n        },\n        Appearance: {\n          type: 'object',\n          title: 'Lesson Appearance',\n          properties: {\n            theme: {\n              anyOf: [\n                {\n                  type: 'string',\n                  title: 'Default Theme',\n                  enum: ['/css/delivery_adaptive_themes_default_light.css'],\n                  default: '/css/delivery_adaptive_themes_default_light.css',\n                },\n                { type: 'string', title: 'Custom Theme' },\n              ],\n            },\n            customCssUrl: {\n              type: 'string',\n              title: 'Custom CSS URL',\n            },\n            backgroundImageURL: {\n              type: 'string',\n              title: 'Background Image URL',\n            },\n            backgroundImageScaleContent: {\n              type: 'boolean',\n              title: 'Scale Background Image to Fit',\n            },\n          },\n        },\n        FinishPanel: {\n          type: 'object',\n          properties: {\n            logoutMessage: {\n              title: 'Message',\n              type: 'string',\n              format: 'textarea',\n            },\n            logoutPanelImageURL: {\n              type: 'string',\n              title: 'Background URL',\n            },\n          },\n        },\n        enableHistory: {\n          title: 'Enable History',\n          type: 'boolean',\n        },\n        ScoreOverview: {\n          type: 'object',\n          properties: {\n            enableLessonMax: { type: 'boolean', title: 'Enable a Lesson Maximum' },\n            lessonMax: { type: 'number', title: 'Lesson Max' },\n          },\n        },\n        customCSS: {\n          title: 'Custom CSS',\n          type: 'string',\n          description: 'block of css code to be injected into style tag',\n          format: 'textarea',\n        },\n      },\n    },\n    CustomLogic: {\n      type: 'object',\n      title: 'Custom Logic',\n      properties: {\n        variables: {\n          type: 'string',\n          title: 'Variables',\n          format: 'textarea',\n        },\n        customScript: {\n          type: 'string',\n          title: 'Custom Script',\n          format: 'textarea',\n        },\n      },\n    },\n  },\n};\n\nexport const lessonUiSchema: UiSchema = {\n  Properties: {\n    'ui:ObjectFieldTemplate': AccordionTemplate,\n    Size: {\n      'ui:ObjectFieldTemplate': CustomFieldTemplate,\n      'ui:title': 'Screen Size',\n      width: {\n        classNames: 'col-6',\n      },\n      height: {\n        classNames: 'col-6',\n      },\n    },\n    Appearance: {\n      'ui:ObjectFieldTemplate': CustomFieldTemplate,\n      'ui:title': 'Lesson Appearance',\n    },\n    FinishPanel: {\n      'ui:ObjectFieldTemplate': CustomFieldTemplate,\n      'ui:title': 'Finish Panel',\n    },\n    ScoreOverview: {\n      'ui:ObjectFieldTemplate': CustomFieldTemplate,\n      'ui:title': 'Score Overview',\n    },\n  },\n  CustomLogic: {\n    'ui:ObjectFieldTemplate': AccordionTemplate,\n  },\n};\n\n// we don't have the actual theme urls yet,\n// they will likely come from somehwere else\n// const themeMap: { [key: string]: string } = {\n//   'url to new theme': 'Light Responsive',\n//   'default': 'LEGACY',\n// };\n\nexport const transformModelToSchema = (model: any) => {\n  const [themeUrl, customCssUrl] = model.additionalStylesheets;\n\n  return {\n    Properties: {\n      Size: { width: model.custom.defaultScreenWidth, height: model.custom.defaultScreenHeight },\n      Appearance: {\n        theme: themeUrl,\n        customCssUrl,\n        backgroundImageURL: model.custom.backgroundImageURL,\n        backgroundImageScaleContent: model.custom.backgroundImageScaleContent,\n      },\n      ScoreOverview: {\n        enableLessonMax: model.custom.enableLessonMax,\n        lessonMax: model.custom.lessonMax,\n      },\n      FinishPanel: {\n        logoutMessage: model.custom.logoutMessage,\n        logoutPanelImageURL: model.custom.logoutPanelImageURL,\n      },\n      title: model.title,\n      customCSS: model.customCss,\n      enableHistory: model.custom.allowNavigation || model.custom.enableHistory || false,\n    },\n    CustomLogic: {\n      variables: JSON.stringify(model.custom.variables),\n      customScript: model.customScript,\n    },\n  };\n};\n\nexport const transformSchemaToModel = (schema: any) => {\n  /* console.log('LESSON SCHEMA -> MODEL', schema); */\n\n  const additionalStylesheets = [\n    schema.Properties.Appearance.theme,\n    schema.Properties.Appearance.customCssUrl,\n  ];\n\n  let variables = [];\n  try {\n    variables = JSON.parse(schema.CustomLogic.variables);\n  } catch (e) {\n    // console.warn('could not parse variables', e);\n    // most likely just empty string\n  }\n\n  return {\n    custom: {\n      defaultScreenWidth: schema.Properties.Size.width,\n      defaultScreenHeight: schema.Properties.Size.height,\n      enableLessonMax: schema.Properties.ScoreOverview.enableLessonMax,\n      lessonMax: schema.Properties.ScoreOverview.lessonMax,\n      enableHistory: schema.Properties.enableHistory,\n      variables,\n      logoutMessage: schema.Properties.FinishPanel.logoutMessage,\n      logoutPanelImageURL: schema.Properties.FinishPanel.logoutPanelImageURL,\n      backgroundImageURL: schema.Properties.Appearance.backgroundImageURL,\n      backgroundImageScaleContent: schema.Properties.Appearance.backgroundImageScaleContent,\n    },\n    additionalStylesheets,\n    title: schema.Properties.title,\n    customCss: schema.Properties.customCSS || '',\n    customScript: schema.CustomLogic.customScript,\n  };\n};\n\nexport default lessonSchema;\n"]}