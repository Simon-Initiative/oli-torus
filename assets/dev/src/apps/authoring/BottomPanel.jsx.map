{"version":3,"file":"BottomPanel.jsx","sourceRoot":"","sources":["../../../../src/apps/authoring/BottomPanel.tsx"],"names":[],"mappings":";;;;;;;;;AAAA,OAAO,KAAK,EAAE,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,EAAE,MAAM,OAAO,CAAC;AAChE,OAAO,EAAE,QAAQ,EAAE,MAAM,QAAQ,CAAC;AAClC,OAAO,EAAE,cAAc,EAAE,OAAO,EAAE,MAAM,iBAAiB,CAAC;AAC1D,OAAO,EAAE,WAAW,EAAE,WAAW,EAAE,MAAM,aAAa,CAAC;AACvD,OAAO,EAAa,qBAAqB,EAAE,MAAM,6CAA6C,CAAC;AAC/F,OAAO,EAAE,iBAAiB,EAAE,cAAc,EAAE,MAAM,mBAAmB,CAAC;AACtE,OAAO,EAAE,KAAK,EAAE,MAAM,oBAAoB,CAAC;AAC3C,OAAO,EAAE,YAAY,EAAE,MAAM,yCAAyC,CAAC;AACvE,OAAO,EAAE,iBAAiB,EAAE,mBAAmB,EAAE,MAAM,kCAAkC,CAAC;AAC1F,OAAO,EAAE,UAAU,EAAE,MAAM,oDAAoD,CAAC;AAEhF,OAAO,aAAa,MAAM,4CAA4C,CAAC;AASvE,MAAM,CAAC,MAAM,WAAW,GAA+B,CAAC,KAAuB,EAAE,EAAE;;IACjF,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,KAAK,CAAC;IACjD,MAAM,gBAAgB,GAAG,OAAO,CAAC;IACjC,MAAM,QAAQ,GAAG,WAAW,EAAE,CAAC;IAC/B,MAAM,WAAW,GAAG,WAAW,CAAC,iBAAiB,CAAC,CAAC;IACnD,MAAM,eAAe,GAAG,WAAW,CAAC,qBAAqB,CAAC,CAAC;IAC3D,MAAM,CAAC,OAAO,EAAE,UAAU,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;IAC9C,MAAM,CAAC,UAAU,EAAE,aAAa,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;IACpD,MAAM,CAAC,iBAAiB,EAAE,oBAAoB,CAAC,GAAG,QAAQ,CAAU,KAAK,CAAC,CAAC;IAC3E,MAAM,OAAO,GAAG,UAAU,EAAE,CAAC;IAE7B,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,WAAW,KAAK,SAAS;YAAE,OAAO;QACtC,IAAI,WAAW,KAAK,WAAW,EAAE;YAC/B,UAAU,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;YAChC,aAAa,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;SACrC;IACH,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;IAElB,MAAM,mBAAmB,GAAG,GAAG,EAAE;QAC/B,MAAM,aAAa,GAAc,KAAK,CAAC,eAAe,CAAC,CAAC;QACxD,MAAM,WAAW,mCAAQ,WAAW,KAAE,OAAO,EAAE,CAAC,OAAO,GAAE,CAAC;QAC1D,MAAM,YAAY,GAAc,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAChE,CAAC,IAAkB,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE,KAAK,WAAW,CAAC,EAAE,CACnD,CAAC;QACF,YAAY,CAAC,OAAO,GAAG,CAAC,OAAO,CAAC;QAChC,QAAQ,CAAC,cAAc,CAAC,EAAE,WAAW,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC;QACvD,UAAU,CAAC,CAAC,OAAO,CAAC,CAAC;QACrB,mBAAmB,CAAC,aAAa,CAAC,CAAC;IACrC,CAAC,CAAC;IAEF,MAAM,oBAAoB,GAAG,GAAG,EAAE;QAChC,MAAM,aAAa,GAAc,KAAK,CAAC,eAAe,CAAC,CAAC;QACxD,MAAM,WAAW,mCAAQ,WAAW,KAAE,QAAQ,EAAE,CAAC,UAAU,GAAE,CAAC;QAC9D,MAAM,YAAY,GAAc,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAChE,CAAC,IAAkB,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE,KAAK,WAAW,CAAC,EAAE,CACnD,CAAC;QACF,YAAY,CAAC,QAAQ,GAAG,CAAC,UAAU,CAAC;QACpC,QAAQ,CAAC,cAAc,CAAC,EAAE,WAAW,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC;QACvD,aAAa,CAAC,CAAC,UAAU,CAAC,CAAC;QAC3B,mBAAmB,CAAC,aAAa,CAAC,CAAC;IACrC,CAAC,CAAC;IAEF,MAAM,mBAAmB,GAAG,WAAW,CACrC,QAAQ,CACN,CAAC,QAAQ,EAAE,EAAE;QACX,QAAQ,CAAC,YAAY,CAAC,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;IACvC,CAAC,EACD,GAAG,EACH,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,CACnC,EACD,EAAE,CACH,CAAC;IAEF,MAAM,mBAAmB,GAAG,CAAC,KAAqB,EAAE,WAAqB,EAAE,EAAE;QAC3E,0EAA0E;QAC1E,MAAM,mBAAmB,GAAG,KAAK,CAAC,SAAS,CACzC,CAAC,IAAkB,EAAE,EAAE,CAAC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CACrD,CAAC;QACF,MAAM,iBAAiB,GAAG,KAAK,CAAC,SAAS,CACvC,CAAC,IAAkB,EAAE,EAAE,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CACtD,CAAC;QAEF,IAAI,mBAAmB,KAAK,CAAC,IAAI,iBAAiB,KAAK,KAAK,CAAC,MAAM,GAAG,CAAC;YAAE,OAAO,KAAK,CAAC;QACtF,MAAM,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC;QAEhC,+CAA+C;QAC/C,UAAU,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,mBAAmB,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEjE,iDAAiD;QACjD,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,iBAAiB,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAE5D,IAAI,WAAW,EAAE;YACf,MAAM,aAAa,GAAc,KAAK,CAAC,eAAe,CAAC,CAAC;YACxD,aAAa,CAAC,SAAS,CAAC,KAAK,GAAG,UAAU,CAAC;YAC3C,mBAAmB,CAAC,aAAa,CAAC,CAAC;SACpC;;YAAM,OAAO,UAAU,CAAC;IAC3B,CAAC,CAAC;IAEF,MAAM,oBAAoB,GAAG,GAAS,EAAE;QACtC,MAAM,EAAE,OAAO,EAAE,cAAc,EAAE,GAAG,MAAM,QAAQ,CAChD,iBAAiB,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CACxC,CAAC;QACF,MAAM,aAAa,GAAc,KAAK,CAAC,eAAe,CAAC,CAAC;QACxD,MAAM,gBAAgB,GAAG,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,SAAS,CAC9D,CAAC,IAAkB,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE,KAAK,WAAW,CAAC,EAAE,CACnD,CAAC;QACF,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,gBAAgB,GAAG,CAAC,EAAE,CAAC,EAAE,cAAc,CAAC,CAAC;QAC9E,aAAa,CAAC,SAAS,CAAC,KAAK,GAAG,mBAAmB,CAAC,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACnF,QAAQ,CAAC,cAAc,CAAC,EAAE,WAAW,EAAE,cAAc,EAAE,CAAC,CAAC,CAAC;QAC1D,mBAAmB,CAAC,aAAa,CAAC,CAAC;IACrC,CAAC,CAAA,CAAC;IAEF,MAAM,sBAAsB,GAAG,GAAS,EAAE;QACxC,MAAM,EAAE,OAAO,EAAE,gBAAgB,EAAE,GAAG,MAAM,QAAQ,CAClD,mBAAmB,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAC1C,CAAC;QACF,MAAM,aAAa,GAAc,KAAK,CAAC,eAAe,CAAC,CAAC;QACxD,MAAM,gBAAgB,GAAG,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,SAAS,CAC9D,CAAC,IAAkB,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE,KAAK,WAAW,CAAC,EAAE,CACnD,CAAC;QACF,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,gBAAgB,GAAG,CAAC,EAAE,CAAC,EAAE,gBAAgB,CAAC,CAAC;QAChF,aAAa,CAAC,SAAS,CAAC,KAAK,GAAG,mBAAmB,CAAC,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACnF,QAAQ,CAAC,cAAc,CAAC,EAAE,WAAW,EAAE,gBAAgB,EAAE,CAAC,CAAC,CAAC;QAC5D,mBAAmB,CAAC,aAAa,CAAC,CAAC;IACrC,CAAC,CAAA,CAAC;IAEF,MAAM,gBAAgB,GAAG,GAAG,EAAE;QAC5B,MAAM,aAAa,GAAc,KAAK,CAAC,eAAe,CAAC,CAAC;QACxD,MAAM,aAAa,GAAG,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,SAAS,CAC3D,CAAC,IAAkB,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE,KAAK,WAAW,CAAC,EAAE,CACnD,CAAC;QACF,IAAI,aAAa,KAAK,CAAC,CAAC,EAAE;YACxB,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;YACvD,MAAM,QAAQ,GAAG,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,CAAC,CAAC,CAAC;YAClE,MAAM,QAAQ,GAAG,aAAa,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,GAAG,CAAC,CAAC,CAAC;YAClE,QAAQ,CAAC,cAAc,CAAC,EAAE,WAAW,EAAE,QAAQ,KAAK,SAAS,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;YACxF,mBAAmB,CAAC,aAAa,CAAC,CAAC;SACpC;QACD,oBAAoB,CAAC,KAAK,CAAC,CAAC;IAC9B,CAAC,CAAC;IAEF,OAAO,CACL,EACE;MAAA,CAAC,OAAO,CACN,EAAE,CAAC,iBAAiB,CACpB,SAAS,CAAC,CAAC,wBAAwB,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CACzE,KAAK,CAAC,CAAC;YACL,IAAI,EAAE,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM;YAC3C,KAAK,EAAE,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;YACjD,MAAM,EAAE,UAAU,CAAC,QAAQ,CAAC;gBAC1B,CAAC,CAAC,CAAC;gBACH,CAAC,CAAC,SAAS,MAAA,QAAQ,CAAC,cAAc,CAAC,iBAAiB,CAAC,0CAAE,YAAY,YAAY;SAClF,CAAC,CAEF;QAAA,CAAC,GAAG,CAAC,SAAS,CAAC,gBAAgB,CAC7B;UAAA,CAAC,GAAG,CAAC,SAAS,CAAC,4BAA4B,CACzC;YAAA,CAAC,GAAG,CAAC,SAAS,CAAC,6BAA6B,CAC1C;cAAA,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,WAAW,EAAE,IAAI,CACzC;cAAA,CAAC,WAAW,IAAI,CAAC,OAAO,IAAI,CAC1B,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CACxB;kBAAA,CAAC,WAAW,KAAK,WAAW,CAAC,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,CACnE;gBAAA,EAAE,IAAI,CAAC,CACR,CACH;YAAA,EAAE,GAAG,CACL;YAAA,CAAC,GAAG,CAAC,SAAS,CAAC,4EAA4E,CACzF;cAAA,CAAC,WAAW;YACV,WAAW,CAAC,OAAO;YACnB,WAAW,CAAC,OAAO;YACnB,WAAW,KAAK,WAAW,IAAI,CAC7B,CAAC,GAAG,CAAC,SAAS,CAAC,8GAA8G,CAC3H;oBAAA,CAAC,KAAK,CACJ,SAAS,CAAC,kBAAkB,CAC5B,IAAI,CAAC,UAAU,CACf,EAAE,CAAC,sBAAsB,CACzB,OAAO,CAAC,CAAC,UAAU,CAAC,CACpB,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC,oBAAoB,EAAE,CAAC,EAEzC;oBAAA,CAAC,KAAK,CAAC,SAAS,CAAC,kBAAkB,CAAC,OAAO,CAAC,sBAAsB,CAChE;;oBACF,EAAE,KAAK,CACT;kBAAA,EAAE,GAAG,CAAC,CACP,CACH;cAAA,CAAC,WAAW,IAAI,CAAC,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,IAAI,WAAW,KAAK,WAAW,IAAI,CACjF,EACE;kBAAA,CAAC,GAAG,CAAC,SAAS,CAAC,sEAAsE,CACnF;oBAAA,CAAC,CAAC,CAAC,SAAS,CAAC,kBAAkB,EAC/B;oBAAA,CAAC,GAAG,CAAC,SAAS,CAAC,8BAA8B,CAC3C;sBAAA,CAAC,KAAK,CACJ,IAAI,CAAC,UAAU,CACf,SAAS,CAAC,sBAAsB,CAChC,EAAE,CAAC,CAAC,gBAAgB,CAAC,CACrB,OAAO,CAAC,CAAC,OAAO,CAAC,CACjB,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC,mBAAmB,EAAE,CAAC,EAExC;sBAAA,CAAC,KAAK,CAAC,SAAS,CAAC,sBAAsB,CAAC,OAAO,CAAC,CAAC,gBAAgB,CAAC,CAAC,EAAE,KAAK,CAC5E;oBAAA,EAAE,GAAG,CACL;oBAAA,CAAC,CAAC,CAAC,SAAS,CAAC,aAAa,EAC5B;kBAAA,EAAE,GAAG,CACL;kBAAA,CAAC,cAAc,CACb,SAAS,CAAC,KAAK,CACf,KAAK,CAAC,CAAC,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,CAChC,OAAO,CAAC,CACN,CAAC,OAAO,CAAC,EAAE,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,CACvD;;sBACF,EAAE,OAAO,CAAC,CACX,CAED;oBAAA,CAAC,IAAI,CACH;sBAAA,CAAC,MAAM,CACL,SAAS,CAAC,uBAAuB,CACjC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC,CAE1C;wBAAA,CAAC,CAAC,CAAC,SAAS,CAAC,iBAAiB,EAChC;sBAAA,EAAE,MAAM,CACV;oBAAA,EAAE,IAAI,CACR;kBAAA,EAAE,cAAc,CAClB;gBAAA,GAAG,CACJ,CACD;cAAA,CAAC,WAAW,IAAI,CAAC,OAAO,IAAI,CAC1B,CAAC,cAAc,CACb,SAAS,CAAC,KAAK,CACf,KAAK,CAAC,CAAC,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,CAChC,OAAO,CAAC,CACN,CAAC,OAAO,CAAC,EAAE,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,CACvD;;oBACF,EAAE,OAAO,CAAC,CACX,CAED;kBAAA,CAAC,GAAG,CAAC,SAAS,CAAC,UAAU,CACvB;oBAAA,CAAC,MAAM,CACL,SAAS,CAAC,CAAC,oCACT,CAAA,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAE,OAAO,EAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAClC,EAAE,CAAC,CACH,IAAI,CAAC,QAAQ,CACb,EAAE,CAAC,CAAC,kCAAkC,CAAC,CACvC,WAAW,CAAC,UAAU,CACtB,aAAa,CAAC,MAAM,CACpB,aAAa,CAAC,OAAO,CACrB,OAAO,CAAC,CAAC,GAAG,EAAE;gBACX,CAAC,CAAC,mCAAmC,CAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;YACrE,CAAC,CAAC,CAEF;sBAAA,CAAC,CAAC,CAAC,SAAS,CAAC,YAAY,EAC3B;oBAAA,EAAE,MAAM,CACR;oBAAA,CAAC,GAAG,CACF,EAAE,CAAC,CAAC,+BAA+B,CAAC,CACpC,SAAS,CAAC,eAAe,CACzB,eAAe,CAAC,CAAC,kCAAkC,CAAC,CAEpD;sBAAA,CAAC,MAAM,CACL,SAAS,CAAC,eAAe,CACzB,OAAO,CAAC,CAAC,GAAG,EAAE;gBACZ,oBAAoB,EAAE,CAAC;YACzB,CAAC,CAAC,CAEF;wBAAA,CAAC,CAAC,CAAC,SAAS,CAAC,kBAAkB,EAAI;sBACrC,EAAE,MAAM,CACR;sBAAA,CAAC,MAAM,CACL,SAAS,CAAC,eAAe,CACzB,OAAO,CAAC,CAAC,GAAG,EAAE;gBACZ,sBAAsB,EAAE,CAAC;YAC3B,CAAC,CAAC,CAEF;wBAAA,CAAC,CAAC,CAAC,SAAS,CAAC,kBAAkB,EAAI;sBACrC,EAAE,MAAM,CACV;oBAAA,EAAE,GAAG,CACP;kBAAA,EAAE,GAAG,CACP;gBAAA,EAAE,cAAc,CAAC,CAClB,CACD;cAAA,CAAC,MAAM,CAAC,SAAS,CAAC,uBAAuB,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE,CAAC,CAClE;gBAAA,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,kBAAkB,EAAG,CAC3D;gBAAA,CAAC,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,mBAAmB,EAAG,CAC/D;cAAA,EAAE,MAAM,CACV;YAAA,EAAE,GAAG,CACP;UAAA,EAAE,GAAG,CACL;UAAA,CAAC,QAAQ,CACX;QAAA,EAAE,GAAG,CACP;MAAA,EAAE,OAAO,CACT;MAAA,CAAC,iBAAiB,IAAI,CACpB,CAAC,aAAa,CACZ,IAAI,CAAC,CAAC,iBAAiB,CAAC,CACxB,WAAW,CAAC,MAAM,CAClB,WAAW,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,CAC9B,aAAa,CAAC,CAAC,GAAG,EAAE,CAAC,gBAAgB,EAAE,CAAC,CACxC,aAAa,CAAC,CAAC,GAAG,EAAE;gBAClB,oBAAoB,CAAC,KAAK,CAAC,CAAC;YAC9B,CAAC,CAAC,EACF,CACH,CACH;IAAA,GAAG,CACJ,CAAC;AACJ,CAAC,CAAC","sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\nimport { debounce } from 'lodash';\nimport { OverlayTrigger, Tooltip } from 'react-bootstrap';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { IActivity, selectCurrentActivity } from '../delivery/store/features/activities/slice';\nimport { selectCurrentRule, setCurrentRule } from './store/app/slice';\nimport { clone } from '../../utils/common';\nimport { saveActivity } from './store/activities/actions/saveActivity';\nimport { createCorrectRule, createIncorrectRule } from './store/activities/actions/rules';\nimport { getIsLayer } from '../delivery/store/features/groups/actions/sequence';\nimport { AdaptiveRule } from './components/AdaptiveRulesList/AdaptiveRulesList';\nimport ConfirmDelete from './components/Modal/DeleteConfirmationModal';\n\nexport interface BottomPanelProps {\n  panelState: any;\n  onToggle: any;\n  children?: any;\n  content?: any;\n}\n\nexport const BottomPanel: React.FC<BottomPanelProps> = (props: BottomPanelProps) => {\n  const { panelState, onToggle, children } = props;\n  const PANEL_SIDE_WIDTH = '270px';\n  const dispatch = useDispatch();\n  const currentRule = useSelector(selectCurrentRule);\n  const currentActivity = useSelector(selectCurrentActivity);\n  const [correct, setCorrect] = useState(false);\n  const [isDisabled, setIsDisabled] = useState(false);\n  const [showConfirmDelete, setShowConfirmDelete] = useState<boolean>(false);\n  const isLayer = getIsLayer();\n\n  useEffect(() => {\n    if (currentRule === undefined) return;\n    if (currentRule !== 'initState') {\n      setCorrect(currentRule.correct);\n      setIsDisabled(currentRule.disabled);\n    }\n  }, [currentRule]);\n\n  const handleCorrectChange = () => {\n    const activityClone: IActivity = clone(currentActivity);\n    const updatedRule = { ...currentRule, correct: !correct };\n    const ruleToUpdate: IActivity = activityClone.authoring.rules.find(\n      (rule: AdaptiveRule) => rule.id === updatedRule.id,\n    );\n    ruleToUpdate.correct = !correct;\n    dispatch(setCurrentRule({ currentRule: updatedRule }));\n    setCorrect(!correct);\n    debounceSaveChanges(activityClone);\n  };\n\n  const handleDisabledChange = () => {\n    const activityClone: IActivity = clone(currentActivity);\n    const updatedRule = { ...currentRule, disabled: !isDisabled };\n    const ruleToUpdate: IActivity = activityClone.authoring.rules.find(\n      (rule: AdaptiveRule) => rule.id === updatedRule.id,\n    );\n    ruleToUpdate.disabled = !isDisabled;\n    dispatch(setCurrentRule({ currentRule: updatedRule }));\n    setIsDisabled(!isDisabled);\n    debounceSaveChanges(activityClone);\n  };\n\n  const debounceSaveChanges = useCallback(\n    debounce(\n      (activity) => {\n        dispatch(saveActivity({ activity }));\n      },\n      500,\n      { maxWait: 10000, leading: false },\n    ),\n    [],\n  );\n\n  const reorderDefaultRules = (rules: AdaptiveRule[], saveChanges?: boolean) => {\n    // process the rules to make a defaultRule sandwich before displaying them\n    const defaultCorrectIndex = rules.findIndex(\n      (rule: AdaptiveRule) => rule.default && rule.correct,\n    );\n    const defaultWrongIndex = rules.findIndex(\n      (rule: AdaptiveRule) => rule.default && !rule.correct,\n    );\n\n    if (defaultCorrectIndex === 0 && defaultWrongIndex === rules.length - 1) return rules;\n    const rulesClone = clone(rules);\n\n    // set the defaultCorrect to the first position\n    rulesClone.unshift(rulesClone.splice(defaultCorrectIndex, 1)[0]);\n\n    // set the defaultWrong rule to the last position\n    rulesClone.push(rulesClone.splice(defaultWrongIndex, 1)[0]);\n\n    if (saveChanges) {\n      const activityClone: IActivity = clone(currentActivity);\n      activityClone.authoring.rules = rulesClone;\n      debounceSaveChanges(activityClone);\n    } else return rulesClone;\n  };\n\n  const handleAddCorrectRule = async () => {\n    const { payload: newCorrectRule } = await dispatch<any>(\n      createCorrectRule({ isDefault: false }),\n    );\n    const activityClone: IActivity = clone(currentActivity);\n    const currentRuleIndex = activityClone.authoring.rules.findIndex(\n      (rule: AdaptiveRule) => rule.id === currentRule.id,\n    );\n    activityClone.authoring.rules.splice(currentRuleIndex + 1, 0, newCorrectRule);\n    activityClone.authoring.rules = reorderDefaultRules(activityClone.authoring.rules);\n    dispatch(setCurrentRule({ currentRule: newCorrectRule }));\n    debounceSaveChanges(activityClone);\n  };\n\n  const handleAddIncorrectRule = async () => {\n    const { payload: newIncorrectRule } = await dispatch<any>(\n      createIncorrectRule({ isDefault: false }),\n    );\n    const activityClone: IActivity = clone(currentActivity);\n    const currentRuleIndex = activityClone.authoring.rules.findIndex(\n      (rule: AdaptiveRule) => rule.id === currentRule.id,\n    );\n    activityClone.authoring.rules.splice(currentRuleIndex + 1, 0, newIncorrectRule);\n    activityClone.authoring.rules = reorderDefaultRules(activityClone.authoring.rules);\n    dispatch(setCurrentRule({ currentRule: newIncorrectRule }));\n    debounceSaveChanges(activityClone);\n  };\n\n  const handleDeleteRule = () => {\n    const activityClone: IActivity = clone(currentActivity);\n    const indexToDelete = activityClone.authoring.rules.findIndex(\n      (rule: AdaptiveRule) => rule.id === currentRule.id,\n    );\n    if (indexToDelete !== -1) {\n      activityClone.authoring.rules.splice(indexToDelete, 1);\n      const prevRule = activityClone.authoring.rules[indexToDelete - 1];\n      const nextRule = activityClone.authoring.rules[indexToDelete + 1];\n      dispatch(setCurrentRule({ currentRule: prevRule !== undefined ? prevRule : nextRule }));\n      debounceSaveChanges(activityClone);\n    }\n    setShowConfirmDelete(false);\n  };\n\n  return (\n    <>\n      <section\n        id=\"aa-bottom-panel\"\n        className={`aa-panel bottom-panel${panelState['bottom'] ? ' open' : ''}`}\n        style={{\n          left: panelState['left'] ? '335px' : '65px', // 335 = PANEL_SIDE_WIDTH + 65px (torus sidebar width)\n          right: panelState['right'] ? PANEL_SIDE_WIDTH : 0,\n          bottom: panelState['bottom']\n            ? 0\n            : `calc(-${document.getElementById('aa-bottom-panel')?.clientHeight}px + 39px)`,\n        }}\n      >\n        <div className=\"aa-panel-inner\">\n          <div className=\"aa-panel-section-title-bar\">\n            <div className=\"aa-panel-section-title pl-2\">\n              <span className=\"title\">rule editor</span>\n              {currentRule && !isLayer && (\n                <span className=\"ruleName\">\n                  {currentRule === 'initState' ? 'Initial State' : currentRule.name}\n                </span>\n              )}\n            </div>\n            <div className=\"aa-panel-section-controls d-flex justify-content-center align-items-center\">\n              {currentRule &&\n                currentRule.default &&\n                currentRule.correct &&\n                currentRule !== 'initState' && (\n                  <div className=\"disable-state-toggle pr-3 mr-0 d-flex justify-content-center align-items-center form-check form-check-inline\">\n                    <input\n                      className=\"form-check-input\"\n                      type=\"checkbox\"\n                      id=\"disable-state-toggle\"\n                      checked={isDisabled}\n                      onChange={() => handleDisabledChange()}\n                    />\n                    <label className=\"form-check-label\" htmlFor=\"disable-state-toggle\">\n                      Disable State\n                    </label>\n                  </div>\n                )}\n              {currentRule && !isLayer && !currentRule.default && currentRule !== 'initState' && (\n                <>\n                  <div className=\"correct-toggle pr-3 d-flex justify-content-center align-items-center\">\n                    <i className=\"fa fa-times mr-2\" />\n                    <div className=\"custom-control custom-switch\">\n                      <input\n                        type=\"checkbox\"\n                        className=\"custom-control-input\"\n                        id={`correct-toggle`}\n                        checked={correct}\n                        onChange={() => handleCorrectChange()}\n                      />\n                      <label className=\"custom-control-label\" htmlFor={`correct-toggle`}></label>\n                    </div>\n                    <i className=\"fa fa-check\" />\n                  </div>\n                  <OverlayTrigger\n                    placement=\"top\"\n                    delay={{ show: 150, hide: 150 }}\n                    overlay={\n                      <Tooltip id=\"button-tooltip\" style={{ fontSize: '12px' }}>\n                        Delete Rule\n                      </Tooltip>\n                    }\n                  >\n                    <span>\n                      <button\n                        className=\"btn btn-link p-0 ml-3\"\n                        onClick={() => setShowConfirmDelete(true)}\n                      >\n                        <i className=\"fa fa-trash-alt\" />\n                      </button>\n                    </span>\n                  </OverlayTrigger>\n                </>\n              )}\n              {currentRule && !isLayer && (\n                <OverlayTrigger\n                  placement=\"top\"\n                  delay={{ show: 150, hide: 150 }}\n                  overlay={\n                    <Tooltip id=\"button-tooltip\" style={{ fontSize: '12px' }}>\n                      New Rule\n                    </Tooltip>\n                  }\n                >\n                  <div className=\"dropdown\">\n                    <button\n                      className={`dropdown-toggle btn btn-link p-0 ${\n                        currentRule?.default ? 'ml-3' : 'ml-1'\n                      }`}\n                      type=\"button\"\n                      id={`bottom-panel-add-context-trigger`}\n                      data-toggle=\"dropdown\"\n                      aria-haspopup=\"true\"\n                      aria-expanded=\"false\"\n                      onClick={() => {\n                        ($(`#bottom-panel-add-context-trigger`) as any).dropdown('toggle');\n                      }}\n                    >\n                      <i className=\"fa fa-plus\" />\n                    </button>\n                    <div\n                      id={`bottom-panel-add-context-menu`}\n                      className=\"dropdown-menu\"\n                      aria-labelledby={`bottom-panel-add-context-trigger`}\n                    >\n                      <button\n                        className=\"dropdown-item\"\n                        onClick={() => {\n                          handleAddCorrectRule();\n                        }}\n                      >\n                        <i className=\"fa fa-check mr-2\" /> New Correct Rule\n                      </button>\n                      <button\n                        className=\"dropdown-item\"\n                        onClick={() => {\n                          handleAddIncorrectRule();\n                        }}\n                      >\n                        <i className=\"fa fa-times mr-2\" /> New Incorrect Rule\n                      </button>\n                    </div>\n                  </div>\n                </OverlayTrigger>\n              )}\n              <button className=\"btn btn-link p-0 ml-1\" onClick={() => onToggle()}>\n                {panelState['bottom'] && <i className=\"fa fa-angle-down\" />}\n                {!panelState['bottom'] && <i className=\"fa fa-angle-right\" />}\n              </button>\n            </div>\n          </div>\n          {children}\n        </div>\n      </section>\n      {showConfirmDelete && (\n        <ConfirmDelete\n          show={showConfirmDelete}\n          elementType=\"Rule\"\n          elementName={currentRule.name}\n          deleteHandler={() => handleDeleteRule()}\n          cancelHandler={() => {\n            setShowConfirmDelete(false);\n          }}\n        />\n      )}\n    </>\n  );\n};\n"]}