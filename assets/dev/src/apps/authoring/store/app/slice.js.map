{"version":3,"file":"slice.js","sourceRoot":"","sources":["../../../../../../src/apps/authoring/store/app/slice.ts"],"names":[],"mappings":"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","sourcesContent":["import { createSelector, createSlice, PayloadAction, Slice } from '@reduxjs/toolkit';\nimport {\n  savePartState,\n  savePartStateToTree,\n} from 'apps/delivery/store/features/attempt/actions/savePart';\nimport { RightPanelTabs } from '../../components/RightMenu/RightMenu';\nimport { saveActivity } from '../activities/actions/saveActivity';\nimport { savePage } from '../page/actions/savePage';\nimport { RootState } from '../rootReducer';\nimport { acquireEditingLock } from './actions/locking';\n\ninterface PartComponentRegistration {\n  slug: string;\n  title: string;\n  description: string;\n  author: string;\n  icon: string;\n  enabled: boolean;\n  global: boolean;\n  delivery_element: string;\n  delivery_script: string;\n  authoring_element: string;\n  authoring_script: string;\n}\n\ninterface ActivityRegistration {\n  id: string;\n  slug: string;\n  title: string;\n  enabled: boolean;\n  global: boolean;\n  delivery_element: string;\n  authoring_element: string;\n}\n\nexport interface AppState {\n  paths: Record<string, string> | null;\n  isAdmin: boolean;\n  projectSlug: string;\n  revisionSlug: string;\n  leftPanel: boolean;\n  rightPanel: boolean;\n  topPanel: boolean;\n  bottomPanel: boolean;\n  visible: boolean; // temp full screen rocket\n  hasEditingLock: boolean;\n  rightPanelActiveTab: RightPanelTabs;\n  currentRule: any;\n  partComponentTypes: PartComponentRegistration[];\n  activityTypes: ActivityRegistration[];\n  copiedPart: any | null;\n  readonly: boolean;\n  showDiagnosticsWindow: boolean;\n}\n\nconst initialState: AppState = {\n  paths: null,\n  isAdmin: false,\n  projectSlug: '',\n  revisionSlug: '',\n  leftPanel: true,\n  rightPanel: true,\n  topPanel: true,\n  bottomPanel: true,\n  visible: false,\n  hasEditingLock: false,\n  rightPanelActiveTab: RightPanelTabs.LESSON,\n  currentRule: undefined,\n  partComponentTypes: [],\n  activityTypes: [],\n  copiedPart: null,\n  readonly: true,\n  showDiagnosticsWindow: false,\n};\n\nexport interface AppConfig {\n  paths?: Record<string, string>;\n  isAdmin?: boolean;\n  projectSlug?: string;\n  revisionSlug?: string;\n  partComponentTypes?: any[];\n  activityTypes?: any[];\n  copiedPart?: any;\n}\n\nconst slice: Slice<AppState> = createSlice({\n  name: 'mainApp',\n  initialState,\n  reducers: {\n    setInitialConfig(state, action: PayloadAction<AppConfig>) {\n      state.paths = action.payload.paths || initialState.paths;\n      state.isAdmin = !!action.payload.isAdmin;\n      state.projectSlug = action.payload.projectSlug || initialState.projectSlug;\n      state.revisionSlug = action.payload.revisionSlug || initialState.revisionSlug;\n      state.partComponentTypes =\n        action.payload.partComponentTypes || initialState.partComponentTypes;\n      state.activityTypes = action.payload.activityTypes || initialState.activityTypes;\n      state.copiedPart = action.payload.copiedPart || initialState.copiedPart;\n    },\n    setPanelState(\n      state,\n      action: PayloadAction<{ left?: boolean; right?: boolean; top?: boolean; bottom?: boolean }>,\n    ) {\n      if (action.payload.left !== undefined) {\n        state.leftPanel = !!action.payload.left;\n      }\n      if (action.payload.right !== undefined) {\n        state.rightPanel = !!action.payload.right;\n      }\n      if (action.payload.top !== undefined) {\n        state.topPanel = !!action.payload.top;\n      }\n      if (action.payload.bottom !== undefined) {\n        state.bottomPanel = !!action.payload.bottom;\n      }\n    },\n    setVisible(state, action: PayloadAction<{ visible: boolean }>) {\n      state.visible = action.payload.visible;\n    },\n    setHasEditingLock(state, action: PayloadAction<{ hasEditingLock: boolean }>) {\n      state.hasEditingLock = action.payload.hasEditingLock;\n    },\n    setRightPanelActiveTab(state, action: PayloadAction<{ rightPanelActiveTab: RightPanelTabs }>) {\n      state.rightPanelActiveTab = action.payload.rightPanelActiveTab;\n    },\n    setCurrentRule(state, action: PayloadAction<{ currentRule: any }>) {\n      state.currentRule = action.payload.currentRule;\n    },\n    setCopiedPart(state, action: PayloadAction<{ copiedPart: any }>) {\n      state.copiedPart = action.payload.copiedPart;\n    },\n    setReadonly(state, action: PayloadAction<{ readonly: boolean }>) {\n      state.readonly = action.payload.readonly;\n    },\n    setShowDiagnosticsWindow(state, action: PayloadAction<{ show: boolean }>) {\n      state.showDiagnosticsWindow = action.payload.show;\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(acquireEditingLock.fulfilled, (state) => {\n      state.hasEditingLock = true;\n    });\n    builder.addCase(acquireEditingLock.rejected, (state) => {\n      state.hasEditingLock = false;\n    });\n    builder.addCase(savePage.rejected, (state) => {\n      state.hasEditingLock = false;\n    });\n    builder.addCase(saveActivity.rejected, (state) => {\n      state.hasEditingLock = false;\n    });\n    builder.addCase(savePartState.rejected, (state) => {\n      state.hasEditingLock = false;\n    });\n    builder.addCase(savePartStateToTree.rejected, (state) => {\n      state.hasEditingLock = false;\n    });\n  },\n});\n\nexport const AppSlice = slice.name;\n\nexport const {\n  setInitialConfig,\n  setPanelState,\n  setVisible,\n  setHasEditingLock,\n  setShowEditingLockErrMsg,\n  setRightPanelActiveTab,\n  setCurrentRule,\n  setCopiedPart,\n  setReadonly,\n  setShowDiagnosticsWindow,\n} = slice.actions;\n\nexport const selectState = (state: RootState): AppState => state[AppSlice] as AppState;\nexport const selectPaths = createSelector(selectState, (state: AppState) => state.paths);\nexport const selectProjectSlug = createSelector(\n  selectState,\n  (state: AppState) => state.projectSlug,\n);\nexport const selectRevisionSlug = createSelector(\n  selectState,\n  (state: AppState) => state.revisionSlug,\n);\nexport const selectLeftPanel = createSelector(selectState, (state: AppState) => state.leftPanel);\nexport const selectRightPanel = createSelector(selectState, (state: AppState) => state.rightPanel);\nexport const selectTopPanel = createSelector(selectState, (state: AppState) => state.topPanel);\nexport const selectBottomPanel = createSelector(\n  selectState,\n  (state: AppState) => state.bottomPanel,\n);\nexport const selectRightPanelActiveTab = createSelector(\n  selectState,\n  (state: AppState) => state.rightPanelActiveTab,\n);\nexport const selectCurrentRule = createSelector(\n  selectState,\n  (state: AppState) => state.currentRule,\n);\nexport const selectCopiedPart = createSelector(selectState, (state: AppState) => state.copiedPart);\n\nexport const selectVisible = createSelector(selectState, (state: AppState) => state.visible);\n\nexport const selectHasEditingLock = createSelector(\n  selectState,\n  (state: AppState) => state.hasEditingLock,\n);\n\nexport const selectPartComponentTypes = createSelector(\n  selectState,\n  (state: AppState) => state.partComponentTypes,\n);\n\nexport const selectActivityTypes = createSelector(\n  selectState,\n  (state: AppState) => state.activityTypes,\n);\n\nexport const selectReadOnly = createSelector(selectState, (state: AppState) => state.readonly);\n\nexport const selectShowDiagnosticsWindow = createSelector(\n  selectState,\n  (state: AppState) => state.showDiagnosticsWindow,\n);\n\nexport default slice.reducer;\n"]}