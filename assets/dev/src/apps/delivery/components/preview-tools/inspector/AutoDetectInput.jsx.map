{"version":3,"file":"AutoDetectInput.jsx","sourceRoot":"","sources":["../../../../../../../src/apps/delivery/components/preview-tools/inspector/AutoDetectInput.tsx"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable no-prototype-builtins */\n/* eslint-disable react/prop-types */\nimport debounce from 'lodash/debounce';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\nimport { CapiVariable, CapiVariableTypes, parseCapiValue } from '../../../../../adaptivity/capi';\nimport { ApplyStateOperation } from '../../../../../adaptivity/scripting';\n\ninterface AutoDetectInputProps {\n  label: string;\n  value: any;\n  state?: any;\n  onChange?: (changeOp: ApplyStateOperation) => void;\n}\nconst AutoDetectInput: React.FC<AutoDetectInputProps> = ({\n  label,\n  value,\n  state,\n  onChange,\n}): any => {\n  /* console.log('ðŸš€ > file: PreviewTools.tsx > line 390 > { label, value ,state}', {\n    label,\n    value,\n    state,\n  }); */\n  const theValue = value as CapiVariable;\n\n  const postChange = useCallback(\n    debounce((changedValue) => {\n      theValue.value = changedValue;\n      const applyOp: ApplyStateOperation = {\n        target: theValue.key,\n        operator: '=',\n        type: theValue.type,\n        value: parseCapiValue(theValue),\n      };\n      if (onChange) {\n        onChange(applyOp);\n      }\n    }, 50),\n    [theValue],\n  );\n\n  const handleValueChange = useCallback(\n    (e, isCheckbox = false) => {\n      if (e.type === 'keydown' && e.key !== 'Enter') {\n        return;\n      }\n      const newValue = isCheckbox ? e.target.checked : e.target.value;\n      setInternalValue(parseCapiValue(newValue));\n      /* console.log('VALUE CHANGE INSPECTOR', { e, newValue, theValue }); */\n      if (newValue === theValue.value) {\n        return;\n      }\n      postChange(newValue);\n    },\n    [onChange],\n  );\n\n  const [internalValue, setInternalValue] = useState<any>(parseCapiValue(theValue));\n\n  useEffect(() => {\n    setInternalValue(parseCapiValue(theValue));\n  }, [theValue]);\n\n  const uuid = uuidv4();\n  switch (theValue.type) {\n    case CapiVariableTypes.BOOLEAN:\n      return (\n        <div className=\"custom-control custom-switch\">\n          <input\n            type=\"checkbox\"\n            className=\"custom-control-input\"\n            id={uuid}\n            checked={internalValue}\n            onChange={(e) => handleValueChange(e, true)}\n            onBlur={(e) => handleValueChange(e, true)}\n          />\n          <label className=\"custom-control-label\" htmlFor={uuid}></label>\n        </div>\n      );\n\n    case CapiVariableTypes.NUMBER:\n      return (\n        <input\n          type=\"number\"\n          className=\"input-group-sm stateValue\"\n          style={{ flex: '1', minWidth: 75 }}\n          aria-label={label}\n          value={internalValue}\n          onKeyDown={handleValueChange}\n          onBlur={handleValueChange}\n          onChange={handleValueChange}\n        />\n      );\n\n    case CapiVariableTypes.ARRAY:\n    case CapiVariableTypes.ARRAY_POINT:\n      // TODO: fancy array editor??\n      return (\n        <input\n          type=\"text\"\n          style={{ flex: '1', minWidth: 75 }}\n          className=\"input-group-sm stateValue\"\n          aria-label={label}\n          value={JSON.stringify(internalValue)}\n          onKeyDown={handleValueChange}\n          onBlur={handleValueChange}\n          onChange={handleValueChange}\n        />\n      );\n\n    case CapiVariableTypes.ENUM:\n      return (\n        <div className=\"user-input\">\n          <select onChange={handleValueChange} className=\"custom-select custom-select-sm\">\n            {value?.allowedValues?.map((item: any) => {\n              return (\n                <option key={item} value={item} selected={internalValue === item}>\n                  {item}\n                </option>\n              );\n            })}\n          </select>\n        </div>\n      );\n\n    default:\n      return (\n        <input\n          type=\"text\"\n          style={{ flex: '1', minWidth: 75 }}\n          className=\"input-group-sm stateValue\"\n          aria-label={label}\n          value={internalValue}\n          onKeyDown={handleValueChange}\n          onBlur={handleValueChange}\n          onChange={handleValueChange}\n        />\n      );\n  }\n};\n\nexport default AutoDetectInput;\n"]}