{"version":3,"file":"HistoryPanel.jsx","sourceRoot":"","sources":["../../../../../../../src/apps/delivery/layouts/deck/components/HistoryPanel.tsx"],"names":[],"mappings":"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","sourcesContent":["import { selectIsLegacyTheme, selectPreviewMode } from 'apps/delivery/store/features/page/slice';\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport TimeAgo from '../../../../../components/common/TimeAgo';\nimport { selectCurrentActivityId } from '../../../store/features/activities/slice';\nimport { setHistoryNavigationTriggered } from '../../../store/features/adaptivity/slice';\nimport { navigateToActivity } from '../../../store/features/groups/actions/deck';\n\ninterface HistoryEntry {\n  id: string;\n  name: string;\n  timestamp?: any; // not sure if this is needed\n  current?: boolean;\n  selected?: boolean;\n}\n\ninterface HistoryPanelProps {\n  items: HistoryEntry[];\n  onMinimize: any; // function?\n  onRestart: any; // function\n}\n\nconst HistoryPanel: React.FC<HistoryPanelProps> = ({ items, onMinimize, onRestart }) => {\n  const dispatch = useDispatch();\n  const currentActivityId = useSelector(selectCurrentActivityId);\n  // TODO: we need to track this as a separate ID\n  const currentHistoryActiveActivityId = currentActivityId;\n\n  const itemClickHandler = (item: HistoryEntry) => {\n    dispatch(navigateToActivity(item.id));\n\n    const nextHistoryActivityIndex = items.findIndex(\n      (historyItem: any) => historyItem.id === item.id,\n    );\n    dispatch(\n      setHistoryNavigationTriggered({\n        historyModeNavigation: nextHistoryActivityIndex !== 0,\n      }),\n    );\n  };\n\n  const getItemClasses = (item: HistoryEntry) => {\n    const currentClass = 'history-element-current';\n    const selectedClass = 'history-element-selected';\n    const otherClass = 'history-element-other';\n    const classes = ['history-element'];\n    if (item.id === currentActivityId) {\n      classes.push(currentClass);\n    }\n    if (item.id === currentHistoryActiveActivityId) {\n      classes.push(selectedClass);\n    }\n    if (item.id !== currentActivityId && item.id !== currentHistoryActiveActivityId) {\n      classes.push(otherClass);\n    }\n    return classes.join(' ');\n  };\n\n  const isLegacyTheme = useSelector(selectIsLegacyTheme);\n  const isPreviewMode = useSelector(selectPreviewMode);\n\n  return (\n    <>\n      {isLegacyTheme ? (\n        <>\n          <div className=\"navbar-resize-dots\"></div>\n          <div className=\"title screenListTitle\">\n            {isPreviewMode ? 'Screen List' : 'Lesson History'}\n          </div>\n          <nav className=\"history\">\n            {items.map((item, index) => (\n              <div key={item.id} id={`qrID${item.id}`} className={getItemClasses(item)}>\n                {items.length - index}. {item.name}\n              </div>\n            ))}\n          </nav>\n        </>\n      ) : (\n        <div\n          id=\"theme-history-panel\"\n          className=\"theme-history\"\n          aria-role=\"alertdialog\"\n          aria-hidden=\"false\"\n          aria-label=\"Lesson history\"\n        >\n          <div className=\"theme-history__title\">\n            <span>Lesson History</span>\n            <button\n              onClick={onMinimize}\n              className=\"theme-history__close-btn\"\n              aria-label=\"Minimize lesson history\"\n            >\n              <span>\n                <div className=\"theme-history__close-icon\" />\n              </span>\n            </button>\n          </div>\n          <nav className=\"theme-history__nav\">\n            {items.map((item) => (\n              <button\n                key={item.id}\n                className={getItemClasses(item)}\n                onClick={() => itemClickHandler(item)}\n              >\n                <div className=\"history-element__screenName\">{item.name}</div>\n                <div className=\"history-element__timestamp\">\n                  {<TimeAgo timeStamp={item.timestamp} liveUpdate={true} />}\n                </div>\n              </button>\n            ))}\n          </nav>\n          <div className=\"theme-history__footer\">\n            <button onClick={onRestart} className=\"theme-history__restart\">\n              <span>\n                <div className=\"theme-history__restart-icon\" />\n                <span className=\"theme-history__restart-label\">Restart Lesson</span>\n              </span>\n            </button>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default HistoryPanel;\n"]}