{"version":3,"file":"slice.js","sourceRoot":"","sources":["../../../../../../../src/apps/delivery/store/features/page/slice.ts"],"names":[],"mappings":"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","sourcesContent":["import { createSelector, createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport guid from 'utils/guid';\nimport { RootState } from '../../rootReducer';\n\nexport interface PageState {\n  userId: number;\n  userName: string;\n  resourceId: number;\n  sectionSlug: string;\n  pageSlug: string;\n  pageTitle: string;\n  content: any; // TODO typing\n  resourceAttemptState: any;\n  resourceAttemptGuid: string;\n  activityGuidMapping: any;\n  previewMode: boolean;\n  enableHistory: boolean;\n  showHistory: boolean;\n  activityTypes: any[];\n  score: number;\n  graded: boolean;\n  activeEverapp: string;\n}\n\nconst initialState: PageState = {\n  userId: -1,\n  userName: 'Guest',\n  resourceId: -1,\n  sectionSlug: '',\n  pageSlug: '',\n  pageTitle: '',\n  content: null,\n  resourceAttemptGuid: '',\n  resourceAttemptState: {},\n  activityGuidMapping: {},\n  previewMode: false,\n  enableHistory: false,\n  showHistory: false,\n  activityTypes: [],\n  score: 0,\n  graded: false,\n  activeEverapp: '',\n};\n\nconst pageSlice = createSlice({\n  name: 'page',\n  initialState,\n  reducers: {\n    loadPageState: (state, action: PayloadAction<PageState>) => {\n      state.userId = action.payload.userId;\n      state.userName = action.payload.userName || 'Guest';\n      state.resourceId = action.payload.resourceId;\n      state.pageSlug = action.payload.pageSlug;\n      state.pageTitle = action.payload.pageTitle;\n      state.sectionSlug = action.payload.sectionSlug;\n      state.content = action.payload.content;\n      state.enableHistory =\n        action.payload?.content?.custom?.allowNavigation ||\n        action.payload?.content?.custom?.enableHistory ||\n        false;\n      state.resourceAttemptGuid = action.payload.resourceAttemptGuid;\n      state.resourceAttemptState = action.payload.resourceAttemptState;\n      state.activityGuidMapping = action.payload.activityGuidMapping;\n      state.previewMode = !!action.payload.previewMode;\n      state.activityTypes = action.payload.activityTypes;\n      state.graded = !!action.payload.graded;\n\n      if (state.previewMode && !state.resourceAttemptGuid) {\n        state.resourceAttemptGuid = `preview_${guid()}`;\n      }\n    },\n    setScore(state, action: PayloadAction<{ score: number }>) {\n      state.score = action.payload.score;\n    },\n    setActiveEverapp(state, action: PayloadAction<{ id: string }>) {\n      state.activeEverapp = action.payload.id;\n    },\n    setShowHistory(state, action: PayloadAction<{ show: boolean }>) {\n      state.showHistory = action.payload.show;\n    },\n  },\n});\n\nexport const PageSlice = pageSlice.name;\n\nexport const { loadPageState, setActiveEverapp, setScore, setShowHistory } = pageSlice.actions;\n\nexport const selectState = (state: RootState): PageState => state[PageSlice];\nexport const selectSectionSlug = createSelector(selectState, (state) => state.sectionSlug);\nexport const selectPageTitle = createSelector(selectState, (state) => state.pageTitle);\nexport const selectPageSlug = createSelector(selectState, (state) => state.pageSlug);\nexport const selectPageContent = createSelector(selectState, (state) => state.content);\nexport const selectPreviewMode = createSelector(selectState, (state) => state.previewMode);\nexport const selectEnableHistory = createSelector(selectState, (state) => state.enableHistory);\nexport const selectShowHistory = createSelector(selectState, (state) => state.showHistory);\nexport const selectResourceAttemptGuid = createSelector(\n  selectState,\n  (state) => state.resourceAttemptGuid,\n);\nexport const selectNavigationSequence = (sequence: any[]) => {\n  return sequence?.filter((entry: any) => !entry.custom?.isLayer && !entry.custom?.isBank);\n};\n\nexport const selectActivityTypes = createSelector(selectState, (state) => state.activityTypes);\nexport const selectActivityGuidMapping = createSelector(\n  selectState,\n  (state: PageState) => state.activityGuidMapping,\n);\n\nexport const selectUserId = createSelector(selectState, (state) => state.userId);\n\nexport const selectUserName = createSelector(selectState, (state) => state.userName);\n\nexport const selectScore = createSelector(selectState, (state) => state.score);\n\nexport const selectIsGraded = createSelector(selectState, (state) => state.graded);\n\nexport const selectActiveEverapp = createSelector(selectState, (state) => state.activeEverapp);\n\nexport const selectIsLegacyTheme = createSelector(\n  selectState,\n  (state) => !state.content?.custom?.themeId,\n);\n\nexport default pageSlice.reducer;\n"]}