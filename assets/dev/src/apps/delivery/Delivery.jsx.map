{"version":3,"file":"Delivery.jsx","sourceRoot":"","sources":["../../../../src/apps/delivery/Delivery.tsx"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable react/prop-types */\nimport useWindowSize from 'components/hooks/useWindowSize';\nimport React, { useEffect } from 'react';\nimport { Provider, useDispatch, useSelector } from 'react-redux';\nimport PreviewTools from './components/PreviewTools';\nimport DeckLayoutView from './layouts/deck/DeckLayoutView';\nimport LessonFinishedDialog from './layouts/deck/LessonFinishedDialog';\nimport RestartLessonDialog from './layouts/deck/RestartLessonDialog';\nimport { LayoutProps } from './layouts/layouts';\nimport store from './store';\nimport { selectLessonEnd, selectRestartLesson } from './store/features/adaptivity/slice';\nimport { LayoutType, selectCurrentGroup } from './store/features/groups/slice';\nimport { loadInitialPageState } from './store/features/page/actions/loadInitialPageState';\n\nexport interface DeliveryProps {\n  resourceId: number;\n  sectionSlug: string;\n  userId: number;\n  userName: string;\n  pageTitle: string;\n  pageSlug: string;\n  content: any;\n  resourceAttemptState: any;\n  resourceAttemptGuid: string;\n  activityGuidMapping: any;\n  previewMode?: boolean;\n  enableHistory?: boolean;\n  activityTypes?: any[];\n  graded: boolean;\n}\n\nconst Delivery: React.FC<DeliveryProps> = ({\n  userId,\n  userName,\n  resourceId,\n  sectionSlug,\n  pageTitle = '',\n  pageSlug,\n  content,\n  resourceAttemptGuid,\n  resourceAttemptState,\n  activityGuidMapping,\n  activityTypes = [],\n  previewMode = false,\n  enableHistory = false,\n  graded = false,\n}) => {\n  const dispatch = useDispatch();\n  const currentGroup = useSelector(selectCurrentGroup);\n  const restartLesson = useSelector(selectRestartLesson);\n  let LayoutView: React.FC<LayoutProps> = () => <div>Unknown Layout</div>;\n  if (currentGroup?.layout === LayoutType.DECK) {\n    LayoutView = DeckLayoutView;\n  }\n\n  useEffect(() => {\n    setInitialPageState();\n  }, []);\n\n  const setInitialPageState = () => {\n    dispatch(\n      loadInitialPageState({\n        userId,\n        userName,\n        resourceId,\n        sectionSlug,\n        pageTitle,\n        pageSlug,\n        content,\n        resourceAttemptGuid,\n        resourceAttemptState,\n        activityGuidMapping,\n        previewMode: !!previewMode,\n        activityTypes,\n        enableHistory,\n        showHistory: false,\n        score: 0,\n        graded,\n        activeEverapp: 'none',\n      }),\n    );\n  };\n  const parentDivClasses: string[] = [];\n  if (content?.custom?.viewerSkin) {\n    parentDivClasses.push(`skin-${content?.custom?.viewerSkin}`);\n  }\n  const dialogImageUrl = content?.custom?.logoutPanelImageURL;\n  const dialogMessage = content?.custom?.logoutMessage;\n  // this is something SS does...\n  const { width: windowWidth } = useWindowSize();\n  const isLessonEnded = useSelector(selectLessonEnd);\n  return (\n    <div className={parentDivClasses.join(' ')}>\n      {previewMode && <PreviewTools model={content?.model} />}\n      <div className=\"mainView\" role=\"main\" style={{ width: windowWidth }}>\n        <LayoutView pageTitle={pageTitle} previewMode={previewMode} pageContent={content} />\n      </div>\n      {restartLesson ? <RestartLessonDialog onRestart={setInitialPageState} /> : null}\n      {isLessonEnded ? (\n        <LessonFinishedDialog imageUrl={dialogImageUrl} message={dialogMessage} />\n      ) : null}\n    </div>\n  );\n};\n\nconst ReduxApp: React.FC<DeliveryProps> = (props) => (\n  <Provider store={store}>\n    <Delivery {...props} />\n  </Provider>\n);\n\nexport default ReduxApp;\n"]}