{"version":3,"file":"Editor.jsx","sourceRoot":"","sources":["../../../../../../src/components/editing/models/link/Editor.tsx"],"names":[],"mappings":"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","sourcesContent":["import { EditorProps } from 'components/editing/models/interfaces';\nimport { DisplayLink } from 'components/editing/models/link/DisplayLink';\nimport { EditLink } from 'components/editing/models/link/EditLink';\nimport { LinkablePages } from 'components/editing/models/link/utils';\nimport { updateModel } from 'components/editing/models/utils';\nimport { HoveringToolbar } from 'components/editing/toolbars/HoveringToolbar';\nimport * as ContentModel from 'data/content/model/elements/types';\nimport { centeredAbove } from 'data/content/utils';\nimport * as Persistence from 'data/persistence/resource';\nimport React, { useState } from 'react';\nimport { Range } from 'slate';\nimport { useFocused, useSelected } from 'slate-react';\n\nexport interface Props extends EditorProps<ContentModel.Hyperlink> {}\n\nexport const LinkEditor = (props: Props) => {\n  const focused = useFocused();\n  const selected = useSelected();\n\n  const [editLink, setEditLink] = useState(false);\n\n  // All of the pages that we have available in the course\n  // for allowing links to\n  const [pages, setPages] = useState<LinkablePages>({ type: 'Uninitialized' });\n\n  // The selected page, when in link from page mode\n  const [selectedPage, setSelectedPage] = useState<Persistence.Page | null>(null);\n\n  const isEditButton = editLink && selectedPage && pages.type === 'success';\n\n  const { attributes, children, editor, model } = props;\n\n  const onEdit = (href: string) => {\n    if (href !== '' && href !== model.href) {\n      updateModel<ContentModel.Hyperlink>(editor, model, { href });\n    }\n    setEditLink(false);\n  };\n\n  const toolbarYOffset = isEditButton ? 132 : 56;\n  const isToolbarOpen =\n    (focused && selected && !!editor.selection && Range.isCollapsed(editor.selection)) || editLink;\n\n  return (\n    <HoveringToolbar\n      isOpen={() => isToolbarOpen}\n      showArrow\n      target={\n        <a\n          id={props.model.id}\n          href=\"#\"\n          className=\"inline-link\"\n          {...attributes}\n          onClick={() => {\n            setEditLink(false);\n          }}\n        >\n          {children}\n        </a>\n      }\n      contentLocation={(loc) => centeredAbove(loc, toolbarYOffset)}\n    >\n      <>\n        {isEditButton && (\n          <EditLink\n            setEditLink={setEditLink}\n            href={model.href}\n            onEdit={onEdit}\n            pages={pages}\n            selectedPage={selectedPage}\n            setSelectedPage={setSelectedPage}\n          />\n        )}\n        {!isEditButton && (\n          <DisplayLink\n            setEditLink={setEditLink}\n            commandContext={props.commandContext}\n            href={model.href}\n            setPages={setPages}\n            pages={pages}\n            selectedPage={selectedPage}\n            setSelectedPage={setSelectedPage}\n          />\n        )}\n      </>\n    </HoveringToolbar>\n  );\n};\n"]}