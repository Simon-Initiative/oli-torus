{"version":3,"file":"DropdownMenu.jsx","sourceRoot":"","sources":["../../../../../../src/components/editing/models/table/DropdownMenu.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport { ReactEditor } from 'slate-react';\nimport { Transforms, Editor, Path, Element } from 'slate';\nimport * as ContentModel from 'data/content/model/elements/factories';\nimport { TableData, TableHeader, TableRow } from 'data/content/model/elements/types';\n\n// Dropdown menu that appears in each table cell.\ninterface Props {\n  editor: Editor;\n  model: TableData | TableHeader;\n}\nexport const DropdownMenu = (props: Props) => {\n  const ref = useRef();\n  const { editor, model } = props;\n\n  // There has to be a better way to do this.\n  useEffect(() => {\n    if (ref !== null && ref.current !== null) {\n      ((window as any).$('.dropdown-toggle') as any).dropdown();\n    }\n  });\n\n  const onToggleHeader = () => {\n    const path = ReactEditor.findPath(editor, model);\n\n    const type = model.type === 'th' ? 'td' : 'th';\n    Transforms.setNodes(editor, { type }, { at: path });\n  };\n\n  const onAddRowBefore = () => {\n    const path = ReactEditor.findPath(editor, model);\n    const [parent, parentPath] = Editor.parent(editor, path);\n\n    const count = parent.children.length;\n    const tds = [];\n    for (let i = 0; i < count; i += 1) {\n      tds.push(ContentModel.td(''));\n    }\n    const row: TableRow = ContentModel.tr(tds);\n\n    Transforms.insertNodes(editor, row, { at: parentPath });\n  };\n\n  const onAddRowAfter = () => {\n    const path = ReactEditor.findPath(editor, model);\n    const [parent, parentPath] = Editor.parent(editor, path);\n\n    const count = parent.children.length;\n    const tds = [];\n    for (let i = 0; i < count; i += 1) {\n      tds.push(ContentModel.td(''));\n    }\n    const row: TableRow = ContentModel.tr(tds);\n    Transforms.insertNodes(editor, row, { at: Path.next(parentPath) });\n  };\n\n  const onAddColumnBefore = () => {\n    Editor.withoutNormalizing(editor, () => {\n      const path = ReactEditor.findPath(editor, model);\n      const [, parentPath] = Editor.parent(editor, path);\n      const [table] = Editor.parent(editor, parentPath);\n\n      const rows = table.children.length;\n      for (let i = 0; i < rows; i += 1) {\n        path[path.length - 2] = i;\n        Transforms.insertNodes(editor, ContentModel.td(''), { at: path });\n      }\n    });\n  };\n\n  const onAddColumnAfter = () => {\n    Editor.withoutNormalizing(editor, () => {\n      const path = ReactEditor.findPath(editor, model);\n      const [, parentPath] = Editor.parent(editor, path);\n      const [table] = Editor.parent(editor, parentPath);\n\n      const rows = table.children.length;\n      for (let i = 0; i < rows; i += 1) {\n        path[path.length - 2] = i;\n        Transforms.insertNodes(editor, ContentModel.td(''), { at: Path.next(path) });\n      }\n    });\n  };\n\n  const onDeleteRow = () => {\n    const path = ReactEditor.findPath(editor, model);\n    Transforms.deselect(editor);\n    Transforms.removeNodes(editor, { at: Path.parent(path) });\n  };\n\n  const onDeleteColumn = () => {\n    Editor.withoutNormalizing(editor, () => {\n      const path = ReactEditor.findPath(editor, model);\n      const [, parentPath] = Editor.parent(editor, path);\n      const [table] = Editor.parent(editor, parentPath);\n\n      const rows = table.children.length;\n      for (let i = 0; i < rows; i += 1) {\n        path[path.length - 2] = i;\n        Transforms.removeNodes(editor, { at: path });\n      }\n    });\n  };\n\n  const onDeleteTable = () => {\n    const [tableEntry] = Editor.nodes(editor, {\n      match: (n) => Element.isElement(n) && n.type === 'table',\n    });\n    if (!tableEntry) return;\n    const [, path] = tableEntry;\n    Transforms.removeNodes(editor, { at: path });\n  };\n\n  return (\n    <div ref={ref as any} className=\"dropdown table-dropdown\" contentEditable={false}>\n      <button\n        type=\"button\"\n        className=\"dropdown-toggle btn\"\n        data-reference=\"parent\"\n        data-toggle=\"dropdown\"\n        aria-haspopup=\"true\"\n        aria-expanded=\"false\"\n      >\n        <span className=\"sr-only\">Toggle Table Cell Options</span>\n      </button>\n      <div className=\"dropdown-menu\">\n        <button type=\"button\" className=\"dropdown-item\" onClick={onToggleHeader}>\n          Toggle Header\n        </button>\n\n        <div className=\"dropdown-divider\"></div>\n\n        <h6 className=\"dropdown-header\">Insert</h6>\n        <button type=\"button\" className=\"dropdown-item\" onClick={onAddRowBefore}>\n          Row before\n        </button>\n        <button type=\"button\" className=\"dropdown-item\" onClick={onAddRowAfter}>\n          Row after\n        </button>\n        <button type=\"button\" className=\"dropdown-item\" onClick={onAddColumnBefore}>\n          Column before\n        </button>\n        <button type=\"button\" className=\"dropdown-item\" onClick={onAddColumnAfter}>\n          Column after\n        </button>\n\n        <div className=\"dropdown-divider\"></div>\n\n        <h6 className=\"dropdown-header\">Delete</h6>\n        <button type=\"button\" className=\"dropdown-item\" onClick={onDeleteRow}>\n          Row\n        </button>\n        <button type=\"button\" className=\"dropdown-item\" onClick={onDeleteColumn}>\n          Column\n        </button>\n\n        <button type=\"button\" className=\"dropdown-item\" onClick={onDeleteTable}>\n          Table\n        </button>\n      </div>\n    </div>\n  );\n};\n"]}