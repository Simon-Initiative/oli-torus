{"version":3,"file":"Editor.jsx","sourceRoot":"","sources":["../../../../../../src/components/editing/models/inputref/Editor.tsx"],"names":[],"mappings":"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","sourcesContent":["import { friendlyType } from 'components/activities/multi_input/utils';\nimport { initCommands } from 'components/editing/models/inputref/commands';\nimport { EditorProps } from 'components/editing/models/interfaces';\nimport { FormattingToolbar } from 'components/editing/toolbars/formatting/Toolbar';\nimport { HoveringToolbar } from 'components/editing/toolbars/HoveringToolbar';\nimport * as ContentModel from 'data/content/model/elements/types';\nimport { centeredAbove } from 'data/content/utils';\nimport React from 'react';\nimport { Transforms } from 'slate';\nimport { ReactEditor, useFocused, useSelected, useSlate } from 'slate-react';\n\nexport interface InputRefProps extends EditorProps<ContentModel.InputRef> {}\nexport const InputRefEditor = (props: InputRefProps) => {\n  const { inputRefContext } = props.commandContext;\n\n  const focused = useFocused();\n  const selected = useSelected();\n  const editor = useSlate();\n\n  const input = inputRefContext?.inputs.get(props.model.id);\n\n  const borderStyle =\n    focused && selected\n      ? { border: 'solid 3px lightblue', borderRadius: '0.25rem' }\n      : { border: 'solid 3px transparent' };\n\n  if (!inputRefContext || !input) {\n    return (\n      <span\n        {...props.attributes}\n        contentEditable={false}\n        style={Object.assign(\n          {\n            border: '1px solid black',\n            borderRadius: 3,\n            padding: 4,\n          },\n          borderStyle,\n        )}\n      >\n        Missing Input Ref (delete){props.children}\n      </span>\n    );\n  }\n\n  const commands = initCommands(input, inputRefContext.setInputType);\n\n  const activeStyle =\n    inputRefContext.selectedInputRef?.id === props.model.id\n      ? { fontWeight: 'bold', backgroundColor: 'lightblue' }\n      : {};\n\n  const withToolbar = (target: React.ReactElement) => (\n    <HoveringToolbar\n      isOpen={() => focused && selected}\n      showArrow\n      target={target}\n      contentLocation={centeredAbove}\n    >\n      <FormattingToolbar commandDescs={commands} commandContext={props.commandContext} />\n    </HoveringToolbar>\n  );\n\n  const action = (e: React.MouseEvent | React.KeyboardEvent) => {\n    e.preventDefault();\n    inputRefContext?.setSelectedInputRef(props.model);\n    Transforms.select(editor, ReactEditor.findPath(editor, props.model));\n  };\n\n  return (\n    <span\n      {...props.attributes}\n      contentEditable={false}\n      style={Object.assign(borderStyle, { display: 'inline-block' })}\n      onKeyPress={(e) => {\n        if (e.key === 'Enter') {\n          action(e);\n        }\n      }}\n    >\n      {withToolbar(\n        <span\n          onClick={(e) => {\n            action(e);\n          }}\n          style={Object.assign(activeStyle, {\n            width: '160px',\n            display: 'inline-block',\n            userSelect: 'none',\n          } as React.CSSProperties)}\n          className=\"form-control\"\n        >\n          {friendlyType(input.inputType)}\n        </span>,\n      )}\n      {props.children}\n    </span>\n  );\n};\n"]}