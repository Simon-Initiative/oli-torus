{"version":3,"file":"commands.jsx","sourceRoot":"","sources":["../../../../../../src/components/editing/models/image/commands.tsx"],"names":[],"mappings":"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","sourcesContent":["import { modalActions } from 'actions/modal';\nimport { selectImage } from 'components/editing/commands/ImageCmd';\nimport { CommandDesc } from 'components/editing/commands/interfaces';\nimport { FullScreenModal } from 'components/editing/toolbars/FullScreenModal';\nimport * as ContentModel from 'data/content/model/elements/types';\nimport * as React from 'react';\nimport { useState } from 'react';\nimport { Maybe } from 'tsmonad';\n\ninterface Props {\n  onDone: (params: any) => void;\n  onCancel: () => void;\n  model: ContentModel.Image;\n}\nconst ImageModal = ({ onDone, onCancel, model }: Props) => {\n  const [value, setValue] = useState(model.alt);\n  return (\n    <FullScreenModal onCancel={(_e) => onCancel()} onDone={() => onDone(value)}>\n      <div>\n        <h3 className=\"mb-2\">Alternative Text</h3>\n        <p className=\"mb-4\">\n          Write a short description of this image for visitors who are unable to see it.\n        </p>\n        <div\n          className=\"m-auto\"\n          style={{\n            width: 300,\n            height: 200,\n            backgroundImage: `url(${model.src})`,\n            backgroundPosition: '50% 50%',\n            backgroundSize: 'contain',\n            backgroundRepeat: 'no-repeat',\n          }}\n        ></div>\n        <input\n          className=\"form-control\"\n          value={value}\n          onChange={(e) => setValue(e.target.value)}\n          placeholder={'E.g., \"Stack of blueberry pancakes with powdered sugar\"'}\n        />\n      </div>\n    </FullScreenModal>\n  );\n};\n\nexport const initCommands = (\n  model: ContentModel.Image,\n  onEdit: (updated: Partial<ContentModel.Image>) => void,\n): CommandDesc[][] => {\n  const setSrc = (src: string) => {\n    onEdit({ src });\n  };\n  const setAlt = (alt: string) => {\n    onEdit({ alt });\n  };\n\n  return [\n    [\n      {\n        type: 'CommandDesc',\n        icon: () => 'insert_photo',\n        description: () => 'Select Image',\n        command: {\n          execute: (context, _editor) => {\n            selectImage(context.projectSlug, model.src).then((selection) =>\n              Maybe.maybe(selection).caseOf({\n                just: (src) => setSrc(src),\n                // eslint-disable-next-line\n                nothing: () => {},\n              }),\n            );\n          },\n          precondition: (_editor) => {\n            return true;\n          },\n        },\n      },\n    ],\n    [\n      {\n        type: 'CommandDesc',\n        icon: () => '',\n        description: () => 'Alt text',\n        command: {\n          execute: (_context, _editor, _params) => {\n            const dismiss = () => (window as any).oliDispatch(modalActions.dismiss());\n            const display = (c: any) => (window as any).oliDispatch(modalActions.display(c));\n\n            display(\n              <ImageModal\n                model={model}\n                onDone={(...args) => {\n                  dismiss();\n                  setAlt(...args);\n                }}\n                onCancel={() => {\n                  dismiss();\n                }}\n              />,\n            );\n          },\n          precondition: () => true,\n        },\n      },\n    ],\n  ];\n};\n"]}