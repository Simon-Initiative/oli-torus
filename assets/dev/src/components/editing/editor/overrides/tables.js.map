{"version":3,"file":"tables.js","sourceRoot":"","sources":["../../../../../../src/components/editing/editor/overrides/tables.ts"],"names":[],"mappings":"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","sourcesContent":["import { Editor, Element, Node, Point, Range } from 'slate';\n\nexport const withTables = (editor: Editor) => {\n  const { deleteBackward, deleteForward, deleteFragment } = editor;\n\n  editor.deleteFragment = () => {\n    const { selection } = editor;\n    if (selection) {\n      const [start, end] = Range.edges(selection);\n\n      // Prevent deletion if start or end of selection is inside a table.\n      const isInsideTable = (n: Node) =>\n        Element.isElement(n) && ['tr', 'th', 'td'].indexOf(n.type as string) > -1;\n      const [...startNodes] = Editor.nodes(editor, { at: start, match: isInsideTable });\n      const [...endNodes] = Editor.nodes(editor, { at: end, match: isInsideTable });\n      if (startNodes.length > 0 || endNodes.length > 0) {\n        return;\n      }\n    }\n\n    deleteFragment();\n  };\n\n  editor.deleteBackward = (unit) => {\n    const { selection } = editor;\n\n    if (selection && Range.isCollapsed(selection)) {\n      const [cell] = Editor.nodes(editor, {\n        match: (n) => Element.isElement(n) && n.type === 'td',\n      });\n\n      if (cell) {\n        const [, cellPath] = cell;\n        const start = Editor.start(editor, cellPath);\n\n        if (Point.equals(selection.anchor, start)) {\n          return;\n        }\n      }\n    }\n\n    deleteBackward(unit);\n  };\n\n  editor.deleteForward = (unit) => {\n    const { selection } = editor;\n\n    if (selection && Range.isCollapsed(selection)) {\n      const [cell] = Editor.nodes(editor, {\n        match: (n) => Element.isElement(n) && n.type === 'td',\n      });\n\n      if (cell) {\n        const [, cellPath] = cell;\n        const end = Editor.end(editor, cellPath);\n\n        if (Point.equals(selection.anchor, end)) {\n          return;\n        }\n      }\n    }\n\n    deleteForward(unit);\n  };\n\n  return editor;\n};\n"]}