{"version":3,"file":"Resizer.jsx","sourceRoot":"","sources":["../../../../../src/components/misc/resizer/Resizer.tsx"],"names":[],"mappings":"AACA,OAAO,EAAE,gBAAgB,EAAE,MAAM,0CAA0C,CAAC;AAC5E,OAAO,EACL,6BAA6B,EAC7B,kBAAkB,EAClB,kBAAkB,EAClB,kBAAkB,GACnB,MAAM,+BAA+B,CAAC;AACvC,OAAO,KAAK,EAAE,EAAgB,SAAS,EAAE,QAAQ,EAAE,MAAM,OAAO,CAAC;AAQjE,MAAM,CAAC,MAAM,OAAO,GAAG,CAAC,EAAE,QAAQ,EAAE,OAAO,EAAE,oBAAoB,EAAS,EAAgB,EAAE;IAC1F,MAAM,CAAC,YAAY,EAAE,eAAe,CAAC,GAAG,QAAQ,CAAuB,SAAS,CAAC,CAAC;IAClF,MAAM,aAAa,GAAG,gBAAgB,EAAE,CAAC;IAEzC,SAAS,CAAC,GAAG,EAAE;QACb,MAAM,SAAS,GAAG,CAAC,CAAa,EAAE,EAAE;YAClC,IAAI,OAAO,IAAI,YAAY,EAAE;gBAC3B,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,CAAC,CAAC;gBAC/B,QAAQ,CACN,6BAA6B,CAC3B,kBAAkB,CAAC,OAAO,CAAC,EAC3B,kBAAkB,CAAC,OAAO,CAAC,EAC3B,EAAE,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,EAAE,EAC1B,YAAY,CACb,CACF,CAAC;aACH;YACD,eAAe,CAAC,SAAS,CAAC,CAAC;QAC7B,CAAC,CAAC;QAEF,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;QAE9C,OAAO,GAAG,EAAE,CAAC,MAAM,CAAC,mBAAmB,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;IAChE,CAAC,EAAE,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC,CAAC;IAE5B,MAAM,iBAAiB,GAAwD,CAAC,GAAG,EAAE;QACnF,MAAM,iBAAiB,GAAG,YAAY,IAAI,aAAa,CAAC;QACxD,IAAI,CAAC,OAAO;YAAE,OAAO,GAAG,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;QACtE,IAAI,CAAC,iBAAiB;YAAE,OAAO,kBAAkB,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,CAAC;QAC/E,OAAO,kBAAkB,CACvB,6BAA6B,CAC3B,kBAAkB,CAAC,OAAO,CAAC,EAC3B,kBAAkB,CAAC,OAAO,CAAC,EAC3B,aAAa,EACb,YAAY,CACb,CACF,CAAC;IACJ,CAAC,CAAC,EAAE,CAAC;IAEL,MAAM,WAAW,GAAG,KAAK,CAAC,WAAW,CACnC,CAAC,QAAkB,EAAE,EAAE,CAAC,CAAC,CAA+C,EAAE,EAAE;QAC1E,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,eAAe,CAAC,QAAQ,CAAC,CAAC;IAC5B,CAAC,EACD,EAAE,CACH,CAAC;IAEF,MAAM,YAAY,GAAG,KAAK,CAAC,WAAW,CACpC,CAAC,QAAkB,EAAE,EAAE,CAAC,CACtB,CAAC,GAAG,CACF,WAAW,CAAC,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CACnC,SAAS,CAAC,6BAA6B,CACvC,KAAK,CAAC,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC,CACpC,EAAE,GAAG,CAAC,CACR,EACD,EAAE,CACH,CAAC;IAEF,OAAO,CACL,EACE;MAAA,CAAC,GAAG,CAAC,SAAS,CAAC,6BAA6B,CAAC,KAAK,CAAC,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,GAAG,CACtF;MAAA,CAAC,YAAY,CAAC,IAAI,CAAC,CACnB;MAAA,CAAC,YAAY,CAAC,IAAI,CAAC,CACnB;MAAA,CAAC,YAAY,CAAC,IAAI,CAAC,CACnB;MAAA,CAAC,YAAY,CAAC,IAAI,CAAC,CACnB;MAAA,CAAC,CAAC,oBAAoB,IAAI,CACxB,EACE;UAAA,CAAC,YAAY,CAAC,GAAG,CAAC,CAClB;UAAA,CAAC,YAAY,CAAC,GAAG,CAAC,CAClB;UAAA,CAAC,YAAY,CAAC,GAAG,CAAC,CAClB;UAAA,CAAC,YAAY,CAAC,GAAG,CAAC,CACpB;QAAA,GAAG,CACJ,CACH;IAAA,GAAG,CACJ,CAAC;AACJ,CAAC,CAAC","sourcesContent":["import { BoundingRect, Position } from 'components/misc/resizer/types';\nimport { useMousePosition } from 'components/misc/resizer/useMousePosition';\nimport {\n  boundingRectFromMousePosition,\n  clientBoundingRect,\n  offsetBoundingRect,\n  resizeHandleStyles,\n} from 'components/misc/resizer/utils';\nimport React, { ReactElement, useEffect, useState } from 'react';\n\ninterface Props {\n  onResize: (boundingRect: BoundingRect) => void;\n  element: HTMLElement;\n  constrainProportions?: boolean;\n}\n\nexport const Resizer = ({ onResize, element, constrainProportions }: Props): ReactElement => {\n  const [resizingFrom, setResizingFrom] = useState<Position | undefined>(undefined);\n  const mousePosition = useMousePosition();\n\n  useEffect(() => {\n    const onMouseUp = (e: MouseEvent) => {\n      if (element && resizingFrom) {\n        const { clientX, clientY } = e;\n        onResize(\n          boundingRectFromMousePosition(\n            clientBoundingRect(element),\n            offsetBoundingRect(element),\n            { x: clientX, y: clientY },\n            resizingFrom,\n          ),\n        );\n      }\n      setResizingFrom(undefined);\n    };\n\n    window.addEventListener('mouseup', onMouseUp);\n\n    return () => window.removeEventListener('mouseup', onMouseUp);\n  }, [resizingFrom, element]);\n\n  const boundResizeStyles: (pos: Position | 'border') => Partial<BoundingRect> = (() => {\n    const currentlyResizing = resizingFrom && mousePosition;\n    if (!element) return () => ({ top: 0, left: 0, width: 0, height: 0 });\n    if (!currentlyResizing) return resizeHandleStyles(offsetBoundingRect(element));\n    return resizeHandleStyles(\n      boundingRectFromMousePosition(\n        clientBoundingRect(element),\n        offsetBoundingRect(element),\n        mousePosition,\n        resizingFrom,\n      ),\n    );\n  })();\n\n  const onMouseDown = React.useCallback(\n    (position: Position) => (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n      e.preventDefault();\n      setResizingFrom(position);\n    },\n    [],\n  );\n\n  const resizeHandle = React.useCallback(\n    (position: Position) => (\n      <div\n        onMouseDown={onMouseDown(position)}\n        className=\"resize-selection-box-handle\"\n        style={boundResizeStyles(position)}\n      ></div>\n    ),\n    [],\n  );\n\n  return (\n    <>\n      <div className=\"resize-selection-box-border\" style={boundResizeStyles('border')}></div>\n      {resizeHandle('nw')}\n      {resizeHandle('ne')}\n      {resizeHandle('sw')}\n      {resizeHandle('se')}\n      {!constrainProportions && (\n        <>\n          {resizeHandle('n')}\n          {resizeHandle('s')}\n          {resizeHandle('e')}\n          {resizeHandle('w')}\n        </>\n      )}\n    </>\n  );\n};\n"]}