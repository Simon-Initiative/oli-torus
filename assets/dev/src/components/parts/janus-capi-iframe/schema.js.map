{"version":3,"file":"schema.js","sourceRoot":"","sources":["../../../../../src/components/parts/janus-capi-iframe/schema.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,iBAAiB,EAAE,MAAM,0BAA0B,CAAC;AAU7D,MAAM,CAAC,MAAM,MAAM,GAAsB;IACvC,cAAc,EAAE;QACd,KAAK,EAAE,kBAAkB;QACzB,IAAI,EAAE,QAAQ;KACf;IACD,GAAG,EAAE;QACH,KAAK,EAAE,QAAQ;QACf,IAAI,EAAE,QAAQ;KACf;IACD,cAAc,EAAE;QACd,KAAK,EAAE,iBAAiB;QACxB,IAAI,EAAE,SAAS;KAChB;CACF,CAAC;AAEF,MAAM,CAAC,MAAM,eAAe,GAAG,GAAG,EAAE,CAAC,CAAC;IACpC,SAAS,EAAE,IAAI;CAChB,CAAC,CAAC;AAEH,MAAM,CAAC,MAAM,gBAAgB,GAAG,CAAC,EAC/B,YAAY,EACZ,aAAa,GAId,EAAE,EAAE;;IACH,MAAM,OAAO,GAAG,aAAa,CAAC;IAC9B,IAAI,gBAAgB,GAAG,EAAE,CAAC;IAC1B,MAAM,UAAU,GAAQ,MAAA,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,MAAM,0CAAE,UAAU,CAAC;IACzD,IAAI,UAAU,IAAI,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;QAC3C,gBAAgB,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,GAAQ,EAAE,yBAA8B,EAAE,EAAE;YAChF,IAAI,SAAS,GAAsB,yBAAyB,CAAC,IAAI,CAAC;YAClE,IAAI,SAAS,EAAE;gBACb,IAAI,KAAK,CAAC,SAAS,CAAC,EAAE;oBACpB,OAAO,CAAC,IAAI,CAAC,sCAAsC,EAAE,yBAAyB,CAAC,CAAC;oBAChF,8BAA8B;oBAC9B,IAAI,SAAS,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,KAAK,QAAQ,EAAE;wBACnD,SAAS,GAAG,iBAAiB,CAAC,MAAM,CAAC;qBACtC;yBAAM,IAAI,SAAS,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,KAAK,QAAQ,EAAE;wBAC1D,SAAS,GAAG,iBAAiB,CAAC,MAAM,CAAC;qBACtC;yBAAM,IAAI,SAAS,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,KAAK,OAAO,EAAE;wBACzD,SAAS,GAAG,iBAAiB,CAAC,KAAK,CAAC;qBACrC;yBAAM,IAAI,SAAS,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,KAAK,SAAS,EAAE;wBAC3D,SAAS,GAAG,iBAAiB,CAAC,OAAO,CAAC;qBACvC;yBAAM,IAAI,SAAS,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,KAAK,MAAM,EAAE;wBACxD,SAAS,GAAG,iBAAiB,CAAC,IAAI,CAAC;qBACpC;yBAAM,IAAI,SAAS,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,KAAK,WAAW,EAAE;wBAC7D,SAAS,GAAG,iBAAiB,CAAC,SAAS,CAAC;qBACzC;yBAAM,IAAI,SAAS,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,KAAK,aAAa,EAAE;wBAC/D,SAAS,GAAG,iBAAiB,CAAC,WAAW,CAAC;qBAC3C;yBAAM;wBACL,qCAAqC;wBACrC,OAAO,GAAG,CAAC;qBACZ;iBACF;gBACD,IAAI,OAAO,KAAK,QAAQ,EAAE;oBACxB,IAAI,CAAC,yBAAyB,CAAC,QAAQ,EAAE;wBACvC,GAAG,CAAC,yBAAyB,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC;qBAChD;iBACF;qBAAM;oBACL,GAAG,CAAC,yBAAyB,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC;iBAChD;aACF;YACD,OAAO,GAAG,CAAC;QACb,CAAC,EAAE,EAAE,CAAC,CAAC;KACR;IACD,OAAO,gBAAgB,CAAC;AAC1B,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,QAAQ,GAAG,EAAE,CAAC;AAE3B,MAAM,CAAC,MAAM,YAAY,GAAG,GAA6B,EAAE,CAAC,CAAC;IAC3D,cAAc,EAAE,EAAE;IAClB,GAAG,EAAE,EAAE;IACP,cAAc,EAAE,KAAK;IACrB,UAAU,EAAE,EAAE;IACd,KAAK,EAAE,GAAG;IACV,MAAM,EAAE,GAAG;CACZ,CAAC,CAAC","sourcesContent":["import { CapiVariableTypes } from '../../../adaptivity/capi';\nimport { JSONSchema7Object } from 'json-schema';\nimport { JanusAbsolutePositioned, JanusCustomCss } from '../types/parts';\n\nexport interface CapiIframeModel extends JanusAbsolutePositioned, JanusCustomCss {\n  src: string;\n  configData: any;\n  allowScrolling: boolean;\n}\n\nexport const schema: JSONSchema7Object = {\n  customCssClass: {\n    title: 'Custom CSS class',\n    type: 'string',\n  },\n  src: {\n    title: 'Source',\n    type: 'string',\n  },\n  allowScrolling: {\n    title: 'Allow Scrolling',\n    type: 'boolean',\n  },\n};\n\nexport const getCapabilities = () => ({\n  configure: true,\n});\n\nexport const adaptivitySchema = ({\n  currentModel,\n  editorContext,\n}: {\n  currentModel: any;\n  editorContext: string;\n}) => {\n  const context = editorContext;\n  let adaptivitySchema = {};\n  const configData: any = currentModel?.custom?.configData;\n  if (configData && Array.isArray(configData)) {\n    adaptivitySchema = configData.reduce((acc: any, typeToAdaptivitySchemaMap: any) => {\n      let finalType: CapiVariableTypes = typeToAdaptivitySchemaMap.type;\n      if (finalType) {\n        if (isNaN(finalType)) {\n          console.warn('Type is not a valid CapiVariableType', typeToAdaptivitySchemaMap);\n          // attempt to fix the bad type\n          if (finalType.toString().toLowerCase() === 'number') {\n            finalType = CapiVariableTypes.NUMBER;\n          } else if (finalType.toString().toLowerCase() === 'string') {\n            finalType = CapiVariableTypes.STRING;\n          } else if (finalType.toString().toLowerCase() === 'array') {\n            finalType = CapiVariableTypes.ARRAY;\n          } else if (finalType.toString().toLowerCase() === 'boolean') {\n            finalType = CapiVariableTypes.BOOLEAN;\n          } else if (finalType.toString().toLowerCase() === 'enum') {\n            finalType = CapiVariableTypes.ENUM;\n          } else if (finalType.toString().toLowerCase() === 'math_expr') {\n            finalType = CapiVariableTypes.MATH_EXPR;\n          } else if (finalType.toString().toLowerCase() === 'array_point') {\n            finalType = CapiVariableTypes.ARRAY_POINT;\n          } else {\n            // couldn't fix it, so just remove it\n            return acc;\n          }\n        }\n        if (context === 'mutate') {\n          if (!typeToAdaptivitySchemaMap.readonly) {\n            acc[typeToAdaptivitySchemaMap.key] = finalType;\n          }\n        } else {\n          acc[typeToAdaptivitySchemaMap.key] = finalType;\n        }\n      }\n      return acc;\n    }, {});\n  }\n  return adaptivitySchema;\n};\n\nexport const uiSchema = {};\n\nexport const createSchema = (): Partial<CapiIframeModel> => ({\n  customCssClass: '',\n  src: '',\n  allowScrolling: false,\n  configData: [],\n  width: 400,\n  height: 400,\n});\n"]}