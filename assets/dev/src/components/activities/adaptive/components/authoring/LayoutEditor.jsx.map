{"version":3,"file":"LayoutEditor.jsx","sourceRoot":"","sources":["../../../../../../../src/components/activities/adaptive/components/authoring/LayoutEditor.tsx"],"names":[],"mappings":";;;;;;;;;AAAA,OAAO,aAAa,MAAM,yDAAyD,CAAC;AACpF,OAAO,EACL,mBAAmB,EACnB,gBAAgB,EAChB,uBAAuB,GACxB,MAAM,8CAA8C,CAAC;AACtD,OAAO,EAAoB,mBAAmB,EAAE,MAAM,8BAA8B,CAAC;AACrF,OAAO,YAAY,MAAM,QAAQ,CAAC;AAClC,OAAO,KAAK,EAAE,EAAE,WAAW,EAAE,UAAU,EAAE,SAAS,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,OAAO,CAAC;AACpF,OAAO,SAAS,MAAM,iBAAiB,CAAC;AACxC,OAAO,EAAE,KAAK,EAAE,MAAM,cAAc,CAAC;AACrC,OAAO,EAAE,QAAQ,EAAE,MAAM,yCAAyC,CAAC;AACnE,OAAO,aAAa,MAAM,yBAAyB,CAAC;AAkBpD,MAAM,cAAc,GAAG,GAAS,EAAE;IAChC,OAAO;QACL,IAAI,EAAE,SAAS;QACf,QAAQ,EAAE,EAAE;KACb,CAAC;AACJ,CAAC,CAAA,CAAC;AAEF,MAAM,gBAAgB,GAAG,CAAC,EAAE,CAAC;AAE7B,MAAM,YAAY,GAAgC,CAAC,KAAK,EAAE,EAAE;IAC1D,MAAM,aAAa,GAAG,UAAU,CAAC,mBAAmB,CAAC,CAAC;IACtD,MAAM,CAAC,MAAM,EAAE,SAAS,CAAC,GAAG,QAAQ,CAAC,aAAa,IAAI,IAAI,YAAY,EAAE,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC,CAAC;IAE9F,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,aAAa,EAAE;YACjB,SAAS,CAAC,aAAa,CAAC,CAAC;SAC1B;IACH,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC,CAAC;IAEpB,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IAChD,MAAM,CAAC,cAAc,EAAE,iBAAiB,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,QAAQ,IAAI,EAAE,CAAC,CAAC;IAC3E,MAAM,CAAC,eAAe,EAAE,kBAAkB,CAAC,GAAG,QAAQ,CAAC,EAAE,CAAC,CAAC;IAC3D,MAAM,CAAC,YAAY,EAAE,eAAe,CAAC,GAAG,QAAQ,CAAM,IAAI,CAAC,CAAC;IAC5D,MAAM,CAAC,UAAU,EAAE,aAAa,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;IACpD,MAAM,CAAC,iBAAiB,EAAE,oBAAoB,CAAC,GAAG,QAAQ,CAAU,KAAK,CAAC,CAAC;IAC3E,MAAM,CAAC,eAAe,EAAE,kBAAkB,CAAC,GAAG,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IAEvE,MAAM,gBAAgB,GAAG,eAAe,KAAK,CAAC,EAAE,EAAE,CAAC;IACnD,MAAM,CAAC,QAAQ,EAAE,WAAW,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,iBAAiB,IAAI,gBAAgB,CAAC,CAAC;IAEtF,SAAS,CAAC,GAAG,EAAE;QACb,WAAW,CAAC,KAAK,CAAC,iBAAiB,IAAI,gBAAgB,CAAC,CAAC;IAC3D,CAAC,EAAE,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC,CAAC;IAE9B,iEAAiE;IACjE,SAAS,CAAC,GAAG,EAAE;QACb,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IACxB,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;IAElB,iEAAiE;IACjE,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,KAAK,CAAC,QAAQ,KAAK,cAAc,EAAE;YACrC,iBAAiB,CAAC,KAAK,CAAC,QAAQ,IAAI,EAAE,CAAC,CAAC;SACzC;IACH,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;IAErB,qEAAqE;IACrE,SAAS,CAAC,GAAG,EAAE;QACb,MAAM,CAAC,GAAG,CAAA,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,MAAM,CAAC,CAAC,KAAI,CAAC,CAAC;QACtC,MAAM,CAAC,GAAG,CAAC,CAAA,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,MAAM,CAAC,CAAC,KAAI,CAAC,CAAC,GAAG,gBAAgB,CAAC;QAC3D,IAAI,eAAe,CAAC,CAAC,KAAK,CAAC,IAAI,eAAe,CAAC,CAAC,KAAK,CAAC,EAAE;YACtD,kBAAkB,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;SAC9B;IACH,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC,CAAC;IAEnB,wFAAwF;IACxF,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,cAAc,EAAE;YAClB,MAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,cAAc,CAAC,CAAC;YACxD,IAAI,IAAI,EAAE;gBACR,IAAI,YAAY,qBAAQ,mBAAmB,CAAE,CAAC;gBAC9C,+CAA+C;gBAC/C,MAAM,SAAS,GAAG,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAChD,IAAI,SAAS,EAAE;oBACb,yEAAyE;oBACzE,MAAM,QAAQ,GAAG,IAAI,SAAS,EAAS,CAAC,CAAC,4BAA4B;oBACrE,IAAI,QAAQ,CAAC,eAAe,EAAE;wBAC5B,YAAY,mCAAQ,YAAY,GAAK,QAAQ,CAAC,eAAe,EAAE,CAAE,CAAC;qBACnE;oBACD,MAAM,oBAAoB,mCAAQ,IAAI,KAAE,YAAY,GAAE,CAAC;oBACvD,eAAe,CAAC,oBAAoB,CAAC,CAAC;oBACtC;;;0BAGM;iBACP;aACF;SACF;aAAM;YACL,eAAe,CAAC,IAAI,CAAC,CAAC;YACtB;;;kBAGM;SACP;QACD,qDAAqD;QACrD,kBAAkB,CAAC,EAAE,CAAC,CAAC;IACzB,CAAC,EAAE,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC,CAAC;IAE5B,4FAA4F;IAC5F,SAAS,CAAC,GAAG,EAAE;QACb,MAAM,eAAe,GAAG,CAAC,CAAM,EAAE,EAAE;YACjC,MAAM,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC;YACpB,MAAM,OAAO,GACX,CAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,GAAG,CAAC,CAAC,IAAiB,EAAE,EAAE,CAAC,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,KAAI,EAAE,CAAC;YACvF,mDAAmD;YACnD,MAAM,cAAc,GAAG,OAAO,CAAC,QAAQ,CAAC,4BAA4B,KAAK,CAAC,EAAE,EAAE,CAAC,CAAC;YAChF,MAAM,cAAc,GAAG,eAAe,KAAK,EAAE,CAAC;YAC9C,iFAAiF;YACjF,IAAI,CAAC,cAAc,IAAI,CAAC,cAAc,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;gBACpF,iBAAiB,CAAC,EAAE,CAAC,CAAC;gBACtB,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;aACpB;QACH,CAAC,CAAC;QACF,IAAI,KAAK,CAAC,OAAO,EAAE;YACjB,KAAK,CAAC,OAAO,CAAC,gBAAgB,CAAC,OAAO,EAAE,eAAe,CAAC,CAAC;SAC1D;QACD,OAAO,GAAG,EAAE;YACV,IAAI,KAAK,CAAC,OAAO,EAAE;gBACjB,KAAK,CAAC,OAAO,CAAC,mBAAmB,CAAC,OAAO,EAAE,eAAe,CAAC,CAAC;aAC7D;QACH,CAAC,CAAC;IACJ,CAAC,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,eAAe,CAAC,CAAC,CAAC;IAEpC,MAAM,eAAe,GAAG,WAAW,CACjC,CAAO,CAAM,EAAE,OAAY,EAAE,EAAE;QAC7B,wDAAwD;QACxD,CAAC,CAAC,eAAe,EAAE,CAAC;QACpB,IAAI,cAAc,KAAK,OAAO,CAAC,EAAE,EAAE;YACjC,OAAO;SACR;QACD,iBAAiB,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QAC9B,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IAC7B,CAAC,CAAA,EACD,CAAC,cAAc,CAAC,CACjB,CAAC;IAEF,MAAM,cAAc,GAAG,WAAW,CAChC,CAAO,OAAY,EAAE,EAAE;QACrB,4CAA4C;QAC5C,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,IAAI,OAAO,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;YAClE,OAAO;SACR;QACD,IAAI,cAAc,GAAG,EAAE,CAAC,CAAC,qCAAqC;QAC9D,MAAM,WAAW,GAAG,EAAE,CAAC,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC;QACrE,MAAM,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC;QAChC,MAAM,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC,CAAM,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,OAAO,CAAC,MAAM,CAAC,CAAC;QAClE,IAAI,IAAI,EAAE;YACR,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,WAAW,CAAC,CAAC,CAAC;YAC9B,cAAc,GAAG,wBAAwB,WAAW,CAAC,CAAC,OAAO,WAAW,CAAC,CAAC,MAAM,CAAC;YACjF,kBAAkB,CAAC,EAAE,CAAC,EAAE,WAAW,CAAC,CAAC,EAAE,CAAC,EAAE,WAAW,CAAC,CAAC,GAAG,gBAAgB,EAAE,CAAC,CAAC;SAC/E;QAED,8BAA8B;QAC9B,QAAQ,CAAC,UAAU,CAAC,CAAC;QAErB,6BAA6B;QAC7B,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAE3B,uDAAuD;QACvD,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,cAAc,CAAC,CAAC;IAC9D,CAAC,CAAA,EACD,CAAC,KAAK,CAAC,CACR,CAAC;IAEF,MAAM,mBAAmB,GAAG,WAAW,CACrC,CAAO,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,EAAE;QACnC;;;;;;cAMM;QACN,IAAI,MAAM,KAAK,cAAc,EAAE;YAC7B,OAAO,CAAC,KAAK,CAAC,uDAAuD,CAAC,CAAC;YACvE,OAAO;SACR;QACD,IAAI,eAAe,KAAK,MAAM,IAAI,SAAS,EAAE;YAC3C,OAAO;SACR;QAED,IAAI,SAAS,EAAE;YACb,IAAI,KAAK,CAAC,eAAe,EAAE;gBACzB,KAAK,CAAC,eAAe,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;aACxC;YACD,kBAAkB,CAAC,MAAM,CAAC,CAAC;SAC5B;aAAM;YACL,kBAAkB,CAAC,EAAE,CAAC,CAAC;SACxB;IACH,CAAC,CAAA,EACD,CAAC,cAAc,EAAE,eAAe,EAAE,QAAQ,EAAE,MAAM,CAAC,CACpD,CAAC;IAEF,4HAA4H;IAC5H,+GAA+G;IAC/G,MAAM,0BAA0B,GAAG,CAAC,MAAc,EAAE,SAAkB,EAAE,EAAE;QACxE,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,QAAQ,EAAE,EAAE,EAAE,MAAM,EAAE,SAAS,EAAE,CAAC,CAAC;IAC5E,CAAC,CAAC;IAEF,MAAM,gBAAgB,GAAG,WAAW,CAAC,GAAS,EAAE;QAC9C,uDAAuD;QACvD,MAAM,aAAa,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE,KAAK,YAAY,CAAC,EAAE,CAAC,CAAC;QAC1E,KAAK,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;QAC9B,oCAAoC;QACpC,QAAQ,CAAC,aAAa,CAAC,CAAC;QACxB,6EAA6E;QAC7E,iBAAiB,CAAC,EAAE,CAAC,CAAC;QACtB,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;IACrB,CAAC,CAAA,EAAE,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC,CAAC;IAE1B,MAAM,sBAAsB,GAAG,WAAW,CAAC,GAAG,EAAE;QAC9C,gBAAgB,EAAE,CAAC;QACnB,oBAAoB,CAAC,KAAK,CAAC,CAAC;IAC9B,CAAC,EAAE,CAAC,gBAAgB,CAAC,CAAC,CAAC;IAEvB,MAAM,mBAAmB,GAAG,WAAW,CAAC,GAAS,EAAE;QACjD,wDAAwD;QACxD,IAAI,KAAK,CAAC,UAAU,EAAE;YACpB,KAAK,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;SAChC;QACD,wDAAwD;IAC1D,CAAC,CAAA,EAAE,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC,CAAC;IAE1B,MAAM,qBAAqB,GAAG,WAAW,CAAC,GAAS,EAAE;QACnD,4DAA4D;QAC5D,MAAM,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC;QAChC,MAAM,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC,CAAM,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,YAAY,CAAC,EAAE,CAAC,CAAC;QACnE,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC;QAClC,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAC3B,oCAAoC;QACpC,QAAQ,CAAC,UAAU,CAAC,CAAC;IACvB,CAAC,CAAA,EAAE,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC,CAAC;IAE1B,MAAM,kBAAkB,GAAG,WAAW,CAAC,GAAS,EAAE;QAChD,6DAA6D;QAC7D,MAAM,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC;QAChC,MAAM,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC,CAAM,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,YAAY,CAAC,EAAE,CAAC,CAAC;QACnE,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC;QAClC,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAC3B,oCAAoC;QACpC,QAAQ,CAAC,UAAU,CAAC,CAAC;IACvB,CAAC,CAAA,EAAE,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC,CAAC;IAE1B,MAAM,yBAAyB,GAAG,WAAW,CAC3C,CAAO,EAAE,EAAE,EAAkB,EAAE,EAAE;QAC/B,2EAA2E;QAC3E,IAAI,CAAC,eAAe,IAAI,EAAE,KAAK,eAAe,EAAE;YAC9C,IAAI,KAAK,CAAC,qBAAqB,EAAE;gBAC/B,KAAK,CAAC,qBAAqB,CAAC,eAAe,CAAC,CAAC;aAC9C;YACD,kBAAkB,CAAC,EAAE,CAAC,CAAC;YACvB,OAAO,IAAI,CAAC;SACb;QACD,OAAO,CAAC,IAAI,CAAC,QAAQ,EAAE,kCAAkC,eAAe,cAAc,CAAC,CAAC;QACxF,OAAO,KAAK,CAAC;IACf,CAAC,CAAA,EACD,CAAC,eAAe,CAAC,CAClB,CAAC;IAEF,MAAM,uBAAuB,GAAG,WAAW,CACzC,CAAO,EAAE,EAAE,EAAE,QAAQ,EAAiC,EAAE,EAAE;QACxD,MAAM,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC;QAChC,MAAM,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC,CAAM,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;QACtD,IAAI,IAAI,EAAE;YACR,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC;YAEvB,qFAAqF;YAErF,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;YAC3B,QAAQ,CAAC,UAAU,CAAC,CAAC;SACtB;QACD,kBAAkB,CAAC,EAAE,CAAC,CAAC;IACzB,CAAC,CAAA,EACD,CAAC,KAAK,CAAC,CACR,CAAC;IAEF,MAAM,mBAAmB,GAAG,CAAC,CAAM,EAAE,EAAE;QACrC,kCAAkC;QAClC,IAAI,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,KAAK,uBAAuB,EAAE;YAC9D,kBAAkB,CAAC,EAAE,CAAC,CAAC;SACxB;IACH,CAAC,CAAC;IAEF,MAAM,CAAC,UAAU,EAAE,aAAa,CAAC,GAAG,QAAQ,CAAW,EAAE,CAAC,CAAC;IAE3D,SAAS,CAAC,GAAG,EAAE;QACb,MAAM,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;YAChC,MAAM,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,eAAe,CAAC;YACxE,OAAO,IAAI,MAAM;;;iBAGN,IAAI,CAAC,MAAM,CAAC,KAAK;;;+BAGH,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC;mBACvD,IAAI,CAAC,MAAM,CAAC,CAAC;QACxB,CAAC;QACL,CAAC,CAAC,CAAC;QACH,aAAa,CAAC,MAAM,CAAC,CAAC;QACtB,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;YACrB,MAAM,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,eAAe,CAAC;YACxE,MAAM,WAAW,GAAG,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;YACpD,IAAI,WAAW,EAAE;gBACf,WAAW,CAAC,YAAY,CACtB,OAAO,EACP,wBAAwB,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,MAAM,CAC1E,CAAC;aACH;QACH,CAAC,CAAC,CAAC;IACL,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;IAEZ,SAAS,CAAC,GAAG,EAAE;QACb,IAAI,CAAC,MAAM,EAAE;YACX,OAAO;SACR;QACD,MAAM,oBAAoB,GAAG;YAC3B,gBAAgB,CAAC,SAAS;YAC1B,gBAAgB,CAAC,gBAAgB;YACjC,gBAAgB,CAAC,cAAc;SAChC,CAAC;QACF,MAAM,aAAa,GAAG,oBAAoB,CAAC,GAAG,CAAC,CAAC,gBAAkC,EAAE,EAAE;YACpF,MAAM,OAAO,GAAG,CAAC,OAAY,EAAE,EAAE;gBAC/B,+EAA+E;gBAC/E,8CAA8C;gBAC9C,uFAAuF;gBACvF,QAAQ,gBAAgB,EAAE;oBACxB,KAAK,gBAAgB,CAAC,gBAAgB;wBACpC,yBAAyB,CAAC,OAAO,CAAC,CAAC;wBACnC,MAAM;oBACR,KAAK,gBAAgB,CAAC,cAAc;wBAClC,qEAAqE;wBACrE,mFAAmF;wBACnF,IAAI,CAAC,eAAe,IAAI,OAAO,CAAC,EAAE,KAAK,eAAe,EAAE;4BACtD,kBAAkB,CAAC,EAAE,CAAC,CAAC;yBACxB;wBACD,MAAM;iBACT;YACH,CAAC,CAAC;YACF,MAAM,KAAK,GAAG,uBAAuB,CAAC,MAAM,EAAE,gBAAgB,EAAE,OAAO,CAAC,CAAC;YACzE,OAAO,KAAK,CAAC;QACf,CAAC,CAAC,CAAC;QACH,OAAO,GAAG,EAAE;YACV,aAAa,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,EAAE;gBAC9B,KAAK,EAAE,CAAC;YACV,CAAC,CAAC,CAAC;QACL,CAAC,CAAC;IACJ,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;IAEb,MAAM,YAAY,GAAG,MAAM,CAAiB,IAAI,CAAC,CAAC;IAElD,MAAM,cAAc,GAAG,CAAO,EAAE,EAAE,EAAE,SAAS,EAAoC,EAAE,EAAE;QACnF,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,EAAE,EAAE,EAAE,SAAS,EAAE,CAAC,CAAC;QAC9C,OAAO;YACL,QAAQ,EAAE,EAAE;YACZ,OAAO,EAAE;gBACP,IAAI,EAAE,QAAQ,CAAC,MAAM;gBACrB,IAAI,EAAE,YAAY,CAAC,OAAO;aAC3B;SACF,CAAC;IACJ,CAAC,CAAA,CAAC;IAEF,OAAO,KAAK,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAC7B,CAAC,mBAAmB,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,CAC1C;MAAA,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,YAAY,CAAC,CAAC,SAAS,CAAC,kBAAkB,CAClD;QAAA,CAAC,KAAK,CACJ;UAAA,CAAC;;;;gCAIqB,KAAK,CAAC,eAAe,IAAI,MAAM;qBAC1C,KAAK,CAAC,KAAK,IAAI,IAAI;sBAClB,KAAK,CAAC,MAAM,IAAI,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAiD7B,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC;SACxB,CACD;QAAA,EAAE,KAAK,CACP;QAAA,CAAC,GAAG,CACF,SAAS,CAAC,uBAAuB,CACjC,KAAK,CAAC,CAAC,EAAE,OAAO,EAAE,eAAe,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAC9D,OAAO,CAAC,CAAC,mBAAmB,CAAC,CAE7B;UAAA,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,gBAAgB,CAAC,CAAC,SAAS,CAAC,6BAA6B,CAAC,EAAE,GAAG,CAC1E;QAAA,EAAE,GAAG,CACL;QAAA,CAAC,GAAG,CACF,EAAE,CAAC,CAAC,4BAA4B,KAAK,CAAC,EAAE,EAAE,CAAC,CAC3C,SAAS,CAAC,0BAA0B,CACpC,KAAK,CAAC,CAAC;YACL,OAAO,EAAE,YAAY,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM;YACvD,GAAG,EAAE,eAAe,CAAC,CAAC;YACtB,IAAI,EAAE,eAAe,CAAC,CAAC;SACxB,CAAC,CAEF;UAAA,CAAC,YAAY,IAAI,YAAY,CAAC,YAAY,CAAC,SAAS,IAAI,CACtD,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC,0BAA0B,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,CACpF;cAAA,CAAC,CAAC,CAAC,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,CAChC;YAAA,EAAE,MAAM,CAAC,CACV,CACD;UAAA,CAAC,YAAY,IAAI,YAAY,CAAC,YAAY,CAAC,IAAI,IAAI,CACjD,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,mBAAmB,CAAC,CAChD;cAAA,CAAC,CAAC,CAAC,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,CAChC;YAAA,EAAE,MAAM,CAAC,CACV,CACD;UAAA,CAAC;;oBAEW,CACZ;UAAA,CAAC,YAAY,IAAI,YAAY,CAAC,YAAY,CAAC,IAAI,IAAI,CACjD,CAAC,MAAM,CAAC,KAAK,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,qBAAqB,CAAC,CAC1D;cAAA,CAAC,CAAC,CAAC,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,CAChC;YAAA,EAAE,MAAM,CAAC,CACV,CACD;UAAA,CAAC,YAAY,IAAI,YAAY,CAAC,YAAY,CAAC,IAAI,IAAI,CACjD,CAAC,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,kBAAkB,CAAC,CACpD;cAAA,CAAC,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,EAAE,CAAC,CACjC;YAAA,EAAE,MAAM,CAAC,CACV,CACD;UAAA,CAAC,YAAY,IAAI,YAAY,CAAC,YAAY,CAAC,MAAM,IAAI,CACnD,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC,CAC/D;cAAA,CAAC,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,EAAE,CAAC,CACjC;YAAA,EAAE,MAAM,CAAC,CACV,CACD;UAAA,CAAC,aAAa,CACZ,IAAI,CAAC,CAAC,iBAAiB,CAAC,CACxB,WAAW,CAAC,WAAW,CACvB,WAAW,CAAC,CAAC,YAAY,aAAZ,YAAY,uBAAZ,YAAY,CAAE,EAAE,CAAC,CAC9B,aAAa,CAAC,CAAC,sBAAsB,CAAC,CACtC,aAAa,CAAC,CAAC,GAAG,EAAE;YAClB,oBAAoB,CAAC,KAAK,CAAC,CAAC;QAC9B,CAAC,CAAC,EAEN;QAAA,EAAE,GAAG,CACL;QAAA,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;YAClB,MAAM,SAAS,GAAG;gBAChB,EAAE,EAAE,IAAI,CAAC,EAAE;gBACX,IAAI,EAAE,IAAI,CAAC,IAAI;gBACf,KAAK,EAAE,IAAI,CAAC,MAAM;gBAClB,KAAK,EAAE,EAAE;gBACT,aAAa,EAAE,IAAI,CAAC,EAAE,KAAK,eAAe;gBAC1C,QAAQ,EAAE,IAAI;gBACd,MAAM,EAAE,QAAQ;gBAChB,MAAM,EAAE,cAAc;gBACtB,OAAO,EAAE,cAAc;gBACvB,MAAM,EAAE,cAAc;gBACtB,QAAQ,EAAE,cAAc;gBACxB,QAAQ,EAAE,cAAc;aACzB,CAAC;YACF,MAAM,WAAW,GACf,cAAc,KAAK,IAAI,CAAC,EAAE;gBAC1B,IAAI,CAAC,EAAE,KAAK,eAAe;gBAC3B,CAAC,YAAY,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;YACpD,OAAO,CACL,CAAC,SAAS,CACR,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CACb,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CACb,eAAe,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAClE,QAAQ,CAAC,CAAC,WAAW,CAAC,CACtB,OAAO,CAAC,CAAC,GAAG,EAAE;oBACZ,aAAa,CAAC,IAAI,CAAC,CAAC;gBACtB,CAAC,CAAC,CACF,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,EAAE;oBACtB,aAAa,CAAC,KAAK,CAAC,CAAC;oBACrB,cAAc,CAAC,EAAE,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,CAAC,CAAC;gBAChD,CAAC,CAAC,CAEF;cAAA,CAAC,aAAa,CACZ,IAAI,SAAS,CAAC,CACd,SAAS,CAAC,CAAC,cAAc,KAAK,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,CACxD,OAAO,CAAC,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,eAAe,CAAC,KAAK,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC,CAC5D,WAAW,CAAC,CAAC,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,EAAE,EAAE,CACtC,mBAAmB,CAAC,IAAI,CAAC,EAAE,EAAE,SAAS,EAAE,OAAO,CAAC,CACjD,CACD,eAAe,CAAC,CAAC,uBAAuB,CAAC,CACzC,iBAAiB,CAAC,CAAC,yBAAyB,CAAC,EAEjD;YAAA,EAAE,SAAS,CAAC,CACb,CAAC;QACJ,CAAC,CAAC,CACJ;MAAA,EAAE,GAAG,CACP;IAAA,EAAE,mBAAmB,CAAC,QAAQ,CAAC,CAChC,CAAC,CAAC,CAAC,IAAI,CAAC;AACX,CAAC,CAAC;AAEF,eAAe,YAAY,CAAC","sourcesContent":["import ConfirmDelete from 'apps/authoring/components/Modal/DeleteConfirmationModal';\nimport {\n  NotificationContext,\n  NotificationType,\n  subscribeToNotification,\n} from 'apps/delivery/components/NotificationContext';\nimport { AnyPartComponent, defaultCapabilities } from 'components/parts/types/parts';\nimport EventEmitter from 'events';\nimport React, { useCallback, useContext, useEffect, useRef, useState } from 'react';\nimport Draggable from 'react-draggable';\nimport { clone } from 'utils/common';\nimport { contexts } from '../../../../../types/applicationContext';\nimport PartComponent from '../common/PartComponent';\n\ninterface LayoutEditorProps {\n  id: string;\n  width: number;\n  height: number;\n  backgroundColor: string; // TODO: background: CSSProperties ??\n  parts: AnyPartComponent[];\n  selected: string;\n  hostRef?: HTMLElement;\n  configurePortalId?: string;\n  onChange: (parts: AnyPartComponent[]) => void;\n  onSelect: (partId: string) => void;\n  onCopyPart?: (part: any) => Promise<any>;\n  onConfigurePart?: (part: any, context: any) => Promise<any>;\n  onCancelConfigurePart?: (partId: string) => Promise<any>;\n}\n\nconst defaultHandler = async () => {\n  return {\n    type: 'success',\n    snapshot: {},\n  };\n};\n\nconst toolBarTopOffset = -38;\n\nconst LayoutEditor: React.FC<LayoutEditorProps> = (props) => {\n  const pusherContext = useContext(NotificationContext);\n  const [pusher, setPusher] = useState(pusherContext || new EventEmitter().setMaxListeners(50));\n\n  useEffect(() => {\n    if (pusherContext) {\n      setPusher(pusherContext);\n    }\n  }, [pusherContext]);\n\n  const [parts, setParts] = useState(props.parts);\n  const [selectedPartId, setSelectedPartId] = useState(props.selected || '');\n  const [configurePartId, setConfigurePartId] = useState('');\n  const [selectedPart, setSelectedPart] = useState<any>(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [showConfirmDelete, setShowConfirmDelete] = useState<boolean>(false);\n  const [toolbarPosition, setToolbarPosition] = useState({ x: 0, y: 0 });\n\n  const fallbackPortalId = `part-portal-${props.id}`;\n  const [portalId, setPortalId] = useState(props.configurePortalId || fallbackPortalId);\n\n  useEffect(() => {\n    setPortalId(props.configurePortalId || fallbackPortalId);\n  }, [props.configurePortalId]);\n\n  // this effect keeps the local parts state in sync with the props\n  useEffect(() => {\n    setParts(props.parts);\n  }, [props.parts]);\n\n  // this effect keeps the local selected id in sync with the props\n  useEffect(() => {\n    if (props.selected !== selectedPartId) {\n      setSelectedPartId(props.selected || '');\n    }\n  }, [props.selected]);\n\n  // this effect keeps the toolbar positioned next to the selected part\n  useEffect(() => {\n    const x = selectedPart?.custom.x || 0;\n    const y = (selectedPart?.custom.y || 0) + toolBarTopOffset;\n    if (toolbarPosition.x !== x && toolbarPosition.y !== y) {\n      setToolbarPosition({ x, y });\n    }\n  }, [selectedPart]);\n\n  // this keeps a reference to the actual part data of the selected part id in local state\n  useEffect(() => {\n    if (selectedPartId) {\n      const part = parts.find((p) => p.id === selectedPartId);\n      if (part) {\n        let capabilities = { ...defaultCapabilities };\n        // attempt to get an instance of the part class\n        const PartClass = customElements.get(part.type);\n        if (PartClass) {\n          // TODO: cache the instance data somewhere so we don't do this every time\n          const instance = new PartClass() as any; // TODO: extend HTMLElement?\n          if (instance.getCapabilities) {\n            capabilities = { ...capabilities, ...instance.getCapabilities() };\n          }\n          const partWithCapabilities = { ...part, capabilities };\n          setSelectedPart(partWithCapabilities);\n          /* console.log('PART SELECTION CHANGED', {\n            selectedPartId,\n            selectedPart: partWithCapabilities,\n          }); */\n        }\n      }\n    } else {\n      setSelectedPart(null);\n      /* console.log('PART SELECTION CHANGED', {\n        selectedPartId,\n        selectedPart: null,\n      }); */\n    }\n    // any time selection changes we need to stop editing\n    setConfigurePartId('');\n  }, [selectedPartId, parts]);\n\n  // this effect is to cover the case when the user is clicking \"off\" of a part to deselect it\n  useEffect(() => {\n    const handleHostClick = (e: any) => {\n      const path = e.path;\n      const pathIds =\n        path?.map((node: HTMLElement) => node.getAttribute && node.getAttribute('id')) || [];\n      // console.log('HOST CLICK', { pathIds, path, e });\n      const isToolbarClick = pathIds.includes(`active-selection-toolbar-${props.id}`);\n      const isInConfigMode = configurePartId !== '';\n      // TODO: ability to click things underneath other things using path and selection\n      if (!isInConfigMode && !isToolbarClick && !parts.find((p) => pathIds.includes(p.id))) {\n        setSelectedPartId('');\n        props.onSelect('');\n      }\n    };\n    if (props.hostRef) {\n      props.hostRef.addEventListener('click', handleHostClick);\n    }\n    return () => {\n      if (props.hostRef) {\n        props.hostRef.removeEventListener('click', handleHostClick);\n      }\n    };\n  }, [props, parts, configurePartId]);\n\n  const handlePartClick = useCallback(\n    async (e: any, payload: any) => {\n      // console.log('AUTHOR PART CLICK', { payload, props });\n      e.stopPropagation();\n      if (selectedPartId === payload.id) {\n        return;\n      }\n      setSelectedPartId(payload.id);\n      props.onSelect(payload.id);\n    },\n    [selectedPartId],\n  );\n\n  const handlePartDrag = useCallback(\n    async (payload: any) => {\n      // console.log('AUTHOR PART DRAG', payload);\n      if (payload.dragData.deltaX === 0 && payload.dragData.deltaY === 0) {\n        return;\n      }\n      let transformStyle = ''; // 'transform: translate(0px, 0px);';\n      const newPosition = { x: payload.dragData.x, y: payload.dragData.y };\n      const partsClone = clone(parts);\n      const part = partsClone.find((p: any) => p.id === payload.partId);\n      if (part) {\n        part.custom.x = newPosition.x;\n        part.custom.y = newPosition.y;\n        transformStyle = `transform: translate(${newPosition.x}px, ${newPosition.y}px);`;\n        setToolbarPosition({ x: newPosition.x, y: newPosition.y + toolBarTopOffset });\n      }\n\n      // optimistically update parts\n      setParts(partsClone);\n\n      // update parent with changes\n      props.onChange(partsClone);\n\n      // need to reset the styling applied by react-draggable\n      payload.dragData.node.setAttribute('style', transformStyle);\n    },\n    [parts],\n  );\n\n  const handlePartConfigure = useCallback(\n    async (partId, configure, context) => {\n      /* console.log('LE: AUTHOR PART CONFIGURE', {\n        configurePartId,\n        partId,\n        configure,\n        portalId,\n        context,\n      }); */\n      if (partId !== selectedPartId) {\n        console.error('trying to enable configure for a not selected partId!');\n        return;\n      }\n      if (configurePartId === partId && configure) {\n        return;\n      }\n\n      if (configure) {\n        if (props.onConfigurePart) {\n          props.onConfigurePart(partId, context);\n        }\n        setConfigurePartId(partId);\n      } else {\n        setConfigurePartId('');\n      }\n    },\n    [selectedPartId, configurePartId, portalId, pusher],\n  );\n\n  // the difference of this is that the toolbar just tells all the parts that this one is supposed to be in configuration mode\n  // that should trigger them to fire their own onConfigure callbacks so that they can send part specific context\n  const handleToolbarPartConfigure = (partId: string, configure: boolean) => {\n    pusher.emit(NotificationType.CONFIGURE.toString(), { partId, configure });\n  };\n\n  const handlePartDelete = useCallback(async () => {\n    // console.log('AUTHOR PART DELETE', { selectedPart });\n    const filteredParts = parts.filter((part) => part.id !== selectedPart.id);\n    props.onChange(filteredParts);\n    // optimistically update local state\n    setParts(filteredParts);\n    // just setting the part ID should trigger the selectedPart also to get reset\n    setSelectedPartId('');\n    props.onSelect('');\n  }, [selectedPart, parts]);\n\n  const DeleteComponentHandler = useCallback(() => {\n    handlePartDelete();\n    setShowConfirmDelete(false);\n  }, [handlePartDelete]);\n\n  const handleCopyComponent = useCallback(async () => {\n    /* console.log('AUTHOR PART COPY', { selectedPart }); */\n    if (props.onCopyPart) {\n      props.onCopyPart(selectedPart);\n    }\n    //dispatch(setCopiedPart({ copiedPart: selectedPart }));\n  }, [selectedPart, parts]);\n\n  const handlePartMoveForward = useCallback(async () => {\n    /* console.log('AUTHOR PART MOVE FWD', { selectedPart }); */\n    const partsClone = clone(parts);\n    const part = partsClone.find((p: any) => p.id === selectedPart.id);\n    part.custom.z = part.custom.z + 1;\n    props.onChange(partsClone);\n    // optimistically update local state\n    setParts(partsClone);\n  }, [selectedPart, parts]);\n\n  const handlePartMoveBack = useCallback(async () => {\n    /* console.log('AUTHOR PART MOVE BACK', { selectedPart }); */\n    const partsClone = clone(parts);\n    const part = partsClone.find((p: any) => p.id === selectedPart.id);\n    part.custom.z = part.custom.z - 1;\n    props.onChange(partsClone);\n    // optimistically update local state\n    setParts(partsClone);\n  }, [selectedPart, parts]);\n\n  const handlePartCancelConfigure = useCallback(\n    async ({ id }: { id: string }) => {\n      /* console.log('AUTHOR PART CANCEL CONFIGURE', { id, configurePartId }); */\n      if (!configurePartId || id === configurePartId) {\n        if (props.onCancelConfigurePart) {\n          props.onCancelConfigurePart(configurePartId);\n        }\n        setConfigurePartId('');\n        return true;\n      }\n      console.warn(`Part ${id} asked to cancel configure but ${configurePartId} is the one.`);\n      return false;\n    },\n    [configurePartId],\n  );\n\n  const handlePartSaveConfigure = useCallback(\n    async ({ id, snapshot }: { id: string; snapshot: any }) => {\n      const partsClone = clone(parts);\n      const part = partsClone.find((p: any) => p.id === id);\n      if (part) {\n        part.custom = snapshot;\n\n        // console.log('LE:SAVE CONFIGURE', { id, snapshot, partsClone: clone(partsClone) });\n\n        props.onChange(partsClone);\n        setParts(partsClone);\n      }\n      setConfigurePartId('');\n    },\n    [parts],\n  );\n\n  const handlePortalBgClick = (e: any) => {\n    // console.log('BG CLICK', { e });\n    if (e.target.getAttribute('class') === 'part-config-container') {\n      setConfigurePartId('');\n    }\n  };\n\n  const [partStyles, setPartStyles] = useState<string[]>([]);\n\n  useEffect(() => {\n    const styles = parts.map((part) => {\n      const partId = part.id ? part.id.replace(/:/g, '\\\\:') : 'ERROR_PART_ID';\n      return `#${partId} {\n        display: block;\n        position: absolute;\n        width: ${part.custom.width}px;\n        top: 0px;\n        left: 0px;\n        transform: translate(${part.custom.x || 0}px, ${part.custom.y || 0}px);\n        z-index: ${part.custom.z};\n      }`;\n    });\n    setPartStyles(styles);\n    parts.forEach((part) => {\n      const partId = part.id ? part.id.replace(/:/g, '\\\\:') : 'ERROR_PART_ID';\n      const partElement = document.getElementById(partId);\n      if (partElement) {\n        partElement.setAttribute(\n          'style',\n          `transform: translate(${part.custom.x || 0}px, ${part.custom.y || 0}px);`,\n        );\n      }\n    });\n  }, [parts]);\n\n  useEffect(() => {\n    if (!pusher) {\n      return;\n    }\n    const notificationsHandled = [\n      NotificationType.CONFIGURE,\n      NotificationType.CONFIGURE_CANCEL,\n      NotificationType.CONFIGURE_SAVE,\n    ];\n    const notifications = notificationsHandled.map((notificationType: NotificationType) => {\n      const handler = (payload: any) => {\n        // the layout renderer needs to handle some notifications to update the toolbar\n        // and configuration portal if it's being used\n        /* console.log(`LayoutEditor catching ${notificationType.toString()}`, { payload }); */\n        switch (notificationType) {\n          case NotificationType.CONFIGURE_CANCEL:\n            handlePartCancelConfigure(payload);\n            break;\n          case NotificationType.CONFIGURE_SAVE:\n            // maybe layout editor should *only* do this for both cancel and save\n            // because the part should also catch this event and call the onCancelConfigurePart\n            if (!configurePartId || payload.id === configurePartId) {\n              setConfigurePartId('');\n            }\n            break;\n        }\n      };\n      const unsub = subscribeToNotification(pusher, notificationType, handler);\n      return unsub;\n    });\n    return () => {\n      notifications.forEach((unsub) => {\n        unsub();\n      });\n    };\n  }, [pusher]);\n\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const handlePartInit = async ({ id, responses }: { id: string; responses: any[] }) => {\n    console.log('LE:PartInit', { id, responses });\n    return {\n      snapshot: {},\n      context: {\n        mode: contexts.AUTHOR,\n        host: containerRef.current,\n      },\n    };\n  };\n\n  return parts && parts.length ? (\n    <NotificationContext.Provider value={pusher}>\n      <div ref={containerRef} className=\"activity-content\">\n        <style>\n          {`\n          .activity-content {\n            position: absolute;\n            border: 1px solid #ccc;\n            background-color: ${props.backgroundColor || '#fff'};\n            width: ${props.width || 1000}px;\n            height: ${props.height || 500}px;\n          }\n          .react-draggable {\n            position: absolute;\n            cursor: pointer;\n          }\n          .react-draggable.selected {\n            cursor: move;\n          }\n          .react-draggable:hover::before{\n            content: \"\";\n            width: calc(100% + 10px);\n            height: calc(100% + 10px);\n            position: absolute;\n            top: -5px;\n            left: -5px;\n            border: 1px #ccc solid;\n            z-index: -1;\n          }\n          .react-draggable.selected::before{\n            content: \"\";\n            width: calc(100% + 10px);\n            height: calc(100% + 10px);\n            position: absolute;\n            top: -5px;\n            left: -5px;\n            border: 2px #00ff00 dashed;\n            z-index: -1;\n          }\n          .active-selection-toolbar {\n            position: absolute;\n            z-index: 999;\n            min-width: 160px;\n          }\n          .part-config-container {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0, 0, 0, 0.5);\n            z-index: 9999;\n          }\n          .part-config-container-inner > :first-child {\n            position: absolute;\n            top: 15px;\n            left: 25%;\n            background-color: #fff;\n          }\n          ${partStyles.join('\\n')}\n        `}\n        </style>\n        <div\n          className=\"part-config-container\"\n          style={{ display: configurePartId.trim() ? 'block' : 'none' }}\n          onClick={handlePortalBgClick}\n        >\n          <div id={fallbackPortalId} className=\"part-config-container-inner\"></div>\n        </div>\n        <div\n          id={`active-selection-toolbar-${props.id}`}\n          className=\"active-selection-toolbar\"\n          style={{\n            display: selectedPart && !isDragging ? 'block' : 'none',\n            top: toolbarPosition.y,\n            left: toolbarPosition.x,\n          }}\n        >\n          {selectedPart && selectedPart.capabilities.configure && (\n            <button title=\"Edit\" onClick={() => handleToolbarPartConfigure(selectedPart.id, true)}>\n              <i className=\"las la-edit\"></i>\n            </button>\n          )}\n          {selectedPart && selectedPart.capabilities.copy && (\n            <button title=\"Copy\" onClick={handleCopyComponent}>\n              <i className=\"las la-copy\"></i>\n            </button>\n          )}\n          {/* <button title=\"Configure\" onClick={handlePartConfigure}>\n            <i className=\"las la-cog\"></i>\n          </button> */}\n          {selectedPart && selectedPart.capabilities.move && (\n            <button title=\"Move Forward\" onClick={handlePartMoveForward}>\n              <i className=\"las la-plus\"></i>\n            </button>\n          )}\n          {selectedPart && selectedPart.capabilities.move && (\n            <button title=\"Move Back\" onClick={handlePartMoveBack}>\n              <i className=\"las la-minus\"></i>\n            </button>\n          )}\n          {selectedPart && selectedPart.capabilities.delete && (\n            <button title=\"Delete\" onClick={() => setShowConfirmDelete(true)}>\n              <i className=\"las la-trash\"></i>\n            </button>\n          )}\n          <ConfirmDelete\n            show={showConfirmDelete}\n            elementType=\"Component\"\n            elementName={selectedPart?.id}\n            deleteHandler={DeleteComponentHandler}\n            cancelHandler={() => {\n              setShowConfirmDelete(false);\n            }}\n          />\n        </div>\n        {parts.map((part) => {\n          const partProps = {\n            id: part.id,\n            type: part.type,\n            model: part.custom,\n            state: {},\n            configureMode: part.id === configurePartId,\n            editMode: true,\n            portal: portalId,\n            onInit: handlePartInit,\n            onReady: defaultHandler,\n            onSave: defaultHandler,\n            onSubmit: defaultHandler,\n            onResize: defaultHandler,\n          };\n          const disableDrag =\n            selectedPartId !== part.id ||\n            part.id === configurePartId ||\n            (selectedPart && !selectedPart.capabilities.move);\n          return (\n            <Draggable\n              key={part.id}\n              grid={[5, 5]}\n              defaultPosition={{ x: part.custom.x || 0, y: part.custom.y || 0 }}\n              disabled={disableDrag}\n              onStart={() => {\n                setIsDragging(true);\n              }}\n              onStop={(_, dragData) => {\n                setIsDragging(false);\n                handlePartDrag({ partId: part.id, dragData });\n              }}\n            >\n              <PartComponent\n                {...partProps}\n                className={selectedPartId === part.id ? 'selected' : ''}\n                onClick={(event) => handlePartClick(event, { id: part.id })}\n                onConfigure={({ configure, context }) =>\n                  handlePartConfigure(part.id, configure, context)\n                }\n                onSaveConfigure={handlePartSaveConfigure}\n                onCancelConfigure={handlePartCancelConfigure}\n              />\n            </Draggable>\n          );\n        })}\n      </div>\n    </NotificationContext.Provider>\n  ) : null;\n};\n\nexport default LayoutEditor;\n"]}