# Simple test to verify update mechanism works

# Create a simple project
- project:
    name: "test_project"
    title: "Test Project"
    root:
      children:
        - page: "Page 1"

# Create section from project
- section:
    name: "test_section"
    from: "test_project"
    title: "Test Section"

# Verify initial structure of section
- assert:
    structure:
      to: "test_section"
      root:
        children:
          - page: "Page 1"

# Add a new page to the project
- manipulate:
    to: "test_project"
    ops:
      - add_page:
          title: "Page 2"
          to: "root"

- publish:
    to: "test_project"
    description: "Adding Page 2"

# Verify the project was updated correctly
- assert:
    structure:
      to: "test_project"
      root:
        children:
          - page: "Page 1"
          - page: "Page 2"

# Apply the publication update to the section
- update:
    from: "test_project"
    to: "test_section"

# Verify updated structure in section
- assert:
    structure:
      to: "test_section"
      root:
        children:
          - page: "Page 1"
          - page: "Page 2"