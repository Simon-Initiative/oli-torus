# Scenario: Test move and reorder operations
# This scenario tests the new move and reorder operations

# Create initial project structure
- project:
    name: "test_move_reorder"
    title: "Test Move and Reorder"
    root:
      children:
        - container: "Module A"
          children:
            - page: "Page 1"
            - page: "Page 2"
            - page: "Page 3"
        - container: "Module B"
          children:
            - page: "Page 4"
            - page: "Page 5"

# Test move operation - move Page 2 from Module A to Module B
- manipulate:
    to: "test_move_reorder"
    ops:
      - move:
          from: "Page 2"
          to: "Module B"

- publish:
    to: "test_move_reorder"
    description: "Moving Page 2 to Module B"

# Verify Page 2 is now in Module B
- assert:
    structure:
      to: "test_move_reorder"
      root:
        children:
          - container: "Module A"
            children:
              - page: "Page 1"
              - page: "Page 3"
          - container: "Module B"
            children:
              - page: "Page 4"
              - page: "Page 5"
              - page: "Page 2"

# Test reorder operation - move Page 5 before Page 4
- manipulate:
    to: "test_move_reorder"
    ops:
      - reorder:
          from: "Page 5"
          before: "Page 4"

- publish:
    to: "test_move_reorder"
    description: "Reordering Page 5 before Page 4"

# Verify Page 5 is now before Page 4
- assert:
    structure:
      to: "test_move_reorder"
      root:
        children:
          - container: "Module A"
            children:
              - page: "Page 1"
              - page: "Page 3"
          - container: "Module B"
            children:
              - page: "Page 5"
              - page: "Page 4"
              - page: "Page 2"

# Test reorder with after - move Page 4 after Page 2
- manipulate:
    to: "test_move_reorder"
    ops:
      - reorder:
          from: "Page 4"
          after: "Page 2"

- publish:
    to: "test_move_reorder"
    description: "Reordering Page 4 after Page 2"

# Verify final structure
- assert:
    structure:
      to: "test_move_reorder"
      root:
        children:
          - container: "Module A"
            children:
              - page: "Page 1"
              - page: "Page 3"
          - container: "Module B"
            children:
              - page: "Page 5"
              - page: "Page 2"
              - page: "Page 4"

# Test moving containers
- manipulate:
    to: "test_move_reorder"
    ops:
      - move:
          from: "Module A"
          to: "Module B"

- publish:
    to: "test_move_reorder"
    description: "Moving Module A inside Module B"

# Verify Module A is now inside Module B
- assert:
    structure:
      to: "test_move_reorder"
      root:
        children:
          - container: "Module B"
            children:
              - page: "Page 5"
              - page: "Page 2"
              - page: "Page 4"
              - container: "Module A"
                children:
                  - page: "Page 1"
                  - page: "Page 3"