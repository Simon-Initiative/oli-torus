/*! For license information please see 506.3084d9e1.iframe.bundle.js.LICENSE.txt */
(self.webpackChunkoli=self.webpackChunkoli||[]).push([[506],{"./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/resolve-url-loader/index.js!./node_modules/@storybook/addon-styling/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[3]!./src/components/common/LoadingSpinner.modules.scss":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,'.MbwkPZjSpnVKHBIrnuFz{color:var(--color-gray-600);-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.MbwkPZjSpnVKHBIrnuFz i{margin:"0 5px";animation-duration:1s}.MbwkPZjSpnVKHBIrnuFz.Xeu653JYT9wKe98eqDzN{font-size:.8em}.MbwkPZjSpnVKHBIrnuFz.Yok4PPDCdzrBdK6VZjCA{font-size:1em}.MbwkPZjSpnVKHBIrnuFz.rRHRMDuicqtN3dkQxFQw{font-size:1.2em}.MbwkPZjSpnVKHBIrnuFz.Dks1huOsfmAlP41ebxPH{text-align:left}.MbwkPZjSpnVKHBIrnuFz.Gebi8v7qO61y0UHW3k92{text-align:center}.MbwkPZjSpnVKHBIrnuFz.MMUL_dKioclQ_CQe15Fg{text-align:right}',"",{version:3,sources:["webpack://./src/components/common/LoadingSpinner.modules.scss","webpack://./styles/common/mixins.scss"],names:[],mappings:"AAEA,sBACE,2BAAA,CAAA,0BAAA,CCCA,wBAAA,CACA,qBAAA,CACA,oBAAA,CACA,gBAAA,CDDA,wBACE,cAAA,CACA,qBAAA,CAGF,2CACE,cAAA,CAGF,2CACE,aAAA,CAGF,2CACE,eAAA,CAGF,2CACE,eAAA,CAGF,2CACE,iBAAA,CAGF,2CACE,gBAAA",sourcesContent:["@import 'common/mixins';\n\n.loadingSpinner {\n  color: var(--color-gray-600);\n  @include disable-select;\n\n  & i {\n    margin: '0 5px';\n    animation-duration: 1s;\n  }\n\n  &.lsSmall {\n    font-size: 0.8em;\n  }\n\n  &.lsMedium {\n    font-size: 1em;\n  }\n\n  &.lsLarge {\n    font-size: 1.2em;\n  }\n\n  &.alignLeft {\n    text-align: left;\n  }\n\n  &.alignCenter {\n    text-align: center;\n  }\n\n  &.alignRight {\n    text-align: right;\n  }\n}\n","/** Mixins */\n\n@mixin disable-select {\n  -webkit-touch-callout: none; /* iOS Safari */\n  -webkit-user-select: none; /* Safari */\n  -moz-user-select: none; /* Firefox */\n  -ms-user-select: none; /* Internet Explorer/Edge */\n  user-select: none; /* Non-prefixed version, currently\n                                  supported by Chrome and Opera */\n}\n\n@mixin enable-select {\n  -webkit-touch-callout: text; /* iOS Safari */\n  -webkit-user-select: text; /* Safari */\n  -moz-user-select: text; /* Firefox */\n  -ms-user-select: text; /* Internet Explorer/Edge */\n  user-select: text; /* Non-prefixed version, currently\n                                  supported by Chrome and Opera */\n}\n\n@mixin ellipsis {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n@mixin clearfix {\n  clear: both;\n}\n\n@function toRem($value) {\n  $remValue: calc($value / 16) + rem;\n  @return $remValue;\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={loadingSpinner:"MbwkPZjSpnVKHBIrnuFz",lsSmall:"Xeu653JYT9wKe98eqDzN",lsMedium:"Yok4PPDCdzrBdK6VZjCA",lsLarge:"rRHRMDuicqtN3dkQxFQw",alignLeft:"Dks1huOsfmAlP41ebxPH",alignCenter:"Gebi8v7qO61y0UHW3k92",alignRight:"MMUL_dKioclQ_CQe15Fg"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/resolve-url-loader/index.js!./node_modules/@storybook/addon-styling/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[3]!./src/components/media/manager/ImageIcon.scss":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".image-icon img{max-width:100%;vertical-align:middle}","",{version:3,sources:["webpack://./src/components/media/manager/ImageIcon.scss"],names:[],mappings:"AACE,gBACE,cAAA,CACA,qBAAA",sourcesContent:[".image-icon {\n  img {\n    max-width: 100%;\n    vertical-align: middle;\n  }\n}\n"],sourceRoot:""}]);const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/resolve-url-loader/index.js!./node_modules/@storybook/addon-styling/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[3]!./src/components/media/manager/MediaManager.scss":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".media-manager{display:flex;flex-direction:column;height:500px;z-index:1000;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.media-manager .media-toolbar{display:flex;flex-direction:row;justify-content:space-between;padding-bottom:15px}.media-manager .media-toolbar>*,.media-manager .media-toolbar .media-toolbar-item{margin-right:15px}.media-manager .media-toolbar>*:last-child,.media-manager .media-toolbar .media-toolbar-item:last-child{margin-right:0}.media-manager .media-toolbar>*.sort-control,.media-manager .media-toolbar .media-toolbar-item.sort-control{display:flex;flex-direction:row;align-items:center;z-index:var(--z-50)}.media-manager .media-toolbar>*.sort-control i,.media-manager .media-toolbar .media-toolbar-item.sort-control i{margin:5px}.media-manager .media-toolbar>*.sort-control button,.media-manager .media-toolbar .media-toolbar-item.sort-control button{cursor:pointer}.media-manager .media-toolbar>*.sort-control .sort-btn,.media-manager .media-toolbar .media-toolbar-item.sort-control .sort-btn{cursor:pointer}.media-manager .media-toolbar>*.sort-control .sort-btn.dropdown-toggle,.media-manager .media-toolbar .media-toolbar-item.sort-control .sort-btn.dropdown-toggle{box-shadow:none}.media-manager .media-toolbar>*.sort-control .sort-btn:active,.media-manager .media-toolbar .media-toolbar-item.sort-control .sort-btn:active{background-color:initial;color:var(--color-selection)}.media-manager .media-toolbar .layout-control button{color:var(--color-secondary);border:1px solid var(--color-secondary);border-right:none}.media-manager .media-toolbar .layout-control button:first-child{border-top-right-radius:0px;border-bottom-right-radius:0px}.media-manager .media-toolbar .layout-control button:last-child{border-right:1px solid var(--color-secondary);border-top-left-radius:0px;border-bottom-left-radius:0px}.media-manager .media-toolbar .layout-control button:hover{background-color:var(--color-gray-100)}.media-manager .media-toolbar .layout-control button:active,.media-manager .media-toolbar .layout-control button.selected{background-color:var(--color-secondary);color:var(--color-white);border-color:var(--color-secondary);box-shadow:none}.media-manager .media-library{display:flex;flex-direction:row;height:400px;border:1px solid var(--color-gray-200)}.media-manager .media-library .media-sidebar{display:flex;flex-direction:column;width:150px;height:100%;overflow:auto;border-right:1px solid var(--color-gray-200);list-style:none;padding:0;margin:0}.media-manager .media-library .media-sidebar li{width:100%;padding:10px;text-align:center;color:var(--color-body-color);cursor:pointer}.media-manager .media-library .media-sidebar li.video{cursor:default;color:var(--color-gray-600)}.media-manager .media-library .media-sidebar li.active{color:initial;background-color:var(--color-gray-300)}.media-manager .media-library .media-content{flex:1;display:flex;flex-direction:column;overflow:hidden}.media-manager .media-library .media-content .media-selection-details{display:flex;flex-direction:column;border-top:1px solid var(--color-gray-200);font-size:.9em;color:var(--color-body-color);-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.media-manager .media-library .media-content .media-selection-details .details-title{display:flex;flex-direction:row;justify-content:space-between;margin:5px 10px;font-weight:600;height:29px;line-height:29px;vertical-align:middle;overflow:hidden}.media-manager .media-library .media-content .media-selection-details .details-title i{padding:8px 4px 4px 4px}.media-manager .media-library .media-content .media-selection-details .details-content{flex:1;display:flex;flex-direction:row;margin:0 10px;margin-bottom:5px}.media-manager .media-library .media-content .media-selection-details .details-content>*{margin-right:20px}.media-manager .media-library .media-content .media-selection-details .details-content>*:last-child{margin-right:0}.media-manager .media-library .media-content .media-selection-details .details-content .media-icon{display:inline-block;max-width:120px;height:60px;line-height:60px;vertical-align:middle;text-align:center}.media-manager .media-library .media-content .media-selection-details .details-content .media-icon .image-icon img{max-width:120px;max-height:60px}.media-manager .media-library .media-content .media-selection-details .details-content .details-info{display:flex;flex-direction:column;min-width:250px}.media-manager .media-library .media-content .media-selection-details .details-content .details-page-refs{display:flex;flex-direction:column;max-height:62px;overflow:auto;word-break:break-all}.media-manager .media-library .media-content .media-grid{flex:1;display:flex;flex-direction:column;overflow:auto}.media-manager .media-library .media-content .media-grid .media-item{position:relative;float:left;margin:5px 5px 55px;list-style:none;border:1px solid rgba(255,255,255,0);width:117px;height:60px;border:1px solid rgba(0,0,0,0)}.media-manager .media-library .media-content .media-grid .media-item .selection-check{position:absolute;top:5px;left:5px;display:none}.media-manager .media-library .media-content .media-grid .media-item .media-icon{width:115px;height:58px;text-align:center;overflow:hidden}.media-manager .media-library .media-content .media-grid .media-item .name{position:absolute;top:60px;left:0;margin:0 auto;padding:5px 0;width:117px;max-height:45px;white-space:pre-wrap;word-wrap:break-word;overflow:hidden;text-align:center;vertical-align:top;line-height:20px}.media-manager .media-library .media-content .media-grid .media-item.not-selectable{opacity:.5}.media-manager .media-library .media-content .media-grid .media-item.selectable{cursor:pointer}.media-manager .media-library .media-content .media-grid .media-item.selectable:hover{border:1px solid var(--color-selection)}.media-manager .media-library .media-content .media-grid .media-item.selectable:hover .selection-check{display:block}.media-manager .media-library .media-content .media-grid .media-item.selectable:active,.media-manager .media-library .media-content .media-grid .media-item.selectable.selected{background-color:rgba(var(--selection, 0.3));border:1px solid var(--color-selection)}.media-manager .media-library .media-content .media-grid .media-item.selectable:active .selection-check,.media-manager .media-library .media-content .media-grid .media-item.selectable.selected .selection-check{display:block}.media-manager .media-library .media-content .media-list{flex:1;display:flex;flex-direction:column}.media-manager .media-library .media-content .media-list .list-header{display:flex;flex-direction:row;background-color:var(--color-gray-100)}.media-manager .media-library .media-content .media-list .list-header .sel-col,.media-manager .media-library .media-content .media-list .list-header .name-col,.media-manager .media-library .media-content .media-list .list-header .refs-col,.media-manager .media-library .media-content .media-list .list-header .date-col,.media-manager .media-library .media-content .media-list .list-header .size-col{padding:0}.media-manager .media-library .media-content .media-list .list-body{flex:1;overflow:auto}.media-manager .media-library .media-content .media-list .sel-col{width:32px;overflow:hidden;padding:5px 5px 5px 0;padding-right:5px}.media-manager .media-library .media-content .media-list .name-col{flex:1;overflow:hidden;padding:5px 5px 5px 0;word-break:break-all}.media-manager .media-library .media-content .media-list .name-col .media-icon{display:inline-block;width:32px;text-align:center;margin-right:5px}.media-manager .media-library .media-content .media-list .name-col .media-icon .image-icon{display:inline}.media-manager .media-library .media-content .media-list .name-col .media-icon .image-icon img{max-width:32px;max-height:32px}.media-manager .media-library .media-content .media-list .refs-col{width:110px;overflow:hidden;padding:5px 5px 5px 0;word-break:break-all}.media-manager .media-library .media-content .media-list .date-col{width:130px;overflow:hidden;padding:5px 5px 5px 0}.media-manager .media-library .media-content .media-list .size-col{width:80px;overflow:hidden;padding:5px 5px 5px 0}.media-manager .media-library .media-content .media-list .media-item{display:flex;flex-direction:row;position:relative;border:1px solid rgba(0,0,0,0)}.media-manager .media-library .media-content .media-list .media-item.not-selectable{opacity:.5}.media-manager .media-library .media-content .media-list .media-item:nth-child(odd){background-color:rgba(var(--gray-100, 0.8))}.media-manager .media-library .media-content .media-list .media-item .selection-check{display:none;visibility:hidden;margin:15px 10px;vertical-align:middle;text-align:center;cursor:pointer}.media-manager .media-library .media-content .media-list .media-item .name{flex:1;padding:0 5px;vertical-align:baseline;overflow:visible;white-space:nowrap}.media-manager .media-library .media-content .media-list .media-item.not-selectable{opacity:.5}.media-manager .media-library .media-content .media-list .media-item.selectable{cursor:pointer}.media-manager .media-library .media-content .media-list .media-item.selectable .selection-check{display:block}.media-manager .media-library .media-content .media-list .media-item.selectable:hover{border:1px solid var(--color-selection)}.media-manager .media-library .media-content .media-list .media-item.selectable:hover .selection-check{visibility:visible}.media-manager .media-library .media-content .media-list .media-item.selectable:active,.media-manager .media-library .media-content .media-list .media-item.selectable.selected{background-color:rgba(var(--selection, 0.3));border:1px solid var(--color-selection)}.media-manager .media-library .media-content .media-list .media-item.selectable:active .selection-check,.media-manager .media-library .media-content .media-list .media-item.selectable.selected .selection-check{visibility:visible}.media-manager .media-infobar{display:flex;flex-direction:row;margin-top:5px;color:var(--color-body-color);height:24px}.media-manager .media-loading{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(255,255,255,.5);display:flex;align-items:center;justify-content:center;z-index:1}","",{version:3,sources:["webpack://./src/components/media/manager/MediaManager.scss","webpack://./styles/common/mixins.scss"],names:[],mappings:"AAEA,eACE,YAAA,CACA,qBAAA,CACA,YAAA,CACA,YAAA,CCHA,0BAAA,CACA,wBAAA,CACA,qBAAA,CACA,oBAAA,CACA,gBAAA,CDEA,8BACE,YAAA,CACA,kBAAA,CACA,6BAAA,CACA,mBAAA,CAEA,kFAEE,iBAAA,CAEA,wGACE,cAAA,CAGF,4GACE,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,mBAAA,CAEA,gHACE,UAAA,CAGF,0HACE,cAAA,CAGF,gIACE,cAAA,CACA,gKACE,eAAA,CAGF,8IACE,wBAAA,CACA,4BAAA,CAON,qDACE,4BAAA,CACA,uCAAA,CACA,iBAAA,CAEA,iEACE,2BAAA,CACA,8BAAA,CAGF,gEACE,6CAAA,CACA,0BAAA,CACA,6BAAA,CAGF,2DACE,sCAAA,CAGF,0HAEE,uCAAA,CACA,wBAAA,CACA,mCAAA,CACA,eAAA,CAMR,8BACE,YAAA,CACA,kBAAA,CACA,YAAA,CACA,sCAAA,CAEA,6CACE,YAAA,CACA,qBAAA,CACA,WAAA,CACA,WAAA,CACA,aAAA,CACA,4CAAA,CACA,eAAA,CACA,SAAA,CACA,QAAA,CAEA,gDACE,UAAA,CACA,YAAA,CACA,iBAAA,CACA,6BAAA,CACA,cAAA,CAEA,sDACE,cAAA,CACA,2BAAA,CAGF,uDACE,aAAA,CACA,sCAAA,CAKN,6CACE,MAAA,CACA,YAAA,CACA,qBAAA,CACA,eAAA,CAEA,sEACE,YAAA,CACA,qBAAA,CACA,0CAAA,CACA,cAAA,CACA,6BAAA,CCtHN,0BAAA,CACA,wBAAA,CACA,qBAAA,CACA,oBAAA,CACA,gBAAA,CDqHM,qFACE,YAAA,CACA,kBAAA,CACA,6BAAA,CACA,eAAA,CACA,eAAA,CACA,WAAA,CACA,gBAAA,CACA,qBAAA,CACA,eAAA,CAEA,uFACE,uBAAA,CAIJ,uFACE,MAAA,CACA,YAAA,CACA,kBAAA,CACA,aAAA,CACA,iBAAA,CAEA,yFACE,iBAAA,CAEA,oGACE,cAAA,CAIJ,mGACE,oBAAA,CACA,eAAA,CACA,WAAA,CACA,gBAAA,CACA,qBAAA,CACA,iBAAA,CAGE,mHACE,eAAA,CACA,eAAA,CAKN,qGACE,YAAA,CACA,qBAAA,CACA,eAAA,CAGF,0GACE,YAAA,CACA,qBAAA,CACA,eAAA,CACA,aAAA,CACA,oBAAA,CAKN,yDACE,MAAA,CACA,YAAA,CACA,qBAAA,CACA,aAAA,CAEA,qEACE,iBAAA,CACA,UAAA,CACA,mBAAA,CACA,eAAA,CACA,oCAAA,CACA,WAAA,CACA,WAAA,CACA,8BAAA,CAEA,sFACE,iBAAA,CACA,OAAA,CACA,QAAA,CACA,YAAA,CAGF,iFACE,WAAA,CACA,WAAA,CACA,iBAAA,CACA,eAAA,CAGF,2EACE,iBAAA,CACA,QAAA,CACA,MAAA,CACA,aAAA,CACA,aAAA,CACA,WAAA,CACA,eAAA,CACA,oBAAA,CACA,oBAAA,CACA,eAAA,CACA,iBAAA,CACA,kBAAA,CACA,gBAAA,CAGF,oFACE,UAAA,CAGF,gFACE,cAAA,CAEA,sFACE,uCAAA,CAEA,uGACE,aAAA,CAIJ,gLAEE,4CAAA,CACA,uCAAA,CAEA,kNACE,aAAA,CAOV,yDACE,MAAA,CACA,YAAA,CACA,qBAAA,CAEA,sEACE,YAAA,CACA,kBAAA,CACA,sCAAA,CAEA,+YAKE,SAAA,CAIJ,oEACE,MAAA,CACA,aAAA,CAGF,kEACE,UAAA,CACA,eAAA,CACA,qBAAA,CACA,iBAAA,CAGF,mEACE,MAAA,CACA,eAAA,CACA,qBAAA,CACA,oBAAA,CAEA,+EACE,oBAAA,CACA,UAAA,CACA,iBAAA,CACA,gBAAA,CAEA,2FACE,cAAA,CAEA,+FACE,cAAA,CACA,eAAA,CAMR,mEACE,WAAA,CACA,eAAA,CACA,qBAAA,CACA,oBAAA,CAGF,mEACE,WAAA,CACA,eAAA,CACA,qBAAA,CAGF,mEACE,UAAA,CACA,eAAA,CACA,qBAAA,CAGF,qEACE,YAAA,CACA,kBAAA,CACA,iBAAA,CACA,8BAAA,CAEA,oFACE,UAAA,CAGF,oFACE,2CAAA,CAGF,sFACE,YAAA,CACA,iBAAA,CACA,gBAAA,CACA,qBAAA,CACA,iBAAA,CACA,cAAA,CAGF,2EACE,MAAA,CACA,aAAA,CACA,uBAAA,CACA,gBAAA,CACA,kBAAA,CAGF,oFACE,UAAA,CAGF,gFACE,cAAA,CAEA,iGACE,aAAA,CAGF,sFACE,uCAAA,CAEA,uGACE,kBAAA,CAIJ,gLAEE,4CAAA,CACA,uCAAA,CAEA,kNACE,kBAAA,CASd,8BACE,YAAA,CACA,kBAAA,CACA,cAAA,CACA,6BAAA,CACA,WAAA,CAGF,8BACE,iBAAA,CACA,KAAA,CACA,MAAA,CACA,UAAA,CACA,WAAA,CACA,qCAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,SAAA",sourcesContent:["@import 'common/mixins';\n\n.media-manager {\n  display: flex;\n  flex-direction: column;\n  height: 500px;\n  z-index: 1000;\n  @include disable-select;\n\n  .media-toolbar {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    padding-bottom: 15px;\n\n    & > *,\n    .media-toolbar-item {\n      margin-right: 15px;\n\n      &:last-child {\n        margin-right: 0;\n      }\n\n      &.sort-control {\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n        z-index: var(--z-50);\n\n        i {\n          margin: 5px;\n        }\n\n        button {\n          cursor: pointer;\n        }\n\n        .sort-btn {\n          cursor: pointer;\n          &.dropdown-toggle {\n            box-shadow: none;\n          }\n\n          &:active {\n            background-color: initial;\n            color: var(--color-selection);\n          }\n        }\n      }\n    }\n\n    .layout-control {\n      button {\n        color: var(--color-secondary);\n        border: 1px solid var(--color-secondary);\n        border-right: none;\n\n        &:first-child {\n          border-top-right-radius: 0px;\n          border-bottom-right-radius: 0px;\n        }\n\n        &:last-child {\n          border-right: 1px solid var(--color-secondary);\n          border-top-left-radius: 0px;\n          border-bottom-left-radius: 0px;\n        }\n\n        &:hover {\n          background-color: var(--color-gray-100);\n        }\n\n        &:active,\n        &.selected {\n          background-color: var(--color-secondary);\n          color: var(--color-white);\n          border-color: var(--color-secondary);\n          box-shadow: none;\n        }\n      }\n    }\n  }\n\n  .media-library {\n    display: flex;\n    flex-direction: row;\n    height: 400px;\n    border: 1px solid var(--color-gray-200);\n\n    .media-sidebar {\n      display: flex;\n      flex-direction: column;\n      width: 150px;\n      height: 100%;\n      overflow: auto;\n      border-right: 1px solid var(--color-gray-200);\n      list-style: none;\n      padding: 0;\n      margin: 0;\n\n      li {\n        width: 100%;\n        padding: 10px;\n        text-align: center;\n        color: var(--color-body-color);\n        cursor: pointer;\n\n        &.video {\n          cursor: default;\n          color: var(--color-gray-600);\n        }\n\n        &.active {\n          color: initial;\n          background-color: var(--color-gray-300);\n        }\n      }\n    }\n\n    .media-content {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n      overflow: hidden;\n\n      .media-selection-details {\n        display: flex;\n        flex-direction: column;\n        border-top: 1px solid var(--color-gray-200);\n        font-size: 0.9em;\n        color: var(--color-body-color);\n        @include enable-select;\n\n        .details-title {\n          display: flex;\n          flex-direction: row;\n          justify-content: space-between;\n          margin: 5px 10px;\n          font-weight: 600;\n          height: 29px;\n          line-height: 29px;\n          vertical-align: middle;\n          overflow: hidden;\n\n          i {\n            padding: 8px 4px 4px 4px;\n          }\n        }\n\n        .details-content {\n          flex: 1;\n          display: flex;\n          flex-direction: row;\n          margin: 0 10px;\n          margin-bottom: 5px;\n\n          & > * {\n            margin-right: 20px;\n\n            &:last-child {\n              margin-right: 0;\n            }\n          }\n\n          .media-icon {\n            display: inline-block;\n            max-width: 120px;\n            height: 60px;\n            line-height: 60px;\n            vertical-align: middle;\n            text-align: center;\n\n            .image-icon {\n              img {\n                max-width: 120px;\n                max-height: 60px;\n              }\n            }\n          }\n\n          .details-info {\n            display: flex;\n            flex-direction: column;\n            min-width: 250px;\n          }\n\n          .details-page-refs {\n            display: flex;\n            flex-direction: column;\n            max-height: 62px;\n            overflow: auto;\n            word-break: break-all;\n          }\n        }\n      }\n\n      .media-grid {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n        overflow: auto;\n\n        .media-item {\n          position: relative;\n          float: left;\n          margin: 5px 5px 55px;\n          list-style: none;\n          border: 1px solid rgba(255, 255, 255, 0);\n          width: 117px;\n          height: 60px;\n          border: 1px solid transparent;\n\n          .selection-check {\n            position: absolute;\n            top: 5px;\n            left: 5px;\n            display: none;\n          }\n\n          .media-icon {\n            width: 115px;\n            height: 58px;\n            text-align: center;\n            overflow: hidden;\n          }\n\n          .name {\n            position: absolute;\n            top: 60px;\n            left: 0;\n            margin: 0 auto;\n            padding: 5px 0;\n            width: 117px;\n            max-height: 45px;\n            white-space: pre-wrap;\n            word-wrap: break-word;\n            overflow: hidden;\n            text-align: center;\n            vertical-align: top;\n            line-height: 20px;\n          }\n\n          &.not-selectable {\n            opacity: 0.5;\n          }\n\n          &.selectable {\n            cursor: pointer;\n\n            &:hover {\n              border: 1px solid var(--color-selection);\n\n              .selection-check {\n                display: block;\n              }\n            }\n\n            &:active,\n            &.selected {\n              background-color: rgba(var(--selection, 0.3));\n              border: 1px solid var(--color-selection);\n\n              .selection-check {\n                display: block;\n              }\n            }\n          }\n        }\n      }\n\n      .media-list {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n\n        .list-header {\n          display: flex;\n          flex-direction: row;\n          background-color: var(--color-gray-100);\n\n          .sel-col,\n          .name-col,\n          .refs-col,\n          .date-col,\n          .size-col {\n            padding: 0;\n          }\n        }\n\n        .list-body {\n          flex: 1;\n          overflow: auto;\n        }\n\n        .sel-col {\n          width: 32px;\n          overflow: hidden;\n          padding: 5px 5px 5px 0;\n          padding-right: 5px;\n        }\n\n        .name-col {\n          flex: 1;\n          overflow: hidden;\n          padding: 5px 5px 5px 0;\n          word-break: break-all;\n\n          .media-icon {\n            display: inline-block;\n            width: 32px;\n            text-align: center;\n            margin-right: 5px;\n\n            .image-icon {\n              display: inline;\n\n              img {\n                max-width: 32px;\n                max-height: 32px;\n              }\n            }\n          }\n        }\n\n        .refs-col {\n          width: 110px;\n          overflow: hidden;\n          padding: 5px 5px 5px 0;\n          word-break: break-all;\n        }\n\n        .date-col {\n          width: 130px;\n          overflow: hidden;\n          padding: 5px 5px 5px 0;\n        }\n\n        .size-col {\n          width: 80px;\n          overflow: hidden;\n          padding: 5px 5px 5px 0;\n        }\n\n        .media-item {\n          display: flex;\n          flex-direction: row;\n          position: relative;\n          border: 1px solid transparent;\n\n          &.not-selectable {\n            opacity: 0.5;\n          }\n\n          &:nth-child(odd) {\n            background-color: rgba(var(--gray-100, 0.8));\n          }\n\n          .selection-check {\n            display: none;\n            visibility: hidden;\n            margin: 15px 10px;\n            vertical-align: middle;\n            text-align: center;\n            cursor: pointer;\n          }\n\n          .name {\n            flex: 1;\n            padding: 0 5px;\n            vertical-align: baseline;\n            overflow: visible;\n            white-space: nowrap;\n          }\n\n          &.not-selectable {\n            opacity: 0.5;\n          }\n\n          &.selectable {\n            cursor: pointer;\n\n            .selection-check {\n              display: block;\n            }\n\n            &:hover {\n              border: 1px solid var(--color-selection);\n\n              .selection-check {\n                visibility: visible;\n              }\n            }\n\n            &:active,\n            &.selected {\n              background-color: rgba(var(--selection, 0.3));\n              border: 1px solid var(--color-selection);\n\n              .selection-check {\n                visibility: visible;\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  .media-infobar {\n    display: flex;\n    flex-direction: row;\n    margin-top: 5px;\n    color: var(--color-body-color);\n    height: 24px;\n  }\n\n  .media-loading {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(255, 255, 255, 0.5);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 1;\n  }\n}\n","/** Mixins */\n\n@mixin disable-select {\n  -webkit-touch-callout: none; /* iOS Safari */\n  -webkit-user-select: none; /* Safari */\n  -moz-user-select: none; /* Firefox */\n  -ms-user-select: none; /* Internet Explorer/Edge */\n  user-select: none; /* Non-prefixed version, currently\n                                  supported by Chrome and Opera */\n}\n\n@mixin enable-select {\n  -webkit-touch-callout: text; /* iOS Safari */\n  -webkit-user-select: text; /* Safari */\n  -moz-user-select: text; /* Firefox */\n  -ms-user-select: text; /* Internet Explorer/Edge */\n  user-select: text; /* Non-prefixed version, currently\n                                  supported by Chrome and Opera */\n}\n\n@mixin ellipsis {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n@mixin clearfix {\n  clear: both;\n}\n\n@function toRem($value) {\n  $remValue: calc($value / 16) + rem;\n  @return $remValue;\n}\n"],sourceRoot:""}]);const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/resolve-url-loader/index.js!./node_modules/@storybook/addon-styling/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[3]!./src/components/resource/objectives/ObjectivesSelection.modules.scss":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".DBqOPxrEA32lhftsStC9 .form-control{height:initial}","",{version:3,sources:["webpack://./src/components/resource/objectives/ObjectivesSelection.modules.scss"],names:[],mappings:"AACE,oCACE,cAAA",sourcesContent:[".objectivesSelection {\n  :global(.form-control) {\n    height: initial;\n  }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={objectivesSelection:"DBqOPxrEA32lhftsStC9"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___},"./src/adaptivity/capi.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Mo:()=>getCapiType,io:()=>CapiVariableTypes});var utils_common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/utils/common.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}var CapiVariableTypes=function(CapiVariableTypes){return CapiVariableTypes[CapiVariableTypes.NUMBER=1]="NUMBER",CapiVariableTypes[CapiVariableTypes.STRING=2]="STRING",CapiVariableTypes[CapiVariableTypes.ARRAY=3]="ARRAY",CapiVariableTypes[CapiVariableTypes.BOOLEAN=4]="BOOLEAN",CapiVariableTypes[CapiVariableTypes.ENUM=5]="ENUM",CapiVariableTypes[CapiVariableTypes.MATH_EXPR=6]="MATH_EXPR",CapiVariableTypes[CapiVariableTypes.ARRAY_POINT=7]="ARRAY_POINT",CapiVariableTypes[CapiVariableTypes.UNKNOWN=99]="UNKNOWN",CapiVariableTypes}({}),getCapiType=function getCapiType(value,allowedValues){return allowedValues&&allowedValues.every((function(v){return"string"==typeof v}))?CapiVariableTypes.ENUM:"boolean"==typeof value||"true"===value||"false"===value?CapiVariableTypes.BOOLEAN:"number"==typeof value?CapiVariableTypes.NUMBER:Array.isArray(value)||(0,utils_common__WEBPACK_IMPORTED_MODULE_0__.GI)(value)?"string"==typeof value&&function isSpecialArrayString(value){var isSpecialArryString=!1;if("string"===_typeof(value)&&"["==value[0]&&"]"==value[value.length-1]){var convertedValue=(0,utils_common__WEBPACK_IMPORTED_MODULE_0__.m7)(value);Array.isArray(convertedValue)&&convertedValue.forEach((function(item){if(!isNaN(Number(item))&&"string"==typeof item&&item.includes(".")){var spl=item.split(".");spl.length>1&&spl[0].length>1&&0===Number(spl[0])&&(isSpecialArryString=!0)}}))}return isSpecialArryString}(value)?CapiVariableTypes.STRING:CapiVariableTypes.ARRAY:"string"==typeof value?CapiVariableTypes.STRING:CapiVariableTypes.UNKNOWN}},"./src/adaptivity/janus-scripts/builtin_functions.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{_:()=>janus_std});var janus_std='\n    let abs = fn(value) { return number(Math.evaluate("abs(" + string(value) + ")")); };\n    let cos = fn(value) { return number(Math.evaluate("cos(" + string(value) + ")")); };\n    let acos = fn(value) { return number(Math.evaluate("acos(" + string(value) + ")")); };\n    let sin = fn(value) { return number(Math.evaluate("sin(" + string(value) + ")")); };\n    let asin = fn(value) { return number(Math.evaluate("asin(" + string(value) + ")")); };\n    let atan = fn(value) { return number(Math.evaluate("atan(" + string(value) + ")")); };\n    let tan = fn(value) { return number(Math.evaluate("tan(" + string(value) + ")")); };\n    let atan2 = fn(value) { return number(Math.evaluate("atan2(" + string(value) + ")")); };\n    let ceil = fn(value) { return number(Math.evaluate("ceil(" + string(value) + ")")); };\n    let floor = fn(value) { return number(Math.evaluate("floor(" + string(value) + ")")); };\n    let exp = fn(value) { return number(Math.evaluate("exp(" + string(value) + ")")); };\n    let log = fn(value) { return number(Math.evaluate("log(" + string(value) + ")")); };\n    let min = Math.min;\n    let max = Math.max;\n    let pow = fn(x, y) { return number(Math.evaluate("pow(" + string(x) + ", " + string(y) + ")")); };\n    let sqrt = fn(value) { return number(Math.evaluate("sqrt(" + string(value) + ")")); };\n    let round = fn(value,decimal) { if(decimal==undefined){ let decimal = 0;} return number(Math.evaluate("round(" + string(value) + ","+string(decimal)+")")); };\n    let roundSF = fn(value, precision) { return Math.evaluate("format(" + string(value) + ", {notation: \'exponential\', precision: " + string(precision) + "})"); };\n    let det = fn(matrix) { return number(Math.evaluate("det(" + string(matrix) + ").toString()")); };\n    let inv = fn(matrix) {\n        if (typeof(matrix) == "ARRAY") {\n            return array(Math.evaluate("inv(" + string(matrix) + ")"));\n        }\n        if (typeof(matrix) == "NUMBER") {\n            return number(Math.evaluate("inv(" + string(matrix) + ")"));\n        }\n    };\n    let ele = fn(matrix, position) {\n        if (typeof(matrix) != "ARRAY") {\n            return undefined;\n        }\n        if (typeof(matrix[0]) == "ARRAY") {\n            if (typeof(position) == "NUMBER") {\n                return matrix[0][position - 1];\n            } else {\n                if (len(position) == 1) {\n                    return matrix[0][position[0] - 1];\n                }\n                if (len(position) == 2) {\n                    return matrix[position[0] - 1][position[1] - 1];\n                }\n                if (len(position) > 2) {\n                    return matrix[position[0] - 1][position[1] - 1][position[2] - 1];\n                }\n            }\n        } else {\n            "this means matrix is a vector";\n            if (typeof(position) == "NUMBER") {\n                return matrix[position - 1];\n            } else {\n                return matrix[position[0] - 1];\n            }\n        }\n    };\n    if (session.userId != undefined) {\n        let session.seed = string(session.userId) + string(1234567);\n    } else {\n        let session.seed = string(session.userName) + string(1234567);\n    }\n    let rand = rng(session.seed);\n    let rndm = fn(min, max, step) {\n        if (step == undefined) {\n            let step = 1;\n        }\n        return Math.round((rand() * (max - min) / step)) * step + min;\n    };\n    let fixedrndm = fn(min, max, step) {\n        return rndm(min, max, step);\n    };\n    let fixedrandom = fn(min, max, step) {\n        return rndm(min, max, step);\n    };\n    let lessonattemptrandom = fn(min, max, step) {\n        return rndm(min, max, step);\n    };\n    let lessonattemptrndm = fn(min, max, step) {\n        return lessonattemptrandom(min, max, step);\n    };\n    let eigenvalues = fn(matrix) {\n        return array(Math.evaluate("eigs(" + string(matrix) + ").values"));\n    };\n    let diag = fn(vector) {\n        return array(Math.evaluate("diag(" + string(vector) + ")"));\n    };\n    let getDiag = fn(matrix) {\n        return array(Math.evaluate("diag(" + string(matrix) + ")"));\n    };\n    let trans = fn(matrix) {\n        return array(Math.evaluate("transpose(" + string(matrix) + ")"));\n    };\n'},"./src/adaptivity/scripting.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{NA:()=>getValue,V1:()=>defaultGlobalEnv,db:()=>getAssignStatements,gH:()=>evalScript,y1:()=>checkExpressionsWithWrongBrackets});var janus_script__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/janus-script/build/module/index.js"),utils_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/utils/common.ts"),_capi__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/adaptivity/capi.ts"),_janus_scripts_builtin_functions__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/adaptivity/janus-scripts/builtin_functions.ts");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}var evaluateJsonObject=function evaluateJsonObject(jsonObj){var env=arguments.length>1&&void 0!==arguments[1]?arguments[1]:defaultGlobalEnv;if("string"==typeof jsonObj)return templatizeText(jsonObj,{},env);if(Array.isArray(jsonObj))return jsonObj.map((function(item){return evaluateJsonObject(item,env)}));if("object"===_typeof(jsonObj)&&jsonObj){for(var newObj={},_i=0,_Object$keys=Object.keys(jsonObj);_i<_Object$keys.length;_i++){var key=_Object$keys[_i];newObj[key]=evaluateJsonObject(jsonObj[key],env)}return newObj}return jsonObj},getExpressionStringForValue=function getExpressionStringForValue(v){var env=arguments.length>1&&void 0!==arguments[1]?arguments[1]:defaultGlobalEnv,val=v.value,isValueVar=!1,isEverAppArrayObject=!1;if("string"==typeof val){var canEval=!1;try{var _test$result,test=evalScript(val,env);canEval=void 0!==(null==test?void 0:test.result)&&!test.result.message,null!=test&&test.result&&null!=test&&null!==(_test$result=test.result)&&void 0!==_test$result&&_test$result.length&&v.key&&v.key.startsWith("app.")&&"string"==typeof val&&"["===val[0]&&"]"===val[val.length-1]&&v.type===_capi__WEBPACK_IMPORTED_MODULE_2__.io.ARRAY&&(isEverAppArrayObject=!0)}catch(e){}var looksLikeAFunction=val.includes("(")&&val.includes(")"),looksLikeJSON=function looksLikeJson(str){var startsLikeJson=str.startsWith('{"')||str.startsWith('{ "'),endsLikeJson=str.endsWith("}");return"{}"===str||startsLikeJson&&endsLikeJson}(val),hasCurlies=val.includes("{")&&val.includes("}");if(looksLikeJSON)try{var valObj=evaluateJsonObject(JSON.parse(val),env);val=JSON.stringify(valObj)}catch(e){}var hasBackslash=val.includes("\\");isValueVar=canEval&&!looksLikeJSON&&looksLikeAFunction&&!hasBackslash&&!isEverAppArrayObject||hasCurlies&&!looksLikeJSON&&!hasBackslash&&!isEverAppArrayObject}if(isValueVar){if("["===val[0]&&"{"===val[1]&&(val.includes("},{")||val.includes("}, {"))&&(val=val.replace(/[[\]]+/g,"")),val.includes("},{")||val.includes("}, {")){var _expressions=extractAllExpressionsFromText(val);if("{"===val[0]&&"}"===val[val.length-1]&&1===(null==_expressions?void 0:_expressions.length))try{var modifiedValue=val.substring(1,val.length-1),evaluatedValue=evalScript(modifiedValue,env).result;void 0!==evaluatedValue&&(val=evaluatedValue)}catch(ex){val=JSON.stringify(val.split(",")).replace(/"/g,"")}else val=JSON.stringify(val.split(",")).replace(/"/g,"")}var actuallyAString=!1,expressions=extractAllExpressionsFromText(val),isCSSString=expressions.filter((function(e){return e.includes(";")}));null!=isCSSString&&isCSSString.length&&(actuallyAString=!0);try{var testEnv=new janus_script__WEBPACK_IMPORTED_MODULE_0__.qA(env);evalScript(val,testEnv)}catch(err){actuallyAString=!0}if(!actuallyAString)try{var _testEnv=new janus_script__WEBPACK_IMPORTED_MODULE_0__.qA(env),testResult=evalScript("let foo = ".concat(val,";"),_testEnv);if(null!==(null==testResult?void 0:testResult.result)){if("{"===val[0]&&"}"===val[val.length-1]){var evaluatedValuess=evalScript(expressions[0],env).result;void 0!==evaluatedValuess?(val=evaluatedValuess,actuallyAString=!1):actuallyAString=null==expressions||!expressions.length}}else{var _evaluatedValue=getValue("foo",_testEnv);if(void 0===_evaluatedValue&&"{"===val[0]&&"}"===val[val.length-1])try{void 0!==(_evaluatedValue=evalScript(expressions[0],env).result)?(val=_evaluatedValue,actuallyAString=!1):actuallyAString=!0}catch(ex){}}}catch(e){if("{"===val[0]&&"}"===val[val.length-1]){var evaluatedValues=evalScript(expressions[0],env).result;void 0!==evaluatedValues&&(val=evaluatedValues,actuallyAString=!1)}else{var containsExpression=val.match(/{([^{^}]+)}/g)||[];if(null!=containsExpression&&containsExpression.length)try{var modifiedVal=templatizeText(val,{},env),updatedValue=evalScript(modifiedVal,env).result;void 0!==updatedValue&&(val=updatedValue)}catch(ex){actuallyAString=!0}else actuallyAString=!0}}if(!actuallyAString)return"".concat(val)}return v.type!==_capi__WEBPACK_IMPORTED_MODULE_2__.io.STRING&&v.type!==_capi__WEBPACK_IMPORTED_MODULE_2__.io.ENUM&&v.type!==_capi__WEBPACK_IMPORTED_MODULE_2__.io.MATH_EXPR||("string"!=typeof val&&(val=JSON.stringify(val)),val||(val=""),val='"'.concat(val.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g," "),'"')),v.type!==_capi__WEBPACK_IMPORTED_MODULE_2__.io.ARRAY&&v.type!==_capi__WEBPACK_IMPORTED_MODULE_2__.io.ARRAY_POINT||(val=isEverAppArrayObject?JSON.stringify(val):JSON.stringify((0,utils_common__WEBPACK_IMPORTED_MODULE_1__.m7)(val))),v.type===_capi__WEBPACK_IMPORTED_MODULE_2__.io.NUMBER&&""===(val=parseFloat(val))&&(val="null"),v.type===_capi__WEBPACK_IMPORTED_MODULE_2__.io.BOOLEAN&&(val=(0,utils_common__WEBPACK_IMPORTED_MODULE_1__.gx)(val)),"object"===_typeof(val)&&(val=JSON.stringify(val)),v.type&&v.type!==_capi__WEBPACK_IMPORTED_MODULE_2__.io.UNKNOWN||("object"===_typeof(v.value)&&Array.isArray(v.value)?val=JSON.stringify(v.value):"string"==typeof val&&'"'!==val[0]&&'"'!==val.slice(-1)&&(val='"'.concat(val,'"'))),"".concat(val)},evalScript=function evalScript(script,env){var _jsResult,_jsResult$message,globalEnv=env||new janus_script__WEBPACK_IMPORTED_MODULE_0__.qA,evaluator=new janus_script__WEBPACK_IMPORTED_MODULE_0__.vX,lexer=new janus_script__WEBPACK_IMPORTED_MODULE_0__.hW(script),parser=new janus_script__WEBPACK_IMPORTED_MODULE_0__._b(lexer),program=parser.parseProgram();if(parser.errors.length)throw new Error("Parse Error in script: ".concat(script,"\n").concat(parser.errors.join("\n")));var jsResult=evaluator.eval(program,globalEnv).toJS();return"null"===jsResult&&(jsResult=null),(null===(_jsResult=jsResult)||void 0===_jsResult||null===(_jsResult$message=_jsResult.message)||void 0===_jsResult$message?void 0:_jsResult$message.indexOf("is a bound reference, cannot assign"))>0?(console.warn("Error in script: ".concat(script,"\n").concat(jsResult.message)),{env:globalEnv,result:null}):{env:globalEnv,result:jsResult}},getAssignStatements=function getAssignStatements(state){var env=arguments.length>1&&void 0!==arguments[1]?arguments[1]:defaultGlobalEnv;return Object.keys(state).map((function(key){var val=state[key],writeVal={key,value:val,type:0};return val&&val.constructor&&val.constructor===Object&&(val.key||val.path?writeVal=_objectSpread(_objectSpread({},val),{},{key:val.path?val.path:val.key}):writeVal.value=JSON.stringify(val)),writeVal.type||(writeVal.type=(0,_capi__WEBPACK_IMPORTED_MODULE_2__.Mo)(writeVal.value)),writeVal})).map((function(v){return"let {".concat(v.key.trim(),"} = ").concat(getExpressionStringForValue(v,env),";")}))},getValue=function getValue(identifier,env){var script="{".concat(identifier,"}");return evalScript(script,env).result},extractAllExpressionsFromText=function extractAllExpressionsFromText(text){if(void 0===text)return text;var expressions=[];if(-1!==(null==text?void 0:text.toString().indexOf("{"))&&-1!==(null==text?void 0:text.toString().indexOf("}"))){var expr=function extractExpressionFromText(text){for(var firstCurly=text.indexOf("{"),lastCurly=-1,counter=1,opens=1;counter<text.length&&-1===lastCurly;)"{"===text[firstCurly+counter]?opens++:"}"===text[firstCurly+counter]&&0==--opens&&(lastCurly=firstCurly+counter),counter++;return text.substring(firstCurly+1,lastCurly)}(text),rest=text.substring(text.indexOf(expr)+expr.length+1);expressions.push(expr),expressions.push.apply(expressions,_toConsumableArray(extractAllExpressionsFromText(rest)))}return expressions},templatizeText=function templatizeText(text,locals,env){var _vars,isFromTrapStates=arguments.length>3&&void 0!==arguments[3]&&arguments[3],useFormattedText=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],innerEnv=new janus_script__WEBPACK_IMPORTED_MODULE_0__.qA(env);if("string"!=typeof text||(null==text?void 0:text.indexOf("\\"))>=0&&-1===(null==text?void 0:text.search(/app\.|variables\.|stage\.|session\./)))return text;var vars=extractAllExpressionsFromText(text),isCSSString=(null===(_vars=vars)||void 0===_vars?void 0:_vars.length)!==(vars=Array.isArray(vars)?vars.filter((function(e){return!e.includes(";")})):vars).length;if(!vars||isCSSString)return text;try{var stateAssignScript=function getAssignScript(state){return getAssignStatements(state,arguments.length>1&&void 0!==arguments[1]?arguments[1]:defaultGlobalEnv).join("")}(locals,innerEnv);evalScript(stateAssignScript,innerEnv)}catch(e){console.warn("[templatizeText] error injecting locals into env",{e,locals,innerEnv})}var templatizedText=text,vals=vars.map((function(v){var stateValue=locals[v];if(!stateValue||"object"===_typeof(stateValue)){try{var _result$result,result=evalScript(v,innerEnv);void 0===(null==result?void 0:result.result)||null!=result&&null!==(_result$result=result.result)&&void 0!==_result$result&&_result$result.message||(innerEnv=result.env,stateValue=result.result)}catch(ex){}if(!stateValue)try{-1===v.indexOf(":")&&-1===v.indexOf(".")||(v="{".concat(v,"}"));try{var _result$result2,_result=evalScript(v,innerEnv);innerEnv=_result.env,null!=_result&&null!==(_result$result2=_result.result)&&void 0!==_result$result2&&_result$result2.message||(stateValue=_result.result)}catch(ex){if("{"===v[0]&&"}"===v[v.length-1]){var _result2$result,functionExpression=v.substring(1,v.length-1),_result2=evalScript(functionExpression,innerEnv);void 0===(null==_result2?void 0:_result2.result)||null!=_result2&&null!==(_result2$result=_result2.result)&&void 0!==_result2$result&&_result2$result.message||(stateValue=_result2.result)}}}catch(e){console.warn("error evaluating text",{v,e})}}if(void 0===stateValue){if(isFromTrapStates)return text;if(1===vars.length&&"{".concat(vars[0],"}")===templatizedText){var finalVar=vars[0];-1===finalVar.indexOf(":")&&-1===finalVar.indexOf(".")||(finalVar="{".concat(finalVar,"}"));var evaluatedValue=evalScript(finalVar,env).result;return void 0!==evaluatedValue?evaluatedValue:""}return""}var strValue=stateValue;return useFormattedText?Array.isArray(stateValue)?strValue=stateValue.map((function(v){return'"'.concat(v,'"')})).join(", "):"object"===_typeof(stateValue)&&(strValue=JSON.stringify(stateValue)):"object"!==_typeof(stateValue)||Array.isArray(stateValue)||(strValue=JSON.stringify(stateValue)),strValue}));return vars.forEach((function(v,index){templatizedText=templatizedText.replace("{".concat(v,"}"),"".concat(vals[index]))})),templatizedText},checkExpressionsWithWrongBrackets=function checkExpressionsWithWrongBrackets(value){var originalValue=value,allexpression=extractAllExpressionsFromText(originalValue),lstEvaluatedExpression={};return allexpression.forEach((function(expression){var _result3,actualExpression=expression,result=expression.match(/{([^{^}]+)}/g)||[];if(result=result.filter((function(expression){return-1!==expression.search(/app\.[a-zA-Z0-9_.-]|variables\.[a-zA-Z0-9_.-]|stage\.[a-zA-Z0-9._-]|session\.[a-zA-Z0-9_.-]/)})),null!==(_result3=result)&&void 0!==_result3&&_result3.length){for(var obj={},i=0;i<(null===(_result4=result)||void 0===_result4?void 0:_result4.length);i++){var _result4;obj["obj"+i]=result[i],expression=expression.replace(result[i],"obj"+i)}expression=(expression=expression.replace(/{/g,"(")).replace(/}/g,")");for(var _i2=0;_i2<(null===(_result5=result)||void 0===_result5?void 0:_result5.length);_i2++){var _result5;obj["obj"+_i2]=result[_i2],expression=expression.replace("obj"+_i2,obj["obj"+_i2])}lstEvaluatedExpression[actualExpression]=expression}})),Object.keys(lstEvaluatedExpression).forEach((function(key){originalValue=originalValue.replace(key,lstEvaluatedExpression[key])})),originalValue},defaultGlobalEnv=new janus_script__WEBPACK_IMPORTED_MODULE_0__.qA;evalScript(_janus_scripts_builtin_functions__WEBPACK_IMPORTED_MODULE_3__._,defaultGlobalEnv)},"./src/apps/authoring/components/Accordion/ContextAwareToggle.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-bootstrap/esm/AccordionContext.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-bootstrap/esm/AccordionToggle.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js"),ContextAwareToggle=function ContextAwareToggle(_ref){var eventKey=_ref.eventKey,callback=_ref.callback,className=_ref.className,onClick=_ref.onClick,currentEventKey=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(react_bootstrap__WEBPACK_IMPORTED_MODULE_2__.Z),decoratedOnClick=(0,react_bootstrap__WEBPACK_IMPORTED_MODULE_3__.n)(eventKey,(function(e){e.stopPropagation(),onClick&&onClick(e),callback&&callback(eventKey)})),isCurrentEventKey=currentEventKey===eventKey,toggleButtonRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(null);return react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){var handler=function handler(e){"expand"===e.detail&&isCurrentEventKey||("collapse"!==e.detail||isCurrentEventKey)&&toggleButtonRef.current&&toggleButtonRef.current.click()};return document.addEventListener(eventKey,handler),function(){document.removeEventListener(eventKey,handler)}}),[decoratedOnClick,eventKey,toggleButtonRef.current,isCurrentEventKey]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("button",{type:"button",ref:toggleButtonRef,className:"btn btn-link p-0 mr-1 ".concat(className||""),onClick:decoratedOnClick,children:isCurrentEventKey?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("i",{className:"fa fa-angle-down"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("i",{className:"fa fa-angle-right"})})};ContextAwareToggle.displayName="ContextAwareToggle";const __WEBPACK_DEFAULT_EXPORT__=ContextAwareToggle;try{ContextAwareToggle.displayName="ContextAwareToggle",ContextAwareToggle.__docgenInfo={description:"",displayName:"ContextAwareToggle",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Accordion/ContextAwareToggle.tsx#ContextAwareToggle"]={docgenInfo:ContextAwareToggle.__docgenInfo,name:"ContextAwareToggle",path:"src/apps/authoring/components/Accordion/ContextAwareToggle.tsx#ContextAwareToggle"})}catch(__react_docgen_typescript_loader_error){}},"./src/apps/authoring/components/AdvancedAuthoringModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{F0:()=>ModalContainer,tv:()=>AdvancedAuthoringModal});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-bootstrap/esm/Modal.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/react-dom/index.js"),__webpack_require__("./node_modules/react/jsx-runtime.js"));function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ModalContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext(null),ModalContainer=function ModalContainer(_ref){var children=_ref.children,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),2),modalContainer=_useState2[0],setModalContainer=_useState2[1];return(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(ModalContext)?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(ModalContext.Provider,{value:modalContainer,children}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{id:"advanced-authoring-modals",ref:setModalContainer})]})};ModalContainer.displayName="ModalContainer";var AdvancedAuthoringPopup=function AdvancedAuthoringPopup(_ref2){var children=_ref2.children,container=useContext(ModalContext);return container?createPortal(children,container):(console.warn("Only use AdvancedAuthoringPopup inside a ModalContainer"),null)},AdvancedAuthoringModal=function AdvancedAuthoringModal(props){var container=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(ModalContext);return container?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_3__.Z,_objectSpread(_objectSpread({},props),{},{container,children:props.children})):(props.show&&console.warn("Only use AdvancedAuthoringModal inside a ModalContainer"),null)};AdvancedAuthoringModal.displayName="AdvancedAuthoringModal";try{ModalContainer.displayName="ModalContainer",ModalContainer.__docgenInfo={description:"",displayName:"ModalContainer",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/AdvancedAuthoringModal.tsx#ModalContainer"]={docgenInfo:ModalContainer.__docgenInfo,name:"ModalContainer",path:"src/apps/authoring/components/AdvancedAuthoringModal.tsx#ModalContainer"})}catch(__react_docgen_typescript_loader_error){}try{AdvancedAuthoringPopup.displayName="AdvancedAuthoringPopup",AdvancedAuthoringPopup.__docgenInfo={description:"",displayName:"AdvancedAuthoringPopup",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/AdvancedAuthoringModal.tsx#AdvancedAuthoringPopup"]={docgenInfo:AdvancedAuthoringPopup.__docgenInfo,name:"AdvancedAuthoringPopup",path:"src/apps/authoring/components/AdvancedAuthoringModal.tsx#AdvancedAuthoringPopup"})}catch(__react_docgen_typescript_loader_error){}try{AdvancedAuthoringModal.displayName="AdvancedAuthoringModal",AdvancedAuthoringModal.__docgenInfo={description:"",displayName:"AdvancedAuthoringModal",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/AdvancedAuthoringModal.tsx#AdvancedAuthoringModal"]={docgenInfo:AdvancedAuthoringModal.__docgenInfo,name:"AdvancedAuthoringModal",path:"src/apps/authoring/components/AdvancedAuthoringModal.tsx#AdvancedAuthoringModal"})}catch(__react_docgen_typescript_loader_error){}},"./src/apps/authoring/components/Flowchart/paths/path-factories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ez:()=>createMCQSpecificPath,Iy:()=>createDropdownCommonErrorPath,J8:()=>createIncorrectPath,Oj:()=>createCorrectPath,Q8:()=>createEndOfActivityPath,Vi:()=>createUnknownPathWithDestination,WL:()=>createAlwaysGoToPath,XB:()=>createMCQCommonErrorPath,YK:()=>createInputNumberCommonErrorPath,oK:()=>createExitPath});var _components_parts_janus_mcq_mcq_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/parts/janus-mcq/mcq-util.ts"),_utils_guid__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/utils/guid.ts"),_delivery_store_features_activities_slice__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/delivery/store/features/activities/slice.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var createUnknownPathWithDestination=function createUnknownPathWithDestination(){var destinationScreenId=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"unknown-reason-path",id:(0,_utils_guid__WEBPACK_IMPORTED_MODULE_0__.Z)(),ruleId:null,destinationScreenId,completed:!1,label:"Unknown Rule",priority:20}},createDestinationPathTemplate=function createDestinationPathTemplate(id){return{id,ruleId:null,destinationScreenId:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,completed:!1}},createInputNumberCommonErrorPath=function createInputNumberCommonErrorPath(ni,index){var _feedback$answer,_feedback$answer2,feedback=ni.custom.advancedFeedback[index],label=(null===(_feedback$answer=feedback.answer)||void 0===_feedback$answer?void 0:_feedback$answer.answerType)===_delivery_store_features_activities_slice__WEBPACK_IMPORTED_MODULE_1__.sp.Between?"Answer is ".concat(feedback.answer.correctMin," to ").concat(feedback.answer.correctMax):"Answer is ".concat(null===(_feedback$answer2=feedback.answer)||void 0===_feedback$answer2?void 0:_feedback$answer2.correctAnswer);return _objectSpread(_objectSpread({},createDestinationPathTemplate("input-number-common-error-".concat(index))),{},{type:"numeric-common-error",feedbackIndex:index,componentId:ni.id,label,priority:4})},createDropdownCommonErrorPath=function createDropdownCommonErrorPath(dropdown,selectedOption){var destinationScreenId=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,optionLabel=dropdown.custom.optionLabels[selectedOption]||"Option #".concat(selectedOption+1);return _objectSpread(_objectSpread({},createDestinationPathTemplate("option-common-error-".concat(selectedOption),destinationScreenId)),{},{type:"option-common-error",selectedOption:selectedOption+1,componentId:dropdown.id,label:"Selected option "+optionLabel.substring(0,20),priority:4})},createMCQSpecificPath=function createMCQSpecificPath(mcq,selectedOption){var _mcq$custom,destinationScreenId=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,optionLabel=(0,_components_parts_janus_mcq_mcq_util__WEBPACK_IMPORTED_MODULE_2__.q)(null===(_mcq$custom=mcq.custom)||void 0===_mcq$custom?void 0:_mcq$custom.mcqItems[selectedOption].nodes)||"Option #".concat(selectedOption+1);return _objectSpread(_objectSpread({},createDestinationPathTemplate("mcq-specific-".concat(selectedOption),destinationScreenId)),{},{type:"option-specific",selectedOption:selectedOption+1,componentId:mcq.id,label:"Selected Option: "+optionLabel.substring(0,20),priority:4})},createMCQCommonErrorPath=function createMCQCommonErrorPath(mcq,selectedOption){var _mcq$custom2,destinationScreenId=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,optionLabel=(0,_components_parts_janus_mcq_mcq_util__WEBPACK_IMPORTED_MODULE_2__.q)(null===(_mcq$custom2=mcq.custom)||void 0===_mcq$custom2?void 0:_mcq$custom2.mcqItems[selectedOption].nodes)||"Option #".concat(selectedOption+1);return _objectSpread(_objectSpread({},createDestinationPathTemplate("mcq-common-error-".concat(selectedOption),destinationScreenId)),{},{type:"option-common-error",selectedOption:selectedOption+1,componentId:mcq.id,label:"Incorrect option: "+optionLabel.substring(0,20),priority:4})},createIncorrectPath=function createIncorrectPath(componentId){return _objectSpread(_objectSpread({},createDestinationPathTemplate("incorrect",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)),{},{type:"incorrect",componentId,label:"Any Incorrect",priority:8})},createCorrectPath=function createCorrectPath(componentId){return _objectSpread(_objectSpread({},createDestinationPathTemplate("correct",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)),{},{type:"correct",componentId,label:"Correct",priority:8})},createAlwaysGoToPath=function createAlwaysGoToPath(){var destinationScreenId=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"always-go-to",id:"always-go-to",ruleId:null,destinationScreenId,completed:!!destinationScreenId,label:"Always",priority:12}},createEndOfActivityPath=function createEndOfActivityPath(){return{type:"end-of-activity",id:"end-of-activity",ruleId:null,completed:!1,label:"Go To End Screen",priority:16}},createExitPath=function createExitPath(){return{type:"exit-activity",id:"exit-activity",ruleId:null,completed:!0,label:"Exit Activity",priority:20}}},"./src/apps/authoring/components/Flowchart/paths/path-options.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Kw:()=>getScreenPrimaryQuestion,S1:()=>getAvailablePaths,im:()=>questionTypeLabels,oI:()=>getScreenQuestionType});var _path_factories__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/apps/authoring/components/Flowchart/paths/path-factories.ts"),_path_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/authoring/components/Flowchart/paths/path-utils.ts");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var getAvailablePaths=function getAvailablePaths(screen){var _screen$content,_screen$content2,_screen$content3,_screen$content4,_screen$content5;switch(getScreenQuestionType(screen)){case"multi-line-text":return[(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.WL)()];case"input-text":return createInputTextPathOptions(null===(_screen$content=screen.content)||void 0===_screen$content?void 0:_screen$content.partsLayout.find(_path_utils__WEBPACK_IMPORTED_MODULE_1__.Sc));case"slider":return createSliderPathOptions(null===(_screen$content2=screen.content)||void 0===_screen$content2?void 0:_screen$content2.partsLayout.find(_path_utils__WEBPACK_IMPORTED_MODULE_1__.tm));case"input-number":return createInputNumberPathOptions(null===(_screen$content3=screen.content)||void 0===_screen$content3?void 0:_screen$content3.partsLayout.find(_path_utils__WEBPACK_IMPORTED_MODULE_1__.Ss));case"check-all-that-apply":case"multiple-choice":return createMultipleChoicePathOptions(null===(_screen$content4=screen.content)||void 0===_screen$content4?void 0:_screen$content4.partsLayout.find(_path_utils__WEBPACK_IMPORTED_MODULE_1__.bH));case"dropdown":return createDropdownChoicePathOptions(null===(_screen$content5=screen.content)||void 0===_screen$content5?void 0:_screen$content5.partsLayout.find(_path_utils__WEBPACK_IMPORTED_MODULE_1__.V0));default:return[(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.WL)(),(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.Q8)()]}},createDefaultPathTypes=function createDefaultPathTypes(){return[(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.WL)(),(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.Vi)(),(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.Q8)()]},createDropdownChoicePathOptions=function createDropdownChoicePathOptions(dropdown){return dropdown?[].concat(_toConsumableArray(dropdown.custom.optionLabels.map((function(label,index){return(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.Iy)(dropdown,index)}))),[(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.Oj)(dropdown.id),(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.J8)(dropdown.id)],_toConsumableArray(createDefaultPathTypes())):[]},createInputTextPathOptions=function createInputTextPathOptions(inputText){return inputText?[(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.Oj)(inputText.id),(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.J8)(inputText.id)].concat(_toConsumableArray(createDefaultPathTypes())):[]},createSliderPathOptions=function createSliderPathOptions(slider){var _slider$custom;return slider?[].concat(_toConsumableArray(((null===(_slider$custom=slider.custom)||void 0===_slider$custom?void 0:_slider$custom.advancedFeedback)||[]).map((function(feedback,index){return(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.YK)(slider,index)}))),[(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.Oj)(slider.id),(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.J8)(slider.id)],_toConsumableArray(createDefaultPathTypes())):[]},createInputNumberPathOptions=function createInputNumberPathOptions(inputNumber){var _inputNumber$custom;return inputNumber?[].concat(_toConsumableArray(((null===(_inputNumber$custom=inputNumber.custom)||void 0===_inputNumber$custom?void 0:_inputNumber$custom.advancedFeedback)||[]).map((function(feedback,index){return(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.YK)(inputNumber,index)}))),[(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.Oj)(inputNumber.id),(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.J8)(inputNumber.id)],_toConsumableArray(createDefaultPathTypes())):[]},createMultipleChoicePathOptions=function createMultipleChoicePathOptions(mcq){if(mcq){var _mcq$custom,_mcq$custom2,multipleSelection=!(null===(_mcq$custom=mcq.custom)||void 0===_mcq$custom||!_mcq$custom.multipleSelection),correct=(null===(_mcq$custom2=mcq.custom)||void 0===_mcq$custom2?void 0:_mcq$custom2.correctAnswer)||[];if(mcq.custom.anyCorrectAnswer){var _mcq$custom3,pathOptions=((null===(_mcq$custom3=mcq.custom)||void 0===_mcq$custom3?void 0:_mcq$custom3.mcqItems)||[]).map((function(_,index){return index})).map((function(index){return(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.Ez)(mcq,index)}));return[].concat(_toConsumableArray(pathOptions),[(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.WL)()])}var _mcq$custom4,commonErrorOptions=((null===(_mcq$custom4=mcq.custom)||void 0===_mcq$custom4?void 0:_mcq$custom4.mcqItems)||[]).map((function(_,index){return index})).filter((function(index){return multipleSelection||!correct[index]})).map((function(index){return(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.XB)(mcq,index)}));return[].concat(_toConsumableArray(commonErrorOptions),[(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.Oj)(mcq.id),(0,_path_factories__WEBPACK_IMPORTED_MODULE_0__.J8)(mcq.id)])}return[]},questionMapping={"janus-multi-line-text":"multi-line-text","janus-input-text":"input-text","janus-input-number":"input-number","janus-dropdown":"dropdown","janus-slider":"slider"},availableQuestionTypes=["janus-mcq"].concat(_toConsumableArray(Object.keys(questionMapping))),questionTypeLabels={"multiple-choice":"Multiple Choice","check-all-that-apply":"Check All That Apply","multi-line-text":"Multi-line Text","input-text":"Text Input","input-number":"Number Input",dropdown:"Dropdown",slider:"Slider",none:"No question"},getScreenQuestionType=function getScreenQuestionType(screen){var _screen$content6;if(!screen)return"none";var question=getScreenPrimaryQuestion(screen);if(!question)return"none";if((0,_path_utils__WEBPACK_IMPORTED_MODULE_1__.bH)(question))return question.custom.multipleSelection?"check-all-that-apply":"multiple-choice";var part=null===(_screen$content6=screen.content)||void 0===_screen$content6?void 0:_screen$content6.partsLayout.find((function(part){return questionMapping[part.type]}));return part?questionMapping[part.type]:"none"},getScreenPrimaryQuestion=function getScreenPrimaryQuestion(screen){var _screen$content7,_screen$content7$part;return null===(_screen$content7=screen.content)||void 0===_screen$content7||null===(_screen$content7$part=_screen$content7.partsLayout)||void 0===_screen$content7$part?void 0:_screen$content7$part.find((function(part){return-1!==availableQuestionTypes.indexOf(part.type)}))}},"./src/apps/authoring/components/Flowchart/paths/path-utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{hu:()=>addComponentId,uM:()=>addDestinationId,NA:()=>hasDestinationPath,mU:()=>isAlwaysPath,W3:()=>isComponentPath,fY:()=>isCorrectPath,M6:()=>isDestinationPath,V0:()=>isDropdown,Jo:()=>isEndOfActivityPath,uX:()=>isIncorrectPath,Ss:()=>isInputNumber,Sc:()=>isInputText,bH:()=>isMCQ,W:()=>isNumericCommonErrorPath,oq:()=>isOptionCommonErrorPath,$G:()=>isOptionSpecificPath,tm:()=>isSlider,bU:()=>isUnknownPath,AG:()=>removeDestinationPath,_M:()=>setGoToAlwaysPath,YY:()=>setUnknownPathDestination,Ih:()=>sortByPriority});__webpack_require__("./src/utils/common.ts");var path_factories=__webpack_require__("./src/apps/authoring/components/Flowchart/paths/path-factories.ts"),componentTypes=["numeric-common-error","option-common-error","multiple-choice-correct","multiple-choice-incorrect","multiple-choice-common-error","end-of-activity","dropdown-correct","dropdown-incorrect","dropdown-common-error"];function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var getPathsFromScreen=function getPathsFromScreen(screen){if(!screen.authoring)throw new Error("Can not modify screens without authoring data.");return screen.authoring.flowchart||(screen.authoring.flowchart={paths:[],screenType:"blank_screen",templateApplied:!1}),screen.authoring.flowchart.paths},isComponentPath=function isComponentPath(path){return componentTypes.includes(path.type)},isInputText=function isInputText(screen){return"janus-input-text"===screen.type},isInputNumber=function isInputNumber(screen){return"janus-input-number"===screen.type},isSlider=function isSlider(screen){return"janus-slider"===screen.type},isMCQ=function isMCQ(screen){return"janus-mcq"===screen.type},isDropdown=function isDropdown(screen){return"janus-dropdown"===screen.type},isEndOfActivityPath=function isEndOfActivityPath(path){return"end-of-activity"===path.type},isDestinationPath=function isDestinationPath(path){return"destinationScreenId"in path},isAlwaysPath=function isAlwaysPath(path){return"always-go-to"===path.type},isCorrectPath=function isCorrectPath(path){return"correct"===path.type},isIncorrectPath=function isIncorrectPath(path){return"incorrect"===path.type},isNumericCommonErrorPath=function isNumericCommonErrorPath(path){return"numeric-common-error"===path.type},isOptionCommonErrorPath=function isOptionCommonErrorPath(path){return"option-common-error"===path.type},isOptionSpecificPath=function isOptionSpecificPath(path){return"option-specific"===path.type},isUnknownPath=function isUnknownPath(path){return"unknown-reason-path"===path.type},setUnknownPathDestination=function setUnknownPathDestination(screen,destinationScreenId){var paths=getPathsFromScreen(screen);paths.filter(isDestinationPath).some((function(path){return path.destinationScreenId===destinationScreenId}))||paths.push((0,path_factories.Vi)(destinationScreenId))},hasDestinationPath=function hasDestinationPath(screen){return getPathsFromScreen(screen).some(isDestinationPath)},removeDestinationPath=function removeDestinationPath(screen,destinationScreenId){var paths=getPathsFromScreen(screen);screen.authoring.flowchart.paths=paths.filter((function(p){return!("destinationScreenId"in p)||p.destinationScreenId!==destinationScreenId}))},setGoToAlwaysPath=function setGoToAlwaysPath(screen,destinationScreenId){var paths=getPathsFromScreen(screen),existingPath=paths.find((function(path){return"always-go-to"===path.type}));existingPath?existingPath.destinationScreenId=destinationScreenId:paths.push((0,path_factories.WL)(destinationScreenId)),function removeEndOfActivityPath(screen){var paths=getPathsFromScreen(screen);screen.authoring.flowchart.paths=paths.filter((function(path){return"end-of-activity"!==path.type}))}(screen)},addComponentId=function addComponentId(path,componentId){return componentId&&isComponentPath(path)?_objectSpread(_objectSpread({},path),{},{componentId}):path},addDestinationId=function addDestinationId(path,destinationScreenId){return destinationScreenId&&isDestinationPath(path)?_objectSpread(_objectSpread({},path),{},{destinationScreenId}):path},sortByPriority=function sortByPriority(a,b){return a.priority-b.priority}},"./src/apps/authoring/components/Flowchart/rules/create-generic-rule.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{VJ:()=>DEFAULT_CORRECT_FEEDBACK,Ot:()=>DEFAULT_FILLED_IN_FEEDBACK,rm:()=>DEFAULT_INCORRECT_FEEDBACK,SC:()=>createNeverCondition,Ov:()=>createRuleTemplate,JV:()=>defaultNextScreenRule,Cx:()=>generateAlwaysGoTo,xu:()=>generateRule,SQ:()=>getActivitySlugFromScreenResourceId,wK:()=>getSequenceIdFromDestinationPath,jy:()=>getSequenceIdFromScreenResourceId,pZ:()=>newId});var guid=__webpack_require__("./src/utils/guid.ts"),common=__webpack_require__("./src/utils/common.ts"),template={type:"feedback",params:{id:"",feedback:{custom:{facts:[],rules:[],width:350,height:100,palette:{fillAlpha:0,fillColor:16777215,lineAlpha:0,lineColor:16777215,lineStyle:0,lineThickness:.1},applyBtnFlag:!1,mainBtnLabel:"Next",applyBtnLabel:"Show Solution",lockCanvasSize:!0,panelTitleColor:16777215,panelHeaderColor:10027008},partsLayout:[{id:"",type:"janus-text-flow",custom:{x:4,y:5,z:0,nodes:[{tag:"p",style:{textAlign:"center"},children:[{tag:"span",style:{},children:[{tag:"text",text:"Feedback goes here.",style:{},children:[]}]}]}],width:340,height:91,palette:{borderColor:"rgba(255,255,255,0)",borderStyle:"solid",borderWidth:"0.1px",borderRadius:0,useHtmlProps:!0,backgroundColor:"rgba(255,255,255,0)"},visible:!0,maxScore:1,overrideWidth:!0,customCssClass:"",overrideHeight:!1,requiresManualGrading:!1}}]}}},create_navigation_action=__webpack_require__("./src/apps/authoring/components/Flowchart/rules/create-navigation-action.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var generateRule=function generateRule(label,conditions,destinationId,correct,priority){var _rule$event$params$ac,feedback=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,additionalActions=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],extra=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},rule=createRuleTemplate(label);(rule.correct=correct,rule.priority=priority,rule.event.params.actions=[],destinationId&&rule.event.params.actions.push((0,create_navigation_action.F)(destinationId)),feedback&&rule.event.params.actions.push(function createFeedbackAction(message){var feedback=(0,common.d9)(template);return feedback.id=(0,guid.Z)(),feedback.params.feedback.partsLayout.id=(0,guid.Z)(),feedback.params.feedback.partsLayout[0].custom.nodes[0].children[0].children[0].text=message,feedback}(feedback)),additionalActions)&&(_rule$event$params$ac=rule.event.params.actions).push.apply(_rule$event$params$ac,_toConsumableArray(additionalActions));return rule.conditions={all:conditions},_objectSpread(_objectSpread({},rule),extra)},createRuleTemplate=function createRuleTemplate(label){return{id:"r:".concat((0,guid.Z)(),".").concat(label),name:label,priority:1,event:{type:"r:".concat((0,guid.Z)(),".").concat(label),params:{actions:[]}},correct:!0,default:!1,disabled:!1,conditions:{id:"b:".concat((0,guid.Z)()),all:[]},forceProgress:!1,additionalScore:0}},defaultNextScreenRule=function defaultNextScreenRule(){return{id:"r:".concat((0,guid.Z)(),".default"),name:"default",priority:1,event:{type:"r:".concat((0,guid.Z)(),".default"),params:{actions:[{type:"navigation",params:{target:"next"}}]}},correct:!0,default:!0,disabled:!1,conditions:{id:"b:".concat((0,guid.Z)()),all:[]},forceProgress:!1,additionalScore:0}},generateAlwaysGoTo=function generateAlwaysGoTo(path,sequence){var rule=createRuleTemplate("always"),sequenceEntry=sequence.find((function(s){return s.resourceId===path.destinationScreenId}));return sequenceEntry?(rule.event.params.actions=[(0,create_navigation_action.F)(sequenceEntry.custom.sequenceId)],[rule]):(console.warn("Couldn't find sequence entry for path",path),[])},newId=function newId(condition){return _objectSpread(_objectSpread({},condition),{},{id:(0,guid.Z)()})},getSequenceIdFromDestinationPath=function getSequenceIdFromDestinationPath(path,sequence){var sequenceEntry=sequence.find((function(s){return s.resourceId===path.destinationScreenId}));return null==sequenceEntry?void 0:sequenceEntry.custom.sequenceId},getSequenceIdFromScreenResourceId=function getSequenceIdFromScreenResourceId(id,sequence){if(id){var sequenceEntry=sequence.find((function(s){return s.resourceId===id}));return null==sequenceEntry?void 0:sequenceEntry.custom.sequenceId}},getActivitySlugFromScreenResourceId=function getActivitySlugFromScreenResourceId(id,sequence){if(id){var sequenceEntry=sequence.find((function(s){return s.resourceId===id}));return null==sequenceEntry?void 0:sequenceEntry.activitySlug}},createNeverCondition=function createNeverCondition(){return{fact:"0",operator:"equal",value:"1",type:1,id:(0,guid.Z)()}},DEFAULT_CORRECT_FEEDBACK="That's correct!",DEFAULT_INCORRECT_FEEDBACK="That's incorrect. Please try again.",DEFAULT_FILLED_IN_FEEDBACK="You seem to be having trouble. We have filled in the correct answer for you. Click next to continue."},"./src/apps/authoring/components/Flowchart/rules/create-navigation-action.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{F:()=>createNavigationAction});var createNavigationAction=function createNavigationAction(target){return{type:"navigation",params:{target}}}},"./src/apps/authoring/components/Flowchart/rules/rule-compilation.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ft:()=>compareRules,$0:()=>generateRules});var path_options=__webpack_require__("./src/apps/authoring/components/Flowchart/paths/path-options.ts"),path_utils=__webpack_require__("./src/apps/authoring/components/Flowchart/paths/path-utils.ts"),guid=__webpack_require__("./src/utils/guid.ts"),createCondition=function createCondition(fact,valueExpression,operator){var type=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return{id:"c:".concat((0,guid.Z)()),fact,type,value:valueExpression,operator}},create_generic_rule=__webpack_require__("./src/apps/authoring/components/Flowchart/rules/create-generic-rule.ts"),uniq=__webpack_require__("./node_modules/lodash/uniq.js"),uniq_default=__webpack_require__.n(uniq);function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var generateThreeTryWorkflow=function generateThreeTryWorkflow(correct,incorrect,commonErrors,setCorrectAction,blankCondition,disableAction){var extraOptions=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},rules=[],options=_objectSpread({threeTimesFeedback:create_generic_rule.Ot},extraOptions),disableIfTrue=function disableIfTrue(val){return val?[disableAction]:[]};correct.destinationId&&rules.push(_objectSpread(_objectSpread({},(0,create_generic_rule.xu)("correct",correct.conditions.map(create_generic_rule.pZ),correct.destinationId,!0,10,correct.feedback,[disableAction])),{},{default:!0})),blankCondition&&rules.push((0,create_generic_rule.xu)("blank",[(0,create_generic_rule.pZ)(blankCondition)],null,!1,20,"Please choose an answer.",[resetTries()]));var _step,_iterator=_createForOfIteratorHelper(commonErrors.filter((function(e){return e.destinationId})));try{for(_iterator.s();!(_step=_iterator.n()).done;){var commonError=_step.value;rules.push((0,create_generic_rule.xu)("common-error-".concat(rules.length),commonError.conditions.map(create_generic_rule.pZ),commonError.destinationId||null,!1,30,commonError.feedback,disableIfTrue(!!commonError.destinationId)))}}catch(err){_iterator.e(err)}finally{_iterator.f()}incorrect.destinationId&&rules.push((0,create_generic_rule.xu)("incorrect-3-times",[thirdOrLaterTry()].concat(_toConsumableArray(incorrect.conditions.map(create_generic_rule.pZ))),incorrect.destinationId,!1,40,options.threeTimesFeedback,_toConsumableArray(setCorrectAction)));var _step2,_iterator2=_createForOfIteratorHelper(commonErrors.filter((function(e){return!e.destinationId})));try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _commonError=_step2.value;rules.push((0,create_generic_rule.xu)("common-error-".concat(rules.length),_commonError.conditions.map(create_generic_rule.pZ),_commonError.destinationId||null,!1,50,_commonError.feedback,disableIfTrue(!!_commonError.destinationId)))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}rules.push(_objectSpread(_objectSpread({},(0,create_generic_rule.xu)("default-incorrect",[],null,!1,70,incorrect.feedback)),{},{default:!0}));var conditions=rules.filter((function(r){return!!r})).map((function(r){return[].concat(_toConsumableArray(r.conditions.all||[]),_toConsumableArray(r.conditions.any||[]))})).flat();return{rules,variables:uniq_default()(conditions.map((function(c){return c.fact})))}},thirdOrLaterTry=function thirdOrLaterTry(){return{fact:"session.attemptNumber",operator:"greaterThan",value:"2",type:1,id:(0,guid.Z)()}},resetTries=function resetTries(){return{type:"mutateState",params:{value:"1",target:"session.attemptNumber",operator:"setting to",targetType:1}}},createCATACorrectCondition=function createCATACorrectCondition(question,correctAnswer){return[createCondition("stage.".concat(question.id,".selectedChoices"),correctAnswer,"is",3)]},createCATAIncorrectCondition=function createCATAIncorrectCondition(question,correctAnswer){return[createCondition("stage.".concat(question.id,".selectedChoices"),correctAnswer,"notIs",3)]},createCATACommonErrorCondition=function createCATACommonErrorCondition(path,question){if(Number.isInteger(path.selectedOption)){var _question$custom5,_question$custom6,isCorrect=!(null===(_question$custom5=question.custom)||void 0===_question$custom5||!_question$custom5.correctAnswer||null===(_question$custom6=question.custom)||void 0===_question$custom6||!_question$custom6.correctAnswer[path.selectedOption-1]);return[createCondition("stage.".concat(question.id,".selectedChoices"),String(path.selectedOption),isCorrect?"notContains":"contains",3)]}return console.warn("Couldn't find correct answer for question",question),[(0,create_generic_rule.SC)()]},createDropdownCorrectCondition=function createDropdownCorrectCondition(question){return Number.isInteger(question.custom.correctAnswer)?[createCondition("stage.".concat(question.id,".selectedIndex"),String(question.custom.correctAnswer||1),"equal")]:(console.warn("Couldn't find correct answer for dropdown question",question),[])},createDropdownIncorrectCondition=function createDropdownIncorrectCondition(question){return Number.isInteger(question.custom.correctAnswer)?[createCondition("stage.".concat(question.id,".selectedIndex"),String(question.custom.correctAnswer||1),"notEqual")]:(console.warn("Couldn't find correct answer for dropdown question",question),[(0,create_generic_rule.SC)()])},createDropdownCommonErrorCondition=function createDropdownCommonErrorCondition(path,question){return Number.isInteger(path.selectedOption)?[createCondition("stage.".concat(question.id,".selectedIndex"),String(path.selectedOption),"equal")]:(console.warn("Couldn't find correct answer for dropdown question",question),[(0,create_generic_rule.SC)()])};function create_all_correct_workflow_typeof(obj){return create_all_correct_workflow_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},create_all_correct_workflow_typeof(obj)}function create_all_correct_workflow_toConsumableArray(arr){return function create_all_correct_workflow_arrayWithoutHoles(arr){if(Array.isArray(arr))return create_all_correct_workflow_arrayLikeToArray(arr)}(arr)||function create_all_correct_workflow_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||create_all_correct_workflow_unsupportedIterableToArray(arr)||function create_all_correct_workflow_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function create_all_correct_workflow_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function create_all_correct_workflow_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?create_all_correct_workflow_ownKeys(Object(source),!0).forEach((function(key){create_all_correct_workflow_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):create_all_correct_workflow_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function create_all_correct_workflow_defineProperty(obj,key,value){return(key=function create_all_correct_workflow_toPropertyKey(arg){var key=function create_all_correct_workflow_toPrimitive(input,hint){if("object"!==create_all_correct_workflow_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==create_all_correct_workflow_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===create_all_correct_workflow_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function create_all_correct_workflow_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return create_all_correct_workflow_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?create_all_correct_workflow_arrayLikeToArray(o,minLen):void 0}}function create_all_correct_workflow_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var generateAllCorrectWorkflow=function generateAllCorrectWorkflow(defaultPath,specificPaths,disableAction){var _step,rules=[],_iterator=function create_all_correct_workflow_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=create_all_correct_workflow_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(specificPaths.filter((function(e){return!!e.destinationId})));try{for(_iterator.s();!(_step=_iterator.n()).done;){var path=_step.value;rules.push((0,create_generic_rule.xu)("specific-path-".concat(rules.length),path.conditions.map(create_generic_rule.pZ),path.destinationId||null,!0,30,path.feedback,[disableAction]))}}catch(err){_iterator.e(err)}finally{_iterator.f()}rules.push(create_all_correct_workflow_objectSpread(create_all_correct_workflow_objectSpread({},(0,create_generic_rule.xu)("always-correct",[],defaultPath.destinationId,!0,50,defaultPath.feedback,[disableAction])),{},{default:!0}));var conditions=rules.filter((function(r){return!!r})).map((function(r){return[].concat(create_all_correct_workflow_toConsumableArray(r.conditions.all||[]),create_all_correct_workflow_toConsumableArray(r.conditions.any||[]))})).flat();return{rules,variables:uniq_default()(conditions.map((function(c){return c.fact})))}},createMCQCorrectCondition=function createMCQCorrectCondition(question){var _question$custom4,correctIndex=((null===(_question$custom4=question.custom)||void 0===_question$custom4?void 0:_question$custom4.correctAnswer)||[]).findIndex((function(answer){return!0===answer}));return-1!==correctIndex?[createCondition("stage.".concat(question.id,".selectedChoice"),String(correctIndex+1),"equal")]:(console.warn("Couldn't find correct answer for dropdown question",question),[])},createMCQIncorrectCondition=function createMCQIncorrectCondition(question){var _question$custom5,correctIndex=((null===(_question$custom5=question.custom)||void 0===_question$custom5?void 0:_question$custom5.correctAnswer)||[]).findIndex((function(answer){return!0===answer}));return-1!==correctIndex?[createCondition("stage.".concat(question.id,".selectedChoice"),String(correctIndex+1),"notEqual")]:(console.warn("Couldn't find correct answer for dropdown question",question),[(0,create_generic_rule.SC)()])},createMCQCommonErrorCondition=function createMCQCommonErrorCondition(path,question){return Number.isInteger(path.selectedOption)?[createCondition("stage.".concat(question.id,".selectedChoice"),String(path.selectedOption),"equal")]:(console.warn("Couldn't find incorrect answer for dropdown question",question),[(0,create_generic_rule.SC)()])},create_navigation_action=__webpack_require__("./src/apps/authoring/components/Flowchart/rules/create-navigation-action.ts"),slice=__webpack_require__("./src/apps/delivery/store/features/activities/slice.ts"),createNumericRangeCondition=function createNumericRangeCondition(questionId,answer){var invert=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return answer.range?[createCondition("stage.".concat(questionId,".value"),"[".concat(answer.correctMin,",").concat(answer.correctMax,"]"),invert?"notInRange":"inRange")]:[createCondition("stage.".concat(questionId,".value"),String(answer.correctAnswer),invert?"notEqual":"equal")]},createNumericCorrectCondition=function createNumericCorrectCondition(question){var answer=question.custom.answer;return answer?createNumericRangeCondition(question.id,answer):(console.warn("Couldn't find correct answer for numeric question",question),[])},createNumericIncorrectCondition=function createNumericIncorrectCondition(question){var answer=question.custom.answer;return answer?createNumericRangeCondition(question.id,answer,!0):(console.warn("Couldn't find correct answer for numeric question",question),[])},createNumericCommonErrorCondition=function createNumericCommonErrorCondition(questionId,feedback){if(feedback&&feedback.answer){var answer=feedback.answer;if(answer.answerType===slice.sp.Between)return[createCondition("stage.".concat(questionId,".value"),"[".concat(answer.correctMin,",").concat(answer.correctMax,"]"),"inRange")];return[createCondition("stage.".concat(questionId,".value"),String(answer.correctAnswer),["equal","","greaterThan","greaterThanInclusive","lessThan","lessThanInclusive"][answer.answerType])]}return console.warn("Couldn't find correct answer for dropdown question",questionId),[(0,create_generic_rule.SC)()]},createNumericCondition=function createNumericCondition(questionId,answer){var invert=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return answer.range?[createCondition("stage.".concat(questionId,".value"),"[".concat(answer.correctMin,",").concat(answer.correctMax,"]"),invert?"notInRange":"inRange")]:[createCondition("stage.".concat(questionId,".value"),String(answer.correctAnswer),invert?"notEqual":"equal")]},create_slider_rules_createNumericCorrectCondition=function createNumericCorrectCondition(question){var answer=question.custom.answer;return answer?createNumericCondition(question.id,answer):(console.warn("Couldn't find correct answer for numeric question",question),[])},create_slider_rules_createNumericIncorrectCondition=function createNumericIncorrectCondition(question){var answer=question.custom.answer;return answer?createNumericCondition(question.id,answer,!0):(console.warn("Couldn't find correct answer for numeric question",question),[])},create_slider_rules_createNumericCommonErrorCondition=function createNumericCommonErrorCondition(questionId,feedback){if(feedback&&feedback.answer){var answer=feedback.answer;if(answer.answerType===slice.sp.Between)return[createCondition("stage.".concat(questionId,".value"),"[".concat(answer.correctMin,",").concat(answer.correctMax,"]"),"inRange")];return[createCondition("stage.".concat(questionId,".value"),String(answer.correctAnswer),["equal","","greaterThan","greaterThanInclusive","lessThan","lessThanInclusive"][answer.answerType])]}return console.warn("Couldn't find correct answer for dropdown question",questionId),[(0,create_generic_rule.SC)()]};function create_text_input_rules_toConsumableArray(arr){return function create_text_input_rules_arrayWithoutHoles(arr){if(Array.isArray(arr))return create_text_input_rules_arrayLikeToArray(arr)}(arr)||function create_text_input_rules_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function create_text_input_rules_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return create_text_input_rules_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return create_text_input_rules_arrayLikeToArray(o,minLen)}(arr)||function create_text_input_rules_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function create_text_input_rules_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var createTextInputCorrectCondition=function createTextInputCorrectCondition(question,requiredTerms,forbiddenTerms,minLength){var requriedConditions=requiredTerms.length>0?requiredTerms.map((function(term){return createCondition("stage.".concat(question.id,".text"),term,"contains",2)})):[],forbiddenConditions=forbiddenTerms.length>0?forbiddenTerms.map((function(term){return createCondition("stage.".concat(question.id,".text"),term,"notContains",2)})):[],lengthCondition=createCondition("stage.".concat(question.id,".textLength"),String(minLength),"greaterThanInclusive");return[].concat(create_text_input_rules_toConsumableArray(requriedConditions),create_text_input_rules_toConsumableArray(forbiddenConditions),[lengthCondition])},createTextInputIncorrectCondition=function createTextInputIncorrectCondition(question){return[]};function rule_compilation_typeof(obj){return rule_compilation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},rule_compilation_typeof(obj)}var notNull=function notNull(t){return null!==t},generateRules=function generateRules(screen,sequence,defaultDestination){try{var _generateRules2=_generateRules(screen,sequence,defaultDestination),rules=_generateRules2.rules,variables=_generateRules2.variables;return{rules:rules.filter(notNull),variables:variables.filter(notNull)}}catch(e){return console.error("Error generating rules for screen",screen,e),{rules:[],variables:[]}}},compareConditions=function compareConditions(a,b){if((null==a?void 0:a.length)!==(null==b?void 0:b.length))return!1;if(!a&&!b)return!0;for(var i=0;i<a.length;i++){var aCondition=a[i],bCondition=b[i];if(aCondition.fact!==bCondition.fact||aCondition.operator!==bCondition.operator||aCondition.type!==bCondition.type||aCondition.value!==bCondition.value)return!1}return!0},compareRules=function compareRules(a,b){if(a.length!==b.length)return!1;for(var i=0;i<a.length;i++){var _aRule$conditions,_bRule$conditions,_aRule$conditions2,_bRule$conditions2,aRule=a[i],bRule=b[i];if(aRule.additionalScore!==bRule.additionalScore||aRule.correct!==bRule.correct||aRule.default!==bRule.default||aRule.disabled!==bRule.disabled||aRule.forceProgress!==bRule.forceProgress||aRule.name!==bRule.name||aRule.priority!==bRule.priority)return console.warn("Rule doesn't match based on properties ",aRule,bRule),!1;if(!compareConditions((null==aRule||null===(_aRule$conditions=aRule.conditions)||void 0===_aRule$conditions?void 0:_aRule$conditions.any)||[],(null==bRule||null===(_bRule$conditions=bRule.conditions)||void 0===_bRule$conditions?void 0:_bRule$conditions.any)||[]))return console.warn("Rule doesn't match based on any conditions ",aRule,bRule),!1;if(!compareConditions((null==aRule||null===(_aRule$conditions2=aRule.conditions)||void 0===_aRule$conditions2?void 0:_aRule$conditions2.all)||[],(null==bRule||null===(_bRule$conditions2=bRule.conditions)||void 0===_bRule$conditions2?void 0:_bRule$conditions2.all)||[]))return console.warn("Rule doesn't match based on all conditions ",aRule,bRule),!1;var aActions=aRule.event.params.actions||[],bActions=bRule.event.params.actions||[];if(aActions.length!==bActions.length)return console.warn("Rule doesn't match based on actions length ",aRule,bRule),!1;for(var _loop=function _loop(){var aAction=aActions[j],bAction=bActions[j];if(aAction.type!==bAction.type)return console.warn("Rule doesn't match based on action type ",aRule,bRule),{v:!1};var aParams=aAction.params||{},bParams=bAction.params||{},keysToIgnore=["id","custom","partsLayout","feedback"],aKeys=Object.keys(aParams).filter((function(key){return!keysToIgnore.includes(key)})),bKeys=Object.keys(bParams).filter((function(key){return!keysToIgnore.includes(key)}));if(aKeys.length!==bKeys.length)return console.warn("Rule doesn't match based on action params length ",aRule,bRule),{v:!1};for(var k=0;k<aKeys.length;k++){var key=aKeys[k];if(aParams[key]!=bParams[key])return console.warn("Rule doesn't match based on action param ",key,aRule,bRule),{v:!1}}},j=0;j<aActions.length;j++){var _ret=_loop();if("object"===rule_compilation_typeof(_ret))return _ret.v}}return!0},_generateRules=function _generateRules(screen,sequence,defaultDestination){switch((0,path_options.oI)(screen)){case"check-all-that-apply":return function generateCATAChoiceRules(screen,sequence,defaultDestination){var _screen$authoring,_screen$authoring$flo,_screen$authoring2,_screen$authoring2$fl,_screen$authoring3,_screen$authoring3$fl,_screen$authoring4,_screen$authoring4$fl,_question$custom,_question$custom2,question=(0,path_options.Kw)(screen),alwaysPath=((null===(_screen$authoring=screen.authoring)||void 0===_screen$authoring||null===(_screen$authoring$flo=_screen$authoring.flowchart)||void 0===_screen$authoring$flo?void 0:_screen$authoring$flo.paths)||[]).find(path_utils.mU),correctPath=((null===(_screen$authoring2=screen.authoring)||void 0===_screen$authoring2||null===(_screen$authoring2$fl=_screen$authoring2.flowchart)||void 0===_screen$authoring2$fl?void 0:_screen$authoring2$fl.paths)||[]).find(path_utils.fY),incorrectPath=((null===(_screen$authoring3=screen.authoring)||void 0===_screen$authoring3||null===(_screen$authoring3$fl=_screen$authoring3.flowchart)||void 0===_screen$authoring3$fl?void 0:_screen$authoring3$fl.paths)||[]).find(path_utils.uX),commonErrorPaths=((null===(_screen$authoring4=screen.authoring)||void 0===_screen$authoring4||null===(_screen$authoring4$fl=_screen$authoring4.flowchart)||void 0===_screen$authoring4$fl?void 0:_screen$authoring4$fl.paths)||[]).filter(path_utils.oq),commonErrorFeedback=(null===(_question$custom=question.custom)||void 0===_question$custom?void 0:_question$custom.commonErrorFeedback)||[],correctOptions=((null===(_question$custom2=question.custom)||void 0===_question$custom2?void 0:_question$custom2.correctAnswer)||[]).map((function(answer,index){return answer?index+1:null})).filter((function(answer){return null!==answer})),correctAnswer="[".concat(correctOptions.join(","),"]"),correct={conditions:createCATACorrectCondition(question,correctAnswer),feedback:question.custom.correctFeedback||create_generic_rule.VJ,destinationId:(0,create_generic_rule.jy)((null==correctPath?void 0:correctPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},incorrect={conditions:createCATAIncorrectCondition(question,correctAnswer),feedback:question.custom.incorrectFeedback||create_generic_rule.rm,destinationId:(0,create_generic_rule.jy)((null==incorrectPath?void 0:incorrectPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},commonErrorConditionsFeedback=commonErrorPaths.map((function(path){return{conditions:createCATACommonErrorCondition(path,question),feedback:commonErrorFeedback[path.selectedOption-1]||create_generic_rule.rm,destinationId:(0,create_generic_rule.wK)(path,sequence)}}));commonErrorFeedback.forEach((function(feedback,index){if(feedback&&!commonErrorPaths.find((function(path){return path.selectedOption===index+1}))){var _question$custom3,_question$custom4,isCorrect=!(null===(_question$custom3=question.custom)||void 0===_question$custom3||!_question$custom3.correctAnswer||null===(_question$custom4=question.custom)||void 0===_question$custom4||!_question$custom4.correctAnswer[index]);commonErrorConditionsFeedback.push({conditions:[createCondition("stage.".concat(question.id,".selectedChoices"),String(index+1),isCorrect?"notContains":"contains",3)],feedback})}}));var disableAction={type:"mutateState",params:{value:"false",target:"stage.".concat(question.id,".enabled"),operator:"=",targetType:4}},setCorrect=[{type:"mutateState",params:{value:correctAnswer,target:"stage.".concat(question.id,".selectedChoices"),operator:"=",targetType:3}},disableAction],blankCondition=createCondition("stage.".concat(question.id,".selectedChoices"),"[]","is",3);return generateThreeTryWorkflow(correct,incorrect,commonErrorConditionsFeedback,setCorrect,blankCondition,disableAction)}(screen,sequence,defaultDestination);case"multiple-choice":return function generateMultipleChoiceRules(screen,sequence,defaultDestination){var _screen$authoring,_screen$authoring$flo,_screen$authoring2,_screen$authoring2$fl,_screen$authoring3,_screen$authoring3$fl,_screen$authoring4,_screen$authoring4$fl,_screen$authoring5,_screen$authoring5$fl,_question$custom,_question$custom2,_question$custom3,question=(0,path_options.Kw)(screen),alwaysPath=((null===(_screen$authoring=screen.authoring)||void 0===_screen$authoring||null===(_screen$authoring$flo=_screen$authoring.flowchart)||void 0===_screen$authoring$flo?void 0:_screen$authoring$flo.paths)||[]).find(path_utils.mU),correctPath=((null===(_screen$authoring2=screen.authoring)||void 0===_screen$authoring2||null===(_screen$authoring2$fl=_screen$authoring2.flowchart)||void 0===_screen$authoring2$fl?void 0:_screen$authoring2$fl.paths)||[]).find(path_utils.fY),incorrectPath=((null===(_screen$authoring3=screen.authoring)||void 0===_screen$authoring3||null===(_screen$authoring3$fl=_screen$authoring3.flowchart)||void 0===_screen$authoring3$fl?void 0:_screen$authoring3$fl.paths)||[]).find(path_utils.uX),commonErrorPaths=((null===(_screen$authoring4=screen.authoring)||void 0===_screen$authoring4||null===(_screen$authoring4$fl=_screen$authoring4.flowchart)||void 0===_screen$authoring4$fl?void 0:_screen$authoring4$fl.paths)||[]).filter(path_utils.oq),specificConditionsFeedback=((null===(_screen$authoring5=screen.authoring)||void 0===_screen$authoring5||null===(_screen$authoring5$fl=_screen$authoring5.flowchart)||void 0===_screen$authoring5$fl?void 0:_screen$authoring5$fl.paths)||[]).filter(path_utils.$G),commonErrorFeedback=(null===(_question$custom=question.custom)||void 0===_question$custom?void 0:_question$custom.commonErrorFeedback)||[],isAlwaysCorrect=!(null===(_question$custom2=question.custom)||void 0===_question$custom2||!_question$custom2.anyCorrectAnswer),correct={conditions:createMCQCorrectCondition(question),feedback:question.custom.correctFeedback||create_generic_rule.VJ,destinationId:(0,create_generic_rule.jy)((null==correctPath?void 0:correctPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},incorrect={conditions:createMCQIncorrectCondition(question),feedback:question.custom.incorrectFeedback||create_generic_rule.rm,destinationId:(0,create_generic_rule.jy)((null==incorrectPath?void 0:incorrectPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},commonErrorConditionsFeedback=commonErrorPaths.map((function(path){return{conditions:createMCQCommonErrorCondition(path,question),feedback:commonErrorFeedback[path.selectedOption-1]||create_generic_rule.VJ,destinationId:(0,create_generic_rule.wK)(path,sequence)}})),correctIndex=((null===(_question$custom3=question.custom)||void 0===_question$custom3?void 0:_question$custom3.correctAnswer)||[]).findIndex((function(answer){return!0===answer}));commonErrorFeedback.forEach((function(feedback,index){feedback&&index!==correctIndex&&(commonErrorPaths.find((function(path){return path.selectedOption===index+1}))||commonErrorConditionsFeedback.push({conditions:[createCondition("stage.".concat(question.id,".selectedChoice"),String(index+1),"equal")],feedback}))}));var disableAction={type:"mutateState",params:{value:"false",target:"stage.".concat(question.id,".enabled"),operator:"=",targetType:4}},setCorrect=[{type:"mutateState",params:{value:String(correctIndex+1),target:"stage.".concat(question.id,".selectedChoice"),operator:"=",targetType:1}},disableAction],blankCondition=createCondition("stage.".concat(question.id,".selectedChoice"),"0","equal");return isAlwaysCorrect?generateAllCorrectWorkflow(correct,specificConditionsFeedback.map((function(path){return{conditions:createMCQCommonErrorCondition(path,question),feedback:correct.feedback||create_generic_rule.VJ,destinationId:(0,create_generic_rule.wK)(path,sequence)}})),disableAction):generateThreeTryWorkflow(correct,incorrect,commonErrorConditionsFeedback,setCorrect,blankCondition,disableAction)}(screen,sequence,defaultDestination);case"multi-line-text":return function generateMultilineTextInputRules(screen,sequence,defaultDestination){var _screen$authoring,_screen$authoring$flo,_screen$authoring2,_screen$authoring2$fl,_question$custom,_question$custom2,_question$custom3,_question$custom4,question=(0,path_options.Kw)(screen),alwaysPath=((null===(_screen$authoring=screen.authoring)||void 0===_screen$authoring||null===(_screen$authoring$flo=_screen$authoring.flowchart)||void 0===_screen$authoring$flo?void 0:_screen$authoring$flo.paths)||[]).find(path_utils.mU),destinationPath=((null===(_screen$authoring2=screen.authoring)||void 0===_screen$authoring2||null===(_screen$authoring2$fl=_screen$authoring2.flowchart)||void 0===_screen$authoring2$fl?void 0:_screen$authoring2$fl.paths)||[]).find(path_utils.M6),rules=[],longEnough=createCondition("stage.".concat(question.id,".textLength"),String((null===(_question$custom=question.custom)||void 0===_question$custom?void 0:_question$custom.minimumLength)||0),"greaterThanInclusive"),tooShort=createCondition("stage.".concat(question.id,".textLength"),String((null===(_question$custom2=question.custom)||void 0===_question$custom2?void 0:_question$custom2.minimumLength)||0),"lessThan"),destination=(0,create_generic_rule.jy)((null==alwaysPath?void 0:alwaysPath.destinationScreenId)||(null==destinationPath?void 0:destinationPath.destinationScreenId)||defaultDestination,sequence)||sequence[0].custom.sequenceId,disableAction={type:"mutateState",params:{value:"false",target:"stage.".concat(question.id,".enabled"),operator:"=",targetType:4}};return rules.push((0,create_generic_rule.xu)("correct",[longEnough],destination,!0,50,(null===(_question$custom3=question.custom)||void 0===_question$custom3?void 0:_question$custom3.correctFeedback)||create_generic_rule.VJ,[disableAction],{default:!0})),rules.push((0,create_generic_rule.xu)("too-short",[tooShort],null,!1,75,(null===(_question$custom4=question.custom)||void 0===_question$custom4?void 0:_question$custom4.incorrectFeedback)||"Please type more to finish your answer")),{rules,variables:["stage.".concat(question.id,".textLength")]}}(screen,sequence,defaultDestination);case"input-text":return function generateTextInputRules(screen,sequence,defaultDestination){var _screen$authoring,_screen$authoring$flo,_screen$authoring2,_screen$authoring2$fl,_screen$authoring3,_screen$authoring3$fl,_question$custom,_question$custom$corr,_question$custom2,_question$custom2$cor,_question$custom$corr2,question=(0,path_options.Kw)(screen),alwaysPath=((null===(_screen$authoring=screen.authoring)||void 0===_screen$authoring||null===(_screen$authoring$flo=_screen$authoring.flowchart)||void 0===_screen$authoring$flo?void 0:_screen$authoring$flo.paths)||[]).find(path_utils.mU),correctPath=((null===(_screen$authoring2=screen.authoring)||void 0===_screen$authoring2||null===(_screen$authoring2$fl=_screen$authoring2.flowchart)||void 0===_screen$authoring2$fl?void 0:_screen$authoring2$fl.paths)||[]).find(path_utils.fY),incorrectPath=((null===(_screen$authoring3=screen.authoring)||void 0===_screen$authoring3||null===(_screen$authoring3$fl=_screen$authoring3.flowchart)||void 0===_screen$authoring3$fl?void 0:_screen$authoring3$fl.paths)||[]).find(path_utils.uX),requiredTerms=((null===(_question$custom=question.custom)||void 0===_question$custom||null===(_question$custom$corr=_question$custom.correctAnswer)||void 0===_question$custom$corr?void 0:_question$custom$corr.mustContain)||"").split(",").map((function(t){return t.trim()})).filter((function(t){return t.length>0})),forbiddenTerms=((null===(_question$custom2=question.custom)||void 0===_question$custom2||null===(_question$custom2$cor=_question$custom2.correctAnswer)||void 0===_question$custom2$cor?void 0:_question$custom2$cor.mustNotContain)||"").split(",").map((function(t){return t.trim()})).filter((function(t){return t.length>0})),minLen=(null===(_question$custom$corr2=question.custom.correctAnswer)||void 0===_question$custom$corr2?void 0:_question$custom$corr2.minimumLength)||0,correct={conditions:createTextInputCorrectCondition(question,requiredTerms,forbiddenTerms,minLen),feedback:question.custom.correctFeedback||create_generic_rule.VJ,destinationId:(0,create_generic_rule.jy)((null==correctPath?void 0:correctPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},incorrect={conditions:createTextInputIncorrectCondition(question),feedback:question.custom.incorrectFeedback||create_generic_rule.rm,destinationId:(0,create_generic_rule.jy)((null==incorrectPath?void 0:incorrectPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},disableAction={type:"mutateState",params:{value:"false",target:"stage.".concat(question.id,".enabled"),operator:"=",targetType:4}},setCorrect=[disableAction],blankCondition=createCondition("stage.".concat(question.id,".textLength"),String(minLen),"lessThan"),threeTimesFeedback="You seem to be having trouble. ";return requiredTerms.length>0&&(threeTimesFeedback+="The answer must contain the following: ".concat(requiredTerms.join(", "),". ")),forbiddenTerms.length>0&&(threeTimesFeedback+="The answer must not contain the following: ".concat(forbiddenTerms.join(", "),". ")),generateThreeTryWorkflow(correct,incorrect,[],setCorrect,blankCondition,disableAction,{threeTimesFeedback:threeTimesFeedback+="Click next to continue. "})}(screen,sequence,defaultDestination);case"slider":return function generateSliderRules(screen,sequence,defaultDestination){var _question$custom,_screen$authoring,_screen$authoring$flo,_screen$authoring2,_screen$authoring2$fl,_screen$authoring3,_screen$authoring3$fl,_screen$authoring4,_screen$authoring4$fl,_question$custom$answ,_question$custom$answ2,question=(0,path_options.Kw)(screen),advancedFeedback=(null===(_question$custom=question.custom)||void 0===_question$custom?void 0:_question$custom.advancedFeedback)||[],alwaysPath=((null===(_screen$authoring=screen.authoring)||void 0===_screen$authoring||null===(_screen$authoring$flo=_screen$authoring.flowchart)||void 0===_screen$authoring$flo?void 0:_screen$authoring$flo.paths)||[]).find(path_utils.mU),correctPath=((null===(_screen$authoring2=screen.authoring)||void 0===_screen$authoring2||null===(_screen$authoring2$fl=_screen$authoring2.flowchart)||void 0===_screen$authoring2$fl?void 0:_screen$authoring2$fl.paths)||[]).find(path_utils.fY),incorrectPath=((null===(_screen$authoring3=screen.authoring)||void 0===_screen$authoring3||null===(_screen$authoring3$fl=_screen$authoring3.flowchart)||void 0===_screen$authoring3$fl?void 0:_screen$authoring3$fl.paths)||[]).find(path_utils.uX),commonErrorPaths=((null===(_screen$authoring4=screen.authoring)||void 0===_screen$authoring4||null===(_screen$authoring4$fl=_screen$authoring4.flowchart)||void 0===_screen$authoring4$fl?void 0:_screen$authoring4$fl.paths)||[]).filter(path_utils.W),correct={conditions:create_slider_rules_createNumericCorrectCondition(question),feedback:question.custom.correctFeedback||create_generic_rule.VJ,destinationId:(0,create_generic_rule.jy)((null==correctPath?void 0:correctPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},incorrect={conditions:create_slider_rules_createNumericIncorrectCondition(question),feedback:question.custom.incorrectFeedback||create_generic_rule.rm,destinationId:(0,create_generic_rule.jy)((null==incorrectPath?void 0:incorrectPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},commonErrorConditionsFeedback=commonErrorPaths.map((function(path){return{conditions:create_slider_rules_createNumericCommonErrorCondition(question.id,advancedFeedback[path.feedbackIndex]),feedback:advancedFeedback[path.feedbackIndex].feedback||create_generic_rule.rm,destinationId:(0,create_generic_rule.wK)(path,sequence)}}));advancedFeedback.forEach((function(feedback,index){feedback&&!commonErrorPaths.find((function(path){return path.feedbackIndex===index}))&&feedback.answer&&commonErrorConditionsFeedback.push({conditions:create_slider_rules_createNumericCommonErrorCondition(question.id,feedback),feedback:feedback.feedback})}));var disableAction={type:"mutateState",params:{value:"false",target:"stage.".concat(question.id,".enabled"),operator:"=",targetType:4}},answer=null!==(_question$custom$answ=question.custom.answer)&&void 0!==_question$custom$answ&&_question$custom$answ.range?question.custom.answer.correctMin:null===(_question$custom$answ2=question.custom.answer)||void 0===_question$custom$answ2?void 0:_question$custom$answ2.correctAnswer,setCorrect=[{type:"mutateState",params:{value:String(answer),target:"stage.".concat(question.id,".value"),operator:"=",targetType:1}},disableAction],blankCondition=createCondition("stage.".concat(question.id,".userModified"),"false","equal",4);return generateThreeTryWorkflow(correct,incorrect,commonErrorConditionsFeedback,setCorrect,blankCondition,disableAction)}(screen,sequence,defaultDestination);case"input-number":return function generteNumberInputRules(screen,sequence,defaultDestination){var _question$custom,_screen$authoring,_screen$authoring$flo,_screen$authoring2,_screen$authoring2$fl,_screen$authoring3,_screen$authoring3$fl,_screen$authoring4,_screen$authoring4$fl,_question$custom$answ,_question$custom$answ2,question=(0,path_options.Kw)(screen),advancedFeedback=(null===(_question$custom=question.custom)||void 0===_question$custom?void 0:_question$custom.advancedFeedback)||[],alwaysPath=((null===(_screen$authoring=screen.authoring)||void 0===_screen$authoring||null===(_screen$authoring$flo=_screen$authoring.flowchart)||void 0===_screen$authoring$flo?void 0:_screen$authoring$flo.paths)||[]).find(path_utils.mU),correctPath=((null===(_screen$authoring2=screen.authoring)||void 0===_screen$authoring2||null===(_screen$authoring2$fl=_screen$authoring2.flowchart)||void 0===_screen$authoring2$fl?void 0:_screen$authoring2$fl.paths)||[]).find(path_utils.fY),incorrectPath=((null===(_screen$authoring3=screen.authoring)||void 0===_screen$authoring3||null===(_screen$authoring3$fl=_screen$authoring3.flowchart)||void 0===_screen$authoring3$fl?void 0:_screen$authoring3$fl.paths)||[]).find(path_utils.uX),commonErrorPaths=((null===(_screen$authoring4=screen.authoring)||void 0===_screen$authoring4||null===(_screen$authoring4$fl=_screen$authoring4.flowchart)||void 0===_screen$authoring4$fl?void 0:_screen$authoring4$fl.paths)||[]).filter(path_utils.W),correct={conditions:createNumericCorrectCondition(question),feedback:question.custom.correctFeedback||create_generic_rule.VJ,destinationId:(0,create_generic_rule.jy)((null==correctPath?void 0:correctPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},incorrect={conditions:createNumericIncorrectCondition(question),feedback:question.custom.incorrectFeedback||create_generic_rule.rm,destinationId:(0,create_generic_rule.jy)((null==incorrectPath?void 0:incorrectPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},commonErrorConditionsFeedback=commonErrorPaths.map((function(path){return{conditions:createNumericCommonErrorCondition(question.id,advancedFeedback[path.feedbackIndex]),feedback:advancedFeedback[path.feedbackIndex].feedback||create_generic_rule.rm,destinationId:(0,create_generic_rule.wK)(path,sequence)}}));advancedFeedback.forEach((function(feedback,index){feedback&&!commonErrorPaths.find((function(path){return path.feedbackIndex===index}))&&feedback.answer&&commonErrorConditionsFeedback.push({conditions:createNumericCommonErrorCondition(question.id,feedback),feedback:feedback.feedback})}));var disableAction={type:"mutateState",params:{value:"false",target:"stage.".concat(question.id,".enabled"),operator:"=",targetType:4}},answer=null!==(_question$custom$answ=question.custom.answer)&&void 0!==_question$custom$answ&&_question$custom$answ.range?question.custom.answer.correctMin:null===(_question$custom$answ2=question.custom.answer)||void 0===_question$custom$answ2?void 0:_question$custom$answ2.correctAnswer,setCorrect=[{type:"mutateState",params:{value:String(answer),target:"stage.".concat(question.id,".value"),operator:"=",targetType:1}},disableAction],blankCondition=createCondition("stage.".concat(question.id,".value"),"true","isNaN",1);return generateThreeTryWorkflow(correct,incorrect,commonErrorConditionsFeedback,setCorrect,blankCondition,disableAction)}(screen,sequence,defaultDestination);case"dropdown":return function generateDropdownRules(screen,sequence,defaultDestination){var _screen$authoring,_screen$authoring$flo,_screen$authoring2,_screen$authoring2$fl,_screen$authoring3,_screen$authoring3$fl,_screen$authoring4,_screen$authoring4$fl,question=(0,path_options.Kw)(screen),commonErrorFeedback=question.custom.commonErrorFeedback||[],alwaysPath=((null===(_screen$authoring=screen.authoring)||void 0===_screen$authoring||null===(_screen$authoring$flo=_screen$authoring.flowchart)||void 0===_screen$authoring$flo?void 0:_screen$authoring$flo.paths)||[]).find(path_utils.mU),correctPath=((null===(_screen$authoring2=screen.authoring)||void 0===_screen$authoring2||null===(_screen$authoring2$fl=_screen$authoring2.flowchart)||void 0===_screen$authoring2$fl?void 0:_screen$authoring2$fl.paths)||[]).find(path_utils.fY),incorrectPath=((null===(_screen$authoring3=screen.authoring)||void 0===_screen$authoring3||null===(_screen$authoring3$fl=_screen$authoring3.flowchart)||void 0===_screen$authoring3$fl?void 0:_screen$authoring3$fl.paths)||[]).find(path_utils.uX),commonErrorPaths=((null===(_screen$authoring4=screen.authoring)||void 0===_screen$authoring4||null===(_screen$authoring4$fl=_screen$authoring4.flowchart)||void 0===_screen$authoring4$fl?void 0:_screen$authoring4$fl.paths)||[]).filter(path_utils.oq),correct={conditions:createDropdownCorrectCondition(question),feedback:question.custom.correctFeedback||create_generic_rule.VJ,destinationId:(0,create_generic_rule.jy)((null==correctPath?void 0:correctPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},incorrect={conditions:createDropdownIncorrectCondition(question),feedback:question.custom.incorrectFeedback||create_generic_rule.rm,destinationId:(0,create_generic_rule.jy)((null==incorrectPath?void 0:incorrectPath.destinationScreenId)||(null==alwaysPath?void 0:alwaysPath.destinationScreenId)||defaultDestination,sequence)||"unknown"},commonErrorConditionsFeedback=commonErrorPaths.map((function(path){return{conditions:createDropdownCommonErrorCondition(path,question),feedback:commonErrorFeedback[path.selectedOption-1]||create_generic_rule.rm,destinationId:(0,create_generic_rule.wK)(path,sequence)}}));commonErrorFeedback.forEach((function(feedback,index){feedback&&index+1!==question.custom.correctAnswer&&(commonErrorPaths.find((function(path){return path.selectedOption===index+1}))||commonErrorConditionsFeedback.push({conditions:[createCondition("stage.".concat(question.id,".selectedIndex"),String(index+1),"equal")],feedback}))}));var disableAction={type:"mutateState",params:{value:"false",target:"stage.".concat(question.id,".enabled"),operator:"=",targetType:4}},setCorrect=[{type:"mutateState",params:{value:String(question.custom.correctAnswer||1),target:"stage.".concat(question.id,".selectedIndex"),operator:"=",targetType:1}},disableAction],blankCondition=createCondition("stage.".concat(question.id,".selectedItem"),"","equal",2);return generateThreeTryWorkflow(correct,incorrect,commonErrorConditionsFeedback,setCorrect,blankCondition,disableAction)}(screen,sequence,defaultDestination);default:return createBlankScreenRules(screen,sequence,defaultDestination)}},createBlankScreenRules=function createBlankScreenRules(screen,sequence,defaultDestination){var _screen$authoring,_screen$authoring$flo,_screen$authoring2,_screen$authoring2$fl;if("end_screen"===(null===(_screen$authoring=screen.authoring)||void 0===_screen$authoring||null===(_screen$authoring$flo=_screen$authoring.flowchart)||void 0===_screen$authoring$flo?void 0:_screen$authoring$flo.screenType))return{rules:[(0,create_generic_rule.JV)()],variables:[]};var rules=((null===(_screen$authoring2=screen.authoring)||void 0===_screen$authoring2||null===(_screen$authoring2$fl=_screen$authoring2.flowchart)||void 0===_screen$authoring2$fl?void 0:_screen$authoring2$fl.paths)||[]).filter(path_utils.mU).map((function(path){return(0,create_generic_rule.Cx)(path,sequence)})).flat();if(0===rules.length){var dest=(0,create_generic_rule.jy)(defaultDestination,sequence);if(dest){var rule=(0,create_generic_rule.Ov)("blank-screen-default");rule.event.params.actions=[(0,create_navigation_action.F)(dest)],rules.push(rule)}else rules.push((0,create_generic_rule.JV)())}return{rules,variables:[]}}},"./src/apps/authoring/components/Modal/DeleteConfirmationModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var react_bootstrap__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-bootstrap/esm/Modal.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js"),ConfirmDelete=function ConfirmDelete(props){var show=props.show,elementType=props.elementType,elementName=props.elementName,cancelHandler=props.cancelHandler,deleteHandler=props.deleteHandler,explanation=props.explanation,title=props.title||"Delete ".concat(elementType);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_2__.Z,{show,onHide:cancelHandler,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_2__.Z.Header,{closeButton:!0,className:"px-8 pb-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("h3",{className:"modal-title font-bold",children:title})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_2__.Z.Body,{className:"px-8",children:[elementName&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("label",{children:"Are you sure you want to delete ".concat(elementName," ?")}),explanation&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("p",{children:explanation})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_2__.Z.Footer,{className:"px-8 pb-6 flex-row justify-items-stretch",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("button",{id:"btnDelete",className:"btn btn-danger flex-grow basis-1",onClick:deleteHandler,children:"Delete ".concat(elementType)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("button",{id:"btnCancel",className:"btn btn-primary flex-grow basis-1",onClick:cancelHandler,children:"Cancel"})]})]})};ConfirmDelete.displayName="ConfirmDelete";const __WEBPACK_DEFAULT_EXPORT__=ConfirmDelete;try{DeleteConfirmationModal.displayName="DeleteConfirmationModal",DeleteConfirmationModal.__docgenInfo={description:"",displayName:"DeleteConfirmationModal",props:{show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},elementType:{defaultValue:null,description:"",name:"elementType",required:!1,type:{name:"string"}},elementName:{defaultValue:null,description:"",name:"elementName",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},explanation:{defaultValue:null,description:"",name:"explanation",required:!1,type:{name:"string"}},cancelHandler:{defaultValue:null,description:"",name:"cancelHandler",required:!0,type:{name:"() => void"}},deleteHandler:{defaultValue:null,description:"",name:"deleteHandler",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/DeleteConfirmationModal.tsx#DeleteConfirmationModal"]={docgenInfo:DeleteConfirmationModal.__docgenInfo,name:"DeleteConfirmationModal",path:"src/apps/authoring/components/Modal/DeleteConfirmationModal.tsx#DeleteConfirmationModal"})}catch(__react_docgen_typescript_loader_error){}},"./src/apps/authoring/components/PropertyEditor/PropertyEditor.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>PropertyEditor_PropertyEditor});var react=__webpack_require__("./node_modules/react/index.js"),bootstrap_4_esm=__webpack_require__("./node_modules/@rjsf/bootstrap-4/dist/bootstrap-4.esm.js"),diff=__webpack_require__("./node_modules/deep-object-diff/mjs/diff.js"),lodash=__webpack_require__("./node_modules/lodash/lodash.js"),ColorPickerWidget=__webpack_require__("./src/apps/authoring/components/PropertyEditor/custom/ColorPickerWidget.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CustomCheckbox=function CustomCheckbox(props){var _React$useState2=_slicedToArray(react.useState(props.value),2),checked=_React$useState2[0],setChecked=_React$useState2[1];return(0,react.useEffect)((function(){setChecked(props.value)}),[props.value]),(0,jsx_runtime.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,jsx_runtime.jsx)("span",{className:"form-label",children:props.label}),(0,jsx_runtime.jsx)("input",{type:"checkbox",className:"my-auto",id:props.id,checked:!!checked,onClick:function onClick(){setChecked(!checked),props.onChange(!checked)},onChange:function onChange(e){}})]})};CustomCheckbox.displayName="CustomCheckbox";const custom_CustomCheckbox=CustomCheckbox;try{CustomCheckbox.displayName="CustomCheckbox",CustomCheckbox.__docgenInfo={description:"",displayName:"CustomCheckbox",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: boolean) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/CustomCheckbox.tsx#CustomCheckbox"]={docgenInfo:CustomCheckbox.__docgenInfo,name:"CustomCheckbox",path:"src/apps/authoring/components/PropertyEditor/custom/CustomCheckbox.tsx#CustomCheckbox"})}catch(__react_docgen_typescript_loader_error){}var ScreenDeleteIcon=__webpack_require__("./src/apps/authoring/components/Flowchart/chart-components/ScreenDeleteIcon.tsx");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return DropdownOptionsEditor_arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function DropdownOptionsEditor_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return DropdownOptionsEditor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DropdownOptionsEditor_arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DropdownOptionsEditor_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var DropdownOptionsEditor=function DropdownOptionsEditor(_ref){var id=_ref.id,value=_ref.value,onChange=_ref.onChange,onBlur=_ref.onBlur,editEntry=(0,react.useCallback)((function(index){return function(modified){var newValue=value.map((function(v,i){return i===index?modified:v}));onChange(newValue),setTimeout((function(){return onBlur(id,newValue)}),0)}}),[id,onBlur,onChange,value]),deleteEntry=(0,react.useCallback)((function(index){return function(){var newValue=value.filter((function(v,i){return i!==index}));onChange(newValue),setTimeout((function(){return onBlur(id,newValue)}),0)}}),[id,onBlur,onChange,value]),onAddOption=(0,react.useCallback)((function(){var newValue=[].concat(_toConsumableArray(value),["Option ".concat(value.length+1)]);onChange(newValue),setTimeout((function(){return onBlur(id,newValue)}),0)}),[id,onBlur,onChange,value]);return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"form-label",children:"Options"}),(0,jsx_runtime.jsx)("div",{children:value.map((function(option,index){return(0,jsx_runtime.jsx)(OptionsEditor,{value:option,onChange:editEntry(index),onDelete:deleteEntry(index)},index)}))}),(0,jsx_runtime.jsx)("button",{className:"btn btn-primary",onClick:onAddOption,children:"+ Add Option"})]})};DropdownOptionsEditor.displayName="DropdownOptionsEditor";var OptionsEditor=function OptionsEditor(_ref2){var value=_ref2.value,_onChange=_ref2.onChange,onDelete=_ref2.onDelete;return(0,jsx_runtime.jsxs)("div",{className:"flex mb-1",children:[(0,jsx_runtime.jsx)("div",{className:"flex-1",children:(0,jsx_runtime.jsx)("input",{type:"text",value,onChange:function onChange(e){return _onChange(e.target.value)}})}),(0,jsx_runtime.jsx)("div",{className:"flex-none",children:(0,jsx_runtime.jsx)("button",{className:"btn btn-link p-0",onClick:onDelete,children:(0,jsx_runtime.jsx)(ScreenDeleteIcon.q,{})})})]})};OptionsEditor.displayName="OptionsEditor";try{DropdownOptionsEditor.displayName="DropdownOptionsEditor",DropdownOptionsEditor.__docgenInfo={description:"",displayName:"DropdownOptionsEditor",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string[]) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(id: string, value: string[]) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/DropdownOptionsEditor.tsx#DropdownOptionsEditor"]={docgenInfo:DropdownOptionsEditor.__docgenInfo,name:"DropdownOptionsEditor",path:"src/apps/authoring/components/PropertyEditor/custom/DropdownOptionsEditor.tsx#DropdownOptionsEditor"})}catch(__react_docgen_typescript_loader_error){}var es=__webpack_require__("./node_modules/react-redux/es/index.js"),mcq_util=__webpack_require__("./src/components/parts/janus-mcq/mcq-util.ts"),deck=__webpack_require__("./src/apps/delivery/store/features/groups/selectors/deck.ts"),slice=__webpack_require__("./src/apps/authoring/store/parts/slice.ts");function MCQCorrectAnswerEditor_toConsumableArray(arr){return function MCQCorrectAnswerEditor_arrayWithoutHoles(arr){if(Array.isArray(arr))return MCQCorrectAnswerEditor_arrayLikeToArray(arr)}(arr)||function MCQCorrectAnswerEditor_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function MCQCorrectAnswerEditor_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MCQCorrectAnswerEditor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MCQCorrectAnswerEditor_arrayLikeToArray(o,minLen)}(arr)||function MCQCorrectAnswerEditor_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MCQCorrectAnswerEditor_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var MCQCorrectAnswerEditor=function MCQCorrectAnswerEditor(_ref){var _part$custom,_part$custom2,value=_ref.value,onChange=_ref.onChange,id=_ref.id,onBlur=_ref.onBlur,currentPartSelection=(0,es.v9)(slice.e5),part=function getPartDef(currentActivityTree,currentPartSelection){try{for(var partDef,i=0;i<currentActivityTree.length;i++){var _activity$content;if(partDef=null===(_activity$content=currentActivityTree[i].content)||void 0===_activity$content?void 0:_activity$content.partsLayout.find((function(part){return part.id===currentPartSelection})))break}return partDef}catch(e){return console.log(e),null}}((0,es.v9)(deck.kv),currentPartSelection),multiSelect=!(null==part||null===(_part$custom=part.custom)||void 0===_part$custom||!_part$custom.multipleSelection),anyCorrectAnswer=!(null==part||null===(_part$custom2=part.custom)||void 0===_part$custom2||!_part$custom2.anyCorrectAnswer),options=(0,react.useMemo)((function(){var _part$custom3;return(null==part||null===(_part$custom3=part.custom)||void 0===_part$custom3?void 0:_part$custom3.mcqItems.map((function(v){return(0,mcq_util.q)(v.nodes)})))||["Option 1","Option 2"]}),[part]),onSelect=(0,react.useCallback)((function(e){var newVal=parseInt(e.currentTarget.value,10),correct=options.map((function(_,i){return i===newVal}));onChange(correct),setTimeout((function(){return onBlur(id,correct)}),0)}),[id,onBlur,onChange,options]);if(anyCorrectAnswer)return null;if(multiSelect)return(0,jsx_runtime.jsx)(MCQCorrectMultiselectAnswerEditor,{value,onChange,id,onBlur,options});var correctIndex=value.findIndex((function(v){return v}));return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"form-label",children:"Correct Answer"}),(0,jsx_runtime.jsx)("select",{className:"form-control",value:correctIndex,onChange:onSelect,children:options.map((function(option,index){return(0,jsx_runtime.jsx)("option",{value:index,children:option},index)}))})]})};MCQCorrectAnswerEditor.displayName="MCQCorrectAnswerEditor";var MCQCorrectMultiselectAnswerEditor=function MCQCorrectMultiselectAnswerEditor(_ref2){var value=_ref2.value,options=_ref2.options,onChange=_ref2.onChange,id=_ref2.id,onBlur=_ref2.onBlur,toggleOption=(0,react.useCallback)((function(i){return function(){var newValue=MCQCorrectAnswerEditor_toConsumableArray(value);newValue[i]=!newValue[i],onChange(newValue),setTimeout((function(){return onBlur(id,newValue)}),0)}}),[id,onBlur,onChange,value]);return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"form-label",children:"Correct Answer"}),options.map((function(option,index){return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("input",{type:"checkbox",checked:value[index],onChange:toggleOption(index)}),(0,jsx_runtime.jsxs)("label",{children:[" ",option]})]},index)}))]})};MCQCorrectMultiselectAnswerEditor.displayName="MCQCorrectMultiselectAnswerEditor";try{MCQCorrectAnswerEditor.displayName="MCQCorrectAnswerEditor",MCQCorrectAnswerEditor.__docgenInfo={description:"",displayName:"MCQCorrectAnswerEditor",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"boolean[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: boolean[]) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(id: string, value: boolean[]) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/MCQCorrectAnswerEditor.tsx#MCQCorrectAnswerEditor"]={docgenInfo:MCQCorrectAnswerEditor.__docgenInfo,name:"MCQCorrectAnswerEditor",path:"src/apps/authoring/components/PropertyEditor/custom/MCQCorrectAnswerEditor.tsx#MCQCorrectAnswerEditor"})}catch(__react_docgen_typescript_loader_error){}function MCQCustomErrorFeedbackAuthoring_toConsumableArray(arr){return function MCQCustomErrorFeedbackAuthoring_arrayWithoutHoles(arr){if(Array.isArray(arr))return MCQCustomErrorFeedbackAuthoring_arrayLikeToArray(arr)}(arr)||function MCQCustomErrorFeedbackAuthoring_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function MCQCustomErrorFeedbackAuthoring_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MCQCustomErrorFeedbackAuthoring_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MCQCustomErrorFeedbackAuthoring_arrayLikeToArray(o,minLen)}(arr)||function MCQCustomErrorFeedbackAuthoring_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MCQCustomErrorFeedbackAuthoring_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var MCQCustomErrorFeedbackAuthoring=function MCQCustomErrorFeedbackAuthoring(_ref){var _part$custom,_part$custom3,_part$custom4,onChange=_ref.onChange,value=_ref.value,label=_ref.label,_onBlur=_ref.onBlur,id=_ref.id,currentPartSelection=(0,es.v9)(slice.e5),part=function getPartDef(currentActivityTree,currentPartSelection){try{for(var partDef,i=0;i<currentActivityTree.length;i++){var _activity$content;if(partDef=null===(_activity$content=currentActivityTree[i].content)||void 0===_activity$content?void 0:_activity$content.partsLayout.find((function(part){return part.id===currentPartSelection})))break}return partDef}catch(e){return console.log(e),null}}((0,es.v9)(deck.kv),currentPartSelection),multiSelect=!(null==part||null===(_part$custom=part.custom)||void 0===_part$custom||!_part$custom.multipleSelection),options=(0,react.useMemo)((function(){var _part$custom2,_part$custom2$mcqItem;return(null==part||null===(_part$custom2=part.custom)||void 0===_part$custom2||null===(_part$custom2$mcqItem=_part$custom2.mcqItems)||void 0===_part$custom2$mcqItem?void 0:_part$custom2$mcqItem.map((function(v){return(0,mcq_util.q)(v.nodes)})))||["Option 1","Option 2"]}),[part]),anyCorrectAnswer=!(null==part||null===(_part$custom3=part.custom)||void 0===_part$custom3||!_part$custom3.anyCorrectAnswer),correctIndex=((null==part||null===(_part$custom4=part.custom)||void 0===_part$custom4?void 0:_part$custom4.correctAnswer)||[]).indexOf(!0)||0,OnOptionChanged=(0,react.useCallback)((function(index){return function(newOptionValue){for(var newFeedback=MCQCustomErrorFeedbackAuthoring_toConsumableArray(value);newFeedback.length<=index;)newFeedback.push("");newFeedback[index]=newOptionValue,newFeedback.length>options.length&&newFeedback.splice(options.length),onChange(newFeedback)}}),[onChange,options.length,value]);return anyCorrectAnswer?null:(0,jsx_runtime.jsxs)("div",{className:"d-flex justify-content-between flex-column",children:[(0,jsx_runtime.jsx)("div",{className:"form-label",children:label}),options.map((function(option,index){return function showOption(index){return multiSelect||index!==correctIndex}(index)?(0,jsx_runtime.jsx)(OptionFeedback,{onBlur:function onBlur(){return _onBlur(id,value)},index,option,feedback:value[index]||"",onChange:OnOptionChanged(index)},index):null}))]})};MCQCustomErrorFeedbackAuthoring.displayName="MCQCustomErrorFeedbackAuthoring";var OptionFeedback=function OptionFeedback(_ref2){var option=_ref2.option,index=_ref2.index,onBlur=_ref2.onBlur,feedback=_ref2.feedback,_onChange=_ref2.onChange,labelOption=option||"Option ".concat(index+1);return(0,jsx_runtime.jsxs)("div",{className:"form-group",children:[(0,jsx_runtime.jsx)("label",{children:labelOption}),(0,jsx_runtime.jsx)("input",{onBlur,className:"form-control",value:feedback,onChange:function onChange(e){return _onChange(e.target.value)}})]})};OptionFeedback.displayName="OptionFeedback";try{MCQCustomErrorFeedbackAuthoring.displayName="MCQCustomErrorFeedbackAuthoring",MCQCustomErrorFeedbackAuthoring.__docgenInfo={description:"",displayName:"MCQCustomErrorFeedbackAuthoring",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string[]) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(id: string, value: string[]) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/MCQCustomErrorFeedbackAuthoring.tsx#MCQCustomErrorFeedbackAuthoring"]={docgenInfo:MCQCustomErrorFeedbackAuthoring.__docgenInfo,name:"MCQCustomErrorFeedbackAuthoring",path:"src/apps/authoring/components/PropertyEditor/custom/MCQCustomErrorFeedbackAuthoring.tsx#MCQCustomErrorFeedbackAuthoring"})}catch(__react_docgen_typescript_loader_error){}var Modal=__webpack_require__("./node_modules/react-bootstrap/esm/Modal.js"),useToggle=__webpack_require__("./src/components/hooks/useToggle.ts"),lib=__webpack_require__("./node_modules/react-quill/lib/index.js"),lib_default=__webpack_require__.n(lib),Delta=__webpack_require__("./node_modules/quill-delta/dist/Delta.js"),Delta_default=__webpack_require__.n(Delta),_excluded=(__webpack_require__("./node_modules/react-dom/index.js"),__webpack_require__("./node_modules/events/events.js"),["children"]);function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _defineProperty(obj,key,value){return(key=_toPropertyKey(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}var ContextProvider=function(_React$Component){_inherits(ContextProvider,_React$Component);var _super=_createSuper(ContextProvider);function ContextProvider(){return _classCallCheck(this,ContextProvider),_super.apply(this,arguments)}return _createClass(ContextProvider,[{key:"getChildContext",value:function getChildContext(){return this.props.context}},{key:"render",value:function render(){var _this$props=this.props,children=_this$props.children,rest=_objectWithoutProperties(_this$props,_excluded);return react.cloneElement(children,rest)}}]),ContextProvider}(react.Component);_defineProperty(ContextProvider,"childContextTypes",{context:function context(){return null}}),ContextProvider.displayName="ContextProvider";var Slot=function(_React$Component2){_inherits(Slot,_React$Component2);var _super2=_createSuper(Slot);function Slot(props){return _classCallCheck(this,Slot),_super2.call(this,props)}return _createClass(Slot,[{key:"render",value:function render(){var _this=this;return react.createElement("slot",_objectSpread(_objectSpread({},this.props),{},{ref:function ref(r){r?(_this.ref=r,_this._listener||(_this._listener=function(event){event.stopPropagation()},r.addEventListener("__react",_this._listener))):_this.ref.removeEventListener("__react",_this._listener)}}))}}]),Slot}(react.Component);Slot.displayName="Slot";function quill_utils_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function quill_utils_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?quill_utils_ownKeys(Object(source),!0).forEach((function(key){quill_utils_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):quill_utils_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function quill_utils_defineProperty(obj,key,value){return(key=function quill_utils_toPropertyKey(arg){var key=function quill_utils_toPrimitive(input,hint){if("object"!==quill_utils_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==quill_utils_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===quill_utils_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function quill_utils_typeof(obj){return quill_utils_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},quill_utils_typeof(obj)}var appendToStringProperty=function appendToStringProperty(append,str){return str?"".concat(str," ").concat(append):append},processJanusChildren=function processJanusChildren(node,doc){var _node$style,_node$style2,_node$style3,_node$style4,_node$style5,_node$style6,parentAttrs=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},attrs={};if("bold"===(null===(_node$style=node.style)||void 0===_node$style?void 0:_node$style.fontWeight)&&(attrs.bold=!0),null!==(_node$style2=node.style)&&void 0!==_node$style2&&_node$style2.fontSize){var size=node.style.fontSize;"number"!=typeof size&&size.endsWith("px")||(size="".concat(size,"px")),attrs.size=size}if(null!==(_node$style3=node.style)&&void 0!==_node$style3&&_node$style3.textDecoration&&(node.style.textDecoration.includes("underline")&&(attrs.underline=!0),node.style.textDecoration.includes("line-through")&&(attrs.strike=!0)),"italic"===(null===(_node$style4=node.style)||void 0===_node$style4?void 0:_node$style4.fontStyle)&&(attrs.italic=!0),null!==(_node$style5=node.style)&&void 0!==_node$style5&&_node$style5.color&&(attrs.color=node.style.color),null!==(_node$style6=node.style)&&void 0!==_node$style6&&_node$style6.backgroundColor&&(attrs.background=node.style.backgroundColor),node.href&&(attrs.link=node.href),"sub"===node.tag&&(attrs.script="sub"),"sup"===node.tag&&(attrs.script="super"),node.children&&node.children.length&&"text"===node.children[0].tag){var textNode=node.children[0];doc.insert(textNode.text,quill_utils_objectSpread(quill_utils_objectSpread({},parentAttrs),attrs))}else node.children.forEach((function(child,index){var _child$style,line=new(Delta_default());if((blockTags.includes(child.tag)||null!==(_child$style=child.style)&&void 0!==_child$style&&_child$style.textAlign)&&("p"===child.tag&&index>0||"p"!==child.tag)){var _child$style2,lineAttrs={};child.tag.startsWith("h")&&(lineAttrs.header=parseInt(child.tag.substring(1),10)),"blockquote"===child.tag&&(lineAttrs.blockquote=!0),"ol"===child.tag&&(parentAttrs.list="ordered"),"ul"===child.tag&&(parentAttrs.list="bullet"),"li"===child.tag&&(0===index&&doc.insert("\n"),lineAttrs.list=parentAttrs.list),null!==(_child$style2=child.style)&&void 0!==_child$style2&&_child$style2.textAlign&&(lineAttrs.align=child.style.textAlign),"img"===child.tag&&doc.insert({image:child.src}),line.insert("\n",lineAttrs)}var childLine=processJanusChildren(child,new(Delta_default()),attrs);doc=line.compose(childLine).compose(doc)}));return doc},blockTags=["p","blockquote","ol","ul","li","h1","h2","h3","h4","h5","h6","img"],convertJanusToQuill=function convertJanusToQuill(nodes){var doc=new(Delta_default()),parentAttrs={};return nodes.forEach((function(node,index){var _node$style7,line=new(Delta_default());if((blockTags.includes(node.tag)||null!==(_node$style7=node.style)&&void 0!==_node$style7&&_node$style7.textAlign)&&("p"===node.tag&&index>0||"p"!==node.tag)){var _node$style8,attrs={};node.tag.startsWith("h")&&(attrs.header=parseInt(node.tag.substring(1),10)),"blockquote"===node.tag&&(attrs.blockquote=!0),"ol"===node.tag&&(parentAttrs.list="ordered"),"ul"===node.tag&&(parentAttrs.list="bullet"),"li"===node.tag&&(attrs.list=parentAttrs.list),null!==(_node$style8=node.style)&&void 0!==_node$style8&&_node$style8.textAlign&&(1===index&&doc.insert("\n"),attrs.align=node.style.textAlign),line.insert("\n",attrs)}var childLine=processJanusChildren(node,new(Delta_default()),parentAttrs);doc=line.compose(childLine).compose(doc)})),doc};function QuillEditor_slicedToArray(arr,i){return function QuillEditor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function QuillEditor_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function QuillEditor_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return QuillEditor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return QuillEditor_arrayLikeToArray(o,minLen)}(arr,i)||function QuillEditor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function QuillEditor_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var supportedFonts=["Initial","Arial","Times New Roman","Sans Serif"],getFontName=function getFontName(font){return font.toLowerCase().replace(/\s/g,"-")},FontAttributor=lib.Quill.import("attributors/class/font");FontAttributor.whitelist=supportedFonts.map(getFontName),lib.Quill.register(FontAttributor,!0);var FontSizeAttributor=lib.Quill.import("attributors/style/size");FontSizeAttributor.whitelist=["10px","12px","14px","16px","18px"],lib.Quill.register(FontSizeAttributor,!0);var fontStyles="".concat(function getCssForFonts(fonts){return fonts.map((function(font){return"\n    .ql-snow .ql-picker.ql-font .ql-picker-label[data-value='".concat(getFontName(font),"']::before,\n    .ql-snow .ql-picker.ql-font .ql-picker-item[data-value='").concat(getFontName(font),"']::before\n    {\n      content: '").concat(font,"';\n      font-family: '").concat(font,"';\n    }\n    .ql-font-").concat(getFontName(font)," {\n      font-family: '").concat(font,"';\n    }\n  ")})).join("\n")}(supportedFonts),"\n/* default normal size */\n.ql-container {\n  font-size: 14px !important;\n}\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=\"10px\"]::before {\n  content: 'Smaller (10px)';\n  font-size: 10px !important;\n}\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=\"12px\"]::before {\n  content: 'Small (12px)';\n  font-size: 12px !important;\n}\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=\"14px\"]::before {\n  content: 'Normal (14px)';\n  font-size: 14px !important;\n}\n\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=\"16px\"]::before {\n  content: 'Large (16px)';\n  font-size: 16px !important;\n}\n\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=\"18px\"]::before {\n  content: 'Larger (18px)';\n  font-size: 18px !important;\n}\n"),customHandlers={adaptivity:function adaptivity(value){var range=this.quill.getSelection(),selectionValue="";range&&range.length>0&&"{"===(selectionValue=this.quill.getText(range.index,range.length)).charAt(0)&&(selectionValue=selectionValue.substring(1,selectionValue.length-1));var expression=prompt("Enter the Expression",selectionValue);expression&&(this.quill.insertText(range.index,"{".concat(expression,"}")),this.quill.deleteText(range.index+expression.length+2,expression.length+2))},image:function image(value){var range=this.quill.getSelection(),expression=prompt("Enter the image URL","");expression&&this.quill.insertEmbed(range.index,"image",expression)}},QuillEditor=function QuillEditor(_ref){var tree=_ref.tree,_ref$showSaveCancelBu=(_ref.html,_ref.showSaveCancelButtons),showSaveCancelButtons=void 0!==_ref$showSaveCancelBu&&_ref$showSaveCancelBu,onChange=_ref.onChange,onSave=_ref.onSave,onCancel=_ref.onCancel,_ref$showimagecontrol=_ref.showimagecontrol,showimagecontrol=void 0!==_ref$showimagecontrol&&_ref$showimagecontrol,_React$useState2=QuillEditor_slicedToArray(react.useState(tree),2),contents=_React$useState2[0],setContents=_React$useState2[1],_React$useState4=QuillEditor_slicedToArray(react.useState(convertJanusToQuill(tree)),2),delta=_React$useState4[0],setDelta=_React$useState4[1];(0,react.useEffect)((function(){var convertedTree=convertJanusToQuill(tree);setDelta(convertedTree)}),[tree]);var handleSave=react.useCallback((function(){contents&&onSave(contents)}),[onSave,contents]),handleQuillChange=react.useCallback((function(content,delta,source,editor){var janusText=function convertQuillToJanus(delta){var doc=(new(Delta_default())).compose(delta),nodes=[],listParent=null;return doc.eachLine((function(line,attrs){var nodeStyle={},node={tag:"p",style:nodeStyle,children:[]};attrs.fontSize&&(nodeStyle.fontSize=attrs.fontSize),attrs.indent&&(nodeStyle.paddingLeft="".concat(3*attrs.indent,"em"),node.customCssClass=appendToStringProperty("ql-indent-".concat(attrs.indent),node.customCssClass)),attrs.align&&(nodeStyle.textAlign=attrs.align),attrs.list?(listParent||(listParent={tag:"ordered"===attrs.list?"ol":"ul",style:{},children:[]},nodes.push(listParent)),node.tag="li"):listParent&&(listParent=null),attrs.blockquote&&(node.tag="blockquote"),attrs.header&&(node.tag="h".concat(attrs.header)),line.forEach((function(op){if("object"===quill_utils_typeof(op.insert)){var imageDetails=op.insert,child={tag:"img",style:{height:"100%",width:"100%"},src:"".concat(imageDetails.image),children:[]};node.children.push(child)}else if("string"==typeof op.insert){var _op$attributes2,_op$attributes3,style={};op.attributes&&(op.attributes.font&&(style.fontFamily=function convertFontName(fontCode){return fontCode.split("-").map((function(s){return s.charAt(0).toUpperCase()+s.slice(1)})).join(" ")}(op.attributes.font)),op.attributes.bold&&(style.fontWeight="bold"),op.attributes.italic&&(style.fontStyle="italic"),op.attributes.size&&(style.fontSize=op.attributes.size),op.attributes.underline&&(style.textDecoration=appendToStringProperty("underline",style.textDecoration)),op.attributes.strike&&(style.textDecoration=appendToStringProperty("line-through",style.textDecoration)),op.attributes.color&&(style.color=op.attributes.color),op.attributes.background&&(style.backgroundColor=op.attributes.background));var _op$attributes,_child={tag:"span",style,children:[{tag:"text",style:{},text:op.insert,children:[]}]};style.fontFamily&&(_child.customCssClass=appendToStringProperty("ql-font-".concat(null===(_op$attributes=op.attributes)||void 0===_op$attributes?void 0:_op$attributes.font),_child.customCssClass)),null!==(_op$attributes2=op.attributes)&&void 0!==_op$attributes2&&_op$attributes2.script&&("sub"===op.attributes.script&&(_child.tag="sub"),"super"===op.attributes.script&&(_child.tag="sup")),null!==(_op$attributes3=op.attributes)&&void 0!==_op$attributes3&&_op$attributes3.link&&(_child.tag="a",_child.href=op.attributes.link),node.children.push(_child)}})),listParent?listParent.children.push(node):nodes.push(node)})),nodes}(new(Delta_default())(editor.getContents().ops));setContents(janusText),onChange({value:janusText})}),[onChange]);return(0,jsx_runtime.jsxs)(react.Fragment,{children:[(0,jsx_runtime.jsx)("link",{rel:"stylesheet",href:"https://cdn.quilljs.com/1.3.6/quill.snow.css"}),(0,jsx_runtime.jsx)("style",{children:fontStyles}),(0,jsx_runtime.jsxs)("div",{style:{maxWidth:520,height:"100%",flex:1,display:"flex",flexDirection:"column",backgroundColor:"#fff"},children:[(0,jsx_runtime.jsx)(lib_default(),{style:{maxHeight:"100%"},modules:{toolbar:{container:[["bold","italic","underline","strike"],["blockquote"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:FontAttributor.whitelist},{size:["10px","12px","14px","16px","18px"]}],[{align:[]}],["link","adaptivity"],["clean"],showimagecontrol?["image"]:[]],handlers:customHandlers}},defaultValue:delta,onChange:handleQuillChange}),showSaveCancelButtons&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("button",{onClick:handleSave,children:"Save"}),(0,jsx_runtime.jsx)("button",{onClick:onCancel,children:"Cancel"})]})]})]})};QuillEditor.displayName="QuillEditor";try{QuillEditor.displayName="QuillEditor",QuillEditor.__docgenInfo={description:"",displayName:"QuillEditor",props:{tree:{defaultValue:null,description:"",name:"tree",required:!0,type:{name:"any[]"}},html:{defaultValue:null,description:"",name:"html",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(changes: any) => void"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!0,type:{name:"(contents: any) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}},showSaveCancelButtons:{defaultValue:{value:"false"},description:"",name:"showSaveCancelButtons",required:!1,type:{name:"boolean"}},showimagecontrol:{defaultValue:{value:"false"},description:"",name:"showimagecontrol",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/parts/janus-text-flow/QuillEditor.tsx#QuillEditor"]={docgenInfo:QuillEditor.__docgenInfo,name:"QuillEditor",path:"src/components/parts/janus-text-flow/QuillEditor.tsx#QuillEditor"})}catch(__react_docgen_typescript_loader_error){}var AdvancedAuthoringModal=__webpack_require__("./src/apps/authoring/components/AdvancedAuthoringModal.tsx"),ScreenEditIcon=__webpack_require__("./src/apps/authoring/components/Flowchart/chart-components/ScreenEditIcon.tsx");function MCQOptionsEditor_typeof(obj){return MCQOptionsEditor_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},MCQOptionsEditor_typeof(obj)}function MCQOptionsEditor_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function MCQOptionsEditor_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?MCQOptionsEditor_ownKeys(Object(source),!0).forEach((function(key){MCQOptionsEditor_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):MCQOptionsEditor_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function MCQOptionsEditor_defineProperty(obj,key,value){return(key=function MCQOptionsEditor_toPropertyKey(arg){var key=function MCQOptionsEditor_toPrimitive(input,hint){if("object"!==MCQOptionsEditor_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==MCQOptionsEditor_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===MCQOptionsEditor_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function MCQOptionsEditor_slicedToArray(arr,i){return function MCQOptionsEditor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MCQOptionsEditor_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||MCQOptionsEditor_unsupportedIterableToArray(arr,i)||function MCQOptionsEditor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MCQOptionsEditor_toConsumableArray(arr){return function MCQOptionsEditor_arrayWithoutHoles(arr){if(Array.isArray(arr))return MCQOptionsEditor_arrayLikeToArray(arr)}(arr)||function MCQOptionsEditor_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||MCQOptionsEditor_unsupportedIterableToArray(arr)||function MCQOptionsEditor_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MCQOptionsEditor_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return MCQOptionsEditor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?MCQOptionsEditor_arrayLikeToArray(o,minLen):void 0}}function MCQOptionsEditor_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var MCQOptionsEditor=function MCQOptionsEditor(_ref){var id=_ref.id,value=_ref.value,onChange=_ref.onChange,onBlur=_ref.onBlur,editEntry=(0,react.useCallback)((function(index){return function(modified){var newValue=value.map((function(v,i){return i===index?modified:v}));onChange(newValue),setTimeout((function(){return onBlur(id,newValue)}),0)}}),[id,onBlur,onChange,value]),deleteEntry=(0,react.useCallback)((function(index){return function(){var newValue=value.filter((function(v,i){return i!==index}));onChange(newValue),setTimeout((function(){return onBlur(id,newValue)}),0)}}),[id,onBlur,onChange,value]),onAddOption=(0,react.useCallback)((function(){var newValue=[].concat(MCQOptionsEditor_toConsumableArray(value),[optionTemplate(value.length+1)]);onChange(newValue),setTimeout((function(){return onBlur(id,newValue)}),0)}),[id,onBlur,onChange,value]);return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"form-label",children:"Options"}),(0,jsx_runtime.jsx)("div",{children:value.map((function(option,index){return(0,jsx_runtime.jsx)(MCQOptionsEditor_OptionsEditor,{value:option,onChange:editEntry(index),onDelete:deleteEntry(index)},index)}))}),(0,jsx_runtime.jsx)("button",{className:"btn btn-primary",onClick:onAddOption,children:"+ Add Option"})]})};MCQOptionsEditor.displayName="MCQOptionsEditor";var MCQOptionsEditor_OptionsEditor=function OptionsEditor(_ref2){var value=_ref2.value,onChange=_ref2.onChange,onDelete=_ref2.onDelete,_useToggle2=MCQOptionsEditor_slicedToArray((0,useToggle.O)(!1),4),editorOpen=_useToggle2[0],openEditor=_useToggle2[2],closeEditor=_useToggle2[3],_useState2=MCQOptionsEditor_slicedToArray((0,react.useState)({value:[]}),2),tempValue=_useState2[0],setTempValue=_useState2[1],onSave=(0,react.useCallback)((function(){closeEditor();var newValue=MCQOptionsEditor_objectSpread(MCQOptionsEditor_objectSpread({},value),{},{nodes:tempValue.value});onChange(newValue),console.info("onSave",newValue)}),[closeEditor,onChange,tempValue.value,value]),onEdit=(0,react.useCallback)((function(){openEditor(),setTempValue({value:value.nodes})}),[openEditor,value.nodes]);return(0,jsx_runtime.jsxs)("div",{className:"flex",children:[(0,jsx_runtime.jsx)("div",{className:"flex-1",children:(0,mcq_util.q)(value.nodes)}),(0,jsx_runtime.jsxs)("div",{className:"flex-none",children:[(0,jsx_runtime.jsx)("button",{className:"btn btn-link p-0 mr-1",onClick:onEdit,children:(0,jsx_runtime.jsx)(ScreenEditIcon.s,{})}),(0,jsx_runtime.jsx)("button",{className:"btn btn-link p-0",onClick:onDelete,children:(0,jsx_runtime.jsx)(ScreenDeleteIcon.q,{})})]}),editorOpen&&(0,jsx_runtime.jsxs)(AdvancedAuthoringModal.tv,{show:!0,children:[(0,jsx_runtime.jsx)(Modal.Z.Body,{children:(0,jsx_runtime.jsx)(QuillEditor,{tree:value.nodes,onChange:setTempValue,onSave:function onSave(){return console.info("onSave")},onCancel:function onCancel(){return console.info("onCancel")}})}),(0,jsx_runtime.jsx)(Modal.Z.Footer,{children:(0,jsx_runtime.jsx)("button",{onClick:onSave,className:"btn btn-primary",children:"Save"})})]})]})};MCQOptionsEditor_OptionsEditor.displayName="OptionsEditor";var optionTemplate=function optionTemplate(count){return{nodes:[{tag:"p",style:{},children:[{tag:"span",style:{},children:[{tag:"text",text:"Option Number ".concat(count),style:{},children:[]}]}]}],scoreValue:0}};try{MCQOptionsEditor.displayName="MCQOptionsEditor",MCQOptionsEditor.__docgenInfo={description:"",displayName:"MCQOptionsEditor",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"OptionsType[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: OptionsType[]) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(id: string, value: OptionsType[]) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/MCQOptionsEditor.tsx#MCQOptionsEditor"]={docgenInfo:MCQOptionsEditor.__docgenInfo,name:"MCQOptionsEditor",path:"src/apps/authoring/components/PropertyEditor/custom/MCQOptionsEditor.tsx#MCQOptionsEditor"})}catch(__react_docgen_typescript_loader_error){}var OptionsCorrectPicker=function OptionsCorrectPicker(_ref){var _part$custom,onChange=_ref.onChange,value=_ref.value,label=_ref.label,_onBlur=_ref.onBlur,id=_ref.id,currentPartSelection=(0,es.v9)(slice.e5),part=function getPartDef(currentActivityTree,currentPartSelection){try{for(var partDef,i=0;i<currentActivityTree.length;i++){var _activity$content;if(partDef=null===(_activity$content=currentActivityTree[i].content)||void 0===_activity$content?void 0:_activity$content.partsLayout.find((function(part){return part.id===currentPartSelection})))break}return partDef}catch(e){return console.log(e),null}}((0,es.v9)(deck.kv),currentPartSelection),options=(null==part||null===(_part$custom=part.custom)||void 0===_part$custom?void 0:_part$custom.optionLabels)||["Option 1","Option 2"],onSelect=(0,react.useCallback)((function(e){var newVal=parseInt(e.currentTarget.value,10);onChange(newVal)}),[onChange]);return(0,jsx_runtime.jsxs)("div",{className:"d-flex justify-content-between flex-column",children:[(0,jsx_runtime.jsx)("div",{className:"form-label",children:label}),(0,jsx_runtime.jsx)("select",{onChange:onSelect,onBlur:function onBlur(){return _onBlur(id,value)},className:"form-control form-select",value:void 0===value?-1:value,children:options.map((function(option,index){return(0,jsx_runtime.jsx)("option",{value:index+1,children:option},index)}))})]})};OptionsCorrectPicker.displayName="OptionsCorrectPicker";try{OptionsCorrectPicker.displayName="OptionsCorrectPicker",OptionsCorrectPicker.__docgenInfo={description:"",displayName:"OptionsCorrectPicker",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: number) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(id: string, value: number) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/OptionsCorrectPicker.tsx#OptionsCorrectPicker"]={docgenInfo:OptionsCorrectPicker.__docgenInfo,name:"OptionsCorrectPicker",path:"src/apps/authoring/components/PropertyEditor/custom/OptionsCorrectPicker.tsx#OptionsCorrectPicker"})}catch(__react_docgen_typescript_loader_error){}function OptionsCustomErrorFeedbackAuthoring_toConsumableArray(arr){return function OptionsCustomErrorFeedbackAuthoring_arrayWithoutHoles(arr){if(Array.isArray(arr))return OptionsCustomErrorFeedbackAuthoring_arrayLikeToArray(arr)}(arr)||function OptionsCustomErrorFeedbackAuthoring_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function OptionsCustomErrorFeedbackAuthoring_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return OptionsCustomErrorFeedbackAuthoring_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return OptionsCustomErrorFeedbackAuthoring_arrayLikeToArray(o,minLen)}(arr)||function OptionsCustomErrorFeedbackAuthoring_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function OptionsCustomErrorFeedbackAuthoring_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var OptionsCustomErrorFeedbackAuthoring=function OptionsCustomErrorFeedbackAuthoring(_ref){var _part$custom,_part$custom2,onChange=_ref.onChange,value=_ref.value,label=_ref.label,_onBlur=_ref.onBlur,id=_ref.id,currentPartSelection=(0,es.v9)(slice.e5),part=function getPartDef(currentActivityTree,currentPartSelection){try{for(var partDef,i=0;i<currentActivityTree.length;i++){var _activity$content;if(partDef=null===(_activity$content=currentActivityTree[i].content)||void 0===_activity$content?void 0:_activity$content.partsLayout.find((function(part){return part.id===currentPartSelection})))break}return partDef}catch(e){return console.log(e),null}}((0,es.v9)(deck.kv),currentPartSelection),options=(null==part||null===(_part$custom=part.custom)||void 0===_part$custom?void 0:_part$custom.optionLabels)||["Option 1","Option 2"],correctIndex=((null==part||null===(_part$custom2=part.custom)||void 0===_part$custom2?void 0:_part$custom2.correctAnswer)||0)-1,OnOptionChanged=(0,react.useCallback)((function(index){return function(newOptionValue){for(var newFeedback=OptionsCustomErrorFeedbackAuthoring_toConsumableArray(value);newFeedback.length<=index;)newFeedback.push("");newFeedback[index]=newOptionValue,newFeedback.length>options.length&&newFeedback.splice(options.length),onChange(newFeedback)}}),[onChange,options.length,value]);return(0,jsx_runtime.jsxs)("div",{className:"d-flex justify-content-between flex-column",children:[(0,jsx_runtime.jsx)("div",{className:"form-label",children:label}),options.map((function(option,index){return index===correctIndex?null:(0,jsx_runtime.jsx)(OptionsCustomErrorFeedbackAuthoring_OptionFeedback,{onBlur:function onBlur(){return _onBlur(id,value)},index,option,feedback:value[index]||"",onChange:OnOptionChanged(index)},index)}))]})};OptionsCustomErrorFeedbackAuthoring.displayName="OptionsCustomErrorFeedbackAuthoring";var OptionsCustomErrorFeedbackAuthoring_OptionFeedback=function OptionFeedback(_ref2){var option=_ref2.option,index=_ref2.index,onBlur=_ref2.onBlur,feedback=_ref2.feedback,_onChange=_ref2.onChange,labelOption=option||"Option ".concat(index+1);return(0,jsx_runtime.jsxs)("div",{className:"form-group",children:[(0,jsx_runtime.jsx)("label",{children:labelOption}),(0,jsx_runtime.jsx)("input",{onBlur,className:"form-control",value:feedback,onChange:function onChange(e){return _onChange(e.target.value)}})]})};OptionsCustomErrorFeedbackAuthoring_OptionFeedback.displayName="OptionFeedback";try{OptionsCustomErrorFeedbackAuthoring.displayName="OptionsCustomErrorFeedbackAuthoring",OptionsCustomErrorFeedbackAuthoring.__docgenInfo={description:"",displayName:"OptionsCustomErrorFeedbackAuthoring",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string[]) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(id: string, value: string[]) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/OptionsCustomErrorFeedbackAuthoring.tsx#OptionsCustomErrorFeedbackAuthoring"]={docgenInfo:OptionsCustomErrorFeedbackAuthoring.__docgenInfo,name:"OptionsCustomErrorFeedbackAuthoring",path:"src/apps/authoring/components/PropertyEditor/custom/OptionsCustomErrorFeedbackAuthoring.tsx#OptionsCustomErrorFeedbackAuthoring"})}catch(__react_docgen_typescript_loader_error){}var ScreenDropdownTemplate=__webpack_require__("./src/apps/authoring/components/PropertyEditor/custom/ScreenDropdownTemplate.tsx"),ButtonGroup=__webpack_require__("./node_modules/react-bootstrap/esm/ButtonGroup.js"),Button=__webpack_require__("./node_modules/react-bootstrap/esm/Button.js");function useAudio_slicedToArray(arr,i){return function useAudio_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function useAudio_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function useAudio_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return useAudio_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return useAudio_arrayLikeToArray(o,minLen)}(arr,i)||function useAudio_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useAudio_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var useAudio=function useAudio(src){var audioRef=(0,react.useRef)(null),_useState2=useAudio_slicedToArray((0,react.useState)(!1),2),isPlaying=_useState2[0],setIsPlaying=_useState2[1],playAudio=(0,react.useCallback)((function(event){(null==event?void 0:event.preventDefault)&&(null==event||event.preventDefault());var audio=audioRef.current;audio&&(audio.paused?(audio.currentTime=0,audio.play().then((function(){return setIsPlaying(!0)})),audio.onabort=function(){return setIsPlaying(!1)},audio.onerror=function(){return setIsPlaying(!1)},audio.onended=function(){return setIsPlaying(!1)}):(setIsPlaying(!1),audio.pause()))}),[]);return{audioPlayer:src?(0,jsx_runtime.jsx)("audio",{ref:audioRef,src,preload:"auto"}):null,playAudio,isPlaying}};try{useAudio.displayName="useAudio",useAudio.__docgenInfo={description:"",displayName:"useAudio",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/hooks/useAudio.tsx#useAudio"]={docgenInfo:useAudio.__docgenInfo,name:"useAudio",path:"src/components/hooks/useAudio.tsx#useAudio"})}catch(__react_docgen_typescript_loader_error){}var Dropdown=__webpack_require__("./node_modules/react-bootstrap/esm/Dropdown.js"),immutable_es=__webpack_require__("./node_modules/immutable/dist/immutable.es.js"),tsmonad=__webpack_require__("./node_modules/tsmonad/dist/tsmonad.js"),classNames=__webpack_require__("./src/utils/classNames.ts"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),LoadingSpinner_modules=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/resolve-url-loader/index.js!./node_modules/@storybook/addon-styling/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[3]!./src/components/common/LoadingSpinner.modules.scss"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(LoadingSpinner_modules.Z,options);const common_LoadingSpinner_modules=LoadingSpinner_modules.Z&&LoadingSpinner_modules.Z.locals?LoadingSpinner_modules.Z.locals:void 0;function LoadingSpinner_typeof(obj){return LoadingSpinner_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},LoadingSpinner_typeof(obj)}function LoadingSpinner_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(arg=descriptor.key,key=void 0,key=function LoadingSpinner_toPrimitive(input,hint){if("object"!==LoadingSpinner_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==LoadingSpinner_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string"),"symbol"===LoadingSpinner_typeof(key)?key:String(key)),descriptor)}var arg,key}function LoadingSpinner_setPrototypeOf(o,p){return LoadingSpinner_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},LoadingSpinner_setPrototypeOf(o,p)}function LoadingSpinner_createSuper(Derived){var hasNativeReflectConstruct=function LoadingSpinner_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=LoadingSpinner_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=LoadingSpinner_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function LoadingSpinner_possibleConstructorReturn(self,call){if(call&&("object"===LoadingSpinner_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function LoadingSpinner_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function LoadingSpinner_getPrototypeOf(o){return LoadingSpinner_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},LoadingSpinner_getPrototypeOf(o)}var LoadingSpinnerSize=function(LoadingSpinnerSize){return LoadingSpinnerSize[LoadingSpinnerSize.Small=0]="Small",LoadingSpinnerSize[LoadingSpinnerSize.Medium=1]="Medium",LoadingSpinnerSize[LoadingSpinnerSize.Large=2]="Large",LoadingSpinnerSize}({}),LoadingSpinner=function(_React$PureComponent){!function LoadingSpinner_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&LoadingSpinner_setPrototypeOf(subClass,superClass)}(LoadingSpinner,_React$PureComponent);var _super=LoadingSpinner_createSuper(LoadingSpinner);function LoadingSpinner(props){return function LoadingSpinner_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LoadingSpinner),_super.call(this,props)}return function LoadingSpinner_createClass(Constructor,protoProps,staticProps){return protoProps&&LoadingSpinner_defineProperties(Constructor.prototype,protoProps),staticProps&&LoadingSpinner_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(LoadingSpinner,[{key:"render",value:function render(){var _this$props=this.props,className=_this$props.className,failed=_this$props.failed,children=_this$props.children,size=_this$props.size,align=_this$props.align,sizeClass=size===LoadingSpinnerSize.Small?common_LoadingSpinner_modules.lsSmall:size===LoadingSpinnerSize.Large?common_LoadingSpinner_modules.lsLarge:common_LoadingSpinner_modules.lsMedium,alignClass="left"===align?common_LoadingSpinner_modules.alignLeft:"right"===align?common_LoadingSpinner_modules.alignRight:common_LoadingSpinner_modules.alignCenter;return(0,jsx_runtime.jsxs)("div",{className:(0,classNames.A)(common_LoadingSpinner_modules.loadingSpinner,sizeClass,alignClass,className),children:[failed?(0,jsx_runtime.jsx)("i",{className:"fa fa-times-circle text-danger"}):(0,jsx_runtime.jsx)("i",{className:"fas fa-circle-notch fa-spin fa-1x fa-fw"}),(0,jsx_runtime.jsx)("span",{className:"ml-1",children})]})}}]),LoadingSpinner}(react.PureComponent);LoadingSpinner.displayName="LoadingSpinner";try{LoadingSpinner.displayName="LoadingSpinner",LoadingSpinner.__docgenInfo={description:"",displayName:"LoadingSpinner",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},failed:{defaultValue:null,description:"",name:"failed",required:!1,type:{name:"boolean"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"enum",value:[{value:"0"},{value:"1"},{value:"2"}]}},align:{defaultValue:null,description:"",name:"align",required:!1,type:{name:"enum",value:[{value:'"left"'},{value:'"right"'},{value:'"center"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/common/LoadingSpinner.tsx#LoadingSpinner"]={docgenInfo:LoadingSpinner.__docgenInfo,name:"LoadingSpinner",path:"src/components/common/LoadingSpinner.tsx#LoadingSpinner"})}catch(__react_docgen_typescript_loader_error){}function relativeToNow(a){return function relativeTo(dateFrom,dateNow){var delta=dateNow.getTime()-dateFrom.getTime(),MS_IN_SECOND=1e3,MS_IN_MINUTE=60*MS_IN_SECOND,MS_IN_HOUR=60*MS_IN_MINUTE,MS_IN_DAY=24*MS_IN_HOUR,MS_IN_WEEK=7*MS_IN_DAY,MS_IN_MONTH=30.5*MS_IN_DAY,MS_IN_YEAR=365*MS_IN_DAY;if(delta>=2*MS_IN_YEAR)return Math.floor(delta/MS_IN_YEAR)+" years ago";if(delta>=MS_IN_YEAR-MS_IN_MONTH)return"a year ago";if(delta>=2*MS_IN_MONTH)return Math.floor(delta/MS_IN_MONTH)+" months ago";if(delta>=MS_IN_MONTH)return"a month ago";if(delta>=2*MS_IN_WEEK)return Math.floor(delta/MS_IN_WEEK)+" weeks ago";if(delta>=MS_IN_WEEK-MS_IN_DAY)return"a week ago";if(delta>=2*MS_IN_DAY)return Math.floor(delta/MS_IN_DAY)+" days ago";if(delta>=MS_IN_DAY)return"a day ago";if(delta>=2*MS_IN_HOUR)return Math.floor(delta/MS_IN_HOUR)+" hours ago";if(delta>=MS_IN_HOUR)return"an hour ago";if(delta>=2*MS_IN_MINUTE)return Math.floor(delta/MS_IN_MINUTE)+" minutes ago";if(delta>=MS_IN_MINUTE)return"a minute ago";if(delta>=7*MS_IN_SECOND)return Math.floor(delta/MS_IN_SECOND)+" seconds ago";if(delta>=2*MS_IN_SECOND)return"a few seconds ago";return"just now"}(a,new Date)}document.createElement("canvas");var convert_toByteNotation=function toByteNotation(value){var decimalPlaces=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!Number.isFinite(value))return null;var unit,UNIT_MAP={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:1024*(1<<30)},mag=Math.abs(value),str=(value/UNIT_MAP[(unit=mag>=UNIT_MAP.tb?"TB":mag>=UNIT_MAP.gb?"GB":mag>=UNIT_MAP.mb?"MB":mag>=UNIT_MAP.kb?"KB":"B").toLowerCase()]).toFixed(decimalPlaces).replace(/^(.+)\.?[0]+$/,"$1").replace(/\.0$/,"");return"".concat(str," ").concat(unit)},stringFormat_ellipsize=function ellipsize(text,maxLength){var postfixLength=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(maxLength<=postfixLength+3)throw Error("maxLength must be greater than postfixLength + 3");if(text.length>maxLength){var front=text.substr(0,Math.min(maxLength,text.length)-3-postfixLength);return"".concat(front,"...").concat(text.substr(text.length-postfixLength,text.length))}return text},guid=__webpack_require__("./src/utils/guid.ts");function colors_slicedToArray(arr,i){return function colors_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function colors_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function colors_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return colors_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return colors_arrayLikeToArray(o,minLen)}(arr,i)||function colors_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function colors_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var stringToColor={hsl:function hsl(str){var minH=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,maxH=arguments.length>2&&void 0!==arguments[2]?arguments[2]:360,hash=function hashString(string){for(var hash=0,str=string+"x",MAX_SAFE_INTEGER=parseInt("".concat(Number.MAX_SAFE_INTEGER/137),10),i=0;i<str.length;i+=1)hash>MAX_SAFE_INTEGER&&(hash=parseInt("".concat(hash/137),10)),hash=131*hash+str.charCodeAt(i);return hash}(str),S=[.35,.5,.65],L=[.35,.5,.65];return[hash%359/1e3*(maxH-minH)+minH,S[(hash=parseInt("".concat(hash/360),10))%S.length],L[(hash=parseInt("".concat(hash/S.length),10))%L.length]]},rgb:function rgb(str){var _stringToColor$hsl2=colors_slicedToArray(stringToColor.hsl(str),3);return function hslToRgb(hue,sat,light){var H=hue/360,q=light<.5?light*(1+sat):light+sat-light*sat,p=2*light-q;return[H+1/3,H,H-1/3].map((function(c){var color=c;return color<0&&(color+=1),color>1&&(color-=1),color=color<1/6?p+6*(q-p)*color:color<.5?q:color<2/3?p+6*(q-p)*(2/3-color):p,Math.round(255*color)}))}(_stringToColor$hsl2[0],_stringToColor$hsl2[1],_stringToColor$hsl2[2])},hex:function hex(str){return function rgbToHex(RGBArray){var hex="#";return RGBArray.forEach((function(value){value<16&&(hex+=0),hex+=value.toString(16)})),hex}(stringToColor.rgb(str))}},isImage=function isImage(mimeType){return mimeType.match(/^image\//)},getFileExtensionColor=function getFileExtensionColor(extension){return{css:"#F438D6",js:"#F2D300",doc:"#012BAA",htm:"#4928CF",img:"#8e44ad",get png(){return this.img},get jpg(){return this.img},get jpe(){return this.img},pdf:"#D11D00",ppt:"#FF9937",txt:"#009CF2",xls:"#00A51C",zip:"#515151"}[extension]||stringToColor.hex(extension)},getFileExtensionGlyph=function getFileExtensionGlyph(extension){return{txt:(0,jsx_runtime.jsxs)("g",{id:"Layer_1",children:[(0,jsx_runtime.jsx)("path",{d:"M163.834,427 L393.834,427 L393.834,452 L163.834,452 L163.834,427 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M163.834,378.316 L393.834,378.316 L393.834,403.316 L163.834,403.316           L163.834,378.316 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M163.834,331.023 L393.834,331.023 L393.834,356.023 L163.834,356.023           L163.834,331.023 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M163.834,283.73 L393.834,283.73 L393.834,308.73 L163.834,308.73           L163.834,283.73 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M163.834,236.437 L393.834,236.437 L393.834,261.437 L163.834,261.437           L163.834,236.437 z",fill:"#DDDDDD"})]}),ppt:(0,jsx_runtime.jsxs)("g",{id:"Layer_1",children:[(0,jsx_runtime.jsx)("path",{d:"M165.888,432 L165.888,370.723 L226.126,370.723 L226.126,432 L165.888,432 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M247.128,432 L247.128,313.152 L307.366,313.152 L307.366,432 L247.128,432 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M331.542,432 L331.542,249.937 L391.78,249.937 L391.78,432 L331.542,432 z",fill:"#DDDDDD"})]}),htm:(0,jsx_runtime.jsxs)("g",{id:"Layer_1",children:[(0,jsx_runtime.jsx)("path",{d:"M237.484,326.874 L237.484,306.333 L146.747,342.414 L146.747,363.49           L237.484,399.392 L237.484,379.03 L171.932,352.952 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M293.57,267.573 L243.914,401 L264.098,401 L313.932,267.573 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M320.184,379.03 L320.184,399.392 L410.921,363.49 L410.921,342.414           L320.184,306.333 L320.184,326.874 L385.736,352.952 z",fill:"#DDDDDD"})]}),doc:(0,jsx_runtime.jsxs)("g",{id:"Layer_1",children:[(0,jsx_runtime.jsx)("path",{d:"M163.834,426 L393.834,426 L393.834,451 L163.834,451 L163.834,426 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M163.834,377.316 L393.834,377.316 L393.834,402.316 L163.834,402.316           L163.834,377.316 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M297.643,330.023 L393.834,330.023 L393.834,355.023 L307.195,355.023           L297.643,330.023 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M278.17,282.73 L393.834,282.73 L393.834,307.73 L288.393,307.588           L278.17,282.73 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M260.644,235.437 L393.834,235.437 L393.834,260.437 L269.758,260.437           L260.644,235.437 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M209.84,308.797 L225.417,264.915 L225.752,264.915 L240.826,308.797 z           M212.353,235.437 L167.131,355.023 L193.594,355.023 L202.973,328.393 L247.693,328.393           L256.737,355.023 L284.037,355.023 L239.318,235.437 z",fill:"#DDDDDD"})]}),js:(0,jsx_runtime.jsxs)("g",{id:"Layer_1",children:[(0,jsx_runtime.jsx)("path",{d:"M251.642,273.503 L251.642,251.033 L226.163,251.033 Q222.753,251.033           218.439,252.738 Q214.126,254.444 210.414,257.754 Q206.703,261.064 204.095,266.18           Q201.487,271.296 201.487,278.117 L201.487,315.834 Q201.487,320.849 199.481,324.36           Q197.474,327.871 194.666,329.978 Q191.857,332.084 188.647,332.987 Q185.437,333.89           183.23,333.89 L183.23,351.344 Q185.437,351.344 188.647,352.247 Q191.857,353.15           194.666,355.055 Q197.474,356.961 199.481,360.171 Q201.487,363.381 201.487,367.996           L201.487,406.916 Q201.487,413.737 204.095,418.853 Q206.703,423.969 210.414,427.279           Q214.126,430.589 218.439,432.295 Q222.753,434 226.163,434 L251.642,434 L251.642,411.53           L240.809,411.53 Q237.197,411.53 235.091,410.126 Q232.984,408.722 231.781,406.615           Q230.577,404.509 230.276,401.901 Q229.975,399.292 229.975,397.086 L229.975,364.986           Q229.975,358.566 227.668,354.454 Q225.361,350.341 222.251,347.833 Q219.141,345.325           215.731,344.222 Q212.32,343.118 210.113,342.918 L210.113,342.316 Q212.32,342.115           215.731,341.112 Q219.141,340.109 222.251,337.601 Q225.361,335.094 227.668,330.58           Q229.975,326.066 229.975,318.643 L229.975,288.148 Q229.975,285.741 230.276,283.133           Q230.577,280.525 231.781,278.418 Q232.984,276.311 235.091,274.907 Q237.197,273.503           240.809,273.503 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M307.415,411.53 L307.415,434 L332.894,434 Q336.304,434 340.618,432.295           Q344.931,430.589 348.643,427.279 Q352.354,423.969 354.962,418.853 Q357.57,413.737           357.57,406.916 L357.57,367.996 Q357.57,363.381 359.577,360.171 Q361.583,356.961           364.391,355.055 Q367.2,353.15 370.41,352.247 Q373.62,351.344 376.027,351.344           L376.027,333.89 Q373.62,333.89 370.41,332.987 Q367.2,332.084 364.391,329.978           Q361.583,327.871 359.577,324.36 Q357.57,320.849 357.57,315.834 L357.57,278.117           Q357.57,271.296 354.962,266.18 Q352.354,261.064 348.643,257.754 Q344.931,254.444           340.618,252.738 Q336.304,251.033 332.894,251.033 L307.415,251.033 L307.415,273.503           L318.249,273.503 Q321.86,273.503 323.966,274.907 Q326.073,276.311 327.276,278.418           Q328.48,280.525 328.781,283.133 Q329.082,285.741 329.082,288.148 L329.082,318.643           Q329.082,326.066 331.389,330.58 Q333.696,335.094 336.806,337.601 Q339.916,340.109           343.326,341.112 Q346.737,342.115 348.944,342.316 L348.944,342.918 Q346.737,343.118           343.326,344.222 Q339.916,345.325 336.806,347.833 Q333.696,350.341 331.389,354.454           Q329.082,358.566 329.082,364.986 L329.082,397.086 Q329.082,399.292 328.781,401.901           Q328.48,404.509 327.276,406.615 Q326.073,408.722 323.966,410.126 Q321.86,411.53           318.249,411.53 z",fill:"#DDDDDD"})]}),get css(){return this.js},xls:(0,jsx_runtime.jsxs)("g",{id:"Layer_1",children:[(0,jsx_runtime.jsx)("path",{d:"M145.187,237.133 L224.978,237.133 L224.978,277.028 L145.187,277.028           L145.187,237.133 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M240.067,237.133 L319.858,237.133 L319.858,277.028 L240.067,277.028           L240.067,237.133 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M336.283,237.133 L416.074,237.133 L416.074,277.028 L336.283,277.028           L336.283,237.133 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M144.519,287.731 L224.31,287.731 L224.31,327.627 L144.519,327.627           L144.519,287.731 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M239.399,287.731 L319.19,287.731 L319.19,327.627 L239.399,327.627           L239.399,287.731 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M335.615,287.731 L415.406,287.731 L415.406,327.627 L335.615,327.627           L335.615,287.731 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M143.851,338.122 L223.642,338.122 L223.642,378.018 L143.851,378.018           L143.851,338.122 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M238.732,338.122 L318.523,338.122 L318.523,378.018 L238.732,378.018           L238.732,338.122 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M334.947,338.122 L414.739,338.122 L414.739,378.018 L334.947,378.018           L334.947,338.122 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M143.184,392.491 L222.975,392.491 L222.975,432.386 L143.184,432.386           L143.184,392.491 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M238.064,392.491 L317.855,392.491 L317.855,432.386 L238.064,432.386           L238.064,392.491 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M334.28,392.491 L414.071,392.491 L414.071,432.386 L334.28,432.386           L334.28,392.491 z",fill:"#DDDDDD"})]}),pdf:(0,jsx_runtime.jsxs)("g",{children:[(0,jsx_runtime.jsx)("path",{d:"M173.917,426 L403.917,426 L403.917,451 L173.917,451 L173.917,426 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M173.917,377.316 L403.917,377.316 L403.917,402.316 L173.917,402.316               L173.917,377.316 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M173.917,282.73 L273.886,282.73 L273.886,307.73 L173.917,307.73               L173.917,282.73 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M173.917,235.437 L273.886,235.437 L273.886,260.437 L173.917,260.437               L173.917,235.437 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M173.917,330.023 L273.886,330.023 L273.886,355.023 L173.917,355.023               L173.917,330.023 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M292.083,235.437 L403.917,235.437 L403.917,355.023 L292.083,355.023               L292.083,235.437 z",fill:"#DDDDDD"})]}),zip:(0,jsx_runtime.jsxs)("g",{children:[(0,jsx_runtime.jsx)("path",{d:"M292.3,292.304 C297.823,292.304 302.301,297.353 302.301,303.582           L302.3,366.543 L255.367,366.543 L255.367,303.582 C255.367,297.353           259.844,292.304 265.367,292.304 L292.3,292.304 z M286.856,300.533 L269.652,300.533           C266.125,300.533 263.265,302.825 263.265,305.653 L263.265,334.239 L293.243,334.239           L293.243,305.653 C293.243,302.825 290.384,300.533 286.856,300.533 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M257.254,476 L299.254,476 L299.254,501 L257.254,501 L257.254,476 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M257.254,442.788 L299.254,442.788 L299.254,467.788 L257.254,467.788           L257.254,442.788 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M257.254,410.331 L299.254,410.331 L299.254,435.331 L257.254,435.331           L257.254,410.331 z",fill:"#DDDDDD"}),(0,jsx_runtime.jsx)("path",{d:"M257.254,378.92 L299.254,378.92 L299.254,403.92 L257.254,403.92           L257.254,378.92 z",fill:"#DDDDDD"})]})}[extension]||(0,jsx_runtime.jsx)("g",{})};try{isImage.displayName="isImage",isImage.__docgenInfo={description:"",displayName:"isImage",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/media/manager/utils.tsx#isImage"]={docgenInfo:isImage.__docgenInfo,name:"isImage",path:"src/components/media/manager/utils.tsx#isImage"})}catch(__react_docgen_typescript_loader_error){}try{getFileExtensionColor.displayName="getFileExtensionColor",getFileExtensionColor.__docgenInfo={description:"",displayName:"getFileExtensionColor",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/media/manager/utils.tsx#getFileExtensionColor"]={docgenInfo:getFileExtensionColor.__docgenInfo,name:"getFileExtensionColor",path:"src/components/media/manager/utils.tsx#getFileExtensionColor"})}catch(__react_docgen_typescript_loader_error){}try{getFileExtensionGlyph.displayName="getFileExtensionGlyph",getFileExtensionGlyph.__docgenInfo={description:"",displayName:"getFileExtensionGlyph",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/media/manager/utils.tsx#getFileExtensionGlyph"]={docgenInfo:getFileExtensionGlyph.__docgenInfo,name:"getFileExtensionGlyph",path:"src/components/media/manager/utils.tsx#getFileExtensionGlyph"})}catch(__react_docgen_typescript_loader_error){}var FileIcon=function FileIcon(_ref){var className=_ref.className,extension=(_ref.filename,_ref.extension),extColor=(_ref.url,getFileExtensionColor(extension)),extGlyph=getFileExtensionGlyph(extension);return(0,jsx_runtime.jsx)("div",{className:"media-icon ".concat(className||""),style:{padding:5},children:(0,jsx_runtime.jsxs)("svg",{x:"0",y:"0",width:"100%",height:"80%",viewBox:"0, 0, 512, 512",children:[(0,jsx_runtime.jsxs)("defs",{children:[(0,jsx_runtime.jsxs)("linearGradient",{id:"Gradient_1",gradientUnits:"userSpaceOnUse",x1:"368.119",y1:"860.572",x2:"368.119",y2:"96.071",gradientTransform:"matrix(1, 0, 0, 1, -114.048, -59.064)",children:[(0,jsx_runtime.jsx)("stop",{offset:"0",stopColor:"#FFFFFF"}),(0,jsx_runtime.jsx)("stop",{offset:"1",stopColor:"#F3F3F3"})]}),(0,jsx_runtime.jsxs)("linearGradient",{id:"Gradient_2",gradientUnits:"userSpaceOnUse",x1:"496.609",y1:"245.199",x2:"496.609",y2:"68.325",gradientTransform:"matrix(1, 0, 0, 1, -114.048, -59.064)",children:[(0,jsx_runtime.jsx)("stop",{offset:"0",stopColor:"#FFFFFF"}),(0,jsx_runtime.jsx)("stop",{offset:"0",stopColor:"#FFFFFF"}),(0,jsx_runtime.jsx)("stop",{offset:"0",stopColor:"#FFFFFF"}),(0,jsx_runtime.jsx)("stop",{offset:"1",stopColor:"#F2F2F2"})]})]}),(0,jsx_runtime.jsxs)("g",{id:"Layer_1",children:[(0,jsx_runtime.jsxs)("g",{id:"body",children:[(0,jsx_runtime.jsx)("path",{d:"M441.629,497.755 C441.629,505.036 435.669,511 428.37,511 C428.37,511 83.63,511                   83.63,511 C76.338,511 70.371,505.036 70.371,497.755 C70.371,497.755                   70.371,14.576 70.371,14.576 C70.371,7.295 76.338,1.331 83.63,1.331                   C83.63,1.331 325.611,1.331 325.611,1.331 C325.611,1.331 441.629,120.479                   441.629,120.479 C441.629,120.479 441.629,497.755 441.629,497.755 z".replace(/\s+/,""),fill:"url(#Gradient_1)"}),(0,jsx_runtime.jsx)("path",{d:"M441.629,497.755 C441.629,505.036 435.669,511 428.37,511 C428.37,511 83.63,511                   83.63,511 C76.338,511 70.371,505.036 70.371,497.755 C70.371,497.755                   70.371,14.576 70.371,14.576 C70.371,7.295 76.338,1.331 83.63,1.331 C83.63,1.331                   325.611,1.331 325.611,1.331 C325.611,1.331 441.629,120.479 441.629,120.479                   C441.629,120.479 441.629,497.755 441.629,497.755 z".replace(/\s+/,""),fillOpacity:"0",stroke:"#000000",strokeWidth:"1"})]}),(0,jsx_runtime.jsxs)("g",{id:"fold",children:[(0,jsx_runtime.jsx)("path",{d:"M326.343,1 C326.343,1 440.544,118.923 440.544,118.923 C440.544,118.923                   325.773,118.923 325.773,118.923 C325.773,118.923 326.343,1 326.343,1 z".replace(/\s+/,""),fill:"url(#Gradient_2)"}),(0,jsx_runtime.jsx)("path",{d:"M326.343,1 C326.343,1 440.544,118.923 440.544,118.923 C440.544,118.923                   325.773,118.923 325.773,118.923 C325.773,118.923 326.343,1 326.343,1 z".replace(/\s+/,""),fillOpacity:"0",stroke:"#000000",strokeWidth:"1"})]}),extension?(0,jsx_runtime.jsxs)("g",{id:"label",transform:"translate(-30)",children:[(0,jsx_runtime.jsx)("path",{d:"M37.454,58 L312.454,58 L312.454,188 L37.454,188 L37.454,58 z",fill:extColor}),(0,jsx_runtime.jsx)("text",{transform:"matrix(1, 0, 0, 1, 175.454, 123)",children:(0,jsx_runtime.jsx)("tspan",{x:"-72.536",y:"26.5",fontFamily:"HelveticaNeue-Bold",fontSize:"72",fill:"#FFFFFF",children:extension.toUpperCase()})})]}):null,(0,jsx_runtime.jsx)("g",{transform:"translate(-25)",children:extGlyph})]})]})})};FileIcon.displayName="FileIcon";try{FileIcon.displayName="FileIcon",FileIcon.__docgenInfo={description:"FileIcon React Stateless FileIcon",displayName:"FileIcon",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},filename:{defaultValue:null,description:"",name:"filename",required:!0,type:{name:"string"}},extension:{defaultValue:null,description:"",name:"extension",required:!0,type:{name:"string"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/media/manager/FileIcon.tsx#FileIcon"]={docgenInfo:FileIcon.__docgenInfo,name:"FileIcon",path:"src/components/media/manager/FileIcon.tsx#FileIcon"})}catch(__react_docgen_typescript_loader_error){}var ImageIcon=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/resolve-url-loader/index.js!./node_modules/@storybook/addon-styling/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[3]!./src/components/media/manager/ImageIcon.scss"),ImageIcon_options={};ImageIcon_options.styleTagTransform=styleTagTransform_default(),ImageIcon_options.setAttributes=setAttributesWithoutAttributes_default(),ImageIcon_options.insert=insertBySelector_default().bind(null,"head"),ImageIcon_options.domAPI=styleDomAPI_default(),ImageIcon_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(ImageIcon.Z,ImageIcon_options);ImageIcon.Z&&ImageIcon.Z.locals&&ImageIcon.Z.locals;var ImageIcon_ImageIcon=function ImageIcon(_ref){var className=_ref.className,url=_ref.url;return(0,jsx_runtime.jsx)("div",{className:"image-icon ".concat(className||""),children:(0,jsx_runtime.jsx)("img",{src:url})})};ImageIcon_ImageIcon.displayName="ImageIcon";try{ImageIcon_ImageIcon.displayName="ImageIcon",ImageIcon_ImageIcon.__docgenInfo={description:"ImageIcon React Stateless Component",displayName:"ImageIcon",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},filename:{defaultValue:null,description:"",name:"filename",required:!0,type:{name:"string"}},extension:{defaultValue:null,description:"",name:"extension",required:!0,type:{name:"string"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/media/manager/ImageIcon.tsx#ImageIcon"]={docgenInfo:ImageIcon_ImageIcon.__docgenInfo,name:"ImageIcon",path:"src/components/media/manager/ImageIcon.tsx#ImageIcon"})}catch(__react_docgen_typescript_loader_error){}var MediaIcon=function MediaIcon(_ref){var className=_ref.className,filename=_ref.filename,mimeType=_ref.mimeType,url=_ref.url,extensionMatches=filename.match(/\.[^.]+$/),extension=extensionMatches?extensionMatches[0].substr(1,3).toLowerCase():"",Icon=function getMediaIconRenderer(mimeType){return isImage(mimeType)?ImageIcon_ImageIcon:FileIcon}(mimeType);return(0,jsx_runtime.jsx)("div",{className:"media-icon ".concat(className||""),children:(0,jsx_runtime.jsx)(Icon,{filename,extension,url})})};MediaIcon.displayName="MediaIcon";try{MediaIcon.displayName="MediaIcon",MediaIcon.__docgenInfo={description:"MediaIcon React Stateless MediaIcon",displayName:"MediaIcon",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},filename:{defaultValue:null,description:"",name:"filename",required:!0,type:{name:"string"}},mimeType:{defaultValue:null,description:"",name:"mimeType",required:!0,type:{name:"string"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/media/manager/MediaIcon.tsx#MediaIcon"]={docgenInfo:MediaIcon.__docgenInfo,name:"MediaIcon",path:"src/components/media/manager/MediaIcon.tsx#MediaIcon"})}catch(__react_docgen_typescript_loader_error){}var MediaManager=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/resolve-url-loader/index.js!./node_modules/@storybook/addon-styling/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[3]!./src/components/media/manager/MediaManager.scss"),MediaManager_options={};MediaManager_options.styleTagTransform=styleTagTransform_default(),MediaManager_options.setAttributes=setAttributesWithoutAttributes_default(),MediaManager_options.insert=insertBySelector_default().bind(null,"head"),MediaManager_options.domAPI=styleDomAPI_default(),MediaManager_options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(MediaManager.Z,MediaManager_options);MediaManager.Z&&MediaManager.Z.locals&&MediaManager.Z.locals;var media=__webpack_require__("./src/data/persistence/media.ts");function upload_typeof(obj){return upload_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},upload_typeof(obj)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==upload_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var uploadFiles=function(){var _ref=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(projectSlug,files){var results,uploadFile;return _regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return results=[],uploadFile=function(){var _ref2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(file){return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(file.size>=367001600)){_context.next=2;break}throw new Error("File is too large");case 2:return _context.abrupt("return",media.Wm(projectSlug,file).then((function(result){return results.push(result),files.length>0?uploadFile(files.pop()):results})));case 3:case"end":return _context.stop()}}),_callee)})));return function uploadFile(_x3){return _ref2.apply(this,arguments)}}(),_context2.abrupt("return",uploadFile(files.pop()));case 3:case"end":return _context2.stop()}}),_callee2)})));return function uploadFiles(_x,_x2){return _ref.apply(this,arguments)}}(),VideoUploadWarning=function VideoUploadWarning(){return(0,jsx_runtime.jsxs)("div",{className:"alert alert-info show",role:"alert",children:["File uploads have a ",350,"mb limit. We recommend uploading your video to YouTube and then embedding that within your lesson for most uses."]})};function MediaManager_typeof(obj){return MediaManager_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},MediaManager_typeof(obj)}function MediaManager_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,MediaManager_toPropertyKey(descriptor.key),descriptor)}}function MediaManager_setPrototypeOf(o,p){return MediaManager_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},MediaManager_setPrototypeOf(o,p)}function MediaManager_createSuper(Derived){var hasNativeReflectConstruct=function MediaManager_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=MediaManager_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=MediaManager_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function MediaManager_possibleConstructorReturn(self,call){if(call&&("object"===MediaManager_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return MediaManager_assertThisInitialized(self)}(this,result)}}function MediaManager_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function MediaManager_getPrototypeOf(o){return MediaManager_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},MediaManager_getPrototypeOf(o)}function MediaManager_defineProperty(obj,key,value){return(key=MediaManager_toPropertyKey(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function MediaManager_toPropertyKey(arg){var key=function MediaManager_toPrimitive(input,hint){if("object"!==MediaManager_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==MediaManager_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===MediaManager_typeof(key)?key:String(key)}VideoUploadWarning.displayName="VideoUploadWarning";var MIMETYPE_FILTERS={IMAGE:["image/jpeg","image/png","image/tiff","image/gif"],AUDIO:["audio/mpeg","audio/wav","audio/mid","audio/mp4"],VIDEO:["video/mp4","video/mpeg","video/webm","video/ogg","video/quicktime"],HTML:["text/html"],CSV:["text/csv"],CAPTIONS:["text/vtt"],ALL:void 0},SELECTION_TYPES=function(SELECTION_TYPES){return SELECTION_TYPES[SELECTION_TYPES.MULTI=0]="MULTI",SELECTION_TYPES[SELECTION_TYPES.SINGLE=1]="SINGLE",SELECTION_TYPES[SELECTION_TYPES.NONE=2]="NONE",SELECTION_TYPES}({}),LAYOUTS=function(LAYOUTS){return LAYOUTS[LAYOUTS.GRID=0]="GRID",LAYOUTS[LAYOUTS.LIST=1]="LIST",LAYOUTS}({}),SORT_MAPPINGS={Newest:{orderBy:"dateCreated",order:"desc",icon:"fa fa-calendar"},Oldest:{orderBy:"dateCreated",order:"asc",icon:"fa fa-calendar"},"A-Z":{orderBy:"fileName",order:"asc",icon:"fas fa-sort-alpha-up"},"Z-A":{orderBy:"fileName",order:"desc",icon:"fas fa-sort-alpha-down"},Type:{orderBy:"mimeType",order:"asc",icon:"far fa-file-image"},"File Size":{orderBy:"fileSize",order:"asc",icon:"fas fa-sort-numeric-up"}},getSortMappingKey=function getSortMappingKey(orderBy,order){return Object.keys(SORT_MAPPINGS).find((function(key){return orderBy===SORT_MAPPINGS[key].orderBy&&(void 0===order||order===SORT_MAPPINGS[key].order)}))},MediaManager_MediaManager=function(_React$PureComponent){!function MediaManager_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&MediaManager_setPrototypeOf(subClass,superClass)}(MediaManager,_React$PureComponent);var _super=MediaManager_createSuper(MediaManager);function MediaManager(props){var _this;return function MediaManager_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,MediaManager),MediaManager_defineProperty(MediaManager_assertThisInitialized(_this=_super.call(this,props)),"isItemSelectable",(function(selectionType,item){return selectionType!==SELECTION_TYPES.NONE&&(!_this.props.mimeFilter||_this.props.mimeFilter.includes(item.mimeType))})),MediaManager_defineProperty(MediaManager_assertThisInitialized(_this),"displayMediaOfType",(function(mimeFilter){var _this$state=_this.state,searchText=_this$state.searchText,orderBy=_this$state.orderBy,order=_this$state.order;_this.props.onResetMedia(),_this.props.onLoadCourseMediaNextPage(_this.props.projectSlug,mimeFilter,searchText,orderBy,order).then((function(_){return _this.setState({filteredMimeTypes:mimeFilter})}))})),MediaManager_defineProperty(MediaManager_assertThisInitialized(_this),"mimeTypeFilter",(function(type){var filteredMimeTypes=_this.state.filteredMimeTypes;if(type===MIMETYPE_FILTERS.ALL||filteredMimeTypes===MIMETYPE_FILTERS.ALL)return type===filteredMimeTypes?"active":"";return function filtersAreSame(arr1,arr2){return arr1.reduce((function(acc,curr,i){return curr===arr2[i]&&acc}),!0)}(filteredMimeTypes,type)?"active":""})),MediaManager_defineProperty(MediaManager_assertThisInitialized(_this),"renderUploadingState",(function(){return _this.state.uploading?(0,jsx_runtime.jsx)("div",{className:"media-loading",children:(0,jsx_runtime.jsx)("h1",{children:"Uploading File"})}):null})),_this.state={selection:immutable_es.aV(),searchText:void 0,orderBy:SORT_MAPPINGS.Newest.orderBy,order:SORT_MAPPINGS.Newest.order,layout:LAYOUTS.GRID,showDetails:!0,error:tsmonad.Maybe.nothing(),filteredMimeTypes:props.mimeFilter,uploading:!1},_this.onScroll=_this.onScroll.bind(MediaManager_assertThisInitialized(_this)),_this.isSelected=_this.isSelected.bind(MediaManager_assertThisInitialized(_this)),_this.onSelect=_this.onSelect.bind(MediaManager_assertThisInitialized(_this)),_this.onSearch=_this.onSearch.bind(MediaManager_assertThisInitialized(_this)),_this.onChangeLayout=_this.onChangeLayout.bind(MediaManager_assertThisInitialized(_this)),_this}return function MediaManager_createClass(Constructor,protoProps,staticProps){return protoProps&&MediaManager_defineProperties(Constructor.prototype,protoProps),staticProps&&MediaManager_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(MediaManager,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this,_this$props=this.props,mimeFilter=_this$props.mimeFilter,initialSelectionPaths=_this$props.initialSelectionPaths,onLoadCourseMediaNextPage=_this$props.onLoadCourseMediaNextPage,onLoadMediaItemByPath=_this$props.onLoadMediaItemByPath,_this$state2=this.state,searchText=_this$state2.searchText,orderBy=_this$state2.orderBy,order=_this$state2.order;onLoadCourseMediaNextPage(this.props.projectSlug,mimeFilter,searchText,orderBy,order),initialSelectionPaths&&Promise.all(initialSelectionPaths.filter((function(path){return path})).map((function(path){return onLoadMediaItemByPath(_this2.props.projectSlug,path.replace(/^[./]+/,""))}))).then((function(mediaItems){1===mediaItems.length&&tsmonad.Maybe.isNothing(mediaItems[0])&&_this2.props.onNotFound&&_this2.props.onNotFound(),_this2.setState({selection:immutable_es.aV(mediaItems.map((function(mi){return mi.caseOf({just:function just(item){return item.guid},nothing:function nothing(){}})})).filter((function(i){return i}))),error:tsmonad.Maybe.nothing()})})).catch((function(e){return _this2.setState({error:tsmonad.Maybe.just(e.message)})}))}},{key:"componentWillUnmount",value:function componentWillUnmount(){var onResetMedia=this.props.onResetMedia;this.scrollView.removeEventListener("scroll",this.onScroll),onResetMedia()}},{key:"onUploadClick",value:function onUploadClick(id){window.$("#"+id).trigger("click")}},{key:"setupScrollListener",value:function setupScrollListener(scrollView){scrollView&&(this.scrollView&&this.scrollView.removeEventListener("scroll",this.onScroll),this.scrollView=scrollView,this.scrollView.addEventListener("scroll",this.onScroll))}},{key:"onScroll",value:function onScroll(){var _this$props2=this.props,media=_this$props2.media,onLoadCourseMediaNextPage=_this$props2.onLoadCourseMediaNextPage,_this$state3=this.state,searchText=_this$state3.searchText,orderBy=_this$state3.orderBy,order=_this$state3.order,filteredMimeTypes=_this$state3.filteredMimeTypes,isLoadingMedia=media.isLoading;media.items.size>=media.totalItems?this.scrollView.removeEventListener("scroll",this.onScroll):!isLoadingMedia&&this.scrollView.scrollTop+100>this.scrollContent.offsetHeight-this.scrollView.offsetHeight&&onLoadCourseMediaNextPage(this.props.projectSlug,filteredMimeTypes,searchText,orderBy,order)}},{key:"onFileUpload",value:function onFileUpload(files){for(var _this3=this,_this$props3=this.props,mimeFilter=_this$props3.mimeFilter,onLoadCourseMediaNextPage=_this$props3.onLoadCourseMediaNextPage,onResetMedia=_this$props3.onResetMedia,_this$state4=this.state,searchText=_this$state4.searchText,orderBy=_this$state4.orderBy,order=_this$state4.order,fileList=[],i=0;i<files.length;i+=1)fileList.push(files[i]);this.setState({uploading:!0}),uploadFiles(this.props.projectSlug,fileList).then((function(result){onResetMedia(),onLoadCourseMediaNextPage(_this3.props.projectSlug,mimeFilter,searchText,orderBy,order).then((function(mediaItems){mediaItems.lift((function(files){files.size>0&&tsmonad.Maybe.maybe(files.find((function(f){return f.url===(result[0]&&result[0].url)}))).lift((function(file){return _this3.onSelect(file.guid)}))}))})).then((function(){return _this3.setState({error:tsmonad.Maybe.nothing()})}))})).catch((function(e){"string"==typeof e?_this3.setState({error:tsmonad.Maybe.just(e)}):_this3.setState({error:tsmonad.Maybe.just(e.message)})})).finally((function(){return _this3.setState({uploading:!1})}))}},{key:"onChangeLayout",value:function onChangeLayout(newLayout){this.setState({layout:newLayout})}},{key:"isSelected",value:function isSelected(guid){return this.state.selection.includes(guid)}},{key:"onSelect",value:function onSelect(guid){var _this$props4=this.props,media=_this$props4.media,selectionType=_this$props4.selectionType,onSelectionChange=_this$props4.onSelectionChange,updatedSelection=this.state.selection;if(selectionType===SELECTION_TYPES.SINGLE)updatedSelection=immutable_es.aV([guid]);else{if(selectionType!==SELECTION_TYPES.MULTI)return;updatedSelection=this.isSelected(guid)?updatedSelection.remove(updatedSelection.findIndex((function(s){return s===guid}))):updatedSelection.push(guid)}this.setState({selection:updatedSelection});var mediaLibrary=media;mediaLibrary&&onSelectionChange(updatedSelection.map((function(s){return mediaLibrary.getItem(s)})).toArray())}},{key:"onSearch",value:function onSearch(searchText){var _this$props5=this.props,onLoadCourseMediaNextPage=_this$props5.onLoadCourseMediaNextPage,onResetMedia=_this$props5.onResetMedia,_this$state5=this.state,orderBy=_this$state5.orderBy,order=_this$state5.order,filteredMimeTypes=_this$state5.filteredMimeTypes;onResetMedia(),onLoadCourseMediaNextPage(this.props.projectSlug,filteredMimeTypes,searchText,orderBy,order)}},{key:"onSortChange",value:function onSortChange(sortKey){var _this$props6=this.props,onLoadCourseMediaNextPage=_this$props6.onLoadCourseMediaNextPage,onResetMedia=_this$props6.onResetMedia,_this$state6=this.state,searchText=_this$state6.searchText,filteredMimeTypes=_this$state6.filteredMimeTypes;this.setState({orderBy:SORT_MAPPINGS[sortKey].orderBy,order:SORT_MAPPINGS[sortKey].order}),onResetMedia(),onLoadCourseMediaNextPage(this.props.projectSlug,filteredMimeTypes,searchText,SORT_MAPPINGS[sortKey].orderBy,SORT_MAPPINGS[sortKey].order)}},{key:"renderMediaList",value:function renderMediaList(disabled){var _this4=this,_this$props7=this.props,media=_this$props7.media,selectionType=_this$props7.selectionType,isLoadingMedia=media.isLoading,allItemsLoaded=media.allItemsLoaded(),mediaItems=media.getItems(),mediaItemRefs=media.references;return(0,jsx_runtime.jsxs)("div",{className:"media-list",children:[(0,jsx_runtime.jsxs)("div",{className:"list-header",children:[(0,jsx_runtime.jsx)("div",{className:"sel-col"}),(0,jsx_runtime.jsx)("div",{className:"name-col",children:"Name"}),(0,jsx_runtime.jsx)("div",{className:"refs-col",children:"References"}),(0,jsx_runtime.jsx)("div",{className:"date-col",children:"Date Modified"}),(0,jsx_runtime.jsx)("div",{className:"size-col",children:"Size"})]}),(0,jsx_runtime.jsx)("div",{className:"list-body",ref:function ref(el){return _this4.setupScrollListener(el)},children:(0,jsx_runtime.jsxs)("div",{ref:function ref(el){return _this4.scrollContent=el},children:[mediaItems.map((function(item){return(0,jsx_runtime.jsxs)("div",{className:"media-item ".concat(_this4.isSelected(item.guid)?"selected":""," ")+"".concat(_this4.isItemSelectable(selectionType,item)&&!disabled?"selectable":"not-selectable"),onClick:function onClick(){return _this4.isItemSelectable(selectionType,item)&&!disabled?_this4.onSelect(item.guid):null},children:[(0,jsx_runtime.jsx)("div",{className:"sel-col",children:(0,jsx_runtime.jsx)("input",{type:"checkbox",readOnly:!0,className:"selection-check",checked:_this4.isSelected(item.guid),onClick:function onClick(){return _this4.onSelect(item.guid)}})}),(0,jsx_runtime.jsxs)("div",{className:"name-col",children:[(0,jsx_runtime.jsx)(MediaIcon,{filename:item.fileName,mimeType:item.mimeType,url:item.url})," ".concat(item.fileName)]}),(0,jsx_runtime.jsx)("div",{className:"refs-col",children:mediaItemRefs.get(item.guid)&&mediaItemRefs.get(item.guid).size}),(0,jsx_runtime.jsx)("div",{className:"date-col",children:item.dateUpdated}),(0,jsx_runtime.jsx)("div",{className:"size-col",children:convert_toByteNotation(item.fileSize)})]},item.guid)})),isLoadingMedia&&!allItemsLoaded?(0,jsx_runtime.jsx)(LoadingSpinner,{size:LoadingSpinnerSize.Small,className:"p-3",children:"Hang on while we load your items..."},"loading"):null]})})]})}},{key:"renderMediaGrid",value:function renderMediaGrid(disabled){var _this5=this,_this$props8=this.props,media=_this$props8.media,selectionType=_this$props8.selectionType,isLoadingMedia=media.isLoading,allItemsLoaded=media.allItemsLoaded(),mediaItems=media.getItems();return(0,jsx_runtime.jsxs)("div",{className:"media-grid",ref:function ref(el){return _this5.setupScrollListener(el)},children:[(0,jsx_runtime.jsx)("div",{className:"scroll-content",ref:function ref(el){return _this5.scrollContent=el},children:mediaItems.map((function(item){return(0,jsx_runtime.jsxs)("div",{className:"media-item ".concat(_this5.isSelected(item.guid)?"selected":""," ")+"".concat(_this5.isItemSelectable(selectionType,item)&&!disabled?"selectable":"not-selectable"),onClick:function onClick(){return _this5.isItemSelectable(selectionType,item)&&!disabled?_this5.onSelect(item.guid):null},children:[(0,jsx_runtime.jsx)("input",{type:"checkbox",readOnly:!0,className:"selection-check",checked:_this5.isSelected(item.guid),onClick:function onClick(){return _this5.onSelect(item.guid)}}),(0,jsx_runtime.jsx)(MediaIcon,{filename:item.fileName,mimeType:item.mimeType,url:item.url}),(0,jsx_runtime.jsx)("div",{className:"name",children:stringFormat_ellipsize(item.fileName,26,5)})]},item.guid)}))}),isLoadingMedia&&!allItemsLoaded?(0,jsx_runtime.jsx)(LoadingSpinner,{size:LoadingSpinnerSize.Small,className:"p-3",children:"Hang on while we load your items..."},"loading"):null]})}},{key:"renderMediaSelectionDetails",value:function renderMediaSelectionDetails(disabled){var media=this.props.media,_this$state7=this.state,selection=_this$state7.selection,showDetails=_this$state7.showDetails,selectedMediaItems=selection.map((function(guid){return media.data.get(guid)})).filter((function(item){return!!item}));if(selectedMediaItems.size>1)return(0,jsx_runtime.jsx)("div",{className:"media-selection-details",children:(0,jsx_runtime.jsx)("div",{className:"details-title",children:"Multiple Items Selected"})});if(selectedMediaItems.size>0){var selectedItem=selectedMediaItems.first();return(0,jsx_runtime.jsxs)("div",{className:"media-selection-details",children:[(0,jsx_runtime.jsxs)("div",{className:"details-title",children:[(0,jsx_runtime.jsxs)("span",{children:["Selected:"," ",(0,jsx_runtime.jsx)("a",{href:selectedItem.url,rel:"noreferrer",target:"_blank",onClick:function onClick(e){disabled||function popOpenImage(e){var link=e.target;window.open(link.href,link.target||"_blank","menubar=no,toolbar=no,location=no,directories=no,status=no,scrollbars=no,resizable=no,dependent,width=800,height=620")}(e)},children:stringFormat_ellipsize(selectedItem.fileName,65,5)})]}),showDetails?(0,jsx_runtime.jsx)("i",{className:"fa-solid fa-angle-down"}):(0,jsx_runtime.jsx)("i",{className:"fa-solid fa-angle-up"})]}),showDetails&&(0,jsx_runtime.jsxs)("div",{className:"details-content",children:[(0,jsx_runtime.jsx)(MediaIcon,{filename:selectedItem.fileName,mimeType:selectedItem.mimeType,url:selectedItem.url}),(0,jsx_runtime.jsxs)("div",{className:"details-info",children:[(0,jsx_runtime.jsxs)("div",{className:"detail-row date-created",children:[(0,jsx_runtime.jsx)("b",{children:"Uploaded:"})," ",relativeToNow(new Date(selectedItem.dateCreated))]}),(0,jsx_runtime.jsxs)("div",{className:"detail-row file-size",children:[(0,jsx_runtime.jsx)("b",{children:"Size:"})," ",convert_toByteNotation(selectedItem.fileSize)]})]})]})]})}}},{key:"renderError",value:function renderError(){return this.state.error.caseOf({just:function just(error){return(0,jsx_runtime.jsxs)("div",{className:"alert alert-danger fade show",role:"alert",children:["Error: Could not upload file.",(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("i",{children:error})]})},nothing:function nothing(){return null}})}},{key:"render",value:function render(){var _this7=this,_this$props9=this.props,className=_this$props9.className,mimeFilter=_this$props9.mimeFilter,media=_this$props9.media,_this$state8=this.state,searchText=_this$state8.searchText,layout=_this$state8.layout,orderBy=_this$state8.orderBy,order=_this$state8.order,disabled=void 0!==this.props.disabled&&this.props.disabled,id=(0,guid.Z)(),mediaCount={numResults:media.totalItemsLoaded,totalResults:media.totalItems};return(0,jsx_runtime.jsxs)("div",{className:"media-manager ".concat(className||""),children:[this.renderError(),this.renderUploadingState(),this.props.mimeFilter===MIMETYPE_FILTERS.VIDEO&&(0,jsx_runtime.jsx)(VideoUploadWarning,{}),(0,jsx_runtime.jsxs)("div",{className:"media-toolbar",children:[(0,jsx_runtime.jsx)("input",{id,style:{display:"none"},disabled,accept:mimeFilter&&"".concat(mimeFilter),multiple:!0,onChange:function onChange(_ref){var files=_ref.target.files;return _this7.onFileUpload(files)},type:"file"}),(0,jsx_runtime.jsx)("div",{className:"media-toolbar-item",children:(0,jsx_runtime.jsxs)("button",{disabled,className:"btn btn-primary media-toolbar-item upload",onClick:function onClick(){return _this7.onUploadClick(id)},children:[(0,jsx_runtime.jsx)("i",{className:"fa fa-upload"})," Upload"]})}),(0,jsx_runtime.jsxs)("div",{className:"media-toolbar-item btn-group layout-control",children:[(0,jsx_runtime.jsxs)("button",{disabled,className:"btn btn-outline-primary ".concat(layout===LAYOUTS.GRID?"selected":""),onClick:function onClick(){return _this7.onChangeLayout(LAYOUTS.GRID)},children:[(0,jsx_runtime.jsx)("i",{className:"fa fa-th"})," Grid"]}),(0,jsx_runtime.jsxs)("button",{disabled,className:"btn btn-outline-primary ".concat(layout===LAYOUTS.LIST?"selected":""),onClick:function onClick(){return _this7.onChangeLayout(LAYOUTS.LIST)},children:[(0,jsx_runtime.jsx)("i",{className:"fa fa-th-list"})," List"]})]}),(0,jsx_runtime.jsx)("div",{className:"flex-grow-1"}),(0,jsx_runtime.jsxs)(Dropdown.Z,{className:"media-toolbar-item sort-control dropdown",children:["Sort by: ",(0,jsx_runtime.jsxs)(Dropdown.Z.Toggle,{className:"sort-btn",variant:"none",children:[(0,jsx_runtime.jsx)("i",{className:(0,classNames.A)(SORT_MAPPINGS[getSortMappingKey(orderBy,order)].icon,"mr-2")})," ".concat(getSortMappingKey(orderBy,order)),(0,jsx_runtime.jsx)("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"caret-down",className:"w-2 ml-2",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",children:(0,jsx_runtime.jsx)("path",{fill:"currentColor",d:"M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"})})]}),(0,jsx_runtime.jsx)(Dropdown.Z.Menu,{children:Object.keys(SORT_MAPPINGS).map((function(sortKey){return(0,jsx_runtime.jsx)(Dropdown.Z.Item,{disabled,type:"button",className:"dropdown-item",onClick:function onClick(){return _this7.onSortChange(sortKey)},children:sortKey},sortKey)}))})]}),(0,jsx_runtime.jsx)("div",{className:"media-toolbar-item search",children:(0,jsx_runtime.jsx)("div",{className:"input-group",children:(0,jsx_runtime.jsx)("input",{disabled,type:"text",className:"form-control",placeholder:"Search",value:searchText,onChange:function onChange(_ref2){var value=_ref2.target.value;return _this7.onSearch(value)}})})})]}),(0,jsx_runtime.jsxs)("div",{className:"media-library",children:[(0,jsx_runtime.jsxs)("ol",{className:"media-sidebar text-center",children:[(0,jsx_runtime.jsx)("li",{className:this.mimeTypeFilter(MIMETYPE_FILTERS.ALL),onClick:function onClick(){return _this7.displayMediaOfType(MIMETYPE_FILTERS.ALL)},children:"All Media"}),(0,jsx_runtime.jsx)("li",{className:this.mimeTypeFilter(MIMETYPE_FILTERS.IMAGE),onClick:function onClick(){return _this7.displayMediaOfType(MIMETYPE_FILTERS.IMAGE)},children:"Images"}),(0,jsx_runtime.jsx)("li",{className:this.mimeTypeFilter(MIMETYPE_FILTERS.AUDIO),onClick:function onClick(){return _this7.displayMediaOfType(MIMETYPE_FILTERS.AUDIO)},children:"Audio"}),(0,jsx_runtime.jsx)("li",{className:this.mimeTypeFilter(MIMETYPE_FILTERS.VIDEO),onClick:function onClick(){return _this7.displayMediaOfType(MIMETYPE_FILTERS.VIDEO)},children:(0,jsx_runtime.jsx)("span",{children:"Video"})})]}),(0,jsx_runtime.jsxs)("div",{className:"media-content",children:[layout===LAYOUTS.GRID?this.renderMediaGrid(disabled):this.renderMediaList(disabled),this.renderMediaSelectionDetails(disabled)]})]}),(0,jsx_runtime.jsxs)("div",{className:"media-infobar",children:[(0,jsx_runtime.jsx)("div",{className:"flex-spacer"}),mediaCount&&mediaCount.totalResults>-1/0&&(0,jsx_runtime.jsxs)("div",{children:["Showing ",mediaCount.numResults," of ",mediaCount.totalResults]})]})]})}}]),MediaManager}(react.PureComponent);MediaManager_MediaManager.displayName="MediaManager";try{MediaManager_MediaManager.displayName="MediaManager",MediaManager_MediaManager.__docgenInfo={description:"MediaManager React Component",displayName:"MediaManager",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},projectSlug:{defaultValue:null,description:"",name:"projectSlug",required:!0,type:{name:"string"}},media:{defaultValue:null,description:"",name:"media",required:!0,type:{name:"OrderedMediaLibrary"}},mimeFilter:{defaultValue:null,description:"",name:"mimeFilter",required:!1,type:{name:"string[]"}},selectionType:{defaultValue:null,description:"",name:"selectionType",required:!0,type:{name:"enum",value:[{value:"0"},{value:"1"},{value:"2"}]}},initialSelectionPaths:{defaultValue:null,description:"",name:"initialSelectionPaths",required:!1,type:{name:"string[]"}},onLoadCourseMediaNextPage:{defaultValue:null,description:"",name:"onLoadCourseMediaNextPage",required:!0,type:{name:"(projectSlug: string, mimeFilter: string[] | undefined, searchText: string, orderBy: string, order: string) => Promise<Maybe<List<MediaItem>>>"}},onResetMedia:{defaultValue:null,description:"",name:"onResetMedia",required:!0,type:{name:"() => void"}},onSelectionChange:{defaultValue:null,description:"",name:"onSelectionChange",required:!0,type:{name:"(selection: MediaItem[]) => void"}},onLoadMediaItemByPath:{defaultValue:null,description:"",name:"onLoadMediaItemByPath",required:!0,type:{name:"(projectSlug: string, path: string) => Promise<Maybe<MediaItem>>"}},onNotFound:{defaultValue:null,description:"",name:"onNotFound",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/media/manager/MediaManager.tsx#MediaManager"]={docgenInfo:MediaManager_MediaManager.__docgenInfo,name:"MediaManager",path:"src/components/media/manager/MediaManager.tsx#MediaManager"})}catch(__react_docgen_typescript_loader_error){}var app_slice=__webpack_require__("./src/apps/authoring/store/app/slice.ts");function Collapse_typeof(obj){return Collapse_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},Collapse_typeof(obj)}function Collapse_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(arg=descriptor.key,key=void 0,key=function Collapse_toPrimitive(input,hint){if("object"!==Collapse_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==Collapse_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string"),"symbol"===Collapse_typeof(key)?key:String(key)),descriptor)}var arg,key}function Collapse_setPrototypeOf(o,p){return Collapse_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},Collapse_setPrototypeOf(o,p)}function Collapse_createSuper(Derived){var hasNativeReflectConstruct=function Collapse_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Collapse_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Collapse_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function Collapse_possibleConstructorReturn(self,call){if(call&&("object"===Collapse_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return Collapse_assertThisInitialized(self)}(this,result)}}function Collapse_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function Collapse_getPrototypeOf(o){return Collapse_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Collapse_getPrototypeOf(o)}var Collapse=function(_React$PureComponent){!function Collapse_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&Collapse_setPrototypeOf(subClass,superClass)}(Collapse,_React$PureComponent);var _super=Collapse_createSuper(Collapse);function Collapse(props){var _this;return function Collapse_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Collapse),(_this=_super.call(this,props)).id=(0,guid.Z)(),_this.state={collapsed:!0},_this.onClick=_this.onClick.bind(Collapse_assertThisInitialized(_this)),_this}return function Collapse_createClass(Constructor,protoProps,staticProps){return protoProps&&Collapse_defineProperties(Constructor.prototype,protoProps),staticProps&&Collapse_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Collapse,[{key:"onClick",value:function onClick(){this.setState({collapsed:!this.state.collapsed})}},{key:"render",value:function render(){var collapsedOrNot=this.state.collapsed?"collapse":"collapse.show",detailsOrExpanded=null;void 0!==this.props.details&&this.state.collapsed?detailsOrExpanded=this.props.details:void 0===this.props.expanded||this.state.collapsed||(detailsOrExpanded=this.props.expanded);var indicator=this.state.collapsed?"+":"-";return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("button",{onClick:this.onClick,type:"button",className:"btn btn-link",children:[indicator," ",this.props.caption]}),detailsOrExpanded,(0,jsx_runtime.jsx)("div",{className:collapsedOrNot,id:this.id,children:this.props.children})]})}}]),Collapse}(react.PureComponent);Collapse.displayName="Collapse";try{Collapse.displayName="Collapse",Collapse.__docgenInfo={description:"",displayName:"Collapse",props:{caption:{defaultValue:null,description:"",name:"caption",required:!0,type:{name:"string"}},details:{defaultValue:null,description:"",name:"details",required:!1,type:{name:"string"}},expanded:{defaultValue:null,description:"",name:"expanded",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/common/Collapse.tsx#Collapse"]={docgenInfo:Collapse.__docgenInfo,name:"Collapse",path:"src/components/common/Collapse.tsx#Collapse"})}catch(__react_docgen_typescript_loader_error){}function ErrorBoundary_typeof(obj){return ErrorBoundary_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},ErrorBoundary_typeof(obj)}function ErrorBoundary_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,ErrorBoundary_toPropertyKey(descriptor.key),descriptor)}}function ErrorBoundary_setPrototypeOf(o,p){return ErrorBoundary_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},ErrorBoundary_setPrototypeOf(o,p)}function ErrorBoundary_createSuper(Derived){var hasNativeReflectConstruct=function ErrorBoundary_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=ErrorBoundary_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=ErrorBoundary_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function ErrorBoundary_possibleConstructorReturn(self,call){if(call&&("object"===ErrorBoundary_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function ErrorBoundary_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function ErrorBoundary_getPrototypeOf(o){return ErrorBoundary_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},ErrorBoundary_getPrototypeOf(o)}function ErrorBoundary_toPropertyKey(arg){var key=function ErrorBoundary_toPrimitive(input,hint){if("object"!==ErrorBoundary_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==ErrorBoundary_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===ErrorBoundary_typeof(key)?key:String(key)}var AppsignalContext=react.createContext(null);AppsignalContext.displayName="Appsignal";var DefaultErrorMessage=function DefaultErrorMessage(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("p",{className:"mb-4",children:"Something went wrong. Please refresh the page and try again."}),(0,jsx_runtime.jsx)("hr",{}),(0,jsx_runtime.jsx)("p",{children:"If the problem persists, contact support with the following details:"})]})},lastReported=null,ErrorBoundary=function(_React$Component){!function ErrorBoundary_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&ErrorBoundary_setPrototypeOf(subClass,superClass)}(ErrorBoundary,_React$Component);var _super=ErrorBoundary_createSuper(ErrorBoundary);function ErrorBoundary(props){var _this;return function ErrorBoundary_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ErrorBoundary),(_this=_super.call(this,props)).state={hasError:!1,error:null,info:null,id:(0,guid.Z)()},_this}return function ErrorBoundary_createClass(Constructor,protoProps,staticProps){return protoProps&&ErrorBoundary_defineProperties(Constructor.prototype,protoProps),staticProps&&ErrorBoundary_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(ErrorBoundary,[{key:"componentDidCatch",value:function componentDidCatch(error,info){(console.error(error),this.context)&&(lastReported!==error&&(this.context.sendError(error),lastReported=error));this.setState({hasError:!0,error,info})}},{key:"render",value:function render(){try{var _this$state$error,_this$state$error2,_this$state$info;return this.state.hasError?(0,jsx_runtime.jsxs)("div",{className:"alert alert-warning",role:"alert",children:[this.props.errorMessage,(0,jsx_runtime.jsx)(Collapse,{caption:"Show error message",children:(0,jsx_runtime.jsxs)("div",{style:{fontFamily:"monospace",wordBreak:"break-word"},children:[(0,jsx_runtime.jsx)("h4",{children:null===(_this$state$error=this.state.error)||void 0===_this$state$error?void 0:_this$state$error.message}),(0,jsx_runtime.jsx)("p",{children:null===(_this$state$error2=this.state.error)||void 0===_this$state$error2?void 0:_this$state$error2.stack}),(0,jsx_runtime.jsx)("p",{children:null===(_this$state$info=this.state.info)||void 0===_this$state$info?void 0:_this$state$info.componentStack})]})})]}):this.props.children}catch(error){console.error(error)}}}]),ErrorBoundary}(react.Component);!function ErrorBoundary_defineProperty(obj,key,value){return(key=ErrorBoundary_toPropertyKey(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}(ErrorBoundary,"defaultProps",{errorMessage:(0,jsx_runtime.jsx)(DefaultErrorMessage,{})}),ErrorBoundary.displayName="ErrorBoundary",ErrorBoundary.contextType=AppsignalContext;try{ErrorBoundary.displayName="Appsignal",ErrorBoundary.__docgenInfo={description:"",displayName:"Appsignal",props:{errorMessage:{defaultValue:{value:"<DefaultErrorMessage />"},description:"",name:"errorMessage",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/common/ErrorBoundary.tsx#Appsignal"]={docgenInfo:Appsignal.__docgenInfo,name:"Appsignal",path:"src/components/common/ErrorBoundary.tsx#Appsignal"})}catch(__react_docgen_typescript_loader_error){}var fetchCourseMediaNextPage=function fetchCourseMediaNextPage(courseId,mimeFilter,searchText,orderBy,order){return function(dispatch,getState){var offset=getState().media.items.size||0;return dispatch(function fetchCourseMedia(courseId,offset,limit,mimeFilter,searchText,orderBy,order){return function(dispatch,getState){var reqId=(0,guid.Z)();return dispatch(function fetchMediaPage(courseId,reqId){return{type:"media/FETCH_MEDIA_PAGE",courseId,reqId}}(courseId,reqId)),media.xY(courseId,offset,limit,mimeFilter,void 0,searchText,orderBy,order).then((function(response){if("success"===response.type){var items=(0,immutable_es.aV)(response.results);return getState().media.lastReqId===reqId&&dispatch(function receiveMediaPage(courseId,items,totalItems){return{type:"media/RECEIVE_MEDIA_PAGE",courseId,items,totalItems}}(courseId,items,response.totalResults)),tsmonad.Maybe.just(items)}return tsmonad.Maybe.nothing()})).catch((function(){return tsmonad.Maybe.nothing()}))}}(courseId,offset,60,mimeFilter,searchText,orderBy,order))}},controller=(0,es.$j)((function mapStateToProps(state,_ownProps){return{media:state.media}}),(function mapDispatchToProps(dispatch,_ownProps){return{onLoadCourseMediaNextPage:function onLoadCourseMediaNextPage(projectSlug,mimeFilter,searchText,orderBy,order){return dispatch(fetchCourseMediaNextPage(projectSlug,mimeFilter,searchText,orderBy,order))},onResetMedia:function onResetMedia(){dispatch({type:"media/RESET_MEDIA"})},onLoadMediaItemByPath:function onLoadMediaItemByPath(projectSlug,path){return dispatch(function fetchMediaItemByPath(courseId,url){return function(_dispatch,_getState){return media.xY(courseId,0,1,void 0,url).then((function(response){if("success"===response.type){var data=(0,immutable_es.D5)(response.results.map((function(item){return[item.guid,item]})));if(data.size>0)return tsmonad.Maybe.just(data.first())}return tsmonad.Maybe.nothing()}))}}(projectSlug,path))}}}))(MediaManager_MediaManager);function UrlOrUpload_slicedToArray(arr,i){return function UrlOrUpload_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function UrlOrUpload_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function UrlOrUpload_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return UrlOrUpload_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UrlOrUpload_arrayLikeToArray(o,minLen)}(arr,i)||function UrlOrUpload_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function UrlOrUpload_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var UrlOrUpload=function UrlOrUpload(props){var _props$initialSelecti,_props$initialSelecti2,onUrlChange=props.onUrlChange,_useState2=UrlOrUpload_slicedToArray((0,react.useState)("library"),2),source=_useState2[0],setSource=_useState2[1],_useState4=UrlOrUpload_slicedToArray((0,react.useState)(null!==(_props$initialSelecti=null===(_props$initialSelecti2=props.initialSelectionPaths)||void 0===_props$initialSelecti2?void 0:_props$initialSelecti2[0])&&void 0!==_props$initialSelecti?_props$initialSelecti:""),2),url=_useState4[0],setUrl=_useState4[1],whenActive=(0,react.useCallback)((function(s,c){return s===source&&c}),[source]),onNotFound=(0,react.useCallback)((function(){url&&"/images/placeholder-image.svg"!==url&&setSource("url")}),[url]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"nav nav-tabs flex mb-1",children:[(0,jsx_runtime.jsx)("button",{className:(0,classNames.A)("nav-link",whenActive("library","active")),onClick:function onClick(){return setSource("library")},children:"Media Library"}),props.externalUrlAllowed&&(0,jsx_runtime.jsx)("button",{className:(0,classNames.A)("nav-link",whenActive("url","active")),onClick:function onClick(){return setSource("url")},children:"External URL"})]}),(0,jsx_runtime.jsxs)("div",{className:"tab-content py-3",children:[(0,jsx_runtime.jsx)("div",{className:(0,classNames.A)("tab-pane fade",whenActive("library","show active")),id:"home",role:"tabpanel","aria-labelledby":"home-tab",children:(0,jsx_runtime.jsx)(ErrorBoundary,{errorMessage:(0,jsx_runtime.jsx)(MediaManagerError,{}),children:(0,jsx_runtime.jsx)(controller,{onNotFound,projectSlug:props.projectSlug,mimeFilter:props.mimeFilter,selectionType:SELECTION_TYPES.SINGLE,initialSelectionPaths:props.initialSelectionPaths,onSelectionChange:props.onMediaSelectionChange})})}),(0,jsx_runtime.jsx)("div",{className:(0,classNames.A)("tab-pane fade",whenActive("url","show active")),id:"profile",role:"tabpanel","aria-labelledby":"profile-tab",children:(0,jsx_runtime.jsxs)("div",{className:"media-url mb-4",children:[(0,jsx_runtime.jsx)("input",{className:"form-control w-100",placeholder:"Enter the media URL address",value:url,onChange:function onChange(_ref){var value=_ref.target.value;setUrl(value),onUrlChange(value)}}),props.children]})})]})]})},MediaManagerError=function MediaManagerError(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("p",{className:"mb-4",children:"Something went wrong accessing the media manager, please try again."}),(0,jsx_runtime.jsx)("hr",{}),(0,jsx_runtime.jsx)("p",{children:"If the problem persists, contact support with the following details:"})]})};UrlOrUpload.defaultProps={externalUrlAllowed:!0};try{UrlOrUpload.displayName="UrlOrUpload",UrlOrUpload.__docgenInfo={description:"",displayName:"UrlOrUpload",props:{projectSlug:{defaultValue:null,description:"",name:"projectSlug",required:!0,type:{name:"string"}},mimeFilter:{defaultValue:null,description:"",name:"mimeFilter",required:!1,type:{name:"string[]"}},selectionType:{defaultValue:null,description:"",name:"selectionType",required:!0,type:{name:"enum",value:[{value:"0"},{value:"1"},{value:"2"}]}},initialSelectionPaths:{defaultValue:null,description:"",name:"initialSelectionPaths",required:!1,type:{name:"string[]"}},onMediaSelectionChange:{defaultValue:null,description:"",name:"onMediaSelectionChange",required:!0,type:{name:"(items: MediaItem[]) => void"}},onUrlChange:{defaultValue:null,description:"",name:"onUrlChange",required:!0,type:{name:"(url: string) => void"}},externalUrlAllowed:{defaultValue:{value:"true"},description:"",name:"externalUrlAllowed",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/media/UrlOrUpload.tsx#UrlOrUpload"]={docgenInfo:UrlOrUpload.__docgenInfo,name:"UrlOrUpload",path:"src/components/media/UrlOrUpload.tsx#UrlOrUpload"})}catch(__react_docgen_typescript_loader_error){}var MediaPickerModal=function MediaPickerModal(_ref){var projectSlug=_ref.projectSlug,initialSelection=_ref.initialSelection,onCancel=_ref.onCancel,onOK=_ref.onOK,onUrlChanged=_ref.onUrlChanged,mimeFilter=_ref.mimeFilter,title=_ref.title,onMediaSelected=(0,react.useCallback)((function(items){items.length>0&&onUrlChanged(items[0].url)}),[onUrlChanged]);return(0,jsx_runtime.jsxs)(Modal.Z,{show:!0,size:"xl",onHide:onCancel,children:[(0,jsx_runtime.jsx)(Modal.Z.Header,{closeButton:!0,children:(0,jsx_runtime.jsx)("h3",{className:"modal-title",children:title})}),(0,jsx_runtime.jsx)(Modal.Z.Body,{children:(0,jsx_runtime.jsx)(UrlOrUpload,{onUrlChange:onUrlChanged,onMediaSelectionChange:onMediaSelected,projectSlug,mimeFilter,selectionType:SELECTION_TYPES.SINGLE,initialSelectionPaths:initialSelection?[initialSelection]:[]})}),(0,jsx_runtime.jsxs)(Modal.Z.Footer,{children:[(0,jsx_runtime.jsx)(Button.Z,{type:"button",variant:"secondary",onClick:onCancel,children:"Cancel"}),(0,jsx_runtime.jsx)(Button.Z,{type:"button",variant:"primary",onClick:onOK,children:"OK"})]})]})};MediaPickerModal.displayName="MediaPickerModal",MediaPickerModal.defaultProps={mimeFilter:MIMETYPE_FILTERS.IMAGE,title:"Select Image"};try{MediaPickerModal.displayName="MediaPickerModal",MediaPickerModal.__docgenInfo={description:"Media manager component wrapped in a react-bootstrap modal, initially for advanced authoring environment usage.",displayName:"MediaPickerModal",props:{initialSelection:{defaultValue:null,description:"",name:"initialSelection",required:!0,type:{name:"string"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}},onOK:{defaultValue:null,description:"",name:"onOK",required:!0,type:{name:"() => void"}},projectSlug:{defaultValue:null,description:"",name:"projectSlug",required:!0,type:{name:"string"}},onUrlChanged:{defaultValue:null,description:"",name:"onUrlChanged",required:!0,type:{name:"(url: string) => void"}},mimeFilter:{defaultValue:{value:"['image/jpeg', 'image/png', 'image/tiff', 'image/gif']"},description:"",name:"mimeFilter",required:!1,type:{name:"string[]"}},title:{defaultValue:{value:"Select Image"},description:"",name:"title",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/MediaPickerModal.tsx#MediaPickerModal"]={docgenInfo:MediaPickerModal.__docgenInfo,name:"MediaPickerModal",path:"src/apps/authoring/components/Modal/MediaPickerModal.tsx#MediaPickerModal"})}catch(__react_docgen_typescript_loader_error){}function TorusMediaBrowserWrapper_typeof(obj){return TorusMediaBrowserWrapper_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},TorusMediaBrowserWrapper_typeof(obj)}function TorusMediaBrowserWrapper_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function TorusMediaBrowserWrapper_defineProperty(obj,key,value){return(key=function TorusMediaBrowserWrapper_toPropertyKey(arg){var key=function TorusMediaBrowserWrapper_toPrimitive(input,hint){if("object"!==TorusMediaBrowserWrapper_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==TorusMediaBrowserWrapper_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===TorusMediaBrowserWrapper_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var TorusMediaBrowserWrapper=function TorusMediaBrowserWrapper(SubComponent){var Component=function Component(props){return(0,react.useContext)(es.ET)?(0,jsx_runtime.jsx)(SubComponent,function TorusMediaBrowserWrapper_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?TorusMediaBrowserWrapper_ownKeys(Object(source),!0).forEach((function(key){TorusMediaBrowserWrapper_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):TorusMediaBrowserWrapper_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},props)):(0,jsx_runtime.jsxs)("div",{className:"mb-0 form-group",children:[(0,jsx_runtime.jsx)("label",{className:"form-label",children:props.label}),(0,jsx_runtime.jsx)("input",{type:"text",className:"form-control",value:props.value,onChange:function onChange(event){return props.onChange(event.target.value)},onBlur:function onBlur(event){return props.onBlur(props.id,event.target.value)}})]})};return Component.displayName="TorusMediaBrowser(".concat(SubComponent.displayName,")"),Component};try{TorusMediaBrowserWrapper.displayName="TorusMediaBrowserWrapper",TorusMediaBrowserWrapper.__docgenInfo={description:"",displayName:"TorusMediaBrowserWrapper",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/TorusMediaBrowserWrapper.tsx#TorusMediaBrowserWrapper"]={docgenInfo:TorusMediaBrowserWrapper.__docgenInfo,name:"TorusMediaBrowserWrapper",path:"src/apps/authoring/components/PropertyEditor/custom/TorusMediaBrowserWrapper.tsx#TorusMediaBrowserWrapper"})}catch(__react_docgen_typescript_loader_error){}function TorusAudioBrowser_slicedToArray(arr,i){return function TorusAudioBrowser_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function TorusAudioBrowser_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function TorusAudioBrowser_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return TorusAudioBrowser_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return TorusAudioBrowser_arrayLikeToArray(o,minLen)}(arr,i)||function TorusAudioBrowser_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function TorusAudioBrowser_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var _TorusAudioBrowser=function _TorusAudioBrowser(_ref){var id=_ref.id,label=_ref.label,value=_ref.value,onChange=_ref.onChange,onBlur=_ref.onBlur,_useToggle2=TorusAudioBrowser_slicedToArray((0,useToggle.O)(),4),pickerOpen=_useToggle2[0],openPicker=_useToggle2[2],closePicker=_useToggle2[3],projectSlug=(0,es.v9)(app_slice.LJ),_useAudio=useAudio(value),audioPlayer=_useAudio.audioPlayer,playAudio=_useAudio.playAudio,isPlaying=_useAudio.isPlaying,commitSelection=(0,react.useCallback)((function(){onBlur(id,value),closePicker()}),[closePicker,id,onBlur,value]),hasAudio=!!value;return(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)("label",{className:"form-label",children:label}),hasAudio&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"truncate-left",children:value}),audioPlayer]}),hasAudio||(0,jsx_runtime.jsx)("div",{className:"truncate-left",children:"No Audio"}),(0,jsx_runtime.jsxs)(ButtonGroup.Z,{children:[(0,jsx_runtime.jsx)(Button.Z,{onClick:openPicker,type:"button",variant:"secondary",size:"sm","aria-label":"Select Audio File",children:(0,jsx_runtime.jsx)("i",{className:"fa-solid fa-microphone"})}),hasAudio&&(0,jsx_runtime.jsx)(Button.Z,{size:"sm",variant:"secondary",onClick:playAudio,children:isPlaying?(0,jsx_runtime.jsx)("i",{className:"fa-solid fa-circle-stop"}):(0,jsx_runtime.jsx)("i",{className:"fa-solid fa-circle-play"})})]}),pickerOpen&&(0,jsx_runtime.jsx)(MediaPickerModal,{onUrlChanged:onChange,initialSelection:value,projectSlug,onOK:commitSelection,onCancel:closePicker,mimeFilter:MIMETYPE_FILTERS.AUDIO,title:"Select Audio File"})]})};_TorusAudioBrowser.displayName="_TorusAudioBrowser";var TorusAudioBrowser=TorusMediaBrowserWrapper(_TorusAudioBrowser);try{TorusAudioBrowser.displayName="TorusAudioBrowser",TorusAudioBrowser.__docgenInfo={description:"",displayName:"TorusAudioBrowser",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(url: string) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(id: string, url: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/TorusAudioBrowser.tsx#TorusAudioBrowser"]={docgenInfo:TorusAudioBrowser.__docgenInfo,name:"TorusAudioBrowser",path:"src/apps/authoring/components/PropertyEditor/custom/TorusAudioBrowser.tsx#TorusAudioBrowser"})}catch(__react_docgen_typescript_loader_error){}function TorusImageBrowser_slicedToArray(arr,i){return function TorusImageBrowser_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function TorusImageBrowser_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function TorusImageBrowser_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return TorusImageBrowser_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return TorusImageBrowser_arrayLikeToArray(o,minLen)}(arr,i)||function TorusImageBrowser_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function TorusImageBrowser_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var _TorusImageBrowser=function _TorusImageBrowser(_ref){var id=_ref.id,label=_ref.label,value=_ref.value,onChange=_ref.onChange,onBlur=_ref.onBlur,_useToggle2=TorusImageBrowser_slicedToArray((0,useToggle.O)(),4),pickerOpen=_useToggle2[0],openPicker=_useToggle2[2],closePicker=_useToggle2[3],projectSlug=(0,es.v9)(app_slice.LJ),commitSelection=(0,react.useCallback)((function(){onBlur(id,value),closePicker()}),[closePicker,id,onBlur,value]),hasImage=value&&"/images/placeholder-image.svg"!==value;return(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)("label",{className:"form-label",children:label}),hasImage&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"truncate-left",children:value}),(0,jsx_runtime.jsx)("div",{className:"image-preview",children:(0,jsx_runtime.jsx)("img",{className:"img-fluid",src:value})})]}),hasImage||(0,jsx_runtime.jsx)("div",{className:"truncate-left",children:"No Image"}),(0,jsx_runtime.jsx)(Button.Z,{onClick:openPicker,type:"button",variant:"secondary",size:"sm","aria-label":"Select Image",children:(0,jsx_runtime.jsx)("i",{className:"fa-solid fa-image"})}),pickerOpen&&(0,jsx_runtime.jsx)(MediaPickerModal,{onUrlChanged:onChange,initialSelection:value,projectSlug,onOK:commitSelection,onCancel:closePicker})]})};_TorusImageBrowser.displayName="_TorusImageBrowser";var TorusImageBrowser=TorusMediaBrowserWrapper(_TorusImageBrowser);try{TorusImageBrowser.displayName="TorusImageBrowser",TorusImageBrowser.__docgenInfo={description:"",displayName:"TorusImageBrowser",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(url: string) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(id: string, url: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/TorusImageBrowser.tsx#TorusImageBrowser"]={docgenInfo:TorusImageBrowser.__docgenInfo,name:"TorusImageBrowser",path:"src/apps/authoring/components/PropertyEditor/custom/TorusImageBrowser.tsx#TorusImageBrowser"})}catch(__react_docgen_typescript_loader_error){}function TorusVideoBrowser_slicedToArray(arr,i){return function TorusVideoBrowser_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function TorusVideoBrowser_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function TorusVideoBrowser_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return TorusVideoBrowser_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return TorusVideoBrowser_arrayLikeToArray(o,minLen)}(arr,i)||function TorusVideoBrowser_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function TorusVideoBrowser_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var _TorusVideoBrowser=function _TorusVideoBrowser(_ref){var id=_ref.id,label=_ref.label,value=_ref.value,onChange=_ref.onChange,onBlur=_ref.onBlur,_useToggle2=TorusVideoBrowser_slicedToArray((0,useToggle.O)(),4),pickerOpen=_useToggle2[0],openPicker=_useToggle2[2],closePicker=_useToggle2[3],projectSlug=(0,es.v9)(app_slice.LJ),commitSelection=(0,react.useCallback)((function(){onBlur(id,value),closePicker()}),[closePicker,id,onBlur,value]),hasVideo=!!value;return(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)("label",{className:"form-label",children:label}),hasVideo&&(0,jsx_runtime.jsx)("div",{className:"truncate-left",children:value}),hasVideo||(0,jsx_runtime.jsx)("div",{className:"truncate-left",children:"No Video"}),(0,jsx_runtime.jsx)(Button.Z,{onClick:openPicker,type:"button",variant:"secondary",size:"sm","aria-label":"Select Video File",children:(0,jsx_runtime.jsx)("i",{className:"fa-regular fa-file-video"})}),pickerOpen&&(0,jsx_runtime.jsx)(MediaPickerModal,{onUrlChanged:onChange,initialSelection:value,projectSlug,onOK:commitSelection,onCancel:closePicker,mimeFilter:MIMETYPE_FILTERS.VIDEO,title:"Select Video File"})]})};_TorusVideoBrowser.displayName="_TorusVideoBrowser";var TorusVideoBrowser=TorusMediaBrowserWrapper(_TorusVideoBrowser);try{TorusVideoBrowser.displayName="TorusVideoBrowser",TorusVideoBrowser.__docgenInfo={description:"",displayName:"TorusVideoBrowser",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(url: string) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(id: string, url: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/TorusVideoBrowser.tsx#TorusVideoBrowser"]={docgenInfo:TorusVideoBrowser.__docgenInfo,name:"TorusVideoBrowser",path:"src/apps/authoring/components/PropertyEditor/custom/TorusVideoBrowser.tsx#TorusVideoBrowser"})}catch(__react_docgen_typescript_loader_error){}function PropertyEditor_typeof(obj){return PropertyEditor_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},PropertyEditor_typeof(obj)}function PropertyEditor_slicedToArray(arr,i){return function PropertyEditor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function PropertyEditor_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function PropertyEditor_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return PropertyEditor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PropertyEditor_arrayLikeToArray(o,minLen)}(arr,i)||function PropertyEditor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PropertyEditor_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var widgets={ColorPicker:ColorPickerWidget.Z,CheckboxWidget:custom_CustomCheckbox,ScreenDropdownTemplate:ScreenDropdownTemplate.Z,TorusImageBrowser,TorusAudioBrowser,TorusVideoBrowser,OptionsCorrectPicker,OptionsCustomErrorFeedbackAuthoring,MCQCorrectAnswerEditor,MCQOptionsEditor,DropdownOptionsEditor,MCQCustomErrorFeedbackAuthoring},PropertyEditor=function PropertyEditor(_ref){var schema=_ref.schema,uiSchema=_ref.uiSchema,value=_ref.value,onChangeHandler=_ref.onChangeHandler,_ref$triggerOnChange=_ref.triggerOnChange,triggerOnChange=void 0!==_ref$triggerOnChange&&_ref$triggerOnChange,_useState2=PropertyEditor_slicedToArray((0,react.useState)(value),2),formData=_useState2[0],setFormData=_useState2[1],findDiffType=function findDiffType(changedProp){var diffType=Object.values(changedProp);return"object"===PropertyEditor_typeof(diffType[0])?findDiffType(diffType[0]):PropertyEditor_typeof(diffType[0])};return(0,react.useEffect)((function(){setFormData(value)}),[value]),(0,jsx_runtime.jsx)(bootstrap_4_esm.ZP,{schema,formData,onChange:function onChange(e){var updatedData=e.formData,changedProp=(0,diff.Z)(formData,updatedData),changedPropType=findDiffType(changedProp),shouldTriggerChange="boolean"==typeof triggerOnChange?triggerOnChange:Object.keys(changedProp).some((function(v){return triggerOnChange.indexOf(v)>-1}));setFormData(updatedData),(shouldTriggerChange||"boolean"===changedPropType)&&updatedData.id===formData.id&&(console.log("ONCHANGE P EDITOR TRIGGERED",{e,updatedData,changedProp,changedPropType,triggerOnChange}),onChangeHandler(updatedData))},onBlur:function onBlur(key,changed){console.info("ONBLUR");var dotPath=key.replace(/_/g,".").replace("root.","");PropertyEditor_slicedToArray((0,lodash.at)(value,dotPath),1)[0]!=changed&&onChangeHandler(formData)},uiSchema,widgets,children:(0,jsx_runtime.jsx)(react.Fragment,{})})};PropertyEditor.displayName="PropertyEditor";const PropertyEditor_PropertyEditor=PropertyEditor;try{PropertyEditor.displayName="PropertyEditor",PropertyEditor.__docgenInfo={description:"",displayName:"PropertyEditor",props:{schema:{defaultValue:null,description:"",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"",name:"uiSchema",required:!0,type:{name:"UiSchema"}},onChangeHandler:{defaultValue:null,description:"",name:"onChangeHandler",required:!0,type:{name:"(changes: unknown) => void"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"unknown"}},triggerOnChange:{defaultValue:{value:"false"},description:"",name:"triggerOnChange",required:!1,type:{name:"boolean | string[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/PropertyEditor.tsx#PropertyEditor"]={docgenInfo:PropertyEditor.__docgenInfo,name:"PropertyEditor",path:"src/apps/authoring/components/PropertyEditor/PropertyEditor.tsx#PropertyEditor"})}catch(__react_docgen_typescript_loader_error){}},"./src/apps/authoring/components/PropertyEditor/custom/ColorPickerWidget.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_color__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-color/es/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var getColorValueString=function getColorValueString(value){return"rgba(".concat(value.rgb.r,",").concat(value.rgb.g,",").concat(value.rgb.b,",").concat(value.rgb.a,")")},ColorPickerWidget=function ColorPickerWidget(props){var color=function getRGBColorValue(value){if(value){var _parts=_slicedToArray(value.replace("rgba(","").replace(")","").split(","),4),r=_parts[0],g=_parts[1],b=_parts[2],_parts$=_parts[3],a=void 0===_parts$?"100":_parts$;return{r:parseInt(r,10),g:parseInt(g,10),b:parseInt(b,10),a:parseFloat(a)}}return{r:255,g:255,b:255,a:100}}(props.value),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),displayPicker=_useState2[0],setDisplayPicker=_useState2[1],handleClick=function handleClick(event){pickerRef.current&&!pickerRef.current.contains(event.target)&&(setDisplayPicker(!1),document.removeEventListener("mousedown",handleClick))},pickerRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),colorDiv={width:"36px",height:"14px",borderRadius:"2px",border:"1px solid black",background:"rgba(".concat(color.r,", ").concat(color.g,", ").concat(color.b,", ").concat(color.a,")")};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className:"form-label",children:props.label}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{style:colorDiv,onClick:function handleColorBoxClick(){setDisplayPicker(!0),document.addEventListener("mousedown",handleClick)}}),displayPicker?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{style:{position:"absolute",zIndex:2,left:0,top:"25px"},ref:pickerRef,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_color__WEBPACK_IMPORTED_MODULE_1__.xS,{color,onChangeComplete:function onChangeComplete(color){props.onChange(getColorValueString(color)),props.onBlur(props.id,getColorValueString(color))}})}):null]})]})};ColorPickerWidget.displayName="ColorPickerWidget";const __WEBPACK_DEFAULT_EXPORT__=ColorPickerWidget;try{ColorPickerWidget.displayName="ColorPickerWidget",ColorPickerWidget.__docgenInfo={description:"",displayName:"ColorPickerWidget",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(colorValue: string) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(id: string, colorValue: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/ColorPickerWidget.tsx#ColorPickerWidget"]={docgenInfo:ColorPickerWidget.__docgenInfo,name:"ColorPickerWidget",path:"src/apps/authoring/components/PropertyEditor/custom/ColorPickerWidget.tsx#ColorPickerWidget"})}catch(__react_docgen_typescript_loader_error){}},"./src/apps/authoring/components/PropertyEditor/custom/CustomFieldTemplate.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js"),CustomFieldTemplate=function CustomFieldTemplate(props){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[props.uiSchema["ui:title"]?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("h6",{children:props.uiSchema["ui:title"]}):null,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[props.description,props.properties.map((function(element){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{className:"".concat(element.content.props.uiSchema.classNames||"col-span-12"," inner"),children:element.content},element.content.key)}))]})]})};CustomFieldTemplate.displayName="CustomFieldTemplate";const __WEBPACK_DEFAULT_EXPORT__=CustomFieldTemplate;try{CustomFieldTemplate.displayName="CustomFieldTemplate",CustomFieldTemplate.__docgenInfo={description:"",displayName:"CustomFieldTemplate",props:{uiSchema:{defaultValue:null,description:"",name:"uiSchema",required:!0,type:{name:"any"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"string"}},properties:{defaultValue:null,description:"",name:"properties",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/CustomFieldTemplate.tsx#CustomFieldTemplate"]={docgenInfo:CustomFieldTemplate.__docgenInfo,name:"CustomFieldTemplate",path:"src/apps/authoring/components/PropertyEditor/custom/CustomFieldTemplate.tsx#CustomFieldTemplate"})}catch(__react_docgen_typescript_loader_error){}},"./src/apps/authoring/components/PropertyEditor/custom/ScreenDropdownTemplate.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react-bootstrap/esm/Dropdown.js"),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),apps_delivery_store_features_groups_actions_sequence__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/apps/delivery/store/features/groups/actions/sequence.ts"),apps_delivery_store_features_groups_selectors_deck__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/apps/delivery/store/features/groups/selectors/deck.ts"),_SequenceDropdown__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/apps/authoring/components/PropertyEditor/custom/SequenceDropdown.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ScreenDropdownTemplate=function ScreenDropdownTemplate(props){var id=props.id,label=props.label,value=props.value,onChange=props.onChange,buttonCSSClass=props.buttonCSSClass,sequence=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(apps_delivery_store_features_groups_selectors_deck__WEBPACK_IMPORTED_MODULE_3__.nu),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("Next Screen"),2),buttonLabel=_useState2[0],setButtonLabel=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((0,apps_delivery_store_features_groups_actions_sequence__WEBPACK_IMPORTED_MODULE_2__._y)(sequence)),2),hierarchy=_useState4[0],setHierarchy=_useState4[1];(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){if("next"!==value){if(sequence){setHierarchy((0,apps_delivery_store_features_groups_actions_sequence__WEBPACK_IMPORTED_MODULE_2__._y)(sequence));var entry=(0,apps_delivery_store_features_groups_actions_sequence__WEBPACK_IMPORTED_MODULE_2__.zK)(sequence,value);if(entry)return void setButtonLabel(entry.custom.sequenceName)}setButtonLabel("Missing Screen!")}else setButtonLabel("Next Screen")}),[value,sequence]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[label&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("span",{className:"form-label",children:label}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.Z,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.Z.Toggle,{variant:"link",id,className:"".concat(buttonCSSClass," form-control dropdown-toggle d-flex justify-content-between"),children:[buttonLabel,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("i",{className:"fas fa-caret-down my-auto"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.Z.Menu,{className:"aa-sequence-editor-menu",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_SequenceDropdown__WEBPACK_IMPORTED_MODULE_4__.T,{items:hierarchy,onChange:function onChangeHandler(item,e,isNext){var itemId=isNext?"next":null==item?void 0:item.custom.sequenceId;onChange(itemId)},value:props.value,showNextBtn:!0})})]})]})};ScreenDropdownTemplate.displayName="ScreenDropdownTemplate";const __WEBPACK_DEFAULT_EXPORT__=ScreenDropdownTemplate;try{ScreenDropdownTemplate.displayName="ScreenDropdownTemplate",ScreenDropdownTemplate.__docgenInfo={description:"",displayName:"ScreenDropdownTemplate",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value?: string | undefined) => void"}},dropDownCSSClass:{defaultValue:null,description:"",name:"dropDownCSSClass",required:!1,type:{name:"string"}},buttonCSSClass:{defaultValue:null,description:"",name:"buttonCSSClass",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/ScreenDropdownTemplate.tsx#ScreenDropdownTemplate"]={docgenInfo:ScreenDropdownTemplate.__docgenInfo,name:"ScreenDropdownTemplate",path:"src/apps/authoring/components/PropertyEditor/custom/ScreenDropdownTemplate.tsx#ScreenDropdownTemplate"})}catch(__react_docgen_typescript_loader_error){}},"./src/apps/authoring/components/PropertyEditor/custom/SequenceDropdown.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{T:()=>SequenceDropdown});__webpack_require__("./node_modules/react/index.js");var react_bootstrap__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react-bootstrap/esm/Accordion.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react-bootstrap/esm/ListGroup.js"),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),apps_delivery_store_features_groups_selectors_deck__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/apps/delivery/store/features/groups/selectors/deck.ts"),_Accordion_ContextAwareToggle__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/apps/authoring/components/Accordion/ContextAwareToggle.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js"),SequenceDropdown=function SequenceDropdown(props){var items=props.items,onChange=props.onChange,value=props.value,showNextBtn=props.showNextBtn;(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(apps_delivery_store_features_groups_selectors_deck__WEBPACK_IMPORTED_MODULE_2__.nu);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"aa-sequence-editor",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.Z,{as:"ol",className:"aa-sequence",children:[showNextBtn?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.Z.Item,{as:"li",className:"aa-sequence-item",onClick:function onClick(e){return onChange(null,e,!0)},tabIndex:0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"aa-sequence-details-wrapper",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"details",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("span",{className:"title",children:"Next Screen"})})})},"next"):null,function sequenceDropDownItems(items){return items.map((function(item,index){var _item$custom,title=(null===(_item$custom=item.custom)||void 0===_item$custom?void 0:_item$custom.sequenceName)||item.activitySlug;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_5__.Z,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.Z.Item,{as:"li",className:"aa-sequence-item".concat(item.children.length?" is-parent":""," ").concat(item.custom.sequenceId===value?"active":""),tabIndex:0,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"aa-sequence-details-wrapper",onClick:function onClick(e){return onChange(item,e,!1)},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"details",children:[item.children.length?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Accordion_ContextAwareToggle__WEBPACK_IMPORTED_MODULE_3__.Z,{eventKey:"".concat(index),className:"aa-sequence-item-toggle"}):null,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("span",{className:"title",children:title})]})}),item.children.length?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_5__.Z.Collapse,{eventKey:"".concat(index),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.Z,{as:"ol",className:"aa-sequence nested",children:sequenceDropDownItems(item.children)})}):null]},"".concat(item.custom.sequenceId))},"".concat(index))}))}(items)]})})};SequenceDropdown.displayName="SequenceDropdown";try{SequenceDropdown.displayName="SequenceDropdown",SequenceDropdown.__docgenInfo={description:"",displayName:"SequenceDropdown",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"SequenceHierarchyItem<SequenceEntryChild>[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(item: SequenceHierarchyItem<SequenceEntryChild> | null, e?: MouseEvent<Element, MouseEvent> | undefined, isNextButton?: boolean | undefined) => void"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string"}},showNextBtn:{defaultValue:null,description:"",name:"showNextBtn",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/SequenceDropdown.tsx#SequenceDropdown"]={docgenInfo:SequenceDropdown.__docgenInfo,name:"SequenceDropdown",path:"src/apps/authoring/components/PropertyEditor/custom/SequenceDropdown.tsx#SequenceDropdown"})}catch(__react_docgen_typescript_loader_error){}},"./src/apps/authoring/components/PropertyEditor/schemas/part.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{GE:()=>transformModelToSchema,J7:()=>simplifiedPartSchema,LR:()=>transformSchemaToModel,VA:()=>simplifiedPartUiSchema,ZP:()=>__WEBPACK_DEFAULT_EXPORT__,cg:()=>partUiSchema});var utils_common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/utils/common.ts"),_custom_CustomFieldTemplate__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/authoring/components/PropertyEditor/custom/CustomFieldTemplate.tsx");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var simplifiedPartSchema={type:"object",properties:{},required:[]},partUiSchema={type:{"ui:title":"Part Type","ui:readonly":!0},Position:{"ui:ObjectFieldTemplate":_custom_CustomFieldTemplate__WEBPACK_IMPORTED_MODULE_1__.Z,"ui:title":"Position",x:{classNames:"col-span-4"},y:{classNames:"col-span-4"},z:{classNames:"col-span-4"}},Size:{"ui:ObjectFieldTemplate":_custom_CustomFieldTemplate__WEBPACK_IMPORTED_MODULE_1__.Z,"ui:title":"Dimensions",width:{classNames:"col-span-6"},height:{classNames:"col-span-6"}},Scoring:{"ui:ObjectFieldTemplate":_custom_CustomFieldTemplate__WEBPACK_IMPORTED_MODULE_1__.Z,"ui:title":"Scoring",requiresManualGrading:{classNames:"col-span-6"},maxScore:{classNames:"col-span-6"}}},simplifiedPartUiSchema={Scoring:{"ui:ObjectFieldTemplate":_custom_CustomFieldTemplate__WEBPACK_IMPORTED_MODULE_1__.Z,"ui:title":"Scoring",maxScore:{classNames:"col-span-6"}}},transformModelToSchema=function transformModelToSchema(model){var id=model.id,type=model.type,_model$custom=model.custom,x=_model$custom.x,y=_model$custom.y,z=_model$custom.z,width=_model$custom.width,height=_model$custom.height,requiresManualGrading=_model$custom.requiresManualGrading,maxScore=_model$custom.maxScore;return{id,type,Position:{x,y,z},Size:{width,height},Scoring:{requiresManualGrading:!!requiresManualGrading,maxScore:(0,utils_common__WEBPACK_IMPORTED_MODULE_0__.Q6)(maxScore)||1},custom:_objectSpread({},model.custom)}},transformSchemaToModel=function transformSchemaToModel(schema){var id=schema.id,type=schema.type,Position=schema.Position,Size=schema.Size,palette=schema.palette,Scoring=schema.Scoring,result={id,type,custom:_objectSpread(_objectSpread({},schema.custom),{},{x:Position.x,y:Position.y,z:Position.z,width:Size.width,height:Size.height,requiresManualGrading:Scoring.requiresManualGrading,maxScore:Scoring.maxScore})};return palette&&(result.custom.palette={useHtmlProps:!0,backgroundColor:palette.backgroundColor||"transparent",borderColor:palette.borderColor||"transparent",borderRadius:(0,utils_common__WEBPACK_IMPORTED_MODULE_0__.Q6)(palette.borderRadius)||0,borderWidth:(0,utils_common__WEBPACK_IMPORTED_MODULE_0__.Q6)(palette.borderWidth)||0,borderStyle:palette.borderStyle||"none"}),result};const __WEBPACK_DEFAULT_EXPORT__={type:"object",properties:{id:{type:"string",title:"Id"},type:{type:"string",title:"Type"},Position:{type:"object",title:"Dimensions",properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"}}},Size:{type:"object",title:"Dimensions",properties:{width:{type:"number",title:"Width"},height:{type:"number",title:"Height"}}},Scoring:{type:"object",title:"Scoring",properties:{requiresManualGrading:{title:"Requires Manual Grading",type:"boolean",format:"checkbox",default:!1},maxScore:{title:"Max Score",type:"number"}}},custom:{type:"object",properties:{addtionalProperties:{type:"string"}}}},required:["id"]}},"./src/apps/authoring/components/RightMenu/RightMenu.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>RightPanelTabs});var react=__webpack_require__("./node_modules/react/index.js"),Tabs=__webpack_require__("./node_modules/react-bootstrap/esm/Tabs.js"),Tab=__webpack_require__("./node_modules/react-bootstrap/esm/Tab.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),common=__webpack_require__("./src/utils/common.ts"),slice=__webpack_require__("./src/apps/authoring/store/app/slice.ts"),actions_sequence=__webpack_require__("./src/apps/delivery/store/features/groups/actions/sequence.ts"),deck=__webpack_require__("./src/apps/delivery/store/features/groups/selectors/deck.ts"),groups_slice=__webpack_require__("./src/apps/delivery/store/features/groups/slice.ts"),saveActivity=__webpack_require__("./src/apps/authoring/store/activities/actions/saveActivity.ts"),updateSequenceItemFromActivity=__webpack_require__("./src/apps/authoring/store/groups/layouts/deck/actions/updateSequenceItemFromActivity.ts"),savePage=__webpack_require__("./src/apps/authoring/store/page/actions/savePage.ts"),page_slice=__webpack_require__("./src/apps/authoring/store/page/slice.ts"),parts_slice=__webpack_require__("./src/apps/authoring/store/parts/slice.ts"),PropertyEditor=__webpack_require__("./src/apps/authoring/components/PropertyEditor/PropertyEditor.tsx"),Accordion=__webpack_require__("./node_modules/react-bootstrap/esm/Accordion.js"),ContextAwareToggle=__webpack_require__("./src/apps/authoring/components/Accordion/ContextAwareToggle.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),AccordionTemplate=function AccordionTemplate(props){return(0,jsx_runtime.jsxs)(Accordion.Z,{className:"aa-properties-editor",defaultActiveKey:"0",children:[(0,jsx_runtime.jsx)("div",{className:"aa-panel-section-title-bar",children:(0,jsx_runtime.jsxs)("div",{className:"d-flex align-items-center",children:[(0,jsx_runtime.jsx)(ContextAwareToggle.Z,{eventKey:"0"}),(0,jsx_runtime.jsx)("span",{className:"title",children:props.title})]})}),(0,jsx_runtime.jsx)(Accordion.Z.Collapse,{eventKey:"0",children:(0,jsx_runtime.jsx)("div",{className:"grid grid-cols-12 mx-4",children:props.properties.map((function(element){return(0,jsx_runtime.jsx)("div",{className:"".concat(element.content.props.uiSchema.classNames||"col-span-12"," inner"),children:element.content},element.content.key)}))})})]})};AccordionTemplate.displayName="AccordionTemplate";const custom_AccordionTemplate=AccordionTemplate;try{AccordionTemplate.displayName="AccordionTemplate",AccordionTemplate.__docgenInfo={description:"",displayName:"AccordionTemplate",props:{key:{defaultValue:null,description:"",name:"key",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},properties:{defaultValue:null,description:"",name:"properties",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/AccordionTemplate.tsx#AccordionTemplate"]={docgenInfo:AccordionTemplate.__docgenInfo,name:"AccordionTemplate",path:"src/apps/authoring/components/PropertyEditor/custom/AccordionTemplate.tsx#AccordionTemplate"})}catch(__react_docgen_typescript_loader_error){}var bankUiSchema={Bank:{"ui:ObjectFieldTemplate":custom_AccordionTemplate,bankEndTarget:{"ui:widget":"ScreenDropdownTemplate"}}};const bank={type:"object",properties:{Bank:{type:"object",properties:{bankShowCount:{type:"number",title:"Randomly selects question(s) from the bank"},bankEndTarget:{type:"string",title:"When Completed, proceed to"}}}}};var chroma=__webpack_require__("./node_modules/chroma-js/chroma.js"),chroma_default=__webpack_require__.n(chroma),ColorPickerWidget=__webpack_require__("./src/apps/authoring/components/PropertyEditor/custom/ColorPickerWidget.tsx"),CustomFieldTemplate=__webpack_require__("./src/apps/authoring/components/PropertyEditor/custom/CustomFieldTemplate.tsx");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var BankPropsUiSchema={Size:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,"ui:title":"Dimensions",width:{classNames:"col-span-6"},height:{classNames:"col-span-6"}},palette:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,"ui:title":"Palette",backgroundColor:{"ui:widget":ColorPickerWidget.Z},borderColor:{"ui:widget":ColorPickerWidget.Z},borderStyle:{classNames:"col-span-6"},borderWidth:{classNames:"col-span-6"}}};const bankScreen={type:"object",properties:{title:{type:"string",title:"Title"},Size:{type:"object",title:"Dimensions",properties:{width:{type:"number"},height:{type:"number"}}},palette:{type:"object",properties:{backgroundColor:{type:"string",title:"Background Color"},borderColor:{type:"string",title:"Border Color"},borderRadius:{type:"string",title:"Border Radius"},borderStyle:{type:"string",title:"Border Style"},borderWidth:{type:"string",title:"Border Width"}}},customCssClass:{title:"Custom CSS Class",type:"string"}}};var Form=__webpack_require__("./node_modules/react-bootstrap/esm/Form.js"),Button=__webpack_require__("./node_modules/react-bootstrap/esm/Button.js"),ListGroup=__webpack_require__("./node_modules/react-bootstrap/esm/ListGroup.js"),OverlayTrigger=__webpack_require__("./node_modules/react-bootstrap/esm/OverlayTrigger.js"),Tooltip=__webpack_require__("./node_modules/react-bootstrap/esm/Tooltip.js"),ListGroupItem=__webpack_require__("./node_modules/react-bootstrap/esm/ListGroupItem.js"),Modal=__webpack_require__("./node_modules/react-bootstrap/esm/Modal.js"),redux_toolkit_esm=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),build_module=__webpack_require__("./node_modules/janus-script/build/module/index.js"),has=__webpack_require__("./node_modules/lodash/has.js"),has_default=__webpack_require__.n(has),uniqBy=__webpack_require__("./node_modules/lodash/uniqBy.js"),uniqBy_default=__webpack_require__.n(uniqBy),builtin_functions=__webpack_require__("./src/adaptivity/janus-scripts/builtin_functions.ts"),scripting=__webpack_require__("./src/adaptivity/scripting.ts"),Dropdown=__webpack_require__("./node_modules/react-bootstrap/esm/Dropdown.js"),lodash=__webpack_require__("./node_modules/lodash/lodash.js"),guid=__webpack_require__("./src/utils/guid.ts"),capi=__webpack_require__("./src/adaptivity/capi.ts"),DeleteConfirmationModal=__webpack_require__("./src/apps/authoring/components/Modal/DeleteConfirmationModal.tsx");var typeOptions=[{key:"string",text:"String",value:capi.io.STRING},{key:"number",text:"Number",value:capi.io.NUMBER},{key:"array",text:"Array",value:capi.io.ARRAY},{key:"boolean",text:"Boolean",value:capi.io.BOOLEAN},{key:"enum",text:"Enum",value:capi.io.ENUM},{key:"math",text:"Math Expression",value:capi.io.MATH_EXPR},{key:"parray",text:"Point Array",value:capi.io.ARRAY_POINT}],conditionOperatorOptions=[{key:"equal",text:"=",value:"equal"},{key:"notEqual",text:"!=",value:"notEqual"},{key:"lessThan",text:"<",value:"lessThan"},{key:"lessThanInclusive",text:"<=",value:"lessThanInclusive"},{key:"greaterThan",text:">",value:"greaterThan"},{key:"greaterThanInclusive",text:">=",value:"greaterThanInclusive"},{key:"in",text:"In",value:"in"},{key:"notIn",text:"Not In",value:"notIn"},{key:"contains",text:"Contains",value:"contains"},{key:"notContains",text:"Not Contains",value:"notContains"},{key:"containsAnyOf",text:"Contains Any",value:"containsAnyOf"},{key:"notContainsAnyOf",text:"Not Contains Any",value:"notContainsAnyOf"},{key:"containsOnly",text:"Contains Only",value:"containsOnly"},{key:"isAnyOf",text:"Is Any Of",value:"isAnyOf"},{key:"notIsAnyOf",text:"Not Any Of",value:"notIsAnyOf"},{key:"isNaN",text:"Is NaN",value:"isNaN"},{key:"equalWithTolerance",text:"~==",value:"equalWithTolerance"},{key:"notEqualWithTolerance",text:"~!=",value:"notEqualWithTolerance"},{key:"inRange",text:"In Range",value:"inRange"},{key:"notInRange",text:"Not In Range",value:"notInRange"},{key:"containsExactly",text:"Contains Exactly",value:"containsExactly"},{key:"notContainsExactly",text:"Not Contains Exactly",value:"notContainsExactly"},{key:"startsWith",text:"Starts With",value:"startsWith"},{key:"endsWith",text:"Ends With",value:"endsWith"},{key:"is",text:"Is",value:"is"},{key:"notIs",text:"Not Is",value:"notIs"},{key:"hasSameTerms",text:"Has Same Terms",value:"hasSameTerms"},{key:"hasDifferentTerms",text:"Has Different Terms",value:"hasDifferentTerms"},{key:"isEquivalentOf",text:"Is Equivalent",value:"isEquivalentOf"},{key:"notIsEquivalentOf",text:"Is Not Equivalent",value:"notIsEquivalentOf"},{key:"isExactly",text:"Is Exactly",value:"isExactly"},{key:"notIsExactly",text:"Not Is Exactly",value:"notIsExactly"}],conditionTypeOperatorCombos=[{type:capi.io.BOOLEAN,operators:["equal","is"]},{type:capi.io.ENUM,operators:["equal","notEqual","is","notIs"]},{type:capi.io.NUMBER,operators:["equal","notEqual","isNaN","is","isAnyOf","notIs","greaterThan","lessThan","greaterThanInclusive","lessThanInclusive","equalWithTolerance","notEqualWithTolerance","inRange","notInRange"]},{type:capi.io.STRING,operators:["equal","notEqual","is","notIs","isExactly","notIsExactly","contains","notContains","containsExactly","notContainsExactly","containsAnyOf","notContainsAnyOf","startsWith","endsWith"]},{type:capi.io.ARRAY,operators:["equal","notEqual","is","notIs","contains","notContains","containsAnyOf","notContainsAnyOf","containsOnly"]},{type:capi.io.MATH_EXPR,operators:["isExactly","notIsExactly","isEquivalentOf","notIsEquivalentOf","hasSameTerms","hasDifferentTerms"]},{type:capi.io.ARRAY_POINT,operators:["equal","notEqual","is","notIs","contains","notContains"]}],sessionVariables=(conditionTypeOperatorCombos[0].operators,conditionTypeOperatorCombos[1].operators,conditionTypeOperatorCombos[2].operators,conditionTypeOperatorCombos[3].operators,conditionTypeOperatorCombos[4].operators,conditionTypeOperatorCombos[5].operators,{attemptNumber:0,currentQuestionScore:0,graded:!1,questionTimeExceeded:!1,timeOnQuestion:0,timeStartQuestion:0,tutorialScore:0,visits:[]}),Popover=__webpack_require__("./node_modules/react-bootstrap/esm/Popover.js"),activities_slice=__webpack_require__("./src/apps/delivery/store/features/activities/slice.ts"),SequenceDropdown=__webpack_require__("./src/apps/authoring/components/PropertyEditor/custom/SequenceDropdown.tsx");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VariablePicker_regeneratorRuntime(){VariablePicker_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==VariablePicker_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function VariablePicker_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function VariablePicker_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){VariablePicker_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){VariablePicker_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function VariablePicker_typeof(obj){return VariablePicker_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},VariablePicker_typeof(obj)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var OverlayPlacements=function(OverlayPlacements){return OverlayPlacements.TOP="top",OverlayPlacements.RIGHT="right",OverlayPlacements.BOTTOM="bottom",OverlayPlacements.LEFT="left",OverlayPlacements}({}),FilterItems=function(FilterItems){return FilterItems.SCREEN="This Screen",FilterItems.SESSION="Session",FilterItems.VARIABLES="Lesson Variables",FilterItems}(FilterItems||{}),VariablePicker=function VariablePicker(_ref){var _ref$placement=_ref.placement,placement=void 0===_ref$placement?OverlayPlacements.TOP:_ref$placement,targetRef=_ref.targetRef,typeRef=_ref.typeRef,context=_ref.context,onTargetChange=_ref.onTargetChange,onTypeChange=_ref.onTypeChange,currentLesson=(0,es.v9)(page_slice.bz),sequence=(0,es.v9)(deck.nu),hierarchy=(0,actions_sequence._y)(sequence),vpContainerRef=(0,react.useRef)(document.getElementById("advanced-authoring")),paths=(0,es.v9)(slice.Dw),availablePartComponents=(0,es.v9)(slice.bo),currentActivityTree=(0,es.v9)(deck.kv),allActivities=(0,es.v9)(activities_slice.N3),_useState2=_slicedToArray((0,react.useState)("stage"),2),specificSequenceId=_useState2[0],setSpecificSequenceId=_useState2[1],_useState4=_slicedToArray((0,react.useState)(),2),specificActivityTree=_useState4[0],setSpecificActivityTree=_useState4[1],_useState6=_slicedToArray((0,react.useState)(!1),2),isFilterMenuOpen=_useState6[0],setIsFilterMenuOpen=_useState6[1],_useState8=_slicedToArray((0,react.useState)(FilterItems.SCREEN),2),activeFilter=_useState8[0],setActiveFilter=_useState8[1],_useState10=_slicedToArray((0,react.useState)({}),2),partAdaptivityMap=_useState10[0],setPartAdaptivityMap=_useState10[1],_useState12=_slicedToArray((0,react.useState)([]),2),allParts=_useState12[0],setAllParts=_useState12[1],setTargetRef=function setTargetRef(setTo){targetRef&&setTimeout((function(){null!=targetRef&&targetRef.current&&(targetRef.current.value=setTo,targetRef.current.click(),targetRef.current.focus())})),onTargetChange&&onTargetChange(setTo)},setTypeRef=function setTypeRef(setTo){if(typeRef){var event=new Event("change",{bubbles:!0});setTimeout((function(){null!=typeRef&&typeRef.current&&(typeRef.current.value=setTo,typeRef.current.click(),typeRef.current.dispatchEvent(event),typeRef.current.focus())}))}onTypeChange&&onTypeChange(setTo)},getPartIcon=function getPartIcon(type){var part=availablePartComponents.find((function(part){return part.delivery_element===type}));return part?"".concat(null==paths?void 0:paths.images,"/icons/").concat(part.icon):"".concat(null==paths?void 0:paths.images,"/icons/icon-componentList.svg")},getLimitedTypeCheck=function getLimitedTypeCheck(typeToCheck){var limitedType;switch(VariablePicker_typeof(typeToCheck)){case"string":limitedType=capi.io.STRING;break;case"boolean":limitedType=capi.io.BOOLEAN;break;default:limitedType=capi.io.NUMBER}return limitedType},getPartTypeTemplate=(0,react.useCallback)((function(part,index){var adaptivitySchema=partAdaptivityMap[part.id];return adaptivitySchema?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Accordion.Z.Toggle,{as:ListGroup.Z.Item,eventKey:"".concat(index),action:!0,className:"part-type",onClick:function onClick(){return setIsFilterMenuOpen(!1)},children:(0,jsx_runtime.jsxs)("div",{className:"d-flex align-items-center justify-space-between flex-grow-1",children:[(0,jsx_runtime.jsxs)("div",{className:"d-flex flex-grow-1",children:[(0,jsx_runtime.jsx)("div",{className:"text-center mr-2 d-flex",children:(0,jsx_runtime.jsx)("img",{title:part.type,src:getPartIcon(part.type),className:"part-type-icon"})}),(0,jsx_runtime.jsx)("span",{className:"mr-2",children:part.id})]}),(0,jsx_runtime.jsx)(ContextAwareToggle.Z,{eventKey:"".concat(index)})]})}),(0,jsx_runtime.jsx)(Accordion.Z.Collapse,{eventKey:"".concat(index),children:(0,jsx_runtime.jsx)("ul",{className:"list-unstyled m-0 mb-2",children:Object.keys(adaptivitySchema).map((function(key,index){return(0,jsx_runtime.jsx)("li",{className:"pb-2 pl-1 ml-4",onClick:function onClick(){setTargetRef("".concat("stage"===specificSequenceId?"stage.":"".concat(specificSequenceId,"|stage.")).concat(part.id,".").concat(key)),setTypeRef("".concat(adaptivitySchema[key]))},children:(0,jsx_runtime.jsx)("button",{type:"button",className:"text-btn font-italic",children:(0,jsx_runtime.jsx)("span",{title:capi.io[adaptivitySchema[key]][0]+capi.io[adaptivitySchema[key]].slice(1).toLowerCase(),children:key})})},index)}))})})]}):null}),[partAdaptivityMap,specificSequenceId]),getAdaptivePartTypes=(0,react.useCallback)(VariablePicker_asyncToGenerator(VariablePicker_regeneratorRuntime().mark((function _callee2(){var getMapPromises,mapItems,adaptivityMap;return VariablePicker_regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return getMapPromises=allParts.map(function(){var _ref3=VariablePicker_asyncToGenerator(VariablePicker_regeneratorRuntime().mark((function _callee(part){var adaptivitySchema,PartClass,instance;return VariablePicker_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(adaptivitySchema=null,!(PartClass=customElements.get(part.type))){_context.next=9;break}if(!(instance=new PartClass)){_context.next=9;break}if(!instance.getAdaptivitySchema){_context.next=9;break}return _context.next=8,instance.getAdaptivitySchema({currentModel:part,editorContext:context});case 8:adaptivitySchema=_context.sent;case 9:return _context.abrupt("return",{adaptivitySchema,type:part.type,id:part.id});case 10:case"end":return _context.stop()}}),_callee)})));return function(_x2){return _ref3.apply(this,arguments)}}()),_context2.next=3,Promise.all(getMapPromises);case 3:return mapItems=_context2.sent,adaptivityMap=mapItems.reduce((function(acc,typeToAdaptivitySchemaMap){return acc[typeToAdaptivitySchemaMap.id]=typeToAdaptivitySchemaMap.adaptivitySchema,acc}),{}),_context2.abrupt("return",Promise.resolve(adaptivityMap));case 6:case"end":return _context2.stop()}}),_callee2)}))),[allParts,currentActivityTree,specificActivityTree]),sessionVisits=[],getSessionVisits=function getSessionVisits(sequence){return sequence.forEach((function(sequenceItem){sequenceItem.custom.isBank||sequenceItem.custom.isLayer||sessionVisits.push({sequenceId:sequenceItem.custom.sequenceId,sequenceName:sequenceItem.custom.sequenceName}),sequenceItem.children.length>0&&getSessionVisits(sequenceItem.children)})),_toConsumableArray(new Map(sessionVisits.map((function(uniqueBy){return[uniqueBy.sequenceId,uniqueBy]}))).values())},SessionTemplate=function SessionTemplate(){return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object.keys(sessionVariables).map((function(variable,index){if("visits"!==variable){var limitedType=getLimitedTypeCheck(sessionVariables[variable]);if("mutate"!==context)return(0,jsx_runtime.jsx)("div",{className:"part-type",children:(0,jsx_runtime.jsx)("button",{type:"button",className:"text-btn font-italic",onClick:function onClick(){setTargetRef("session.".concat(variable)),setTypeRef("".concat(limitedType))},title:"".concat(capi.io[limitedType][0]+capi.io[limitedType].slice(1).toLowerCase()),children:variable})},index);if("tutorialScore"===variable||"currentQuestionScore"===variable)return(0,jsx_runtime.jsx)("div",{className:"part-type",children:(0,jsx_runtime.jsx)("button",{type:"button",className:"text-btn font-italic",onClick:function onClick(){setTargetRef("session.".concat(variable)),setTypeRef("".concat(limitedType))},title:"".concat(capi.io[limitedType][0]+capi.io[limitedType].slice(1).toLowerCase()),children:variable})},index)}if("visits"===variable&&"mutate"!==context){var _sessionVisits=getSessionVisits(hierarchy);return(0,jsx_runtime.jsxs)(Accordion.Z,{children:[(0,jsx_runtime.jsx)(Accordion.Z.Toggle,{as:ListGroup.Z.Item,eventKey:"".concat(index),action:!0,className:"part-type border-top",onClick:function onClick(){return setIsFilterMenuOpen(!1)},children:(0,jsx_runtime.jsxs)("div",{className:"d-flex align-items-center justify-space-between flex-grow-1",children:[(0,jsx_runtime.jsx)("div",{className:"d-flex flex-grow-1",children:(0,jsx_runtime.jsx)("span",{className:"ml-1 text-btn font-weight-bold",children:variable})}),(0,jsx_runtime.jsx)(ContextAwareToggle.Z,{eventKey:"".concat(index)})]})}),(0,jsx_runtime.jsx)(Accordion.Z.Collapse,{eventKey:"".concat(index),children:(0,jsx_runtime.jsx)("ul",{className:"list-unstyled m-0 mb-2",children:_sessionVisits.map((function(sequence,index){return(0,jsx_runtime.jsx)("li",{className:"pb-2 pl-1 ml-3",onClick:function onClick(){setTargetRef("session.visits.".concat(sequence.sequenceId)),setTypeRef("".concat(capi.io.NUMBER))},children:(0,jsx_runtime.jsx)("button",{type:"button",className:"text-btn font-italic",children:(0,jsx_runtime.jsx)("span",{title:"".concat(sequence.sequenceId),children:sequence.sequenceName})})},index)}))})})]})}}))})},VariableTemplate=function VariableTemplate(){var _currentLesson$custom,_currentLesson$custom2;return null==currentLesson||null===(_currentLesson$custom=currentLesson.custom)||void 0===_currentLesson$custom||null===(_currentLesson$custom2=_currentLesson$custom.variables)||void 0===_currentLesson$custom2?void 0:_currentLesson$custom2.map((function(variable,index){var expression=variable.expression,name=variable.name,limitedType=getLimitedTypeCheck(expression);return(0,jsx_runtime.jsx)("div",{className:"part-type",children:(0,jsx_runtime.jsx)("button",{type:"button",className:"text-btn font-italic",onClick:function onClick(){setTargetRef("variables.".concat(name)),setTypeRef("".concat(limitedType))},title:"".concat(capi.io[limitedType][0]+capi.io[limitedType].slice(1).toLowerCase()),children:name})},index)}))};return(0,react.useEffect)((function(){var isMounted=!0;return getAdaptivePartTypes().then((function(map){isMounted&&setPartAdaptivityMap(map)})),function(){isMounted=!1}}),[allParts,currentActivityTree,specificActivityTree]),(0,react.useEffect)((function(){var someParts=(activeFilter.includes(FilterItems.SCREEN)?currentActivityTree:specificActivityTree||[]).reduce((function(acc,activity){return acc.concat(activity.content.partsLayout||[])}),[]);setAllParts(someParts)}),[currentActivityTree,specificActivityTree,activeFilter]),(0,jsx_runtime.jsx)(OverlayTrigger.Z,{rootClose:!0,trigger:"click",placement,container:vpContainerRef.current,onExit:function onExit(){return setIsFilterMenuOpen(!1)},overlay:(0,jsx_runtime.jsxs)(Popover.Z,{id:"aa-variable-picker",children:[(0,jsx_runtime.jsx)(Popover.Z.Title,{as:"h3",children:"Variable Picker"}),(0,jsx_runtime.jsxs)(Popover.Z.Content,{children:[(0,jsx_runtime.jsx)("div",{className:"target-select-container",children:(0,jsx_runtime.jsxs)("div",{className:"input-group input-group-sm flex-grow-1",children:[(0,jsx_runtime.jsx)("div",{className:"input-group-prepend",title:"filter",children:(0,jsx_runtime.jsx)("div",{className:"input-group-text",children:(0,jsx_runtime.jsx)("i",{className:"fa fa-filter"})})}),(0,jsx_runtime.jsxs)(Dropdown.Z,{className:"flex-grow-1",show:isFilterMenuOpen,children:[(0,jsx_runtime.jsx)(Dropdown.Z.Toggle,{id:"target-select",size:"sm",split:!0,className:"variable-picker-dropdown d-flex align-items-center flex-grow-1",onClick:function onClick(){return setIsFilterMenuOpen(!isFilterMenuOpen)},children:(0,jsx_runtime.jsx)("span",{className:"d-flex",children:activeFilter})}),(0,jsx_runtime.jsxs)(Dropdown.Z.Menu,{onClick:function onClick(){return setIsFilterMenuOpen(!isFilterMenuOpen)},show:isFilterMenuOpen,rootCloseEvent:"click",children:[(0,jsx_runtime.jsx)(Dropdown.Z.Item,{active:activeFilter===FilterItems.SCREEN,onClick:function onClick(){setActiveFilter(FilterItems.SCREEN),setSpecificSequenceId("stage")},children:FilterItems.SCREEN}),"init"!==context&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Dropdown.Z.Item,{active:activeFilter===FilterItems.SESSION,onClick:function onClick(){setActiveFilter(FilterItems.SESSION),setSpecificSequenceId("session")},children:FilterItems.SESSION}),"mutate"!==context&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Dropdown.Z.Item,{active:activeFilter===FilterItems.VARIABLES,onClick:function onClick(){setActiveFilter(FilterItems.VARIABLES),setSpecificSequenceId("variables")},children:FilterItems.VARIABLES}),(0,jsx_runtime.jsx)(Dropdown.Z.Divider,{}),(0,jsx_runtime.jsx)(Dropdown.Z.Header,{children:"Other Screens"}),(0,jsx_runtime.jsx)("div",{className:"screen-picker-container",children:(0,jsx_runtime.jsx)(SequenceDropdown.T,{items:hierarchy,onChange:function onChangeHandler(item,e,isNextButton){if(item){var selectedActivityTree=(0,actions_sequence.Iy)(sequence,item.custom.sequenceId).map((function(lineageItem){return allActivities.find((function(act){return act.id===lineageItem.resourceId}))}));setActiveFilter(null==item?void 0:item.custom.sequenceName),setSpecificActivityTree(selectedActivityTree)}setIsFilterMenuOpen(!1);var itemId=isNextButton?"next":null==item?void 0:item.custom.sequenceId;if(!itemId)return console.warn("SequenceId not found in sequence");setSpecificSequenceId(itemId)},value:"next",showNextBtn:!1})})]})]})]})]})]})}),(0,jsx_runtime.jsxs)("div",{className:"activity-tree",children:[activeFilter===FilterItems.SESSION&&(0,jsx_runtime.jsx)(SessionTemplate,{}),activeFilter===FilterItems.VARIABLES&&(0,jsx_runtime.jsx)(VariableTemplate,{}),activeFilter!==FilterItems.SESSION&&activeFilter!==FilterItems.VARIABLES&&(0,jsx_runtime.jsx)(Accordion.Z,{children:allParts.map((function(part,index){return(0,jsx_runtime.jsx)(react.Fragment,{children:getPartTypeTemplate(part,index)},part.id)}))})]})]})]}),children:(0,jsx_runtime.jsx)(Button.Z,{className:"input-group-text",children:(0,jsx_runtime.jsx)("i",{className:"fa fa-crosshairs"})})})};VariablePicker.displayName="VariablePicker";try{VariablePicker.displayName="VariablePicker",VariablePicker.__docgenInfo={description:"",displayName:"VariablePicker",props:{placement:{defaultValue:{value:"OverlayPlacements.TOP"},description:"",name:"placement",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"right"'},{value:'"bottom"'},{value:'"left"'}]}},targetRef:{defaultValue:null,description:"",name:"targetRef",required:!1,type:{name:"RefObject<HTMLInputElement>"}},typeRef:{defaultValue:null,description:"",name:"typeRef",required:!1,type:{name:"RefObject<HTMLSelectElement>"}},onTargetChange:{defaultValue:null,description:"",name:"onTargetChange",required:!1,type:{name:"((value: any) => any)"}},onTypeChange:{defaultValue:null,description:"",name:"onTypeChange",required:!1,type:{name:"((value: any) => any)"}},context:{defaultValue:null,description:"",name:"context",required:!0,type:{name:"enum",value:[{value:'"condition"'},{value:'"init"'},{value:'"mutate"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/AdaptivityEditor/VariablePicker.tsx#VariablePicker"]={docgenInfo:VariablePicker.__docgenInfo,name:"VariablePicker",path:"src/apps/authoring/components/AdaptivityEditor/VariablePicker.tsx#VariablePicker"})}catch(__react_docgen_typescript_loader_error){}function ConditionItemEditor_slicedToArray(arr,i){return function ConditionItemEditor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ConditionItemEditor_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function ConditionItemEditor_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ConditionItemEditor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ConditionItemEditor_arrayLikeToArray(o,minLen)}(arr,i)||function ConditionItemEditor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ConditionItemEditor_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ConditionItemEditor=function ConditionItemEditor(props){var condition=props.condition,parentIndex=props.parentIndex,onChange=props.onChange,onDelete=props.onDelete,_useState2=ConditionItemEditor_slicedToArray((0,react.useState)(condition.fact),2),fact=_useState2[0],setFact=_useState2[1],_useState3=(0,react.useState)(condition.type||function inferTypeFromOperatorAndValue(operator,value){var typeCombos=conditionTypeOperatorCombos.filter((function(combo){return combo.operators.includes(operator)}));if(1===typeCombos.length)return typeCombos[0].type;var valueType=(0,capi.Mo)(value);return typeCombos.map((function(combo){return combo.type})).includes(valueType)?valueType:typeCombos[0]?typeCombos[0].type:(console.warn("Could not infer type for operator ".concat(operator)),capi.io.STRING)}(condition.operator,condition.value)),_useState4=ConditionItemEditor_slicedToArray(_useState3,2),targetType=_useState4[0],setTargetType=_useState4[1],_useState6=ConditionItemEditor_slicedToArray((0,react.useState)(condition.operator),2),operator=_useState6[0],setOperator=_useState6[1],_useState8=ConditionItemEditor_slicedToArray((0,react.useState)(condition.value),2),value=_useState8[0],setValue=_useState8[1],_useState10=ConditionItemEditor_slicedToArray((0,react.useState)(!1),2),showConfirmDelete=_useState10[0],setShowConfirmDelete=_useState10[1],handleFactChange=function handleFactChange(val){setFact(val),onChange({fact:val})},handleTargetTypeChange=function handleTargetTypeChange(e){var val=parseInt(e.target.value);val!==targetType&&(setTargetType(val),onChange({type:val}))},handleOperatorChange=function handleOperatorChange(e){var val=e.target.value;val!==operator&&(setOperator(val),onChange({operator:val}))},typeRef=(0,react.useRef)(null),getFilteredConditionOperatorOptions=function getFilteredConditionOperatorOptions(){var _filteredCombo$,filteredConditionOperatorOptions=[];return null===(_filteredCombo$=conditionTypeOperatorCombos.filter((function(combo){return combo.type===targetType}))[0])||void 0===_filteredCombo$||_filteredCombo$.operators.forEach((function(comboOperator){conditionOperatorOptions.forEach((function(conditionOperator){conditionOperator.key===comboOperator&&filteredConditionOperatorOptions.push(conditionOperator)}))})),filteredConditionOperatorOptions};return(0,react.useEffect)((function(){setTimeout((function(){var filteredOperations=getFilteredConditionOperatorOptions(),operatorInList=filteredOperations.find((function(option){return option.value===operator})),updatedOperator=operatorInList?operatorInList.value:filteredOperations[0].value;updatedOperator!==operator&&(setOperator(updatedOperator),onChange({operator:updatedOperator}))}),10)}),[targetType]),react.useEffect((function(){setFact(condition.fact)}),[condition.fact]),(0,jsx_runtime.jsxs)("div",{className:"d-flex mt-1",children:[(0,jsx_runtime.jsxs)("div",{className:"input-group input-group-sm flex-grow-1",children:[(0,jsx_runtime.jsx)("div",{className:"input-group-prepend",title:"Target",children:(0,jsx_runtime.jsx)(VariablePicker,{onTargetChange:function onTargetChange(value){return handleFactChange(value)},typeRef,placement:OverlayPlacements.TOP,context:"condition"})}),(0,jsx_runtime.jsx)("label",{className:"sr-only",htmlFor:"target-".concat(parentIndex),children:"target"}),(0,jsx_runtime.jsx)("input",{id:"target-".concat(parentIndex),className:"form-control form-control-sm flex-grow-1 mr-2 w-8",type:"text",placeholder:"Target",value:fact,onChange:function onChange(e){return setFact(e.target.value)},onBlur:function onBlur(e){return handleFactChange(e.target.value)},title:fact.toString(),tabIndex:0},"target-".concat(parentIndex))]}),(0,jsx_runtime.jsx)("label",{className:"sr-only",htmlFor:"target-type-".concat(parentIndex),children:"type"}),(0,jsx_runtime.jsx)("select",{className:"custom-select mr-2 form-control form-control-sm",id:"target-type-".concat(parentIndex),defaultValue:targetType,onChange:function onChange(e){return handleTargetTypeChange(e)},ref:typeRef,children:typeOptions.map((function(type){return(0,jsx_runtime.jsx)("option",{value:type.value,children:type.text},type.key)}))}),(0,jsx_runtime.jsx)("label",{className:"sr-only",htmlFor:"operator-".concat(parentIndex),children:"operator"}),(0,jsx_runtime.jsx)("select",{className:"custom-select mr-2 form-control form-control-sm flex-grow-1 mw-25",id:"operator-".concat(parentIndex),placeholder:"Operator",defaultValue:operator,onChange:function onChange(e){return handleOperatorChange(e)},title:operator.toString(),tabIndex:0,children:getFilteredConditionOperatorOptions().map((function(option,index){return(0,jsx_runtime.jsx)("option",{value:option.value,title:option.key,children:option.text},"option".concat(index,"-").concat(parentIndex))}))},"operator-".concat(parentIndex)),(0,jsx_runtime.jsx)("label",{className:"sr-only",htmlFor:"value-".concat(parentIndex),children:"value"}),(0,jsx_runtime.jsx)("input",{type:"text",className:"form-control form-control-sm flex-grow-1 mw-25",id:"value-".concat(parentIndex),defaultValue:value,onBlur:function onBlur(e){return function handleValueChange(e){var val=e.target.value;val!==value&&(setValue(val),onChange({value:val}))}(e)},title:value.toString(),placeholder:"Value",tabIndex:0},"value-".concat(parentIndex)),(0,jsx_runtime.jsx)(OverlayTrigger.Z,{placement:"top",delay:{show:150,hide:150},overlay:(0,jsx_runtime.jsx)(Tooltip.Z,{id:"button-tooltip",style:{fontSize:"12px"},children:"Delete Condition"}),children:(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("button",{className:"btn btn-link p-0 ml-1",onClick:function onClick(){return setShowConfirmDelete(!0)},children:(0,jsx_runtime.jsx)("i",{className:"fa fa-trash-alt"})})})}),showConfirmDelete&&(0,jsx_runtime.jsx)(DeleteConfirmationModal.Z,{show:showConfirmDelete,elementType:"Condition",elementName:"this rule condition",deleteHandler:function deleteHandler(){onDelete(),setShowConfirmDelete(!1)},cancelHandler:function cancelHandler(){setShowConfirmDelete(!1)}})]},parentIndex)};ConditionItemEditor.displayName="ConditionItemEditor";const AdaptivityEditor_ConditionItemEditor=ConditionItemEditor;try{ConditionItemEditor.displayName="ConditionItemEditor",ConditionItemEditor.__docgenInfo={description:"",displayName:"ConditionItemEditor",props:{condition:{defaultValue:null,description:"",name:"condition",required:!0,type:{name:"JanusConditionProperties"}},parentIndex:{defaultValue:null,description:"",name:"parentIndex",required:!0,type:{name:"number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(condition: Partial<JanusConditionProperties>) => void"}},onDelete:{defaultValue:null,description:"",name:"onDelete",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/AdaptivityEditor/ConditionItemEditor.tsx#ConditionItemEditor"]={docgenInfo:ConditionItemEditor.__docgenInfo,name:"ConditionItemEditor",path:"src/apps/authoring/components/AdaptivityEditor/ConditionItemEditor.tsx#ConditionItemEditor"})}catch(__react_docgen_typescript_loader_error){}function ConditionsBlockEditor_typeof(obj){return ConditionsBlockEditor_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},ConditionsBlockEditor_typeof(obj)}function ConditionsBlockEditor_toConsumableArray(arr){return function ConditionsBlockEditor_arrayWithoutHoles(arr){if(Array.isArray(arr))return ConditionsBlockEditor_arrayLikeToArray(arr)}(arr)||function ConditionsBlockEditor_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||ConditionsBlockEditor_unsupportedIterableToArray(arr)||function ConditionsBlockEditor_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ConditionsBlockEditor_defineProperty(obj,key,value){return(key=function ConditionsBlockEditor_toPropertyKey(arg){var key=function ConditionsBlockEditor_toPrimitive(input,hint){if("object"!==ConditionsBlockEditor_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==ConditionsBlockEditor_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===ConditionsBlockEditor_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function ConditionsBlockEditor_slicedToArray(arr,i){return function ConditionsBlockEditor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ConditionsBlockEditor_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||ConditionsBlockEditor_unsupportedIterableToArray(arr,i)||function ConditionsBlockEditor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ConditionsBlockEditor_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return ConditionsBlockEditor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ConditionsBlockEditor_arrayLikeToArray(o,minLen):void 0}}function ConditionsBlockEditor_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var findConditionById=function findConditionById(id,conditions){var found=conditions.find((function(condition){return condition.id===id}))||null;if(!found){var blocks=conditions.filter((function(condition){return condition.all||condition.any}));if(blocks.length>0)for(var i=0;i<blocks.length&&!(found=findConditionById(id,blocks[i].any||blocks[i].all));i++);}return found||null},forEachCondition=function forEachCondition(conditions,callback){for(var cloneConditions=(0,common.d9)(conditions),i=0;i<cloneConditions.length;i++){var _condition=cloneConditions[i];if(callback(_condition),_condition.all||_condition.any){var type=!!_condition.all?"all":"any";_condition[type]=forEachCondition(_condition[type],callback)}}return cloneConditions},deleteConditionById=function deleteConditionById(id,conditions){var cloneConditions=(0,common.d9)(conditions);return cloneConditions.find((function(condition){return condition.id===id}))?cloneConditions.filter((function(condition){return condition.id!==id})):forEachCondition(cloneConditions,(function(condition){(condition.all||condition.any)&&(!!condition.all?condition.all=deleteConditionById(id,condition.all):condition.any=deleteConditionById(id,condition.any))}))},ConditionsBlockEditor=function ConditionsBlockEditor(props){var id=props.id,type=props.type,index=props.index,rootConditions=props.rootConditions,onChange=props.onChange,_useState2=ConditionsBlockEditor_slicedToArray((0,react.useState)(type),2),blockType=_useState2[0],setBlockType=_useState2[1],_useState4=ConditionsBlockEditor_slicedToArray((0,react.useState)(rootConditions||[]),2),conditions=_useState4[0],setConditions=_useState4[1],_useState6=ConditionsBlockEditor_slicedToArray((0,react.useState)(index),2),loopIndex=_useState6[0],setLoopIndex=_useState6[1],_useState8=ConditionsBlockEditor_slicedToArray((0,react.useState)(!1),2),showConfirmDelete=_useState8[0],setShowConfirmDelete=_useState8[1],_useState10=ConditionsBlockEditor_slicedToArray((0,react.useState)(void 0),2),conditionToDelete=_useState10[0],setConditionToDelete=_useState10[1],_useState12=ConditionsBlockEditor_slicedToArray((0,react.useState)(void 0),2),loopIndexToDelete=_useState12[0],setLoopIndexToDelete=_useState12[1];(0,react.useEffect)((function(){setLoopIndex(index+1)}),[]),(0,react.useEffect)((function(){type!==blockType&&setBlockType(type),(0,lodash.isEqual)(conditions,rootConditions)||setConditions(rootConditions||[])}),[type,rootConditions]),(0,react.useEffect)((function(){onChange(ConditionsBlockEditor_defineProperty({},blockType,conditions))}),[conditions,blockType]);var handleBlockTypeChange=function handleBlockTypeChange(){setBlockType("all"===blockType?"any":"all")},handleAddConditionBlock=function handleAddConditionBlock(){var newType=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"any",block=ConditionsBlockEditor_defineProperty({id:"b:".concat((0,guid.Z)())},newType,[{id:"c:".concat((0,guid.Z)()),fact:"stage.",type:capi.io.STRING,operator:"equal",value:""}]);setConditions([].concat(ConditionsBlockEditor_toConsumableArray(conditions),[block]))},handleDeleteCondition=function handleDeleteCondition(condition,loopIndex){if("root"===condition.id){var empty=[];return setConditions(empty),onChange(loopIndex&&loopIndex>0?{}:ConditionsBlockEditor_defineProperty({},blockType,empty))}var updatedConditions=deleteConditionById(condition.id,conditions);setConditions(updatedConditions)},AddConditionContextMenu=function AddConditionContextMenu(){return(0,jsx_runtime.jsxs)(Dropdown.Z.Menu,{children:[(0,jsx_runtime.jsxs)(Dropdown.Z.Item,{onClick:function onClick(){return function handleAddCondition(){var newCondition={id:"c:".concat((0,guid.Z)()),type:capi.io.STRING,fact:"stage.",operator:"equal",value:""};setConditions([].concat(ConditionsBlockEditor_toConsumableArray(conditions),[newCondition]))}()},children:[(0,jsx_runtime.jsx)("i",{className:"fa fa-plus mr-2"})," Single Condition"]}),(0,jsx_runtime.jsxs)(Dropdown.Z.Item,{onClick:function onClick(){return handleAddConditionBlock("any")},children:[(0,jsx_runtime.jsx)("i",{className:"fa fa-plus mr-2"})," Any Block"]}),(0,jsx_runtime.jsxs)(Dropdown.Z.Item,{onClick:function onClick(){return handleAddConditionBlock("all")},children:[(0,jsx_runtime.jsx)("i",{className:"fa fa-plus mr-2"})," All Block"]})]})};return(0,jsx_runtime.jsxs)("div",{className:"aa-conditions d-flex",children:[(0,jsx_runtime.jsxs)(Dropdown.Z,{children:[(0,jsx_runtime.jsx)(OverlayTrigger.Z,{placement:"top",delay:{show:150,hide:150},overlay:(0,jsx_runtime.jsx)(Tooltip.Z,{id:"button-tooltip",style:{fontSize:"12px"},children:"New Condition"}),children:(0,jsx_runtime.jsx)(Dropdown.Z.Toggle,{id:"rules-list-add-context-trigger",className:"dropdown-toggle aa-add-button btn btn-primary btn-sm mr-3",children:(0,jsx_runtime.jsx)("i",{className:"fa fa-plus"})})}),(0,jsx_runtime.jsx)(AddConditionContextMenu,{})]}),(0,jsx_runtime.jsx)("div",{className:"d-flex flex-column flex-1",children:(0,jsx_runtime.jsxs)("div",{className:"aa-condition border rounded p-2 mt-4",children:[(0,jsx_runtime.jsxs)("div",{className:"aa-condition-header d-flex justify-content-between align-items-center",children:[(0,jsx_runtime.jsx)("div",{children:"CONDITIONS"}),(0,jsx_runtime.jsxs)("div",{children:[0!==loopIndex&&(0,jsx_runtime.jsx)(OverlayTrigger.Z,{placement:"top",delay:{show:150,hide:150},overlay:(0,jsx_runtime.jsx)(Tooltip.Z,{id:"button-tooltip",style:{fontSize:"12px"},children:"Delete Group"}),children:(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("button",{className:"btn btn-link p-0",onClick:function onClick(){setShowConfirmDelete(!0),setConditionToDelete({id:"root"}),setLoopIndexToDelete(loopIndex)},children:(0,jsx_runtime.jsx)("i",{className:"fa fa-trash-alt"})})})}),0===loopIndex&&conditions.length>=1&&(0,jsx_runtime.jsx)(OverlayTrigger.Z,{placement:"top",delay:{show:150,hide:150},overlay:(0,jsx_runtime.jsx)(Tooltip.Z,{id:"button-tooltip",style:{fontSize:"12px"},children:"Delete ".concat(0===loopIndex?"All":"Group")}),children:(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("button",{className:"btn btn-link p-0",onClick:function onClick(){setShowConfirmDelete(!0),setConditionToDelete({id:"root"})},children:(0,jsx_runtime.jsx)("i",{className:"fa fa-trash-alt"})})})}),(0,jsx_runtime.jsxs)(Dropdown.Z,{children:[(0,jsx_runtime.jsx)(OverlayTrigger.Z,{placement:"top",delay:{show:150,hide:150},overlay:(0,jsx_runtime.jsx)(Tooltip.Z,{id:"button-tooltip",style:{fontSize:"12px"},children:"New Condition"}),children:(0,jsx_runtime.jsx)(Dropdown.Z.Toggle,{variant:"link",id:"add-condition-".concat(id,"-context-trigger-").concat(index),className:"dropdown-toggle btn btn-link p-0 ml-1",children:(0,jsx_runtime.jsx)("i",{className:"fa fa-plus"})})}),(0,jsx_runtime.jsx)(AddConditionContextMenu,{})]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"d-flex align-items-center flex-wrap",children:[(0,jsx_runtime.jsx)("span",{className:"mr-2",children:"If"}),(0,jsx_runtime.jsxs)("div",{className:"form-check form-check-inline mr-1",children:[(0,jsx_runtime.jsx)("input",{className:"form-check-input",type:"radio",name:"anyAllToggle-".concat(id),id:"anyCondition-".concat(id),checked:"any"===blockType,onChange:function onChange(){return handleBlockTypeChange()}}),(0,jsx_runtime.jsx)("label",{className:"form-check-label",htmlFor:"anyCondition-root",children:"ANY"})]}),(0,jsx_runtime.jsxs)("div",{className:"form-check form-check-inline mr-2",children:[(0,jsx_runtime.jsx)("input",{className:"form-check-input",type:"radio",name:"anyAllToggle-".concat(id),id:"allCondition-".concat(id),checked:"all"===blockType,onChange:function onChange(){return handleBlockTypeChange()}}),(0,jsx_runtime.jsx)("label",{className:"form-check-label",htmlFor:"allCondition-root",children:"ALL"})]}),"of the following conditions are met"]}),conditions.length<=0&&(0,jsx_runtime.jsx)("div",{className:"mt-2 text-danger",children:"No conditions. This rule will always fire."}),conditions.map((function(condition,index){return condition.all||condition.any?(0,jsx_runtime.jsx)(ConditionsBlockEditor,{id:condition.id||"cb-".concat(index),type:condition.all?"all":"any",rootConditions:condition.all||condition.any||[],onChange:function onChange(changes){return function handleSubBlockChange(condition,changes){var updatedConditions=forEachCondition(conditions,(function(c){c.id===condition.id&&(changes.all?(delete c.any,c.all=changes.all):(delete c.all,c.any=changes.any))}));setConditions(updatedConditions)}(condition,changes)},index:loopIndex},condition.id||"cb-".concat(index)):(0,jsx_runtime.jsx)(AdaptivityEditor_ConditionItemEditor,{parentIndex:index,condition,onChange:function onChange(changes){return function handleConditionItemChange(condition,changes){var updatedConditions=forEachCondition(conditions,(function(c){c.id===condition.id&&(changes.fact&&(c.fact=changes.fact),changes.type&&(c.type=changes.type),changes.operator&&(c.operator=changes.operator),void 0!==changes.value&&(c.value=changes.value))}));setConditions(updatedConditions)}(condition,changes)},onDelete:function onDelete(){return handleDeleteCondition(condition)}},condition.id||"ci-".concat(index))}))]})}),showConfirmDelete&&(0,jsx_runtime.jsx)(DeleteConfirmationModal.Z,{show:showConfirmDelete,elementType:"".concat(loopIndexToDelete?"Condition Group":"All Conditions"),elementName:"".concat(loopIndexToDelete?"this condition group":"all conditions"),deleteHandler:function deleteHandler(){handleDeleteCondition(conditionToDelete,loopIndexToDelete||void 0),setShowConfirmDelete(!1),setConditionToDelete(void 0),setLoopIndexToDelete(void 0)},cancelHandler:function cancelHandler(){setShowConfirmDelete(!1),setConditionToDelete(void 0),setLoopIndexToDelete(void 0)}})]})};ConditionsBlockEditor.displayName="ConditionsBlockEditor";try{ConditionsBlockEditor.displayName="ConditionsBlockEditor",ConditionsBlockEditor.__docgenInfo={description:"",displayName:"ConditionsBlockEditor",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:'"all"'},{value:'"any"'}]}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},rootConditions:{defaultValue:null,description:"",name:"rootConditions",required:!0,type:{name:"JanusNestedCondition[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(changes: Partial<JanusTopLevelCondition>) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/AdaptivityEditor/ConditionsBlockEditor.tsx#ConditionsBlockEditor"]={docgenInfo:ConditionsBlockEditor.__docgenInfo,name:"ConditionsBlockEditor",path:"src/apps/authoring/components/AdaptivityEditor/ConditionsBlockEditor.tsx#ConditionsBlockEditor"})}catch(__react_docgen_typescript_loader_error){}var DiagnosticTypes=function(DiagnosticTypes){return DiagnosticTypes.DUPLICATE="duplicate",DiagnosticTypes.PATTERN="pattern",DiagnosticTypes.BROKEN="broken",DiagnosticTypes.INCOMPLETE="incomplete",DiagnosticTypes.INVALID_TARGET_MUTATE="invalid_target_mutate",DiagnosticTypes.INVALID_VALUE="invalid_value",DiagnosticTypes.INVALID_TARGET_INIT="invalid_target_init",DiagnosticTypes.INVALID_TARGET_COND="invalid_target_cond",DiagnosticTypes.INVALID_EXPRESSION_VALUE="invalid_expression_value",DiagnosticTypes.INVALID_EXPRESSION="invalid_expression",DiagnosticTypes.INVALID_OWNER_INIT="invalid_owner_init",DiagnosticTypes.INVALID_OWNER_CONDITION="invalid_owner_condition",DiagnosticTypes.INVALID_OWNER_MUTATE="invalid_owner_mutate",DiagnosticTypes.DEFAULT="",DiagnosticTypes}({}),DiagnosticRuleTypes=[DiagnosticTypes.INVALID_TARGET_COND,DiagnosticTypes.INVALID_TARGET_INIT,DiagnosticTypes.INVALID_TARGET_MUTATE,DiagnosticTypes.INVALID_VALUE,DiagnosticTypes.INVALID_EXPRESSION_VALUE,DiagnosticTypes.INVALID_EXPRESSION,DiagnosticTypes.INVALID_OWNER_INIT,DiagnosticTypes.INVALID_OWNER_CONDITION,DiagnosticTypes.INVALID_OWNER_MUTATE],app_name=__webpack_require__("./src/apps/authoring/store/app/name.ts");function validate_typeof(obj){return validate_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},validate_typeof(obj)}function validate_regeneratorRuntime(){validate_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==validate_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function validate_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function validate_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){validate_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){validate_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function validate_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function validate_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?validate_ownKeys(Object(source),!0).forEach((function(key){validate_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):validate_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function validate_defineProperty(obj,key,value){return(key=function validate_toPropertyKey(arg){var key=function validate_toPrimitive(input,hint){if("object"!==validate_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==validate_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===validate_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function validate_toConsumableArray(arr){return function validate_arrayWithoutHoles(arr){if(Array.isArray(arr))return validate_arrayLikeToArray(arr)}(arr)||function validate_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function validate_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return validate_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return validate_arrayLikeToArray(o,minLen)}(arr)||function validate_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function validate_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var generateSuggestion=function generateSuggestion(id){var dupBlacklist=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],newId=id.replace(/[^a-zA-Z0-9_]/g,"");if(dupBlacklist.includes(newId)){var lastChar=newId.slice(-1);if(lastChar.match(/[0-9]/)){var newLastChar=parseInt(lastChar,10)+1;newId="".concat(newId.slice(0,-1)).concat(newLastChar)}else newId="".concat(newId,"1");return generateSuggestion(newId,dupBlacklist)}return newId},parseTarget=function parseTarget(target){var screen;target.indexOf("|")>-1&&(screen=(screen=target.split("|")[0].replace("{","")).replace("(",""));var targetNameIdx=target.search(/app|variables|stage|session/),split=target.slice(targetNameIdx).split(".");return{type:split[0],id:split[1],screen}},validateTarget=function validateTarget(target,activity,parts){if(target.match(/{([^{^}]+)}/g))return!1;var _parseTarget=parseTarget(target),id=_parseTarget.id,type=_parseTarget.type;if(!id)return!1;switch(type){case"app":return"active"===id||parts.some((function(p){return p.id===id}));case"variables":case"stage":return parts.some((function(p){return p.id===id}));case"session":return!!id;default:return!1}},validateValueExpression=function validateValueExpression(condition,rule,owner){if("string"==typeof condition.value){var evaluatedExp=(0,scripting.y1)(condition.value);if(evaluatedExp!==condition.value)return{condition,rule,fact:rule,owner,suggestedFix:evaluatedExp}}},validateOwner=function validateOwner(value,activityList,sequence){var _parseTarget2=parseTarget(value),id=_parseTarget2.id,screen=_parseTarget2.screen;if(screen){var act=getOwnerByScreenId(screen,activityList||[],sequence),isValidPart=null==act?void 0:act.content.partsLayout.find((function(part){return part.id===id}));if(!isValidPart)return{suggestedFix:value}}return null},getOwnerByScreenId=function getOwnerByScreenId(screen,activityList,sequence){return null==activityList?void 0:activityList.find((function(activity){var seqItem=sequence.find((function(s){return s.resourceId===activity.id}));return(null==seqItem?void 0:seqItem.custom.sequenceId)===screen}))},getExpressionTarget=function getExpressionTarget(value){var val=Array.isArray(value)?value[0].toString():value.toString(),expr=val.match(/{([^{^}]+)}/g);return expr&&expr.length>0&&(val=expr[0]),val},validators=[{type:DiagnosticTypes.INVALID_EXPRESSION,validate:function validate(activity,sequence){var _activity$content;if(!sequence)throw new Error("INVALID_EXPRESSION VALIDATION: sequence is undefined!");if(null===(_activity$content=activity.content)||void 0===_activity$content||!_activity$content.partsLayout)throw new Error("INVALID_EXPRESSION VALIDATION: activity.content.partsLayout is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id})),parts=activity.content.partsLayout,brokenExpressions=[];return parts.forEach((function(part){var Klass=customElements.get(part.type);if(Klass){var instance=new Klass;if(instance.getCapabilities)if(instance.getCapabilities().canUseExpression&&instance.validateUserConfig){var partClone=(0,common.d9)(part),formattedExpression=instance.validateUserConfig(partClone,owner);null!=formattedExpression&&formattedExpression.length&&brokenExpressions.push.apply(brokenExpressions,validate_toConsumableArray(formattedExpression))}}})),[].concat(brokenExpressions)}},{type:DiagnosticTypes.DUPLICATE,validate:function validate(activity,sequence,allParts,allActivities){var _activity$content2;if(!sequence)throw new Error("DUPLICATE VALIDATION: sequence is undefined!");if(null===(_activity$content2=activity.content)||void 0===_activity$content2||!_activity$content2.partsLayout)throw new Error("DUPLICATE VALIDATION: activity.content.partsLayout is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id}));if(!owner)throw new Error("DUPLICATE VALIDATION: activity ".concat(activity.id," not found in sequence!"));var lineage=(0,actions_sequence.Iy)(sequence,owner.custom.sequenceId);lineage.pop();var lineageBlacklist=lineage.map((function(s){return allActivities.find((function(a){return a.id===s.resourceId}))})).map((function(a){var _a$content;return((null==a||null===(_a$content=a.content)||void 0===_a$content?void 0:_a$content.partsLayout)||[]).map((function(ref){return ref.id}))})).reduce((function(acc,cur){return acc.concat(cur)}),[]),partList=activity.content.partsLayout,selfDupes=partList.filter((function(ref){return partList.filter((function(ref2){return ref2.id===ref.id})).length>1})).map((function(ref){return validate_objectSpread(validate_objectSpread({},ref),{},{owner})})),lineageDupes=partList.filter((function(ref){return lineageBlacklist.includes(ref.id)})).map((function(ref){return validate_objectSpread(validate_objectSpread({},ref),{},{owner})}));return[].concat(validate_toConsumableArray(selfDupes),validate_toConsumableArray(lineageDupes))}},{type:DiagnosticTypes.PATTERN,validate:function validate(activity,sequence){var _activity$content3;if(!sequence)throw new Error("PATTERN VALIDATION: sequence is undefined!");if(null===(_activity$content3=activity.content)||void 0===_activity$content3||!_activity$content3.partsLayout)throw new Error("PATTERN VALIDATION: activity.content.partsLayout is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id}));return activity.content.partsLayout.filter((function(ref){return!ref.inherited&&!/^[a-zA-Z0-9_\-: ]+$/.test(ref.id)})).map((function(ref){return validate_objectSpread(validate_objectSpread({},ref),{},{owner})}))}},{type:DiagnosticTypes.BROKEN,validate:function validate(activity,sequence){var _activity$authoring;if(!sequence)throw new Error("BROKEN NAVIGATION VALIDATION: sequence is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id})),hierarchy=(0,actions_sequence._y)(sequence);return((null===(_activity$authoring=activity.authoring)||void 0===_activity$authoring?void 0:_activity$authoring.rules)||[]).reduce((function(brokenColl,rule){var brokenActions=rule.event.params.actions.map((function(action){var _action$params;if("navigation"===action.type&&(null!=action&&null!==(_action$params=action.params)&&void 0!==_action$params&&_action$params.target&&"next"!==action.params.target&&!(0,actions_sequence.wb)(hierarchy,action.params.target)))return validate_objectSpread(validate_objectSpread({},rule),{},{owner,suggestedFix:"Screen does not exist, fix navigate to."});return null}));return[].concat(validate_toConsumableArray(brokenColl),validate_toConsumableArray(brokenActions))}),[])}},{type:DiagnosticTypes.INVALID_TARGET_MUTATE,validate:function validate(activity,sequence,parts){var _activity$authoring2;if(!sequence)throw new Error("INVALID_TARGET_MUTATE VALIDATION: sequence is undefined!");if(!parts)throw new Error("INVALID_TARGET_MUTATE VALIDATION: parts is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id}));return((null===(_activity$authoring2=activity.authoring)||void 0===_activity$authoring2?void 0:_activity$authoring2.rules)||[]).reduce((function(brokenColl,rule){var brokenActions=rule.event.params.actions.map((function(action){return"mutateState"===action.type?validateTarget(action.params.target,0,parts)?null:validate_objectSpread(validate_objectSpread({},rule),{},{action,owner,suggestedFix:""}):null}));return[].concat(validate_toConsumableArray(brokenColl),validate_toConsumableArray(brokenActions))}),[])}},{type:DiagnosticTypes.INVALID_TARGET_INIT,validate:function validate(activity,sequence,parts){var _activity$content4,_activity$content4$cu;if(!sequence)throw new Error("INVALID_TARGET_INIT VALIDATION: sequence is undefined!");if(!parts)throw new Error("INVALID_TARGET_INIT VALIDATION: parts is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id}));return(null===(_activity$content4=activity.content)||void 0===_activity$content4||null===(_activity$content4$cu=_activity$content4.custom)||void 0===_activity$content4$cu?void 0:_activity$content4$cu.facts).reduce((function(broken,fact){return[].concat(validate_toConsumableArray(broken),[validateTarget(fact.target,0,parts)?null:{fact,owner,suggestedFix:""}])}),[])}},{type:DiagnosticTypes.INVALID_TARGET_COND,validate:function validate(activity,sequence,parts){var _activity$authoring3;if(!sequence)throw new Error("INVALID_TARGET_COND VALIDATION: sequence is undefined!");if(!parts)throw new Error("INVALID_TARGET_COND VALIDATION: parts is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id}));return((null===(_activity$authoring3=activity.authoring)||void 0===_activity$authoring3?void 0:_activity$authoring3.rules)||[]).reduce((function(broken,rule){var conditions=[].concat(validate_toConsumableArray(rule.conditions.all||[]),validate_toConsumableArray(rule.conditions.any||[])),brokenConditionValues=[];return forEachCondition(conditions,(function(condition){validateTarget(condition.fact,0,parts)||brokenConditionValues.push({condition,rule,owner,suggestedFix:""})})),[].concat(validate_toConsumableArray(broken),brokenConditionValues)}),[])}},{type:DiagnosticTypes.INVALID_VALUE,validate:function validate(activity,sequence){var _activity$authoring4;if(!sequence)throw new Error("INVALID_VALUE VALIDATION: sequence is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id}));return((null===(_activity$authoring4=activity.authoring)||void 0===_activity$authoring4?void 0:_activity$authoring4.rules)||[]).reduce((function(broken,rule){var conditions=[].concat(validate_toConsumableArray(rule.conditions.all||[]),validate_toConsumableArray(rule.conditions.any||[])),brokenConditionValues=[];return forEachCondition(conditions,(function(condition){brokenConditionValues.push(function validateValue(condition,rule,owner){return!has_default()(condition,"value")||null!==condition.value&&void 0!==condition.value?null:{condition,rule,owner,suggestedFix:""}}(condition,rule,owner))})),[].concat(validate_toConsumableArray(broken),brokenConditionValues)}),[])}},{type:DiagnosticTypes.INVALID_EXPRESSION_VALUE,validate:function validate(activity,sequence){var _activity$content5,_activity$content5$cu,_activity$authoring5;if(!sequence)throw new Error("INVALID_EXPRESSION_VALUE VALIDATION: sequence is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id})),brokenFactConditionValues=[],brokenFacts=(null===(_activity$content5=activity.content)||void 0===_activity$content5||null===(_activity$content5$cu=_activity$content5.custom)||void 0===_activity$content5$cu?void 0:_activity$content5$cu.facts).reduce((function(broken,fact){var updatedFact=validateValueExpression(fact,fact,owner);if(updatedFact)return updatedFact&&broken?[].concat(validate_toConsumableArray(broken),[updatedFact]):[updatedFact]}),[]);if(null!=brokenFacts&&brokenFacts.length){var updatedFacts=null==brokenFacts?void 0:brokenFacts.filter((function(fact){return fact}));updatedFacts&&brokenFactConditionValues.push.apply(brokenFactConditionValues,validate_toConsumableArray(updatedFacts))}var brokenConditionValues=((null===(_activity$authoring5=activity.authoring)||void 0===_activity$authoring5?void 0:_activity$authoring5.rules)||[]).reduce((function(broken,rule){var conditions=[].concat(validate_toConsumableArray(rule.conditions.all||[]),validate_toConsumableArray(rule.conditions.any||[])),brokenConditionValues=[];return forEachCondition(conditions,(function(condition){brokenConditionValues.push(validateValueExpression(condition,rule,owner))})),[].concat(validate_toConsumableArray(broken),brokenConditionValues)}),[]);return[].concat(validate_toConsumableArray(brokenConditionValues),brokenFactConditionValues)}},{type:DiagnosticTypes.INVALID_OWNER_INIT,validate:function validate(activity,sequence,parts,activityList){var _activity$content6,_activity$content7,_activity$content7$cu;if(!sequence)throw new Error("DUPLICATE VALIDATION: sequence is undefined!");if(null===(_activity$content6=activity.content)||void 0===_activity$content6||!_activity$content6.partsLayout)throw new Error("DUPLICATE VALIDATION: activity.content.partsLayout is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id})),brokenFactConditionValues=[],brokenFacts=(null===(_activity$content7=activity.content)||void 0===_activity$content7||null===(_activity$content7$cu=_activity$content7.custom)||void 0===_activity$content7$cu?void 0:_activity$content7$cu.facts).reduce((function(broken,fact){var val=getExpressionTarget(fact.value),fix=validateOwner(val,activityList||[],sequence);if(fix){var error=validate_objectSpread({fact,owner},fix);broken=[].concat(validate_toConsumableArray(broken),[error])}return broken}),[]);if(null!=brokenFacts&&brokenFacts.length){var updatedFacts=null==brokenFacts?void 0:brokenFacts.filter((function(fact){return fact}));updatedFacts&&brokenFactConditionValues.push.apply(brokenFactConditionValues,validate_toConsumableArray(updatedFacts))}return[].concat(brokenFactConditionValues)}},{type:DiagnosticTypes.INVALID_OWNER_CONDITION,validate:function validate(activity,sequence,parts,activityList){var _activity$content8,_activity$authoring6;if(!sequence)throw new Error("DUPLICATE VALIDATION: sequence is undefined!");if(null===(_activity$content8=activity.content)||void 0===_activity$content8||!_activity$content8.partsLayout)throw new Error("DUPLICATE VALIDATION: activity.content.partsLayout is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id})),brokenConditionValues=((null===(_activity$authoring6=activity.authoring)||void 0===_activity$authoring6?void 0:_activity$authoring6.rules)||[]).reduce((function(broken,rule){var conditions=[].concat(validate_toConsumableArray(rule.conditions.all||[]),validate_toConsumableArray(rule.conditions.any||[]));return forEachCondition(conditions,(function(condition){var val=getExpressionTarget(condition.value);if("string"==typeof val){var fix=validateOwner(val,activityList||[],sequence);if(fix){var error=validate_objectSpread({condition,owner,rule},fix);broken=[].concat(validate_toConsumableArray(broken),[error])}}else Array.isArray(val)&&val.forEach((function(v){if("string"==typeof v){var _fix=validateOwner(v,activityList||[],sequence);_fix&&(broken=[].concat(validate_toConsumableArray(broken),[validate_objectSpread({condition,rule,owner},_fix)]))}}))})),broken}),[]);return validate_toConsumableArray(brokenConditionValues)}},{type:DiagnosticTypes.INVALID_OWNER_MUTATE,validate:function validate(activity,sequence,parts,activityList){var _activity$content9,_activity$authoring7;if(!sequence)throw new Error("DUPLICATE VALIDATION: sequence is undefined!");if(null===(_activity$content9=activity.content)||void 0===_activity$content9||!_activity$content9.partsLayout)throw new Error("DUPLICATE VALIDATION: activity.content.partsLayout is undefined!");var owner=sequence.find((function(s){return s.resourceId===activity.id})),brokenMutateValues=((null===(_activity$authoring7=activity.authoring)||void 0===_activity$authoring7?void 0:_activity$authoring7.rules)||[]).reduce((function(broken,rule){var brokenActions=rule.event.params.actions.map((function(action){if("mutateState"===action.type){var val=getExpressionTarget(action.params.value);if("string"==typeof val){var fix=validateOwner(val,activityList||[],sequence);if(fix){var error=validate_objectSpread(validate_objectSpread({action,owner},rule),fix);broken=[].concat(validate_toConsumableArray(broken),[error])}}else Array.isArray(val)&&val.forEach((function(v){if("string"==typeof v){var _fix2=validateOwner(v,activityList||[],sequence);_fix2&&(broken=[].concat(validate_toConsumableArray(broken),[validate_objectSpread({action,rule,owner},_fix2)]))}}))}return null}));return[].concat(validate_toConsumableArray(broken),validate_toConsumableArray(brokenActions))}),[]);return validate_toConsumableArray(brokenMutateValues)}}],diagnosePage=function diagnosePage(page,allActivities,sequence){var _page$custom,_page$custom2,hierarchy=(0,actions_sequence._y)(sequence),errors=[],partsList=allActivities.reduce((function(list,act){return list.concat(act.content.partsLayout)}),[]),parts=uniqBy_default()([].concat(validate_toConsumableArray(partsList),validate_toConsumableArray((null==page||null===(_page$custom=page.custom)||void 0===_page$custom?void 0:_page$custom.everApps)||[]),validate_toConsumableArray(((null==page||null===(_page$custom2=page.custom)||void 0===_page$custom2?void 0:_page$custom2.variables)||[]).map((function(v){return{id:v.name}})))),(function(i){return i.id}));return allActivities.forEach((function(activity){var foundProblems=validators.reduce((function(probs,validator){return validate_objectSpread(validate_objectSpread({},probs),{},validate_defineProperty({},validator.type,validator.validate(activity,sequence,parts,allActivities).filter((function(e){return!!e}))))}),{});if(Object.keys(foundProblems).reduce((function(c,current){return foundProblems[current].length+c}),0)>0){var _hierarchyItem$childr,activitySequence=sequence.find((function(s){return s.resourceId===activity.id})),lineageBlacklist=(0,actions_sequence.Iy)(sequence,activitySequence.custom.sequenceId).map((function(s){return allActivities.find((function(a){return a.id===s.resourceId}))})).map((function(a){var _a$content2;return((null==a||null===(_a$content2=a.content)||void 0===_a$content2?void 0:_a$content2.partsLayout)||[]).map((function(ref){return ref.id}))})).reduce((function(acc,cur){return acc.concat(cur)}),[]),hierarchyItem=(0,actions_sequence.wb)(hierarchy,activitySequence.custom.sequenceId),childrenBlackList=(0,actions_sequence.Uv)(null!==(_hierarchyItem$childr=null==hierarchyItem?void 0:hierarchyItem.children)&&void 0!==_hierarchyItem$childr?_hierarchyItem$childr:[]).map((function(s){return allActivities.find((function(a){return a.id===s.resourceId}))})).map((function(a){var _a$content3;return((null==a||null===(_a$content3=a.content)||void 0===_a$content3?void 0:_a$content3.partsLayout)||[]).map((function(ref){return ref.id}))})).reduce((function(acc,cur){return acc.concat(cur)}),[]),testBlackList=Array.from(new Set([].concat(validate_toConsumableArray(lineageBlacklist),validate_toConsumableArray(childrenBlackList)))),problems=Object.keys(foundProblems).reduce((function(errs,currentErr){return[].concat(validate_toConsumableArray(errs),validate_toConsumableArray(function mapErrorProblems(list,type,seq,blackList){return list.map((function(item){var problemSequence=seq.find((function(s){return s.custom.sequenceId===item.owner}));return{type,item,owner:problemSequence||item.owner,suggestedFix:"string"==typeof item.suggestedFix?item.suggestedFix:generateSuggestion(item.id,blackList)}}))}(foundProblems[currentErr],currentErr,sequence,testBlackList)))}),[]);errors.push({activity:activitySequence,problems})}})),errors},validateLessonVariables=function validateLessonVariables(page){var _page$custom3;if(null==page||null===(_page$custom3=page.custom)||void 0===_page$custom3||!_page$custom3.variables)return[];var allNames=page.custom.variables.map((function(v){return v.name})),statements=page.custom.variables.map((function(v){if(!v.name||!v.expression)return"";var expr=v.expression;return allNames.forEach((function(name){var regex=new RegExp("{".concat(name,"}"),"g");expr=expr.replace(regex,"{variables.".concat(name,"}"))})),{expression:"let {variables.".concat(v.name.trim(),"} = ").concat(expr,";"),name:v.name}})).filter((function(s){return s})),testEnv=new build_module.qA;if((0,scripting.gH)(builtin_functions._,testEnv),page.customScript)try{(0,scripting.gH)(page.customScript,testEnv)}catch(e){console.error("Error evaluating custom script: ",e)}var broken=[];return statements.forEach((function(statement){try{null!==(0,scripting.gH)(statement.expression,testEnv).result&&broken.push({owner:page,id:statement.name,item:statement,suggestedFix:""})}catch(e){broken.push({owner:page,key:statement.name,fact:statement,suggestedFix:""})}})),[].concat(broken)},validatePartIds=(0,redux_toolkit_esm.hg)("".concat(app_name.M,"/validatePartIds"),function(){var _ref2=validate_asyncToGenerator(validate_regeneratorRuntime().mark((function _callee(payload,_ref){var getState,fulfillWithValue,rootState,allActivities,sequence,currentLesson,errors;return validate_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return getState=_ref.getState,fulfillWithValue=_ref.fulfillWithValue,rootState=getState(),allActivities=(0,activities_slice.N3)(rootState),sequence=(0,deck.nu)(rootState),currentLesson=(0,page_slice.bz)(rootState),errors=diagnosePage(currentLesson,allActivities,sequence),_context.abrupt("return",fulfillWithValue({errors}));case 7:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}()),validateVariables=(0,redux_toolkit_esm.hg)("".concat(app_name.M,"/validateVariables"),function(){var _ref4=validate_asyncToGenerator(validate_regeneratorRuntime().mark((function _callee2(payload,_ref3){var getState,fulfillWithValue,rootState,currentLesson,errors;return validate_regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return getState=_ref3.getState,fulfillWithValue=_ref3.fulfillWithValue,rootState=getState(),currentLesson=(0,page_slice.bz)(rootState),errors=validateLessonVariables(currentLesson),_context2.abrupt("return",fulfillWithValue({errors}));case 5:case"end":return _context2.stop()}}),_callee2)})));return function(_x3,_x4){return _ref4.apply(this,arguments)}}()),Badge=__webpack_require__("./node_modules/react-bootstrap/esm/Badge.js"),setCurrentActivityFromSequence=__webpack_require__("./src/apps/authoring/store/groups/layouts/deck/actions/setCurrentActivityFromSequence.ts"),AdvancedAuthoringModal=__webpack_require__("./src/apps/authoring/components/AdvancedAuthoringModal.tsx");function DiagnosticMessage_typeof(obj){return DiagnosticMessage_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},DiagnosticMessage_typeof(obj)}function DiagnosticMessage_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function DiagnosticMessage_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?DiagnosticMessage_ownKeys(Object(source),!0).forEach((function(key){DiagnosticMessage_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):DiagnosticMessage_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function DiagnosticMessage_defineProperty(obj,key,value){return(key=function DiagnosticMessage_toPropertyKey(arg){var key=function DiagnosticMessage_toPrimitive(input,hint){if("object"!==DiagnosticMessage_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==DiagnosticMessage_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===DiagnosticMessage_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var DupeMessage=function DupeMessage(_ref){var problem=_ref.problem;return(0,jsx_runtime.jsxs)("span",{children:["A ",problem.item.type,' component with the ID "',(0,jsx_runtime.jsxs)("strong",{children:[problem.item.id," "]}),' "located on']})};DupeMessage.displayName="DupeMessage";var PatternMessage=function PatternMessage(_ref2){var problem=_ref2.problem;return(0,jsx_runtime.jsxs)("span",{children:["A ",problem.item.type,' component with the ID "',(0,jsx_runtime.jsx)("strong",{children:problem.item.id}),'", has problematic characters. It is best to use alphanumeric characters only.']})};PatternMessage.displayName="PatternMessage";var BrokenMessage=function BrokenMessage(_ref3){var problem=_ref3.problem;return(0,jsx_runtime.jsxs)("span",{children:["A ",problem.item.type,' component with the ID "',(0,jsx_runtime.jsx)("strong",{children:problem.item.id}),'", has a broken path.']})};BrokenMessage.displayName="BrokenMessage";var ValueUndefined=function ValueUndefined(_ref4){var _problem$item,_problem$item$rule,problem=_ref4.problem;return(0,jsx_runtime.jsxs)("span",{children:['The "',(0,jsx_runtime.jsx)("strong",{children:null==problem||null===(_problem$item=problem.item)||void 0===_problem$item||null===(_problem$item$rule=_problem$item.rule)||void 0===_problem$item$rule?void 0:_problem$item$rule.name}),'" rule is missing a condition value.']})};ValueUndefined.displayName="ValueUndefined";var InvalidExpressionValue=function InvalidExpressionValue(_ref5){var _problem$item2,_problem$item2$rule,_problem$item3,_problem$item3$rule,problem=_ref5.problem;return(0,jsx_runtime.jsx)("span",{children:null!=problem&&null!==(_problem$item2=problem.item)&&void 0!==_problem$item2&&null!==(_problem$item2$rule=_problem$item2.rule)&&void 0!==_problem$item2$rule&&_problem$item2$rule.name?(0,jsx_runtime.jsxs)("span",{children:['The "',(0,jsx_runtime.jsx)("strong",{children:null==problem||null===(_problem$item3=problem.item)||void 0===_problem$item3||null===(_problem$item3$rule=_problem$item3.rule)||void 0===_problem$item3$rule?void 0:_problem$item3$rule.name}),'" rule has invalid expression.']}):(0,jsx_runtime.jsx)("span",{children:"A rule in the initial state has an invalid expression."})})};InvalidExpressionValue.displayName="InvalidExpressionValue";var InvalidPartExpressionValue=function InvalidPartExpressionValue(_ref6){var _problem$item4,_problem$item4$part,problem=_ref6.problem;return(0,jsx_runtime.jsxs)("span",{children:['The "',(0,jsx_runtime.jsx)("strong",{children:null==problem||null===(_problem$item4=problem.item)||void 0===_problem$item4||null===(_problem$item4$part=_problem$item4.part)||void 0===_problem$item4$part?void 0:_problem$item4$part.id}),'" component has invalid expression  ',problem.item.message&&(0,jsx_runtime.jsxs)("span",{children:["in ",problem.item.message]})]})};InvalidPartExpressionValue.displayName="InvalidPartExpressionValue";var InvalidMutateTarget=function InvalidMutateTarget(_ref7){var _problem$item5,_problem$item6,problem=_ref7.problem;return(0,jsx_runtime.jsxs)("span",{children:['The "',(0,jsx_runtime.jsx)("strong",{children:null==problem||null===(_problem$item5=problem.item)||void 0===_problem$item5?void 0:_problem$item5.name}),'" rule, has an invalid action target (',(0,jsx_runtime.jsx)("strong",{children:null==problem||null===(_problem$item6=problem.item)||void 0===_problem$item6?void 0:_problem$item6.action.params.target}),")."]})};InvalidMutateTarget.displayName="InvalidMutateTarget";var InvalidCondTarget=function InvalidCondTarget(_ref8){var _problem$item7,_problem$item7$rule,_problem$item8,_problem$item8$condit,problem=_ref8.problem;return(0,jsx_runtime.jsxs)("span",{children:['The "',(0,jsx_runtime.jsx)("strong",{children:null==problem||null===(_problem$item7=problem.item)||void 0===_problem$item7||null===(_problem$item7$rule=_problem$item7.rule)||void 0===_problem$item7$rule?void 0:_problem$item7$rule.name}),'" rule has an invalid condition target (',(0,jsx_runtime.jsx)("strong",{children:null==problem||null===(_problem$item8=problem.item)||void 0===_problem$item8||null===(_problem$item8$condit=_problem$item8.condition)||void 0===_problem$item8$condit?void 0:_problem$item8$condit.fact}),")."]})};InvalidCondTarget.displayName="InvalidCondTarget";var InvalidInitStateTarget=function InvalidInitStateTarget(_ref9){var _problem$item9,_problem$item9$fact,problem=_ref9.problem;return(0,jsx_runtime.jsxs)("span",{children:["A rule in the initial state has an invalid component target (",(0,jsx_runtime.jsx)("strong",{children:null==problem||null===(_problem$item9=problem.item)||void 0===_problem$item9||null===(_problem$item9$fact=_problem$item9.fact)||void 0===_problem$item9$fact?void 0:_problem$item9$fact.target}),")."]})};InvalidInitStateTarget.displayName="InvalidInitStateTarget";var InvalidOwnerInitState=function InvalidOwnerInitState(_ref10){var _problem$item10,_problem$item10$fact,problem=_ref10.problem;return(0,jsx_runtime.jsxs)("span",{children:["Invalid init state: problem with owner target (",(0,jsx_runtime.jsx)("strong",{children:null==problem||null===(_problem$item10=problem.item)||void 0===_problem$item10||null===(_problem$item10$fact=_problem$item10.fact)||void 0===_problem$item10$fact?void 0:_problem$item10$fact.value}),")."]})};InvalidOwnerInitState.displayName="InvalidOwnerInitState";var InvalidOwnerCondition=function InvalidOwnerCondition(_ref11){var _problem$item11,_problem$item11$rule,problem=_ref11.problem;return(0,jsx_runtime.jsxs)("span",{children:["Invalid condition: problem with owner target in (",(0,jsx_runtime.jsx)("strong",{children:null==problem||null===(_problem$item11=problem.item)||void 0===_problem$item11||null===(_problem$item11$rule=_problem$item11.rule)||void 0===_problem$item11$rule?void 0:_problem$item11$rule.name}),")."]})};InvalidOwnerCondition.displayName="InvalidOwnerCondition";var InvalidOwnerMutateState=function InvalidOwnerMutateState(_ref12){var _problem$item12,_problem$item12$rule,problem=_ref12.problem;return(0,jsx_runtime.jsxs)("span",{children:["Invalid mutate state: problem with owner target in (",(0,jsx_runtime.jsx)("strong",{children:null==problem||null===(_problem$item12=problem.item)||void 0===_problem$item12||null===(_problem$item12$rule=_problem$item12.rule)||void 0===_problem$item12$rule?void 0:_problem$item12$rule.name}),")."]})};InvalidOwnerMutateState.displayName="InvalidOwnerMutateState";var DiagnosticMessage=function DiagnosticMessage(props){var action,_problem$type=props.problem.type;switch(void 0===_problem$type?DiagnosticTypes.DEFAULT:_problem$type){case DiagnosticTypes.DUPLICATE:action=(0,jsx_runtime.jsx)(DupeMessage,DiagnosticMessage_objectSpread({},props));break;case DiagnosticTypes.PATTERN:action=(0,jsx_runtime.jsx)(PatternMessage,DiagnosticMessage_objectSpread({},props));break;case DiagnosticTypes.BROKEN:action=(0,jsx_runtime.jsx)(BrokenMessage,DiagnosticMessage_objectSpread({},props));break;case DiagnosticTypes.INVALID_TARGET_COND:action=(0,jsx_runtime.jsx)(InvalidCondTarget,DiagnosticMessage_objectSpread({},props));break;case DiagnosticTypes.INVALID_TARGET_INIT:action=(0,jsx_runtime.jsx)(InvalidInitStateTarget,DiagnosticMessage_objectSpread({},props));break;case DiagnosticTypes.INVALID_TARGET_MUTATE:action=(0,jsx_runtime.jsx)(InvalidMutateTarget,DiagnosticMessage_objectSpread({},props));break;case DiagnosticTypes.INVALID_VALUE:action=(0,jsx_runtime.jsx)(ValueUndefined,DiagnosticMessage_objectSpread({},props));break;case DiagnosticTypes.INVALID_EXPRESSION_VALUE:action=(0,jsx_runtime.jsx)(InvalidExpressionValue,DiagnosticMessage_objectSpread({},props));break;case DiagnosticTypes.INVALID_EXPRESSION:action=(0,jsx_runtime.jsx)(InvalidPartExpressionValue,DiagnosticMessage_objectSpread({},props));break;case DiagnosticTypes.INVALID_OWNER_INIT:action=(0,jsx_runtime.jsx)(InvalidOwnerInitState,DiagnosticMessage_objectSpread({},props));break;case DiagnosticTypes.INVALID_OWNER_CONDITION:action=(0,jsx_runtime.jsx)(InvalidOwnerCondition,DiagnosticMessage_objectSpread({},props));break;case DiagnosticTypes.INVALID_OWNER_MUTATE:action=(0,jsx_runtime.jsx)(InvalidOwnerMutateState,DiagnosticMessage_objectSpread({},props));break;default:action=(0,jsx_runtime.jsx)(react.Fragment,{children:"No fix defined."})}return(0,jsx_runtime.jsx)(react.Fragment,{children:action})};DiagnosticMessage.displayName="DiagnosticMessage";const diagnostics_DiagnosticMessage=DiagnosticMessage;try{DupeMessage.displayName="DupeMessage",DupeMessage.__docgenInfo={description:"",displayName:"DupeMessage",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#DupeMessage"]={docgenInfo:DupeMessage.__docgenInfo,name:"DupeMessage",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#DupeMessage"})}catch(__react_docgen_typescript_loader_error){}try{PatternMessage.displayName="PatternMessage",PatternMessage.__docgenInfo={description:"",displayName:"PatternMessage",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#PatternMessage"]={docgenInfo:PatternMessage.__docgenInfo,name:"PatternMessage",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#PatternMessage"})}catch(__react_docgen_typescript_loader_error){}try{BrokenMessage.displayName="BrokenMessage",BrokenMessage.__docgenInfo={description:"",displayName:"BrokenMessage",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#BrokenMessage"]={docgenInfo:BrokenMessage.__docgenInfo,name:"BrokenMessage",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#BrokenMessage"})}catch(__react_docgen_typescript_loader_error){}try{ValueUndefined.displayName="ValueUndefined",ValueUndefined.__docgenInfo={description:"",displayName:"ValueUndefined",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#ValueUndefined"]={docgenInfo:ValueUndefined.__docgenInfo,name:"ValueUndefined",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#ValueUndefined"})}catch(__react_docgen_typescript_loader_error){}try{InvalidExpressionValue.displayName="InvalidExpressionValue",InvalidExpressionValue.__docgenInfo={description:"",displayName:"InvalidExpressionValue",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidExpressionValue"]={docgenInfo:InvalidExpressionValue.__docgenInfo,name:"InvalidExpressionValue",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidExpressionValue"})}catch(__react_docgen_typescript_loader_error){}try{InvalidPartExpressionValue.displayName="InvalidPartExpressionValue",InvalidPartExpressionValue.__docgenInfo={description:"",displayName:"InvalidPartExpressionValue",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidPartExpressionValue"]={docgenInfo:InvalidPartExpressionValue.__docgenInfo,name:"InvalidPartExpressionValue",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidPartExpressionValue"})}catch(__react_docgen_typescript_loader_error){}try{InvalidMutateTarget.displayName="InvalidMutateTarget",InvalidMutateTarget.__docgenInfo={description:"",displayName:"InvalidMutateTarget",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidMutateTarget"]={docgenInfo:InvalidMutateTarget.__docgenInfo,name:"InvalidMutateTarget",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidMutateTarget"})}catch(__react_docgen_typescript_loader_error){}try{InvalidCondTarget.displayName="InvalidCondTarget",InvalidCondTarget.__docgenInfo={description:"",displayName:"InvalidCondTarget",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidCondTarget"]={docgenInfo:InvalidCondTarget.__docgenInfo,name:"InvalidCondTarget",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidCondTarget"})}catch(__react_docgen_typescript_loader_error){}try{InvalidInitStateTarget.displayName="InvalidInitStateTarget",InvalidInitStateTarget.__docgenInfo={description:"",displayName:"InvalidInitStateTarget",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidInitStateTarget"]={docgenInfo:InvalidInitStateTarget.__docgenInfo,name:"InvalidInitStateTarget",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidInitStateTarget"})}catch(__react_docgen_typescript_loader_error){}try{InvalidOwnerInitState.displayName="InvalidOwnerInitState",InvalidOwnerInitState.__docgenInfo={description:"",displayName:"InvalidOwnerInitState",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidOwnerInitState"]={docgenInfo:InvalidOwnerInitState.__docgenInfo,name:"InvalidOwnerInitState",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidOwnerInitState"})}catch(__react_docgen_typescript_loader_error){}try{InvalidOwnerCondition.displayName="InvalidOwnerCondition",InvalidOwnerCondition.__docgenInfo={description:"",displayName:"InvalidOwnerCondition",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidOwnerCondition"]={docgenInfo:InvalidOwnerCondition.__docgenInfo,name:"InvalidOwnerCondition",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidOwnerCondition"})}catch(__react_docgen_typescript_loader_error){}try{InvalidOwnerMutateState.displayName="InvalidOwnerMutateState",InvalidOwnerMutateState.__docgenInfo={description:"",displayName:"InvalidOwnerMutateState",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidOwnerMutateState"]={docgenInfo:InvalidOwnerMutateState.__docgenInfo,name:"InvalidOwnerMutateState",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#InvalidOwnerMutateState"})}catch(__react_docgen_typescript_loader_error){}try{DiagnosticMessage.displayName="DiagnosticMessage",DiagnosticMessage.__docgenInfo={description:"",displayName:"DiagnosticMessage",props:{problem:{defaultValue:null,description:"",name:"problem",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#DiagnosticMessage"]={docgenInfo:DiagnosticMessage.__docgenInfo,name:"DiagnosticMessage",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticMessage.tsx#DiagnosticMessage"})}catch(__react_docgen_typescript_loader_error){}var ScreenDropdownTemplate=__webpack_require__("./src/apps/authoring/components/PropertyEditor/custom/ScreenDropdownTemplate.tsx");function FixBrokenPathButton_slicedToArray(arr,i){return function FixBrokenPathButton_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function FixBrokenPathButton_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function FixBrokenPathButton_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return FixBrokenPathButton_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FixBrokenPathButton_arrayLikeToArray(o,minLen)}(arr,i)||function FixBrokenPathButton_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FixBrokenPathButton_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var FixBrokenPathButton=function FixBrokenPathButton(_ref){var onClick=_ref.onClick,_React$useState2=FixBrokenPathButton_slicedToArray(react.useState("invalid"),2),target=_React$useState2[0],setTarget=_React$useState2[1],uuid=(0,guid.Z)();return(0,jsx_runtime.jsxs)("div",{className:"aa-action d-flex mb-2 form-inline align-items-center flex-nowrap",children:[(0,jsx_runtime.jsx)("label",{className:"sr-only",htmlFor:"action-navigation-".concat(uuid),children:"SequenceId"}),(0,jsx_runtime.jsxs)("div",{className:"input-group input-group-sm flex-grow-1",children:[(0,jsx_runtime.jsx)("div",{className:"input-group-prepend",children:(0,jsx_runtime.jsxs)("div",{className:"input-group-text",children:[(0,jsx_runtime.jsx)("i",{className:"fa fa-compass mr-1"}),"Navigate To"]})}),(0,jsx_runtime.jsx)(ScreenDropdownTemplate.Z,{id:"action-navigation-".concat(uuid),label:"",value:target,onChange:function onChangeHandler(sequenceId){setTarget(sequenceId||"invalid")},dropDownCSSClass:"",buttonCSSClass:"form-control-sm"})]}),(0,jsx_runtime.jsx)("button",{className:"btn btn-sm btn-primary ml-2",onClick:function handleClick(){"invalid"!==target&&onClick(target)},children:"Apply"})]})};FixBrokenPathButton.displayName="FixBrokenPathButton";try{FixBrokenPathButton.displayName="FixBrokenPathButton",FixBrokenPathButton.__docgenInfo={description:"",displayName:"FixBrokenPathButton",props:{type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"string"}},suggestion:{defaultValue:null,description:"",name:"suggestion",required:!0,type:{name:"string"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(val: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/FixBrokenPathButton.tsx#FixBrokenPathButton"]={docgenInfo:FixBrokenPathButton.__docgenInfo,name:"FixBrokenPathButton",path:"src/apps/authoring/components/Modal/diagnostics/FixBrokenPathButton.tsx#FixBrokenPathButton"})}catch(__react_docgen_typescript_loader_error){}var FixIdButton=function FixIdButton(_ref){var suggestion=_ref.suggestion,onClick=_ref.onClick,txtRef=react.useRef(null);return(0,jsx_runtime.jsxs)("div",{className:"aa-action aa-mutate d-flex mb-2 form-inline align-items-center flex-nowrap",children:[(0,jsx_runtime.jsx)("input",{ref:txtRef,type:"text",defaultValue:suggestion,className:"form-control form-control-sm"}),(0,jsx_runtime.jsx)("button",{className:"btn btn-sm btn-primary ml-2",onClick:function handleClick(){if(txtRef.current&&onClick){var newVal=txtRef.current.value;onClick(newVal)}},children:"Apply"})]})};FixIdButton.displayName="FixIdButton";try{FixIdButton.displayName="FixIdButton",FixIdButton.__docgenInfo={description:"",displayName:"FixIdButton",props:{type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"string"}},suggestion:{defaultValue:null,description:"",name:"suggestion",required:!0,type:{name:"string"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(val: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/FixIdButton.tsx#FixIdButton"]={docgenInfo:FixIdButton.__docgenInfo,name:"FixIdButton",path:"src/apps/authoring/components/Modal/diagnostics/FixIdButton.tsx#FixIdButton"})}catch(__react_docgen_typescript_loader_error){}function FixTargetButton_slicedToArray(arr,i){return function FixTargetButton_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function FixTargetButton_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function FixTargetButton_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return FixTargetButton_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FixTargetButton_arrayLikeToArray(o,minLen)}(arr,i)||function FixTargetButton_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FixTargetButton_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var FixTargetButton=function FixTargetButton(_ref){var onClick=_ref.onClick,targetRef=(0,react.useRef)(null),typeRef=(0,react.useRef)(null),_useState2=FixTargetButton_slicedToArray((0,react.useState)(),2),target=_useState2[0],setTarget=_useState2[1],_useState4=FixTargetButton_slicedToArray((0,react.useState)(!1),2),setIsDirty=(_useState4[0],_useState4[1]),uuid=(0,guid.Z)(),handleTargetChange=function handleTargetChange(val){setTarget(val),setIsDirty(!0)};return(0,jsx_runtime.jsxs)("div",{className:"aa-action aa-mutate d-flex mb-2 form-inline align-items-center flex-nowrap",children:[(0,jsx_runtime.jsx)("label",{className:"sr-only",htmlFor:"action-mutate-target-".concat(uuid),children:"target"}),(0,jsx_runtime.jsxs)("div",{className:"input-group input-group-sm flex-grow-1",children:[(0,jsx_runtime.jsx)("div",{className:"input-group-prepend",title:"target",children:(0,jsx_runtime.jsx)(VariablePicker,{onTargetChange:function onTargetChange(value){return handleTargetChange(value)},typeRef,placement:OverlayPlacements.TOP,context:"mutate"})}),(0,jsx_runtime.jsx)("input",{type:"text",className:"form-control form-control-sm mr-2 flex-grow-1",id:"action-mutate-target-".concat(uuid),defaultValue:target,onBlur:function onBlur(e){return handleTargetChange(e.target.value)},title:target,placeholder:"Target",ref:targetRef})]}),(0,jsx_runtime.jsx)("button",{className:"btn btn-sm btn-primary",onClick:function handleClick(){if(targetRef.current&&onClick){var newVal=targetRef.current.value;onClick(newVal)}},children:"Apply"})]})};FixTargetButton.displayName="FixTargetButton";try{FixTargetButton.displayName="FixTargetButton",FixTargetButton.__docgenInfo={description:"",displayName:"FixTargetButton",props:{type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"string"}},suggestion:{defaultValue:null,description:"",name:"suggestion",required:!0,type:{name:"string"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(val: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/FixTargetButton.tsx#FixTargetButton"]={docgenInfo:FixTargetButton.__docgenInfo,name:"FixTargetButton",path:"src/apps/authoring/components/Modal/diagnostics/FixTargetButton.tsx#FixTargetButton"})}catch(__react_docgen_typescript_loader_error){}function DiagnosticSolution_typeof(obj){return DiagnosticSolution_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},DiagnosticSolution_typeof(obj)}function DiagnosticSolution_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function DiagnosticSolution_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?DiagnosticSolution_ownKeys(Object(source),!0).forEach((function(key){DiagnosticSolution_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):DiagnosticSolution_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function DiagnosticSolution_defineProperty(obj,key,value){return(key=function DiagnosticSolution_toPropertyKey(arg){var key=function DiagnosticSolution_toPrimitive(input,hint){if("object"!==DiagnosticSolution_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==DiagnosticSolution_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===DiagnosticSolution_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var DiagnosticSolution=function DiagnosticSolution(props){var action,_props$type=props.type;switch(void 0===_props$type?DiagnosticTypes.DEFAULT:_props$type){case DiagnosticTypes.DUPLICATE:case DiagnosticTypes.PATTERN:action=(0,jsx_runtime.jsx)(FixIdButton,DiagnosticSolution_objectSpread({},props));break;case DiagnosticTypes.BROKEN:action=(0,jsx_runtime.jsx)(FixBrokenPathButton,DiagnosticSolution_objectSpread({},props));break;case DiagnosticTypes.INVALID_TARGET_COND:case DiagnosticTypes.INVALID_TARGET_INIT:case DiagnosticTypes.INVALID_TARGET_MUTATE:action=(0,jsx_runtime.jsx)(FixTargetButton,DiagnosticSolution_objectSpread({},props));break;case DiagnosticTypes.INVALID_VALUE:case DiagnosticTypes.INVALID_EXPRESSION_VALUE:case DiagnosticTypes.INVALID_EXPRESSION:case DiagnosticTypes.INVALID_OWNER_INIT:case DiagnosticTypes.INVALID_OWNER_CONDITION:case DiagnosticTypes.INVALID_OWNER_MUTATE:action=(0,jsx_runtime.jsx)(FixIdButton,DiagnosticSolution_objectSpread({},props));break;default:action=(0,jsx_runtime.jsx)(react.Fragment,{children:"No fix defined."})}return(0,jsx_runtime.jsx)(react.Fragment,{children:action})};DiagnosticSolution.displayName="DiagnosticSolution";try{DiagnosticSolution.displayName="DiagnosticSolution",DiagnosticSolution.__docgenInfo={description:"",displayName:"DiagnosticSolution",props:{type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"string"}},suggestion:{defaultValue:null,description:"",name:"suggestion",required:!0,type:{name:"string"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"(val: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/diagnostics/DiagnosticSolution.tsx#DiagnosticSolution"]={docgenInfo:DiagnosticSolution.__docgenInfo,name:"DiagnosticSolution",path:"src/apps/authoring/components/Modal/diagnostics/DiagnosticSolution.tsx#DiagnosticSolution"})}catch(__react_docgen_typescript_loader_error){}var cloneDeep=__webpack_require__("./node_modules/lodash/cloneDeep.js"),cloneDeep_default=__webpack_require__.n(cloneDeep),merge=__webpack_require__("./node_modules/lodash/merge.js"),merge_default=__webpack_require__.n(merge),history_slice=__webpack_require__("./src/apps/authoring/store/history/slice.ts"),parts_name=__webpack_require__("./src/apps/authoring/store/parts/name.ts");function updatePart_typeof(obj){return updatePart_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},updatePart_typeof(obj)}function updatePart_regeneratorRuntime(){updatePart_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==updatePart_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function updatePart_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function updatePart_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){updatePart_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){updatePart_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var _updaters,updatePart=(0,redux_toolkit_esm.hg)("".concat(parts_name.H,"/updatePart"),function(){var _ref2=updatePart_asyncToGenerator(updatePart_regeneratorRuntime().mark((function _callee(payload,_ref){var getState,dispatch,rootState,activity,undo,redo,activityClone,partDef,authorPart,sequence,sequenceEntry,activitySequenceId,authorPartConfig,hierarchy,allInvolved,activitiesToUpdate,orig;return updatePart_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(getState=_ref.getState,dispatch=_ref.dispatch,rootState=getState(),activity=(0,activities_slice.ho)(rootState,payload.activityId),undo=[],redo=[],activity){_context.next=7;break}throw new Error("Activity: ".concat(payload.activityId," not found!"));case 7:if(activityClone=(0,common.d9)(activity),partDef=activityClone.content.partsLayout.find((function(part){return part.id===payload.partId})),partDef){_context.next=11;break}throw new Error("Part: ".concat(payload.partId," not found in Activity: ").concat(payload.activityId));case 11:if(authorPart=activityClone.authoring.parts.find((function(part){return part.id===payload.partId&&!part.inherited})),!payload.changes.id){_context.next=29;break}if(sequence=(0,deck.nu)(rootState),sequenceEntry=(0,actions_sequence.xw)(sequence,activityClone.id),activitySequenceId=null==sequenceEntry?void 0:sequenceEntry.custom.sequenceId,authorPart||"janus-text-flow"===partDef.type||"janus-image"===partDef.type?authorPart&&(authorPart.id=payload.changes.id,authorPart.gradingApproach=partDef.custom.requiresManualGrading?"manual":"automatic",authorPart.outOf=partDef.custom.maxScore||1):(authorPartConfig={id:payload.changes.id,inherited:!1,type:partDef.type,owner:activitySequenceId,gradingApproach:partDef.custom.requiresManualGrading?"manual":"automatic",outOf:partDef.custom.maxScore||1},activityClone.authoring.parts.push(authorPartConfig)),!sequenceEntry||"janus-text-flow"===partDef.type||"janus-image"===partDef.type){_context.next=29;break}if(hierarchy=(0,actions_sequence._y)(sequence,activitySequenceId),allInvolved=(0,actions_sequence.Uv)(hierarchy),activitiesToUpdate=[],orig=[],allInvolved.forEach((function(item){var activity=(0,activities_slice.ho)(rootState,item.resourceId);if(activity){var cloned=(0,common.d9)(activity);orig.push(cloned);var part=cloned.authoring.parts.find((function(part){return part.id===payload.partId&&part.owner===activitySequenceId}));part&&(part.id=payload.changes.id,activitiesToUpdate.push(cloned))}})),!activitiesToUpdate.length){_context.next=29;break}return console.info("Bulk saving",activitiesToUpdate.map((function(a){return a.id})).join(", ")),_context.next=27,dispatch((0,saveActivity.V)({activities:activitiesToUpdate,undoable:!1}));case 27:undo.unshift((0,saveActivity.V)({activities:orig,undoable:!1})),redo.unshift((0,saveActivity.V)({activities:activitiesToUpdate,undoable:!1}));case 29:return payload.mergeChanges?merge_default()(partDef,payload.changes):(payload.changes.id&&payload.changes.type||console.error("Not merging part changes, but no id/type specified.",payload.changes),activityClone.content.partsLayout=activityClone.content.partsLayout.map((function(part){return part.id===payload.partId?payload.changes:part}))),authorPart&&(authorPart.gradingApproach=partDef.custom.requiresManualGrading?"manual":"automatic",authorPart.outOf=partDef.custom.maxScore||1),_context.next=33,dispatch((0,saveActivity.d)({activity:activityClone,undoable:!1}));case 33:undo.unshift((0,saveActivity.d)({activity,undoable:!1})),redo.unshift((0,saveActivity.d)({activity:activityClone,undoable:!1})),dispatch((0,history_slice.gV)({undo,redo}));case 36:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}()),updatePartWithCorrectExpression=(0,redux_toolkit_esm.hg)("".concat(parts_name.H,"/updatePart"),function(){var _ref4=updatePart_asyncToGenerator(updatePart_regeneratorRuntime().mark((function _callee2(payload,_ref3){var _payload$changes,_payload$changes$part,getState,dispatch,rootState,activity,undo,redo,activityClone,partDef;return updatePart_regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(getState=_ref3.getState,dispatch=_ref3.dispatch,rootState=getState(),activity=(0,activities_slice.ho)(rootState,payload.activityId),undo=[],redo=[],activity){_context2.next=7;break}throw new Error("Activity: ".concat(payload.activityId," not found!"));case 7:if(activityClone=(0,common.d9)(activity),partDef=activityClone.content.partsLayout.find((function(part){return part.id===payload.partId})),partDef){_context2.next=11;break}throw new Error("Part: ".concat(payload.partId," not found in Activity: ").concat(payload.activityId));case 11:return payload.changes.formattedExpression&&null!=partDef&&partDef.custom&&null!==(_payload$changes=payload.changes)&&void 0!==_payload$changes&&null!==(_payload$changes$part=_payload$changes.part)&&void 0!==_payload$changes$part&&_payload$changes$part.custom&&(partDef.custom=payload.changes.part.custom),_context2.next=14,dispatch((0,saveActivity.d)({activity:activityClone,undoable:!1}));case 14:undo.unshift((0,saveActivity.d)({activity,undoable:!1})),redo.unshift((0,saveActivity.d)({activity:activityClone,undoable:!1})),dispatch((0,history_slice.gV)({undo,redo}));case 17:case"end":return _context2.stop()}}),_callee2)})));return function(_x3,_x4){return _ref4.apply(this,arguments)}}());function actions_typeof(obj){return actions_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},actions_typeof(obj)}function actions_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function actions_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?actions_ownKeys(Object(source),!0).forEach((function(key){actions_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):actions_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function actions_defineProperty(obj,key,value){return(key=function actions_toPropertyKey(arg){var key=function actions_toPrimitive(input,hint){if("object"!==actions_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==actions_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===actions_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function actions_toConsumableArray(arr){return function actions_arrayWithoutHoles(arr){if(Array.isArray(arr))return actions_arrayLikeToArray(arr)}(arr)||function actions_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function actions_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return actions_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return actions_arrayLikeToArray(o,minLen)}(arr)||function actions_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function actions_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var updateId=function updateId(problem,fixed){var activityId=problem.owner.resourceId,partId=problem.item.id;return updatePart({activityId,partId,changes:{id:fixed},mergeChanges:!0})},updateRule=function updateRule(rule,problem,activities){var owner=problem.owner,activity=activities.find((function(a){return a.id===owner.resourceId})),existing=null==activity?void 0:activity.authoring.rules.find((function(r){return r.id===rule.id})),diff=JSON.stringify(rule)!==JSON.stringify(existing);if(existing){if(diff){var activityClone=(0,common.d9)(activity),rulesClone=activity?actions_toConsumableArray(activity.authoring.rules):[];return rulesClone[null==activity?void 0:activity.authoring.rules.indexOf(existing)]=rule,activityClone.authoring.rules=rulesClone,(0,saveActivity.d)({activity:activityClone,undoable:!0,immediate:!0})}}else console.warn("rule not found, shouldn't happen!!!")},updatePath=function updatePath(t){var side=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"target";return function(problem,fixed,activities){var _ruleClone$event,_ruleClone$event$para,item=problem.item,ruleClone=cloneDeep_default()(problem.item),actions=null===(_ruleClone$event=ruleClone.event)||void 0===_ruleClone$event||null===(_ruleClone$event$para=_ruleClone$event.params)||void 0===_ruleClone$event$para?void 0:_ruleClone$event$para.actions,action=null==actions?void 0:actions.find((function(a){return a.type===t})),actionsClone=item&&item.event&&item.event.params?actions_toConsumableArray(item.event.params.actions):[],a=actions_objectSpread(actions_objectSpread({},action),{},{params:actions_objectSpread(actions_objectSpread({},action.params),{},actions_defineProperty({},side,fixed))});return actionsClone[actions.indexOf(action)]=a,ruleClone.event.params.actions=actionsClone,updateRule(ruleClone,problem,activities)}},updateConditionProperty=function updateConditionProperty(t){return function(problem,fixed,activities){var item=problem.item,ruleClone=cloneDeep_default()(item.rule),type=has_default()(ruleClone.conditions,"all")?"all":"any";if(ruleClone.conditions){var list=ruleClone.conditions[type];return forEachCondition(list,(function(condition){if(condition.id===item.condition.id){var cond=findConditionById(condition.id,list);cond&&(cond[t]=fixed)}})),updateRule(ruleClone,problem,activities)}return updateInitComponentPath("value")(problem,fixed,activities)}},updateInitComponentPath=function updateInitComponentPath(t){return function(problem,fixed,activities){var item=problem.item,owner=problem.owner,fact=item.fact,factClone=(0,common.d9)(fact);factClone[t]=fixed;var activity=activities.find((function(a){return a.id===owner.resourceId})),existing=null==activity?void 0:activity.content.custom.facts.find((function(r){return r.id===fact.id})),diff=JSON.stringify(factClone)!==JSON.stringify(existing);if(existing){if(diff){var activityClone=(0,common.d9)(activity),factsClone=activity?actions_toConsumableArray(activity.content.custom.facts):[];return factsClone[null==activity?void 0:activity.content.custom.facts.indexOf(existing)]=factClone,activityClone.content.custom.facts=factsClone,(0,saveActivity.d)({activity:activityClone,undoable:!0,immediate:!0})}}else console.warn("rule not found, shouldn't happen!!!")}},updaters=(actions_defineProperty(_updaters={},DiagnosticTypes.DUPLICATE,updateId),actions_defineProperty(_updaters,DiagnosticTypes.PATTERN,updateId),actions_defineProperty(_updaters,DiagnosticTypes.BROKEN,updatePath("navigation")),actions_defineProperty(_updaters,DiagnosticTypes.INVALID_TARGET_INIT,updateInitComponentPath("target")),actions_defineProperty(_updaters,DiagnosticTypes.INVALID_TARGET_MUTATE,updatePath("mutateState")),actions_defineProperty(_updaters,DiagnosticTypes.INVALID_VALUE,updateConditionProperty("value")),actions_defineProperty(_updaters,DiagnosticTypes.INVALID_EXPRESSION_VALUE,updateConditionProperty("value")),actions_defineProperty(_updaters,DiagnosticTypes.INVALID_EXPRESSION,(function updatePartsWithCorrectExpression(problem,fixed){var activityId=problem.owner.resourceId,partId=problem.item.part.id,changes={item:problem.item.item,part:problem.item.part,formattedExpression:problem.item.formattedExpression,message:problem.item.message};return updatePartWithCorrectExpression({activityId,partId,changes})})),actions_defineProperty(_updaters,DiagnosticTypes.INVALID_TARGET_COND,updateConditionProperty("fact")),actions_defineProperty(_updaters,DiagnosticTypes.INVALID_OWNER_INIT,updateInitComponentPath("value")),actions_defineProperty(_updaters,DiagnosticTypes.INVALID_OWNER_CONDITION,updateConditionProperty("value")),actions_defineProperty(_updaters,DiagnosticTypes.INVALID_OWNER_MUTATE,updatePath("mutateState","value")),actions_defineProperty(_updaters,DiagnosticTypes.DEFAULT,(function(){})),_updaters),createUpdater=function createUpdater(type){return updaters[type]};function DiagnosticsWindow_typeof(obj){return DiagnosticsWindow_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},DiagnosticsWindow_typeof(obj)}function DiagnosticsWindow_slicedToArray(arr,i){return function DiagnosticsWindow_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function DiagnosticsWindow_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function DiagnosticsWindow_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return DiagnosticsWindow_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DiagnosticsWindow_arrayLikeToArray(o,minLen)}(arr,i)||function DiagnosticsWindow_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DiagnosticsWindow_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function DiagnosticsWindow_regeneratorRuntime(){DiagnosticsWindow_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==DiagnosticsWindow_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function DiagnosticsWindow_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function DiagnosticsWindow_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){DiagnosticsWindow_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){DiagnosticsWindow_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var ActivityPartError=function ActivityPartError(_ref){var error=_ref.error,onApplyFix=_ref.onApplyFix,dispatch=(0,es.I0)(),isReadOnlyMode=(0,es.v9)(slice.jw),currentActivities=(0,es.v9)(activities_slice.N3),handleClickScreen=function handleClickScreen(sequenceId){dispatch((0,setCurrentActivityFromSequence.P)(sequenceId))},getOwnerName=function getOwnerName(dupe){var screen=error.activity;return dupe.owner.custom.sequenceId===screen.custom.sequenceId?"self":dupe.owner.custom.sequenceId===screen.custom.layerRef?"".concat(dupe.owner.custom.sequenceName," (Parent)"):dupe.owner.custom.sequenceName},errorTotals="",dupes=error.problems.filter((function(p){return"duplicate"===p.type})),pattern=error.problems.filter((function(p){return"pattern"===p.type})),broken=error.problems.filter((function(p){return"broken"===p.type}));dupes.length&&(errorTotals+="".concat(dupes.length," components with duplicate IDs found.\n")),pattern.length&&(errorTotals+="".concat(pattern.length," components with problematic IDs found.\n")),broken.length&&(errorTotals+="".concat(broken.length," components with broken paths found.\n"));var handleProblemFix=function(){var _ref2=DiagnosticsWindow_asyncToGenerator(DiagnosticsWindow_regeneratorRuntime().mark((function _callee(fixed,problem){var updater,result,ruleId,activity,rule;return DiagnosticsWindow_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,dispatch((0,parts_slice.ah)(""));case 2:return updater=createUpdater(problem.type)(problem,fixed,currentActivities),_context.next=5,dispatch(updater);case 5:result=_context.sent,ruleId=problem.type===DiagnosticTypes.INVALID_TARGET_MUTATE?problem.item.id:problem.type===DiagnosticTypes.INVALID_TARGET_COND||problem.type===DiagnosticTypes.INVALID_VALUE||problem.type===DiagnosticTypes.INVALID_EXPRESSION_VALUE?problem.item.rule.id:"initState",(activity=result.meta.arg.activity)&&(rule=activity.authoring.rules.find((function(rule){return rule.id===ruleId})),dispatch((0,slice.fK)({currentRule:rule}))),onApplyFix();case 10:case"end":return _context.stop()}}),_callee)})));return function handleProblemFix(_x,_x2){return _ref2.apply(this,arguments)}}(),handleProblemClick=function(){var _ref3=DiagnosticsWindow_asyncToGenerator(DiagnosticsWindow_regeneratorRuntime().mark((function _callee2(problem){return DiagnosticsWindow_regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,dispatch((0,setCurrentActivityFromSequence.P)(error.activity.custom.sequenceId));case 2:setTimeout((function(){switch(problem.type){case DiagnosticTypes.INVALID_TARGET_INIT:dispatch((0,slice.fK)({currentRule:"initState"}));break;case DiagnosticTypes.INVALID_TARGET_COND:case DiagnosticTypes.INVALID_VALUE:dispatch((0,slice.fK)({currentRule:problem.item.rule}));break;case DiagnosticTypes.INVALID_TARGET_MUTATE:dispatch((0,slice.fK)({currentRule:problem.item}))}}),100);case 3:case"end":return _context2.stop()}}),_callee2)})));return function handleProblemClick(_x3){return _ref3.apply(this,arguments)}}(),isRuleItem=function isRuleItem(type){return DiagnosticRuleTypes.indexOf(type)>-1};return(0,jsx_runtime.jsxs)(ListGroup.Z,{children:[(0,jsx_runtime.jsx)(ListGroup.Z.Item,{children:(0,jsx_runtime.jsxs)(ListGroup.Z,{horizontal:!0,children:[(0,jsx_runtime.jsx)(ListGroup.Z.Item,{action:!0,onClick:function onClick(){return handleClickScreen(error.activity.custom.sequenceId)},children:error.activity.custom.sequenceName}),(0,jsx_runtime.jsx)(ListGroup.Z.Item,{children:errorTotals})]})}),error.problems.map((function(problem){return(0,jsx_runtime.jsx)(ListGroup.Z.Item,{children:(0,jsx_runtime.jsxs)(ListGroup.Z,{horizontal:!0,children:[(0,jsx_runtime.jsx)(ListGroup.Z.Item,{action:isRuleItem(problem.type),className:"flex-grow-1",onClick:function onClick(){return handleProblemClick(problem)},children:(0,jsx_runtime.jsx)(diagnostics_DiagnosticMessage,{problem})}),problem.type===DiagnosticTypes.DUPLICATE&&(0,jsx_runtime.jsx)(ListGroup.Z.Item,{action:!0,onClick:function onClick(){return handleClickScreen(problem.owner.custom.sequenceId)},children:getOwnerName(problem)}),!isReadOnlyMode&&(0,jsx_runtime.jsx)(ListGroup.Z.Item,{children:(0,jsx_runtime.jsx)(DiagnosticSolution,{type:problem.type,suggestion:problem.suggestedFix,onClick:function onClick(val){return handleProblemFix(val,problem)}})})]})},problem.owner.resourceId)}))]})};ActivityPartError.displayName="ActivityPartError";var PageError=function PageError(_ref4){var error=_ref4.error;return(0,jsx_runtime.jsx)(ListGroup.Z,{children:(0,jsx_runtime.jsx)(ListGroup.Z.Item,{children:(0,jsx_runtime.jsx)(ListGroup.Z,{horizontal:!0,children:(0,jsx_runtime.jsxs)(ListGroup.Z.Item,{className:"flex-grow-1 alert alert-danger",children:[(0,jsx_runtime.jsxs)("span",{children:['Variable(s) "',(0,jsx_runtime.jsxs)("strong",{children:[error.map((function(err){return err.id})).join(", ")," "]})]}),'" failed to evaluate.']})})})})};PageError.displayName="PageError";var DiagnosticsWindow=function DiagnosticsWindow(_ref5){var onClose=_ref5.onClose,_useState2=DiagnosticsWindow_slicedToArray((0,react.useState)(null),2),results=_useState2[0],setResults=_useState2[1],dispatch=(0,es.I0)(),handleValidateClick=function(){var _ref6=DiagnosticsWindow_asyncToGenerator(DiagnosticsWindow_regeneratorRuntime().mark((function _callee3(){var result,errorList;return DiagnosticsWindow_regeneratorRuntime().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,dispatch(validatePartIds({}));case 2:"fulfilled"===(result=_context3.sent).meta.requestStatus&&(result.payload.errors.length>0?(errorList=result.payload.errors.map((function(item){return(0,jsx_runtime.jsx)(ActivityPartError,{error:item,onApplyFix:function onApplyFix(){return setResults(null)}},item.activity.resourceId)})),setResults(errorList)):setResults((0,jsx_runtime.jsx)("p",{children:"No errors found."})));case 4:case"end":return _context3.stop()}}),_callee3)})));return function handleValidateClick(){return _ref6.apply(this,arguments)}}(),handleValidateVariablesClick=function(){var _ref7=DiagnosticsWindow_asyncToGenerator(DiagnosticsWindow_regeneratorRuntime().mark((function _callee4(){var result,errors,errorList;return DiagnosticsWindow_regeneratorRuntime().wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,dispatch(validateVariables({}));case 2:"fulfilled"===(result=_context4.sent).meta.requestStatus&&(result.payload.errors.length>0?(errors=result.payload.errors,errorList=(0,jsx_runtime.jsx)(PageError,{error:errors},errors[0].owner.title),setResults(errorList)):setResults((0,jsx_runtime.jsx)("p",{children:"No errors found."})));case 4:case"end":return _context4.stop()}}),_callee4)})));return function handleValidateVariablesClick(){return _ref7.apply(this,arguments)}}();return(0,jsx_runtime.jsx)(react.Fragment,{children:(0,jsx_runtime.jsxs)(AdvancedAuthoringModal.tv,{show:!0,size:"xl",onHide:function handleClose(){onClose&&onClose(),dispatch((0,slice.sB)({show:!1}))},dialogClassName:"diagnostic-modal advanced-authoring",children:[(0,jsx_runtime.jsx)(Modal.Z.Header,{closeButton:!0,children:(0,jsx_runtime.jsx)("h3",{className:"modal-title",children:"Lesson Diagnostics"})}),(0,jsx_runtime.jsxs)(Modal.Z.Body,{children:[(0,jsx_runtime.jsx)("div",{className:" startup",children:(0,jsx_runtime.jsxs)("ul",{children:[(0,jsx_runtime.jsxs)("li",{children:["Validate Lesson",(0,jsx_runtime.jsx)("button",{className:"btn btn-sm btn-primary ml-2",onClick:handleValidateClick,children:"Execute"})]}),(0,jsx_runtime.jsxs)("li",{style:{marginTop:"5px"},children:["Validate Variables",(0,jsx_runtime.jsx)("button",{className:"btn btn-sm btn-primary ml-2",onClick:handleValidateVariablesClick,children:"Execute"})]})]})}),(0,jsx_runtime.jsx)("hr",{}),(0,jsx_runtime.jsx)("div",{children:results})]})]})})};DiagnosticsWindow.displayName="DiagnosticsWindow";var DiagnosticsTrigger=function DiagnosticsTrigger(_ref8){var onClick=_ref8.onClick,_useState4=DiagnosticsWindow_slicedToArray((0,react.useState)(0),2),results=_useState4[0],setResults=_useState4[1],_useState6=DiagnosticsWindow_slicedToArray((0,react.useState)(0),2),lessonResultsCount=_useState6[0],setLessonResultsCount=_useState6[1],_useState8=DiagnosticsWindow_slicedToArray((0,react.useState)(0),2),variableResultsCount=_useState8[0],setVariableResultsCount=_useState8[1],dispatch=(0,es.I0)(),showDiagnosticsWindow=(0,es.v9)(slice.UM),sequence=(0,es.v9)(deck.nu),checkInvalidLessons=function(){var _ref9=DiagnosticsWindow_asyncToGenerator(DiagnosticsWindow_regeneratorRuntime().mark((function _callee5(){var result,errors;return DiagnosticsWindow_regeneratorRuntime().wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,dispatch(validatePartIds({}));case 2:"fulfilled"===(result=_context5.sent).meta.requestStatus&&(errors=result.payload.errors,setLessonResultsCount(errors.length));case 4:case"end":return _context5.stop()}}),_callee5)})));return function checkInvalidLessons(){return _ref9.apply(this,arguments)}}(),checkInvalidVariables=function(){var _ref10=DiagnosticsWindow_asyncToGenerator(DiagnosticsWindow_regeneratorRuntime().mark((function _callee6(){var result,errors;return DiagnosticsWindow_regeneratorRuntime().wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,dispatch(validateVariables({}));case 2:"fulfilled"===(result=_context6.sent).meta.requestStatus&&(errors=result.payload.errors,setVariableResultsCount(errors.length));case 4:case"end":return _context6.stop()}}),_callee6)})));return function checkInvalidVariables(){return _ref10.apply(this,arguments)}}();return(0,react.useEffect)((function(){sequence&&(checkInvalidLessons(),checkInvalidVariables())}),[sequence]),(0,react.useEffect)((function(){showDiagnosticsWindow||(checkInvalidLessons(),checkInvalidVariables())}),[showDiagnosticsWindow]),(0,react.useEffect)((function(){setResults(lessonResultsCount+variableResultsCount)}),[lessonResultsCount,variableResultsCount]),(0,jsx_runtime.jsx)(OverlayTrigger.Z,{placement:"bottom",delay:{show:150,hide:150},overlay:(0,jsx_runtime.jsx)(Tooltip.Z,{id:"button-tooltip",style:{fontSize:"12px"},children:"Diagnostics"}),children:(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsxs)("button",{className:"px-2 btn btn-link",onClick,style:{position:"relative"},children:[(0,jsx_runtime.jsx)("i",{className:"fa fa-wrench",style:{fontSize:32,color:"#333",verticalAlign:"middle"}}),results>0&&(0,jsx_runtime.jsx)(Badge.Z,{pill:!0,variant:"danger",style:{right:"0px",position:"absolute",fontSize:"0.9rem"},children:results})]})})})};DiagnosticsTrigger.displayName="DiagnosticsTrigger";try{PageError.displayName="PageError",PageError.__docgenInfo={description:"",displayName:"PageError",props:{error:{defaultValue:null,description:"",name:"error",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/DiagnosticsWindow.tsx#PageError"]={docgenInfo:PageError.__docgenInfo,name:"PageError",path:"src/apps/authoring/components/Modal/DiagnosticsWindow.tsx#PageError"})}catch(__react_docgen_typescript_loader_error){}try{DiagnosticsTrigger.displayName="DiagnosticsTrigger",DiagnosticsTrigger.__docgenInfo={description:"",displayName:"DiagnosticsTrigger",props:{onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/DiagnosticsWindow.tsx#DiagnosticsTrigger"]={docgenInfo:DiagnosticsTrigger.__docgenInfo,name:"DiagnosticsTrigger",path:"src/apps/authoring/components/Modal/DiagnosticsWindow.tsx#DiagnosticsTrigger"})}catch(__react_docgen_typescript_loader_error){}try{DiagnosticsWindow.displayName="DiagnosticsWindow",DiagnosticsWindow.__docgenInfo={description:"",displayName:"DiagnosticsWindow",props:{onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/Modal/DiagnosticsWindow.tsx#DiagnosticsWindow"]={docgenInfo:DiagnosticsWindow.__docgenInfo,name:"DiagnosticsWindow",path:"src/apps/authoring/components/Modal/DiagnosticsWindow.tsx#DiagnosticsWindow"})}catch(__react_docgen_typescript_loader_error){}function VariableEditor_typeof(obj){return VariableEditor_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},VariableEditor_typeof(obj)}function VariableEditor_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function VariableEditor_defineProperty(obj,key,value){return(key=function VariableEditor_toPropertyKey(arg){var key=function VariableEditor_toPrimitive(input,hint){if("object"!==VariableEditor_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==VariableEditor_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===VariableEditor_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function VariableEditor_regeneratorRuntime(){VariableEditor_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==VariableEditor_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function VariableEditor_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function VariableEditor_slicedToArray(arr,i){return function VariableEditor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function VariableEditor_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function VariableEditor_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return VariableEditor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VariableEditor_arrayLikeToArray(o,minLen)}(arr,i)||function VariableEditor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VariableEditor_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var FieldTemplate=function FieldTemplate(props){var _props$rawErrors,_props$rawErrors2;return props.hidden?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}):(0,jsx_runtime.jsxs)(Form.Z.Group,{className:"mb-0",children:[(0,jsx_runtime.jsx)("div",{children:props.children}),(0,jsx_runtime.jsx)("div",{children:props.rawHelp&&(null===(_props$rawErrors=props.rawErrors)||void 0===_props$rawErrors?void 0:_props$rawErrors.length)<1&&(0,jsx_runtime.jsx)(Form.Z.Text,{className:(null===(_props$rawErrors2=props.rawErrors)||void 0===_props$rawErrors2?void 0:_props$rawErrors2.length)>0?"text-danger":"text-muted",id:props.id,children:props.rawHelp})})]})},ObjectFieldTemplate=function ObjectFieldTemplate(_ref){var DescriptionField=_ref.DescriptionField,description=_ref.description,TitleField=_ref.TitleField,title=_ref.title,properties=_ref.properties,required=_ref.required,uiSchema=_ref.uiSchema,idSchema=_ref.idSchema;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(uiSchema["ui:title"]||title)&&(0,jsx_runtime.jsx)(TitleField,{id:"".concat(idSchema.$id,"-title"),title:uiSchema["ui:title"]||title,required}),description&&(0,jsx_runtime.jsx)(DescriptionField,{id:"".concat(idSchema.$id,"-description"),description}),(0,jsx_runtime.jsx)("div",{className:"d-flex",children:properties.map((function(element,index){return(0,jsx_runtime.jsx)("div",{className:"mr-2 ".concat(0===index?"":"flex-grow-1"),children:element.content},index)}))})]})},VariableArrayItem=function VariableArrayItem(props){return(0,jsx_runtime.jsx)("div",{className:"mt-2 border-bottom",children:(0,jsx_runtime.jsxs)("div",{className:"mb-2 d-flex flex-row align-items-start",children:[(0,jsx_runtime.jsxs)("div",{className:"self-end mb-3",children:[(0,jsx_runtime.jsxs)(Button.Z,{disabled:!props.hasMoveUp||props.readonly||props.disabled,variant:"link",size:"sm",onClick:props.onReorderClick(props.index,props.index-1),children:[(0,jsx_runtime.jsx)("i",{className:"fa fa-arrow-circle-up fa-2x"}),(0,jsx_runtime.jsx)("span",{className:"sr-only",children:"Move Up"})]}),(0,jsx_runtime.jsxs)(Button.Z,{disabled:!props.hasMoveDown||props.readonly||props.disabled,variant:"link",size:"sm",onClick:props.onReorderClick(props.index,props.index+1),children:[(0,jsx_runtime.jsx)("i",{className:"fa fa-arrow-circle-down fa-2x"}),(0,jsx_runtime.jsx)("span",{className:"sr-only",children:"Move Down"})]})]}),(0,jsx_runtime.jsx)("div",{className:"flex-grow-1",children:props.children}),(0,jsx_runtime.jsx)("div",{className:"self-end mb-3",children:(0,jsx_runtime.jsxs)(Button.Z,{variant:"danger",disabled:props.disabled||props.readonly,onClick:props.onDropIndexClick(props.index),children:[(0,jsx_runtime.jsx)("span",{className:"sr-only",children:"Delete"}),(0,jsx_runtime.jsx)("i",{className:"fa fa-trash"})]})})]})})};VariableArrayItem.displayName="VariableArrayItem";var VariableEditor=function VariableEditor(props){var _useState2=VariableEditor_slicedToArray((0,react.useState)(!1),2),show=_useState2[0],setShow=_useState2[1],_useState4=VariableEditor_slicedToArray((0,react.useState)(null),2),results=_useState4[0],setResults=_useState4[1],dispatch=(0,es.I0)(),handleClose=function(){var _ref2=function VariableEditor_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){VariableEditor_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){VariableEditor_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(VariableEditor_regeneratorRuntime().mark((function _callee(){var result,errors,errorList;return VariableEditor_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,dispatch(validateVariables({}));case 2:"fulfilled"===(result=_context.sent).meta.requestStatus&&(result.payload.errors.length>0?(errors=result.payload.errors,errorList=(0,jsx_runtime.jsx)(PageError,{error:errors},errors[0].owner.title),setResults(errorList)):(setResults(null),setShow(!1)));case 4:case"end":return _context.stop()}}),_callee)})));return function handleClose(){return _ref2.apply(this,arguments)}}();return(0,jsx_runtime.jsxs)("div",{className:"p-3",children:[(0,jsx_runtime.jsx)("button",{className:"btn btn-primary btn-block",type:"button",disabled:!props.canAdd,onClick:function handleShow(){return setShow(!0)},children:"Edit Lesson Variables"}),(0,jsx_runtime.jsx)(ListGroup.Z,{className:"mt-2",variant:"flush",children:props.items.map((function(element,index){var _element$children,_element$children$pro,_element$children$pro2,_element$children2,_element$children2$pr,_element$children2$pr2;return(0,jsx_runtime.jsx)(OverlayTrigger.Z,{placement:"left",overlay:(0,jsx_runtime.jsxs)(Tooltip.Z,{id:"tooltip-".concat(index),children:["Expression: ",(0,jsx_runtime.jsx)("strong",{children:null==element||null===(_element$children=element.children)||void 0===_element$children||null===(_element$children$pro=_element$children.props)||void 0===_element$children$pro||null===(_element$children$pro2=_element$children$pro.formData)||void 0===_element$children$pro2?void 0:_element$children$pro2.expression})]}),children:(0,jsx_runtime.jsx)(ListGroupItem.Z,{children:null==element||null===(_element$children2=element.children)||void 0===_element$children2||null===(_element$children2$pr=_element$children2.props)||void 0===_element$children2$pr||null===(_element$children2$pr2=_element$children2$pr.formData)||void 0===_element$children2$pr2?void 0:_element$children2$pr2.name},index)},index)}))}),(0,jsx_runtime.jsxs)(Modal.Z,{show,onHide:handleClose,size:"lg",children:[(0,jsx_runtime.jsx)(Modal.Z.Header,{closeButton:!0,children:(0,jsx_runtime.jsx)(Modal.Z.Title,{children:"Variable editor"})}),(0,jsx_runtime.jsxs)(Modal.Z.Body,{children:[(0,jsx_runtime.jsx)("div",{children:results}),props.items.map((function(element,idx){return(0,jsx_runtime.jsx)(VariableArrayItem,function VariableEditor_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?VariableEditor_ownKeys(Object(source),!0).forEach((function(key){VariableEditor_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):VariableEditor_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},element),idx)})),props.canAdd&&(0,jsx_runtime.jsxs)("button",{className:"btn btn-primary mt-2",type:"button",onClick:props.onAddClick,children:[(0,jsx_runtime.jsx)("i",{className:"fa fa-plus"}),"Add Variable"]})]}),(0,jsx_runtime.jsx)(Modal.Z.Footer,{children:(0,jsx_runtime.jsx)(Button.Z,{variant:"secondary",onClick:handleClose,children:"Finished"})})]})]})};VariableEditor.displayName="VariableEditor";const custom_VariableEditor=VariableEditor;try{FieldTemplate.displayName="FieldTemplate",FieldTemplate.__docgenInfo={description:"",displayName:"FieldTemplate",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/VariableEditor.tsx#FieldTemplate"]={docgenInfo:FieldTemplate.__docgenInfo,name:"FieldTemplate",path:"src/apps/authoring/components/PropertyEditor/custom/VariableEditor.tsx#FieldTemplate"})}catch(__react_docgen_typescript_loader_error){}try{ObjectFieldTemplate.displayName="ObjectFieldTemplate",ObjectFieldTemplate.__docgenInfo={description:"",displayName:"ObjectFieldTemplate",props:{DescriptionField:{defaultValue:null,description:"",name:"DescriptionField",required:!0,type:{name:"FunctionComponent<{ id: string; description: string | ReactElement<any, string | JSXElementConstructor<any>>; }>"}},TitleField:{defaultValue:null,description:"",name:"TitleField",required:!0,type:{name:"FunctionComponent<{ id: string; title: string; required: boolean; }>"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},properties:{defaultValue:null,description:"",name:"properties",required:!0,type:{name:"{ content: ReactElement<any, string | JSXElementConstructor<any>>; name: string; disabled: boolean; readonly: boolean; hidden: boolean; }[]"}},onAddClick:{defaultValue:null,description:"",name:"onAddClick",required:!0,type:{name:"(schema: JSONSchema7) => () => void"}},readonly:{defaultValue:null,description:"",name:"readonly",required:!0,type:{name:"boolean"}},required:{defaultValue:null,description:"",name:"required",required:!0,type:{name:"boolean"}},schema:{defaultValue:null,description:"",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"",name:"uiSchema",required:!0,type:{name:"UiSchema"}},idSchema:{defaultValue:null,description:"",name:"idSchema",required:!0,type:{name:"IdSchema<any>"}},formData:{defaultValue:null,description:"",name:"formData",required:!0,type:{name:"any"}},formContext:{defaultValue:null,description:"",name:"formContext",required:!0,type:{name:"any"}},registry:{defaultValue:null,description:"",name:"registry",required:!0,type:{name:"Registry"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/VariableEditor.tsx#ObjectFieldTemplate"]={docgenInfo:ObjectFieldTemplate.__docgenInfo,name:"ObjectFieldTemplate",path:"src/apps/authoring/components/PropertyEditor/custom/VariableEditor.tsx#ObjectFieldTemplate"})}catch(__react_docgen_typescript_loader_error){}try{VariableEditor.displayName="VariableEditor",VariableEditor.__docgenInfo={description:"",displayName:"VariableEditor",props:{onAddClick:{defaultValue:null,description:"",name:"onAddClick",required:!0,type:{name:"any"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"any[]"}},canAdd:{defaultValue:null,description:"",name:"canAdd",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/VariableEditor.tsx#VariableEditor"]={docgenInfo:VariableEditor.__docgenInfo,name:"VariableEditor",path:"src/apps/authoring/components/PropertyEditor/custom/VariableEditor.tsx#VariableEditor"})}catch(__react_docgen_typescript_loader_error){}function lesson_slicedToArray(arr,i){return function lesson_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function lesson_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function lesson_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return lesson_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lesson_arrayLikeToArray(o,minLen)}(arr,i)||function lesson_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lesson_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var simpleLessonSchema={type:"object",properties:{Properties:{type:"object",title:" Properties",properties:{title:{type:"string",title:"Title",readOnly:!0},Appearance:{type:"object",properties:{displayApplicationChrome:{type:"boolean",title:"Display Torus Navigation",default:"false"}}},FinishPanel:{type:"object",properties:{logoutMessage:{title:"Message",type:"string",format:"textarea"}}},enableHistory:{title:"Enable History",type:"boolean"}}}}},simpleLessonUiSchema={Properties:{"ui:ObjectFieldTemplate":custom_AccordionTemplate,FinishPanel:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,"ui:title":"Finish Panel"}}},lessonUiSchema={Properties:{"ui:ObjectFieldTemplate":custom_AccordionTemplate,Size:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,"ui:title":"Screen Size",width:{classNames:"col-span-6"},height:{classNames:"col-span-6"}},Appearance:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,"ui:title":"Lesson Appearance",backgroundImageURL:{"ui:widget":"TorusImageBrowser"}},FinishPanel:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,"ui:title":"Finish Panel"}},CustomLogic:{"ui:ObjectFieldTemplate":custom_AccordionTemplate,variables:{"ui:ArrayFieldTemplate":custom_VariableEditor,items:{"ui:ObjectFieldTemplate":ObjectFieldTemplate,name:{"ui:FieldTemplate":FieldTemplate},expression:{"ui:FieldTemplate":FieldTemplate}}}}};const lesson={type:"object",properties:{Properties:{type:"object",title:" Properties",properties:{title:{type:"string",title:"Title",readOnly:!0},Size:{type:"object",title:"Dimensions",properties:{width:{type:"number"},height:{type:"number"}}},Appearance:{type:"object",title:"Lesson Appearance",properties:{theme:{anyOf:[{type:"string",title:"Default Theme",enum:["/css/delivery_adaptive_themes_default_light.css","/css/delivery_adaptive_themes_flowchart.css"],default:"/css/delivery_adaptive_themes_default_light.css"},{type:"string",title:"Custom Theme"}]},customCssUrl:{type:"string",title:"Custom CSS URL"},backgroundImageURL:{type:"string",title:"Background Image URL"},backgroundImageScaleContent:{type:"boolean",title:"Scale Background Image to Fit"},displayApplicationChrome:{type:"boolean",title:"Display Torus Navigation",default:"false"}}},FinishPanel:{type:"object",properties:{logoutMessage:{title:"Message",type:"string",format:"textarea"},logoutPanelImageURL:{type:"string",title:"Background URL"}}},enableHistory:{title:"Enable History",type:"boolean"},customCSS:{title:"Custom CSS",type:"string",description:"block of css code to be injected into style tag",format:"textarea"}}},CustomLogic:{type:"object",title:"Custom Logic",properties:{variables:{type:"array",title:"Variables",items:{type:"object",properties:{name:{type:"string",title:"Name"},expression:{type:"string",title:"Expression"}}}},customScript:{type:"string",title:"Custom Script",format:"textarea"}}}}};var react_bootstrap_typeahead_es=__webpack_require__("./node_modules/react-bootstrap-typeahead/es/index.js"),immutable_es=__webpack_require__("./node_modules/immutable/dist/immutable.es.js"),persistence_common=__webpack_require__("./src/data/persistence/common.ts");var classNames=__webpack_require__("./src/utils/classNames.ts"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),ObjectivesSelection_modules=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/resolve-url-loader/index.js!./node_modules/@storybook/addon-styling/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[3]!./src/components/resource/objectives/ObjectivesSelection.modules.scss"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(ObjectivesSelection_modules.Z,options);const objectives_ObjectivesSelection_modules=ObjectivesSelection_modules.Z&&ObjectivesSelection_modules.Z.locals?ObjectivesSelection_modules.Z.locals:void 0;function ObjectivesSelection_slicedToArray(arr,i){return function ObjectivesSelection_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ObjectivesSelection_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function ObjectivesSelection_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ObjectivesSelection_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ObjectivesSelection_arrayLikeToArray(o,minLen)}(arr,i)||function ObjectivesSelection_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ObjectivesSelection_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function filterBy(byId,option,props){return option.title.indexOf(props.text)>-1||null!==option.parentId&&byId[option.parentId].title.indexOf(props.text)>-1}function createMapById(objectives){return objectives.reduce((function(m,o){return m[o.id]=o,m}),{})}var ObjectivesSelection=function ObjectivesSelection(props){var objectives=props.objectives,editMode=props.editMode,selected=props.selected,onEdit=props.onEdit,onRegisterNewObjective=props.onRegisterNewObjective,id=ObjectivesSelection_slicedToArray((0,react.useState)((0,guid.Z)()),1)[0],_useState4=ObjectivesSelection_slicedToArray((0,react.useState)(createMapById(objectives)),2),byId=_useState4[0],setById=_useState4[1],allSelected=selected.reduce((function(m,id){return m[id]=!0,m}),{});(0,react.useEffect)((function(){setById(createMapById(objectives))}),[objectives]);var map=immutable_es.D5(objectives.map((function(o){return[o.id,o]}))),asObjectives=selected.map((function(s){return map.get(s)})),allowNewObjective=!!onRegisterNewObjective;return(0,jsx_runtime.jsx)("div",{className:(0,classNames.A)(objectives_ObjectivesSelection_modules.objectivesSelection,"flex-grow-1"),children:(0,jsx_runtime.jsx)(react_bootstrap_typeahead_es.pY,{id,filterBy:filterBy.bind(undefined,byId),renderMenuItemChildren:function renderMenuItemChildren(option,_props,_index){return(0,jsx_runtime.jsxs)("div",{children:[null!==option.parentId?(0,jsx_runtime.jsx)("span",{className:"ml-3",children:" "}):null,(0,jsx_runtime.jsx)("input",{className:"mr-2",type:"checkbox",readOnly:!0,checked:allSelected[option.id]}),option.title]})},multiple:!0,disabled:!editMode,onChange:function onChange(updated){var createdObjective=updated.find((function(o){return o.customOption}));if(createdObjective)(function create(project,title){var params={method:"POST",body:JSON.stringify({title}),url:"/objectives/project/".concat(project)};return(0,persistence_common.$)(params)})(props.projectSlug,createdObjective.title).then((function(result){if("success"!==result.result||!onRegisterNewObjective)throw result;onRegisterNewObjective({id:result.resourceId,title:createdObjective.title,parentId:null});var updatedObjectives=updated.map((function(o){return o.customOption?result.resourceId:o.id}));onEdit(updatedObjectives)})).catch((function(e){console.error("objective creation failed",e)}));else if(updated.length!==selected.length){var updatedObjectives=updated.map((function(o){return o.id})).reduce((function(m,i){return m[i]=!0,m}),{}),ids=Object.keys(updatedObjectives).map((function(str){return parseInt(str)}));onEdit(ids)}},options:props.objectives,allowNew:allowNewObjective,newSelectionPrefix:"Create new objective: ",labelKey:"title",selected:asObjectives,placeholder:"Select learning objectives..."})})};ObjectivesSelection.displayName="ObjectivesSelection";try{ObjectivesSelection.displayName="ObjectivesSelection",ObjectivesSelection.__docgenInfo={description:"",displayName:"ObjectivesSelection",props:{objectives:{defaultValue:null,description:"",name:"objectives",required:!0,type:{name:"Objective[]"}},selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"number[]"}},editMode:{defaultValue:null,description:"",name:"editMode",required:!0,type:{name:"boolean"}},projectSlug:{defaultValue:null,description:"",name:"projectSlug",required:!0,type:{name:"string"}},onEdit:{defaultValue:null,description:"",name:"onEdit",required:!0,type:{name:"(objectives: number[]) => void"}},onRegisterNewObjective:{defaultValue:null,description:"",name:"onRegisterNewObjective",required:!1,type:{name:"((objective: Objective) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/resource/objectives/ObjectivesSelection.tsx#ObjectivesSelection"]={docgenInfo:ObjectivesSelection.__docgenInfo,name:"ObjectivesSelection",path:"src/components/resource/objectives/ObjectivesSelection.tsx#ObjectivesSelection"})}catch(__react_docgen_typescript_loader_error){}var LearningObjectivesModal=function LearningObjectivesModal(_ref){var readonly=_ref.readonly,handleClose=_ref.handleClose,onChange=_ref.onChange,currentObjectives=_ref.currentObjectives,objectiveMap=_ref.objectiveMap,projectSlug=(0,es.v9)(slice.LJ);return(0,jsx_runtime.jsxs)(AdvancedAuthoringModal.tv,{onHide:handleClose,show:!0,size:"xl",children:[(0,jsx_runtime.jsx)(Modal.Z.Header,{closeButton:!0,children:(0,jsx_runtime.jsx)(Modal.Z.Title,{children:"Objectives editor"})}),(0,jsx_runtime.jsx)(Modal.Z.Body,{children:(0,jsx_runtime.jsx)(ObjectivesSelection,{editMode:!readonly,objectives:Object.values(objectiveMap),selected:currentObjectives,onEdit:onChange,projectSlug})}),(0,jsx_runtime.jsx)(Modal.Z.Footer,{children:(0,jsx_runtime.jsx)(Button.Z,{variant:"primary",onClick:handleClose,children:"Finished"})})]})};LearningObjectivesModal.displayName="LearningObjectivesModal";try{LearningObjectivesModal.displayName="LearningObjectivesModal",LearningObjectivesModal.__docgenInfo={description:"",displayName:"LearningObjectivesModal",props:{readonly:{defaultValue:null,description:"",name:"readonly",required:!0,type:{name:"boolean"}},handleClose:{defaultValue:null,description:"",name:"handleClose",required:!0,type:{name:"() => void"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(items: number[]) => void"}},currentObjectives:{defaultValue:null,description:"",name:"currentObjectives",required:!0,type:{name:"number[]"}},objectiveMap:{defaultValue:null,description:"",name:"objectiveMap",required:!0,type:{name:"ObjectivesMap"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/LearningObjectivesModal.tsx#LearningObjectivesModal"]={docgenInfo:LearningObjectivesModal.__docgenInfo,name:"LearningObjectivesModal",path:"src/apps/authoring/components/PropertyEditor/custom/LearningObjectivesModal.tsx#LearningObjectivesModal"})}catch(__react_docgen_typescript_loader_error){}function LearningObjectivesEditor_slicedToArray(arr,i){return function LearningObjectivesEditor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function LearningObjectivesEditor_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function LearningObjectivesEditor_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return LearningObjectivesEditor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LearningObjectivesEditor_arrayLikeToArray(o,minLen)}(arr,i)||function LearningObjectivesEditor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function LearningObjectivesEditor_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var SingleObjective=function SingleObjective(_ref){var objective=_ref.objective;return(0,jsx_runtime.jsx)("li",{children:objective.title})};SingleObjective.displayName="SingleObjective";var LearningObjectivesEditor=function LearningObjectivesEditor(_ref2){var disabled=_ref2.disabled,value=_ref2.value,readonly=_ref2.readonly,onChange=_ref2.onChange,onBlur=_ref2.onBlur,id=_ref2.id,_useState2=LearningObjectivesEditor_slicedToArray((0,react.useState)(!1),2),editorWindowOpen=_useState2[0],setEditorWindowOpen=_useState2[1],handleOpenEditorWindow=(0,react.useCallback)((function(){return setEditorWindowOpen(!0)}),[]),handleCloseEditorWindow=(0,react.useCallback)((function(){onBlur(id,value),setEditorWindowOpen(!1)}),[]),objectiveMap=(0,es.v9)(slice.Sp),onObjectivesChanged=(0,react.useCallback)((function(value){onChange(value)}),[onChange]);return Array.isArray(value)?(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"form-label",children:"Learning Objectives"}),(0,jsx_runtime.jsx)("ul",{className:"list-unstyled objectives-flat-list",children:value.map((function(objectiveId){return objectiveMap[String(objectiveId)]})).filter((function(objective){return!!objective})).map((function(objective){return(0,jsx_runtime.jsx)(SingleObjective,{objective},objective.id)}))}),(0,jsx_runtime.jsx)("button",{className:"btn btn-primary btn-block",type:"button",disabled:disabled||editorWindowOpen,onClick:handleOpenEditorWindow,children:"Edit Objectives"}),editorWindowOpen&&(0,jsx_runtime.jsx)(LearningObjectivesModal,{readonly,currentObjectives:value,objectiveMap,handleClose:handleCloseEditorWindow,onChange:onObjectivesChanged})]}):null};LearningObjectivesEditor.displayName="LearningObjectivesEditor";try{LearningObjectivesEditor.displayName="LearningObjectivesEditor",LearningObjectivesEditor.__docgenInfo={description:"",displayName:"LearningObjectivesEditor",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"number[]"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},readonly:{defaultValue:null,description:"",name:"readonly",required:!0,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(items: number[]) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(id: string, items: number[]) => void"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/LearningObjectivesEditor.tsx#LearningObjectivesEditor"]={docgenInfo:LearningObjectivesEditor.__docgenInfo,name:"LearningObjectivesEditor",path:"src/apps/authoring/components/PropertyEditor/custom/LearningObjectivesEditor.tsx#LearningObjectivesEditor"})}catch(__react_docgen_typescript_loader_error){}function screen_typeof(obj){return screen_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},screen_typeof(obj)}function screen_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function screen_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?screen_ownKeys(Object(source),!0).forEach((function(key){screen_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):screen_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function screen_defineProperty(obj,key,value){return(key=function screen_toPropertyKey(arg){var key=function screen_toPrimitive(input,hint){if("object"!==screen_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==screen_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===screen_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var simpleScreenSchema={type:"object",properties:{title:{type:"string",title:"Screen Title"},palette:{type:"object",properties:{backgroundColor:{type:"string",title:"Background Color"},borderColor:{type:"string",title:"Border Color"},borderRadius:{type:"string",title:"Border Radius"},borderStyle:{type:"string",title:"Border Style"},borderWidth:{type:"string",title:"Border Width"}}},checkButton:{type:"object",properties:{showCheckBtn:{title:"Show Check Button",type:"boolean",format:"checkbox"},checkButtonLabel:{title:"Check Button Label",type:"string"}}},max:{type:"object",title:"Scoring",properties:{maxScore:{title:"Max Score",type:"number",default:4}}},learningObjectives:{title:"Learning Objectives",type:"array",items:{type:"number"}}}},simpleScreenUiSchema={max:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,maxAttempt:{classNames:"col-span-6"},maxScore:{classNames:"col-span-6"}},palette:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,"ui:title":"Palette",backgroundColor:{"ui:widget":ColorPickerWidget.Z},borderColor:{"ui:widget":ColorPickerWidget.Z},borderStyle:{classNames:"col-span-6"},borderWidth:{classNames:"col-span-6"}},checkButton:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,showCheckBtn:{classNames:"col-span-12"},checkButtonLabel:{classNames:"col-span-12"}},learningObjectives:{"ui:widget":LearningObjectivesEditor}},screenUiSchema={Size:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,"ui:title":"Dimensions",width:{classNames:"col-span-6"},height:{classNames:"col-span-6"}},max:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,maxAttempt:{classNames:"col-span-6"},maxScore:{classNames:"col-span-6"}},palette:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,"ui:title":"Palette",backgroundColor:{"ui:widget":ColorPickerWidget.Z},borderColor:{"ui:widget":ColorPickerWidget.Z},borderStyle:{classNames:"col-span-6"},borderWidth:{classNames:"col-span-6"}},checkButton:{"ui:ObjectFieldTemplate":CustomFieldTemplate.Z,showCheckBtn:{classNames:"col-span-12"},checkButtonLabel:{classNames:"col-span-12"}},learningObjectives:{"ui:widget":LearningObjectivesEditor}};const screen={type:"object",properties:{title:{type:"string",title:"Title"},Size:{type:"object",title:"Dimensions",properties:{width:{type:"number",title:"Width"},height:{type:"number",title:"Height"}}},palette:{type:"object",properties:{backgroundColor:{type:"string",title:"Background Color"},borderColor:{type:"string",title:"Border Color"},borderRadius:{type:"string",title:"Border Radius"},borderStyle:{type:"string",title:"Border Style"},borderWidth:{type:"string",title:"Border Width"}}},customCssClass:{title:"Custom CSS Class",type:"string"},combineFeedback:{title:"Combine Feedback",type:"boolean",format:"checkbox",default:!0},checkButton:{type:"object",properties:{showCheckBtn:{title:"Show Check Button",type:"boolean",format:"checkbox"},checkButtonLabel:{title:"Check Button Label",type:"string"}}},max:{type:"object",properties:{maxAttempt:{title:"Max Attempts",type:"number"},maxScore:{title:"Max Score",type:"number"}}},trapStateScoreScheme:{title:"Trap State Scoring",type:"boolean",format:"checkbox",default:!0},negativeScoreAllowed:{title:"Allow Negative Question Score",type:"boolean",format:"checkbox",default:!0},learningObjectives:{title:"Learning Objectives",type:"array",items:{type:"number"}}}};var ButtonToolbar=__webpack_require__("./node_modules/react-bootstrap/esm/ButtonToolbar.js"),ButtonGroup=__webpack_require__("./node_modules/react-bootstrap/esm/ButtonGroup.js"),useToggle=__webpack_require__("./src/components/hooks/useToggle.ts");function CompJsonEditor_slicedToArray(arr,i){return function CompJsonEditor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CompJsonEditor_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function CompJsonEditor_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CompJsonEditor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CompJsonEditor_arrayLikeToArray(o,minLen)}(arr,i)||function CompJsonEditor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CompJsonEditor_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CompJsonEditor=function CompJsonEditor(props){var jsonValue=props.jsonValue,onChange=props.onChange,existingPartIds=props.existingPartIds,val={id:jsonValue.id,custom:jsonValue.custom},_useState2=CompJsonEditor_slicedToArray((0,react.useState)(JSON.stringify(val,null,4)),2),value=_useState2[0],setValue=_useState2[1],_useState4=CompJsonEditor_slicedToArray((0,react.useState)(""),2),validationMsg=_useState4[0],setValidationMsg=_useState4[1],currentPartSelection=(0,es.v9)(parts_slice.e5),_useState6=CompJsonEditor_slicedToArray((0,react.useState)(!1),2),displayEditor=_useState6[0],setDisplayEditor=_useState6[1];(0,react.useEffect)((function(){val={id:jsonValue.id,custom:jsonValue.custom},setValue(JSON.stringify(val,null,4))}),[jsonValue]);return(0,jsx_runtime.jsxs)(react.Fragment,{children:[(0,jsx_runtime.jsx)(Button.Z,{onClick:function onClick(){return setDisplayEditor(!0)},children:(0,jsx_runtime.jsx)("i",{className:"fas fa-edit mr-2"})}),(0,jsx_runtime.jsxs)(AdvancedAuthoringModal.tv,{show:displayEditor,onHide:function onHide(){return setDisplayEditor(!1)},children:[(0,jsx_runtime.jsx)(Modal.Z.Header,{closeButton:!0,children:(0,jsx_runtime.jsx)("h4",{className:"modal-title",children:"Edit JSON"})}),(0,jsx_runtime.jsxs)(Modal.Z.Body,{children:[(0,jsx_runtime.jsx)("textarea",{style:{width:"100%"},rows:20,onChange:function handleOnChange(event){var changedVal=event.target.value;setValue(changedVal);try{var jsonVal=JSON.parse(changedVal);-1!==existingPartIds.indexOf(jsonVal.id)&&currentPartSelection!==jsonVal.id?setValidationMsg("ID you have used is already exist in the current Activity."):jsonVal.id?setValidationMsg(""):setValidationMsg("ID is required and cannot be empty")}catch(e){setValidationMsg("Please make sure the JSON is in proper format.")}},value}),(0,jsx_runtime.jsx)("label",{className:"text-danger",children:validationMsg})]}),(0,jsx_runtime.jsxs)(Modal.Z.Footer,{children:[(0,jsx_runtime.jsx)("button",{id:"btnSave",type:"button",className:"btn btn-success",onClick:function onClick(){setDisplayEditor(!1),onChange(JSON.parse(value))},disabled:""!==validationMsg,children:"Save"}),(0,jsx_runtime.jsx)("button",{type:"button",className:"btn btn-danger",onClick:function onClick(){return setDisplayEditor(!1)},children:"Cancel"})]})]})]})};CompJsonEditor.displayName="CompJsonEditor";const custom_CompJsonEditor=CompJsonEditor;try{CompJsonEditor.displayName="CompJsonEditor",CompJsonEditor.__docgenInfo={description:"",displayName:"CompJsonEditor",props:{jsonValue:{defaultValue:null,description:"",name:"jsonValue",required:!0,type:{name:"any"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(changedJson: object) => void"}},existingPartIds:{defaultValue:null,description:"",name:"existingPartIds",required:!0,type:{name:"string[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/PropertyEditor/custom/CompJsonEditor.tsx#CompJsonEditor"]={docgenInfo:CompJsonEditor.__docgenInfo,name:"CompJsonEditor",path:"src/apps/authoring/components/PropertyEditor/custom/CompJsonEditor.tsx#CompJsonEditor"})}catch(__react_docgen_typescript_loader_error){}var part=__webpack_require__("./src/apps/authoring/components/PropertyEditor/schemas/part.ts");function PartPropertyEditor_typeof(obj){return PartPropertyEditor_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},PartPropertyEditor_typeof(obj)}function PartPropertyEditor_slicedToArray(arr,i){return function PartPropertyEditor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function PartPropertyEditor_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function PartPropertyEditor_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return PartPropertyEditor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PartPropertyEditor_arrayLikeToArray(o,minLen)}(arr,i)||function PartPropertyEditor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PartPropertyEditor_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function PartPropertyEditor_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function PartPropertyEditor_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?PartPropertyEditor_ownKeys(Object(source),!0).forEach((function(key){PartPropertyEditor_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):PartPropertyEditor_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function PartPropertyEditor_defineProperty(obj,key,value){return(key=function PartPropertyEditor_toPropertyKey(arg){var key=function PartPropertyEditor_toPrimitive(input,hint){if("object"!==PartPropertyEditor_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==PartPropertyEditor_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===PartPropertyEditor_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var findPartByIdInActivity=function findPartByIdInActivity(currentActivity,targetPartId){var _currentActivity$cont;return currentActivity&&targetPartId?null===(_currentActivity$cont=currentActivity.content)||void 0===_currentActivity$cont?void 0:_currentActivity$cont.partsLayout.find((function(part){return part.id===targetPartId})):null},getSimplifiedComponentSchema=function getSimplifiedComponentSchema(instance){if(instance&&instance.getSchema){var customPartSchema=instance.getSchema("simple"),newSchema=PartPropertyEditor_objectSpread(PartPropertyEditor_objectSpread({},part.J7),{},{properties:PartPropertyEditor_objectSpread({custom:{type:"object",properties:PartPropertyEditor_objectSpread({},customPartSchema)}},part.J7.properties)});return customPartSchema.definitions&&(newSchema.definitions=customPartSchema.definitions,delete newSchema.properties.custom.properties.definitions),customPartSchema.allOf&&(newSchema.properties.custom.allOf=customPartSchema.allOf,delete newSchema.properties.custom.properties.allOf),newSchema}return part.J7},getExpertComponentSchema=function getExpertComponentSchema(instance){if(instance&&instance.getSchema){var customPartSchema=instance.getSchema("expert"),newSchema=PartPropertyEditor_objectSpread(PartPropertyEditor_objectSpread({},part.ZP),{},{properties:PartPropertyEditor_objectSpread(PartPropertyEditor_objectSpread({},part.ZP.properties),{},{custom:{type:"object",properties:PartPropertyEditor_objectSpread({},customPartSchema)}})});return customPartSchema.definitions&&(newSchema.definitions=customPartSchema.definitions,delete newSchema.properties.custom.properties.definitions),newSchema}return part.ZP},simplifiedLabels={"janus-text-flow":"Text Flow","janus-image":"Image","janus-video":"Video","janus-popup":"Popup Icon","janus-audio":"Audio","janus-capi-iframe":"iFrame","janus-mcq":"Multiple Choice Question","janus-input-text":"Text Input","janus-input-number":"Number Input","janus-dropdown":"Dropdown","janus-slider":"Slider","janus-multi-line-text":"Multi line text input"},getSimplifiedComponentUISchema=function getSimplifiedComponentUISchema(instance){var tagName=instance?String(instance.tagName).toLowerCase():"",title=simplifiedLabels[tagName]||"Component Options";if(instance&&instance.getUiSchema){var customPartUiSchema=instance.getUiSchema("simple");return PartPropertyEditor_objectSpread(PartPropertyEditor_objectSpread({},part.VA),{},{custom:PartPropertyEditor_objectSpread({"ui:title":title},customPartUiSchema)})}return part.VA},getExpertComponentUISchema=function getExpertComponentUISchema(instance){if(instance&&instance.getUiSchema){var customPartUiSchema=instance.getUiSchema("expert");return PartPropertyEditor_objectSpread(PartPropertyEditor_objectSpread({},part.cg),{},{custom:PartPropertyEditor_objectSpread({"ui:ObjectFieldTemplate":custom_AccordionTemplate,"ui:title":"Custom"},customPartUiSchema)})}return part.cg},PartPropertyEditor=function PartPropertyEditor(_ref){var currentActivity=_ref.currentActivity,currentActivityTree=_ref.currentActivityTree,currentPartSelection=_ref.currentPartSelection,existingIds=_ref.existingIds,dispatch=(0,es.I0)(),partEditMode="expert"===(0,es.v9)(slice.Xi)?"expert":"simple",_useToggle2=PartPropertyEditor_slicedToArray((0,useToggle.O)(!1),4),shouldShowConfirmDelete=_useToggle2[0],showConfirmDelete=_useToggle2[2],hideConfirmDelete=_useToggle2[3],partDef=(0,react.useMemo)((function(){return function getPartDef(currentActivityTree,currentPartSelection){for(var partDef,i=0;i<currentActivityTree.length;i++){var _activity$content;if(partDef=null===(_activity$content=currentActivityTree[i].content)||void 0===_activity$content?void 0:_activity$content.partsLayout.find((function(part){return part.id===currentPartSelection})),partDef)break}return partDef}(currentActivityTree,currentPartSelection)}),[currentActivityTree,currentPartSelection]),currentPartInstance=(0,react.useMemo)((function(){return function getCurrentPartInstance(type){var PartClass=customElements.get(type);return PartClass?new PartClass:null}(null==partDef?void 0:partDef.type)}),[null==partDef?void 0:partDef.type]),selectedPartDef=(0,react.useMemo)((function(){return findPartByIdInActivity(currentActivity,currentPartSelection)}),[currentActivity,currentPartSelection]),currentComponentData=(0,react.useMemo)((function(){return function getComponentData(instance,partDef){if(!instance||!partDef)return null;var data=(0,common.d9)(partDef);return instance.transformModelToSchema&&(data.custom=PartPropertyEditor_objectSpread(PartPropertyEditor_objectSpread({},data.custom),instance.transformModelToSchema(partDef.custom))),(0,part.GE)(data)}(currentPartInstance,partDef)}),[currentPartInstance,partDef]),componentSchema=(0,react.useMemo)((function(){return function getComponentSchema(instance,partEditMode){return"simple"===partEditMode?getSimplifiedComponentSchema(instance):getExpertComponentSchema(instance)}(currentPartInstance,partEditMode)}),[currentPartInstance,partEditMode]),componentUiSchema=(0,react.useMemo)((function(){return function getComponentUISchema(instance,partEditMode){return"simple"===partEditMode?getSimplifiedComponentUISchema(instance):getExpertComponentUISchema(instance)}(currentPartInstance,partEditMode)}),[currentPartInstance,partEditMode]),handleDeleteComponent=(0,react.useCallback)((function(){var _currentActivity$cont2;if(currentActivity&&currentPartSelection){var partDef=null===(_currentActivity$cont2=currentActivity.content)||void 0===_currentActivity$cont2?void 0:_currentActivity$cont2.partsLayout.find((function(part){return part.id===currentPartSelection}));if(partDef){var cloneActivity=(0,common.d9)(currentActivity);cloneActivity.authoring.parts=cloneActivity.authoring.parts.filter((function(part){return part.id!==currentPartSelection})),cloneActivity.content.partsLayout=cloneActivity.content.partsLayout.filter((function(part){return part.id!==currentPartSelection})),dispatch((0,saveActivity.d)({activity:cloneActivity,undoable:!0})),dispatch((0,parts_slice.ah)({selection:""})),dispatch((0,slice.IJ)({rightPanelActiveTab:RightPanelTabs.SCREEN}))}else console.warn("Part with id ".concat(currentPartSelection," not found on this screen"))}}),[currentActivity,currentPartSelection,dispatch]),handleCopyComponent=(0,react.useCallback)((function(){if(currentActivity&&currentPartSelection){var _partDef=findPartByIdInActivity(currentActivity,currentPartSelection);if(!_partDef)return void console.warn("Part with id ".concat(currentPartSelection," not found on this screen"));dispatch((0,slice.WM)({copiedPart:_partDef}))}}),[currentActivity,currentPartSelection,dispatch]),componentPropertyChangeHandler=(0,react.useCallback)((function(properties){var modelChanges=properties;modelChanges.id&&modelChanges.id.trim()||(modelChanges.id=currentPartSelection),modelChanges=(0,part.LR)(modelChanges),currentPartInstance&&currentPartInstance.transformSchemaToModel&&(modelChanges.custom=PartPropertyEditor_objectSpread(PartPropertyEditor_objectSpread({},modelChanges.custom),currentPartInstance.transformSchemaToModel(modelChanges.custom))),dispatch(updatePart({activityId:String(currentActivity.id),partId:currentPartSelection,changes:modelChanges,mergeChanges:!1})),dispatch((0,parts_slice.ah)({selection:modelChanges.id}))}),[currentActivity.id,currentPartInstance,currentPartSelection,dispatch]);return partDef?(0,jsx_runtime.jsxs)("div",{className:"component-tab p-3 overflow-hidden part-property-editor",children:[selectedPartDef&&"expert"===partEditMode&&(0,jsx_runtime.jsx)(ButtonToolbar.Z,{"aria-label":"Component Tools",children:(0,jsx_runtime.jsxs)(ButtonGroup.Z,{className:"me-2","aria-label":"First group",children:[(0,jsx_runtime.jsx)("div",{className:"input-group-prepend",children:(0,jsx_runtime.jsx)("div",{className:"input-group-text",id:"btnGroupAddon",children:(0,jsx_runtime.jsx)("i",{className:"fas fa-wrench mr-2"})})}),(0,jsx_runtime.jsx)(Button.Z,{children:(0,jsx_runtime.jsx)("i",{className:"fas fa-copy mr-2",onClick:function onClick(){return handleCopyComponent()}})}),(0,jsx_runtime.jsx)(custom_CompJsonEditor,{onChange:function handleEditComponentJson(newJson){var _cloneActivity$conten,cloneActivity=(0,common.d9)(currentActivity),ogPart=null===(_cloneActivity$conten=cloneActivity.content)||void 0===_cloneActivity$conten?void 0:_cloneActivity$conten.partsLayout.find((function(part){return part.id===currentPartSelection}));ogPart?(""!==newJson.id&&newJson.id!==ogPart.id&&(ogPart.id=newJson.id,dispatch((0,parts_slice.ah)({selection:newJson.id}))),ogPart.custom=newJson.custom,(0,lodash.isEqual)(cloneActivity,currentActivity)||dispatch((0,saveActivity.d)({activity:cloneActivity,undoable:!0}))):console.warn("couldnt find part in current activity, most like lives on a layer; you need to update they layer copy directly")},jsonValue:selectedPartDef,existingPartIds:existingIds}),(0,jsx_runtime.jsx)(Button.Z,{variant:"danger",onClick:showConfirmDelete,children:(0,jsx_runtime.jsx)("i",{className:"fas fa-trash mr-2"})}),(0,jsx_runtime.jsx)(DeleteConfirmationModal.Z,{show:shouldShowConfirmDelete,elementType:"Component",elementName:null==currentComponentData?void 0:currentComponentData.id,deleteHandler:function DeleteComponentHandler(){handleDeleteComponent(),showConfirmDelete()},cancelHandler:hideConfirmDelete})]})}),(0,jsx_runtime.jsx)(PropertyEditor.Z,{schema:componentSchema,uiSchema:componentUiSchema,value:currentComponentData,onChangeHandler:componentPropertyChangeHandler},currentComponentData.id)]}):null};PartPropertyEditor.displayName="PartPropertyEditor";try{PartPropertyEditor.displayName="PartPropertyEditor",PartPropertyEditor.__docgenInfo={description:"",displayName:"PartPropertyEditor",props:{currentActivity:{defaultValue:null,description:"",name:"currentActivity",required:!0,type:{name:"IActivity"}},currentActivityTree:{defaultValue:null,description:"",name:"currentActivityTree",required:!0,type:{name:"IActivity[]"}},currentPartSelection:{defaultValue:null,description:"",name:"currentPartSelection",required:!0,type:{name:"string"}},existingIds:{defaultValue:null,description:"",name:"existingIds",required:!0,type:{name:"string[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/RightMenu/PartPropertyEditor.tsx#PartPropertyEditor"]={docgenInfo:PartPropertyEditor.__docgenInfo,name:"PartPropertyEditor",path:"src/apps/authoring/components/RightMenu/PartPropertyEditor.tsx#PartPropertyEditor"})}catch(__react_docgen_typescript_loader_error){}function RightMenu_typeof(obj){return RightMenu_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},RightMenu_typeof(obj)}var _excluded=["title"];function RightMenu_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function RightMenu_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?RightMenu_ownKeys(Object(source),!0).forEach((function(key){RightMenu_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):RightMenu_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function RightMenu_defineProperty(obj,key,value){return(key=function RightMenu_toPropertyKey(arg){var key=function RightMenu_toPrimitive(input,hint){if("object"!==RightMenu_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==RightMenu_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===RightMenu_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function RightMenu_slicedToArray(arr,i){return function RightMenu_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function RightMenu_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function RightMenu_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return RightMenu_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return RightMenu_arrayLikeToArray(o,minLen)}(arr,i)||function RightMenu_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function RightMenu_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var RightPanelTabs=function(RightPanelTabs){return RightPanelTabs.LESSON="lesson",RightPanelTabs.SCREEN="screen",RightPanelTabs.COMPONENT="component",RightPanelTabs}({}),RightMenu=function RightMenu(){var dispatch=(0,es.I0)(),selectedTab=(0,es.v9)(slice.EJ),currentActivityTree=(0,es.v9)(deck.kv),currentLesson=(0,es.v9)(page_slice.bz),currentGroup=(0,es.v9)(groups_slice.Ks),currentPartSelection=(0,es.v9)(parts_slice.e5),flowchartMode="flowchart"===(0,es.v9)(slice.Xi),currentSequenceId=(0,es.v9)(deck.d4),sequence=(0,es.v9)(deck.nu),currentSequence=(0,actions_sequence.zK)(sequence,currentSequenceId||""),currentActivity=RightMenu_slicedToArray((currentActivityTree||[]).slice(-1),1)[0],scrUiSchema=(0,react.useMemo)((function(){return null!=currentSequence&&currentSequence.custom.isBank?BankPropsUiSchema:flowchartMode?simpleScreenUiSchema:screenUiSchema}),[null==currentSequence?void 0:currentSequence.custom.isBank,flowchartMode]),scrSchema=(0,react.useMemo)((function(){return null!=currentSequence&&currentSequence.custom.isBank?bankScreen:flowchartMode?simpleScreenSchema:screen}),[null==currentSequence?void 0:currentSequence.custom.isBank,flowchartMode]),questionBankData=(0,react.useMemo)((function(){return function transformBankModeltoSchema(currentSequence){if(currentSequence){var schemaData={Bank:{bankShowCount:(null==currentSequence?void 0:currentSequence.custom.bankShowCount)||1,bankEndTarget:null==currentSequence?void 0:currentSequence.custom.bankEndTarget}};return schemaData.Bank.bankEndTarget?"next"===schemaData.Bank.bankEndTarget.toLowerCase()&&(schemaData.Bank.bankEndTarget=schemaData.Bank.bankEndTarget.toLowerCase()):schemaData.Bank.bankEndTarget="next",schemaData}}(currentSequence)}),[currentSequence]),scrData=(0,react.useMemo)((function(){return currentActivity?null!=currentSequence&&currentSequence.custom.isBank?function transformBankPropsModeltoSchema(activity){if(activity){var _activity$content,data=null==activity||null===(_activity$content=activity.content)||void 0===_activity$content?void 0:_activity$content.custom;if(!data)return void console.warn("no custom??",{activity});var schemaPalette=_objectSpread(_objectSpread({},data.palette),{},{borderWidth:"".concat(data.palette.lineThickness?data.palette.lineThickness+"px":"1px"),borderRadius:"10px",borderStyle:"solid",borderColor:"rgba(".concat(data.palette.lineColor||0===data.palette.lineColor?chroma_default()(data.palette.lineColor).rgb().join(","):"255, 255, 255",",").concat(data.palette.lineAlpha||"100",")"),backgroundColor:"rgba(".concat(data.palette.fillColor||0===data.palette.fillColor?chroma_default()(data.palette.fillColor).rgb().join(","):"255, 255, 255",",").concat(data.palette.fillAlpha||"100",")")});return _objectSpread(_objectSpread({},data),{},{title:(null==activity?void 0:activity.title)||"",Size:{width:data.width,height:data.height},palette:data.palette.useHtmlProps?data.palette:schemaPalette})}}(currentActivity):function transformScreenModeltoSchema(activity){if(activity){var _activity$content,data=null==activity||null===(_activity$content=activity.content)||void 0===_activity$content?void 0:_activity$content.custom;if(!data)return void console.warn("no custom??",{activity});var backgroundColor="rgba(255, 255, 255, 100)";data.palette.useHTMLProps||(data.palette.backgroundColor?backgroundColor=data.palette.backgroundColor:(data.palette.fillColor||0===data.palette.fillColor)&&(backgroundColor="rgba(".concat(chroma_default()(data.palette.fillColor).rgb().join(","),",").concat(data.palette.fillAlpha||"100",")")));var schemaPalette=screen_objectSpread(screen_objectSpread({},data.palette),{},{borderWidth:"".concat(data.palette.lineThickness?data.palette.lineThickness+"px":"1px"),borderRadius:"10px",borderStyle:"solid",borderColor:"rgba(".concat(data.palette.lineColor||0===data.palette.lineColor?chroma_default()(data.palette.lineColor).rgb().join(","):"255, 255, 255",",").concat(data.palette.lineAlpha||"100",")"),backgroundColor});return screen_objectSpread(screen_objectSpread({},data),{},{title:(null==activity?void 0:activity.title)||"",Size:{width:data.width,height:data.height},checkButton:{showCheckBtn:data.showCheckBtn,checkButtonLabel:data.checkButtonLabel},max:{maxAttempt:data.maxAttempt,maxScore:data.maxScore},palette:data.palette.useHtmlProps?data.palette:schemaPalette,learningObjectives:Object.values((null==activity?void 0:activity.objectives)||{}).flat()})}}(currentActivity):null}),[currentActivity,currentSequence]),existingIds=(0,react.useMemo)((function(){return(null==currentActivityTree?void 0:currentActivityTree.reduce((function(acc,activity){var _activity$content,ids=((null===(_activity$content=activity.content)||void 0===_activity$content?void 0:_activity$content.partsLayout)||[]).map((function(p){return p.id}));return acc.concat(ids)}),[]))||[]}),[currentActivityTree]),lessonData=function transformModelToSchema(model){var _model$additionalStyl=lesson_slicedToArray(model.additionalStylesheets,2),themeUrl=_model$additionalStyl[0],customCssUrl=_model$additionalStyl[1];return{Properties:{Size:{width:model.custom.defaultScreenWidth,height:model.custom.defaultScreenHeight},Appearance:{theme:themeUrl,customCssUrl,backgroundImageURL:model.custom.backgroundImageURL,backgroundImageScaleContent:model.custom.backgroundImageScaleContent,displayApplicationChrome:model.displayApplicationChrome},FinishPanel:{logoutMessage:model.custom.logoutMessage,logoutPanelImageURL:model.custom.logoutPanelImageURL},title:model.title,customCSS:model.customCss,enableHistory:model.custom.allowNavigation||model.custom.enableHistory||!1},CustomLogic:{variables:model.custom.variables,customScript:model.customScript}}}(currentLesson),bankPropertyChangeHandler=(0,react.useCallback)((function(properties){if(currentSequence){var modelChanges=function transformBankSchematoModel(schema){return{bankShowCount:schema.Bank.bankShowCount,bankEndTarget:schema.Bank.bankEndTarget}}(properties),bankShowCount=modelChanges.bankShowCount,bankEndTarget=modelChanges.bankEndTarget;if(currentSequence){var cloneSequence=(0,common.d9)(currentSequence);cloneSequence.custom.bankShowCount=bankShowCount,cloneSequence.custom.bankEndTarget=bankEndTarget,dispatch((0,updateSequenceItemFromActivity.O)({sequence:cloneSequence,group:currentGroup})),dispatch((0,savePage.J)({undoable:!0}))}}}),[currentGroup,currentSequence,dispatch]),screenPropertyChangeHandler=(0,react.useCallback)((function(properties){if(currentActivity){var _currentActivity$cont,_currentActivity$auth,modelChanges=null!=currentSequence&&currentSequence.custom.isBank?function transformBankPropsSchematoModel(schema){return{title:schema.title,width:schema.Size.width,height:schema.Size.height,customCssClass:schema.customCssClass,palette:_objectSpread(_objectSpread({},schema.palette),{},{useHtmlProps:!0})}}(properties):function transformScreenSchematoModel(schema){return{objectives:schema.learningObjectives,title:schema.title,width:schema.Size.width,height:schema.Size.height,customCssClass:schema.customCssClass,combineFeedback:schema.combineFeedback,showCheckBtn:schema.checkButton.showCheckBtn,checkButtonLabel:schema.checkButton.checkButtonLabel,maxAttempt:schema.max.maxAttempt,maxScore:schema.max.maxScore,palette:screen_objectSpread(screen_objectSpread({},schema.palette),{},{useHtmlProps:!0}),trapStateScoreScheme:schema.trapStateScoreScheme,negativeScoreAllowed:schema.negativeScoreAllowed}}(properties),title=modelChanges.title,screenModelChanges=_objectWithoutProperties(modelChanges,_excluded),objectives=modelChanges.objectives||[],screenChanges=RightMenu_objectSpread(RightMenu_objectSpread({},null==currentActivity||null===(_currentActivity$cont=currentActivity.content)||void 0===_currentActivity$cont?void 0:_currentActivity$cont.custom),screenModelChanges),cloneActivity=(0,common.d9)(currentActivity);cloneActivity.content.custom=screenChanges,0===objectives.length?cloneActivity.objectives={}:null!==(_currentActivity$auth=currentActivity.authoring)&&void 0!==_currentActivity$auth&&_currentActivity$auth.parts&&currentActivity.authoring.parts.length>0?cloneActivity.objectives=RightMenu_defineProperty({},currentActivity.authoring.parts[0].id,objectives):cloneActivity.objectives={__default:objectives},title&&(cloneActivity.title=title),JSON.stringify(cloneActivity)!==JSON.stringify(currentActivity)&&dispatch((0,saveActivity.d)({activity:cloneActivity,undoable:!0}))}}),[currentActivity]),lessonPropertyChangeHandler=(0,react.useCallback)((function(properties){var modelChanges=function transformSchemaToModel(schema){var additionalStylesheets=[schema.Properties.Appearance.theme,schema.Properties.Appearance.customCssUrl].filter((function(url){return url})),variables=[];try{variables=schema.CustomLogic.variables}catch(e){}return{custom:{defaultScreenWidth:schema.Properties.Size.width,defaultScreenHeight:schema.Properties.Size.height,enableHistory:schema.Properties.enableHistory,variables,logoutMessage:schema.Properties.FinishPanel.logoutMessage,logoutPanelImageURL:schema.Properties.FinishPanel.logoutPanelImageURL,backgroundImageURL:schema.Properties.Appearance.backgroundImageURL,backgroundImageScaleContent:schema.Properties.Appearance.backgroundImageScaleContent},displayApplicationChrome:schema.Properties.Appearance.displayApplicationChrome,additionalStylesheets,title:schema.Properties.title,customCss:schema.Properties.customCSS||"",customScript:schema.CustomLogic.customScript||""}}(properties);null===modelChanges.additionalStylesheets[0]&&(modelChanges.additionalStylesheets[0]=(currentLesson.additionalStylesheets||[])[0]);var lessonChanges=RightMenu_objectSpread(RightMenu_objectSpread(RightMenu_objectSpread({},currentLesson),modelChanges),{},{custom:RightMenu_objectSpread(RightMenu_objectSpread({},currentLesson.custom),modelChanges.custom)});void 0!==lessonChanges.custom.enableHistory&&void 0!==lessonChanges.custom.allowNavigation&&delete lessonChanges.custom.allowNavigation,JSON.stringify(lessonChanges)!==JSON.stringify(currentLesson)&&dispatch((0,savePage.J)(RightMenu_objectSpread(RightMenu_objectSpread({},lessonChanges),{},{undoable:!0})))}),[currentLesson,dispatch]);return(0,jsx_runtime.jsxs)(Tabs.Z,{className:"aa-panel-section-title-bar aa-panel-tabs",activeKey:selectedTab,onSelect:function handleSelectTab(key){dispatch((0,slice.IJ)({rightPanelActiveTab:key}))},children:[(0,jsx_runtime.jsx)(Tab.Z,{eventKey:RightPanelTabs.LESSON,title:"Lesson",children:(0,jsx_runtime.jsx)("div",{className:"lesson-tab overflow-hidden",children:(0,jsx_runtime.jsx)(PropertyEditor.Z,{schema:flowchartMode?simpleLessonSchema:lesson,uiSchema:flowchartMode?simpleLessonUiSchema:lessonUiSchema,value:lessonData,triggerOnChange:["CustomLogic"],onChangeHandler:lessonPropertyChangeHandler})})}),(0,jsx_runtime.jsxs)(Tab.Z,{eventKey:RightPanelTabs.SCREEN,title:"Screen",children:[currentActivity&&currentSequence&&null!=currentSequence&&currentSequence.custom.isBank?(0,jsx_runtime.jsx)("div",{className:"bank-tab p-3",children:(0,jsx_runtime.jsx)(PropertyEditor.Z,{schema:bank,uiSchema:bankUiSchema,value:questionBankData,onChangeHandler:bankPropertyChangeHandler,triggerOnChange:!0},currentActivity.id)}):null,(0,jsx_runtime.jsx)("div",{className:"screen-tab p-3 overflow-hidden",children:currentActivity&&scrData?(0,jsx_runtime.jsx)(PropertyEditor.Z,{schema:scrSchema,uiSchema:scrUiSchema,value:scrData,onChangeHandler:screenPropertyChangeHandler},currentActivity.id):null})]}),(0,jsx_runtime.jsx)(Tab.Z,{eventKey:RightPanelTabs.COMPONENT,title:"Component",disabled:!currentPartSelection,children:currentPartSelection&&currentActivityTree&&(0,jsx_runtime.jsx)(PartPropertyEditor,{currentActivityTree,currentActivity,currentPartSelection,existingIds})})]})};RightMenu.displayName="RightMenu";try{RightMenu.displayName="RightMenu",RightMenu.__docgenInfo={description:"",displayName:"RightMenu",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/authoring/components/RightMenu/RightMenu.tsx#RightMenu"]={docgenInfo:RightMenu.__docgenInfo,name:"RightMenu",path:"src/apps/authoring/components/RightMenu/RightMenu.tsx#RightMenu"})}catch(__react_docgen_typescript_loader_error){}},"./src/apps/authoring/store/activities/actions/saveActivity.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{V:()=>bulkSaveActivity,d:()=>saveActivity});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),deep_object_diff__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./node_modules/deep-object-diff/mjs/diff.js"),lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/cloneDeep.js"),lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0__),lodash_debounce__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash/debounce.js"),lodash_debounce__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash_debounce__WEBPACK_IMPORTED_MODULE_1__),lodash_memoize__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/lodash/memoize.js"),lodash_memoize__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(lodash_memoize__WEBPACK_IMPORTED_MODULE_2__),apps_delivery_store_features_groups_slice__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/apps/delivery/store/features/groups/slice.ts"),data_persistence_activity__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/data/persistence/activity.ts"),_utils_common__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/utils/common.ts"),_delivery_store_features_activities_name__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./src/apps/delivery/store/features/activities/name.ts"),_delivery_store_features_activities_slice__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/apps/delivery/store/features/activities/slice.ts"),_delivery_store_features_groups_selectors_deck__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/apps/delivery/store/features/groups/selectors/deck.ts"),_components_Flowchart_rules_rule_compilation__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/apps/authoring/components/Flowchart/rules/rule-compilation.ts"),_app_slice__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/apps/authoring/store/app/slice.ts"),_groups_layouts_deck_actions_updateSequenceItemFromActivity__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/apps/authoring/store/groups/layouts/deck/actions/updateSequenceItemFromActivity.ts"),_history_slice__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./src/apps/authoring/store/history/slice.ts"),_page_actions_savePage__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./src/apps/authoring/store/page/actions/savePage.ts"),_page_slice__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./src/apps/authoring/store/page/slice.ts"),_persistance_options__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./src/apps/authoring/store/persistance-options.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var saveActivity=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_15__.hg)("".concat(_delivery_store_features_activities_name__WEBPACK_IMPORTED_MODULE_16__.Z,"/saveActivity"),function(){var _ref2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(payload,_ref){var dispatch,getState,_activity$authoring,_activity$authoring$p,activity,_payload$undoable,undoable,rootState,projectSlug,resourceId,currentActivityState,group,sequence,appMode,all,isReadOnlyMode,endScreen,_generateRules,variables,rules,changeData,_activity$content,_oldActivityData$cont,debouncedEdit,oldActivityData,currentPage;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(dispatch=_ref.dispatch,getState=_ref.getState,_context.prev=1,activity=payload.activity,_payload$undoable=payload.undoable,undoable=void 0===_payload$undoable||_payload$undoable,rootState=getState(),projectSlug=(0,_app_slice__WEBPACK_IMPORTED_MODULE_9__.LJ)(rootState),resourceId=(0,_page_slice__WEBPACK_IMPORTED_MODULE_13__.mi)(rootState),currentActivityState=(0,_delivery_store_features_activities_slice__WEBPACK_IMPORTED_MODULE_6__.ho)(rootState,activity.id),group=(0,apps_delivery_store_features_groups_slice__WEBPACK_IMPORTED_MODULE_3__.Ks)(rootState),sequence=(0,_delivery_store_features_groups_selectors_deck__WEBPACK_IMPORTED_MODULE_7__.nu)(rootState),appMode=(0,_app_slice__WEBPACK_IMPORTED_MODULE_9__.Xi)(rootState),all=(0,_delivery_store_features_activities_slice__WEBPACK_IMPORTED_MODULE_6__.N3)(rootState),isReadOnlyMode=(0,_app_slice__WEBPACK_IMPORTED_MODULE_9__.jw)(rootState),null!=activity&&null!==(_activity$authoring=activity.authoring)&&void 0!==_activity$authoring&&null!==(_activity$authoring$p=_activity$authoring.parts)&&void 0!==_activity$authoring$p&&_activity$authoring$p.length?activity.authoring.parts.length>1&&(activity.authoring.parts=activity.authoring.parts.filter((function(part){return"__default"!==part.id}))):(activity.authoring=activity.authoring||{},activity.authoring.parts=[{id:"__default",type:"janus-text-flow",inherited:!1,owner:"self"}]),"flowchart"===appMode&&(endScreen=all.find((function(s){var _s$authoring,_s$authoring$flowchar;return"end_screen"===(null===(_s$authoring=s.authoring)||void 0===_s$authoring||null===(_s$authoring$flowchar=_s$authoring.flowchart)||void 0===_s$authoring$flowchar?void 0:_s$authoring$flowchar.screenType)})),_generateRules=(0,_components_Flowchart_rules_rule_compilation__WEBPACK_IMPORTED_MODULE_8__.$0)(activity,sequence,(null==endScreen?void 0:endScreen.resourceId)||-1),variables=_generateRules.variables,rules=_generateRules.rules,activity.authoring=(0,_utils_common__WEBPACK_IMPORTED_MODULE_5__.Cw)(activity.authoring),activity.authoring.rules=rules,activity.authoring.variablesRequiredForEvaluation=variables),changeData={title:activity.title,objectives:activity.objectives,content:_objectSpread(_objectSpread({},activity.content),{},{authoring:activity.authoring}),tags:activity.tags||[]},isReadOnlyMode){_context.next=32;break}if(console.log("going to save acivity: ",{changeData,activity}),(debouncedEdit=getDebouncedEdit(String(activity.id)))(projectSlug,resourceId,activity.resourceId,changeData,!1),!payload.immediate){_context.next=22;break}return _context.next=22,debouncedEdit.flush();case 22:return oldActivityData=(0,_delivery_store_features_activities_slice__WEBPACK_IMPORTED_MODULE_6__.ho)(rootState,activity.resourceId),_context.next=25,dispatch((0,_delivery_store_features_activities_slice__WEBPACK_IMPORTED_MODULE_6__.Xx)({activity}));case 25:if(currentPage=(0,_page_slice__WEBPACK_IMPORTED_MODULE_13__.bz)(rootState),!(activity.title!==(null==currentActivityState?void 0:currentActivityState.title)||!currentPage.custom.scoreFixed&&(null===(_activity$content=activity.content)||void 0===_activity$content?void 0:_activity$content.custom.maxScore)!==(null==oldActivityData||null===(_oldActivityData$cont=oldActivityData.content)||void 0===_oldActivityData$cont?void 0:_oldActivityData$cont.custom.maxScore))){_context.next=31;break}return dispatch((0,_groups_layouts_deck_actions_updateSequenceItemFromActivity__WEBPACK_IMPORTED_MODULE_10__.q)({activity,group})),_context.next=31,dispatch((0,_page_actions_savePage__WEBPACK_IMPORTED_MODULE_12__.J)({}));case 31:undoable&&dispatch((0,_history_slice__WEBPACK_IMPORTED_MODULE_11__.gV)({undo:[saveActivity({activity:lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0___default()(currentActivityState),undoable:!1})],redo:[saveActivity({activity:lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0___default()(activity),undoable:!1})]}));case 32:return _context.abrupt("return");case 35:throw _context.prev=35,_context.t0=_context.catch(1),console.error("Error during ".concat(_delivery_store_features_activities_name__WEBPACK_IMPORTED_MODULE_16__.Z,"/saveActivity: "),_context.t0),_context.t0;case 39:case"end":return _context.stop()}}),_callee,null,[[1,35]])})));return function(_x,_x2){return _ref2.apply(this,arguments)}}()),getDebouncedEdit=lodash_memoize__WEBPACK_IMPORTED_MODULE_2___default()((function wrapEdit(activityId){return lodash_debounce__WEBPACK_IMPORTED_MODULE_1___default()(function(){var _ref3=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(project,resource,activity,pendingUpdate,releaseLock){var editResults;return _regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return console.log("Saving activity: ",{activityId,project,resource,activity,pendingUpdate,releaseLock}),_context2.next=3,(0,data_persistence_activity__WEBPACK_IMPORTED_MODULE_4__.eP)(project,resource,activity,pendingUpdate,releaseLock);case 3:editResults=_context2.sent,console.log("EDIT SAVE RESULTS",{editResults});case 5:case"end":return _context2.stop()}}),_callee2)})));return function(_x3,_x4,_x5,_x6,_x7){return _ref3.apply(this,arguments)}}(),_persistance_options__WEBPACK_IMPORTED_MODULE_14__.f,_persistance_options__WEBPACK_IMPORTED_MODULE_14__.C)}),(function(activityId){return activityId||"default"})),bulkSaveActivity=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_15__.hg)("".concat(_delivery_store_features_activities_name__WEBPACK_IMPORTED_MODULE_16__.Z,"/bulkSaveActivity"),function(){var _ref5=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(payload,_ref4){var dispatch,getState,activities,_payload$undoable2,undoable,rootState,projectSlug,pageResourceId,currentActivities,isReadOnlyMode,updates;return _regeneratorRuntime().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(dispatch=_ref4.dispatch,getState=_ref4.getState,activities=payload.activities,_payload$undoable2=payload.undoable,undoable=void 0!==_payload$undoable2&&_payload$undoable2,rootState=getState(),projectSlug=(0,_app_slice__WEBPACK_IMPORTED_MODULE_9__.LJ)(rootState),pageResourceId=(0,_page_slice__WEBPACK_IMPORTED_MODULE_13__.mi)(rootState),currentActivities=(0,_delivery_store_features_activities_slice__WEBPACK_IMPORTED_MODULE_6__.N3)(rootState),isReadOnlyMode=(0,_app_slice__WEBPACK_IMPORTED_MODULE_9__.jw)(rootState),console.log("bulkSaveActivity",currentActivities,activities,(0,deep_object_diff__WEBPACK_IMPORTED_MODULE_17__.Z)(currentActivities,activities)),isReadOnlyMode){_context3.next=16;break}return updates=activities.map((function(activity){var _activity$authoring2,_activity$authoring2$;return null!=activity&&null!==(_activity$authoring2=activity.authoring)&&void 0!==_activity$authoring2&&null!==(_activity$authoring2$=_activity$authoring2.parts)&&void 0!==_activity$authoring2$&&_activity$authoring2$.length||(activity.authoring=activity.authoring||{},activity.authoring.parts=[{id:"__default",type:"janus-text-flow",inherited:!1,owner:"self"}]),{title:activity.title,objectives:activity.objectives,content:activity.content,authoring:activity.authoring,resource_id:activity.resourceId}})),_context3.next=12,(0,data_persistence_activity__WEBPACK_IMPORTED_MODULE_4__.zh)(projectSlug,pageResourceId,updates);case 12:if(!undoable){_context3.next=15;break}return _context3.next=15,dispatch((0,_history_slice__WEBPACK_IMPORTED_MODULE_11__.gV)({undo:[bulkSaveActivity({activities:lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0___default()(currentActivities)})],redo:[bulkSaveActivity({activities:lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0___default()(activities)})]}));case 15:dispatch((0,_delivery_store_features_activities_slice__WEBPACK_IMPORTED_MODULE_6__.Zl)({activities}));case 16:return _context3.abrupt("return");case 17:case"end":return _context3.stop()}}),_callee3)})));return function(_x8,_x9){return _ref5.apply(this,arguments)}}())},"./src/apps/authoring/store/app/name.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{M:()=>AppSlice,Z:()=>__WEBPACK_DEFAULT_EXPORT__});var AppSlice="mainApp";const __WEBPACK_DEFAULT_EXPORT__=AppSlice},"./src/apps/authoring/store/app/slice.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{ZP:()=>app_slice,pR:()=>slice_selectActivityTypes,Sp:()=>selectAllObjectivesMap,Xi:()=>selectAppMode,Yj:()=>selectCopiedPart,bo:()=>selectPartComponentTypes,Dw:()=>selectPaths,LJ:()=>selectProjectSlug,jw:()=>selectReadOnly,T7:()=>selectRevisionSlug,EJ:()=>selectRightPanelActiveTab,UM:()=>selectShowDiagnosticsWindow,WM:()=>setCopiedPart,fK:()=>setCurrentRule,qV:()=>setDebugConfig,IJ:()=>setRightPanelActiveTab,sB:()=>setShowDiagnosticsWindow,hu:()=>setShowScoringOverview});var redux_toolkit_esm=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),es=__webpack_require__("./node_modules/reselect/es/index.js"),slice=__webpack_require__("./src/apps/delivery/store/features/activities/slice.ts"),scripting=__webpack_require__("./src/adaptivity/scripting.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(arg=descriptor.key,key=void 0,key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string"),"symbol"===_typeof(key)?key:String(key)),descriptor)}var arg,key}function DeferredPersistenceStrategy_typeof(obj){return DeferredPersistenceStrategy_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},DeferredPersistenceStrategy_typeof(obj)}function DeferredPersistenceStrategy_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(arg=descriptor.key,key=void 0,key=function DeferredPersistenceStrategy_toPrimitive(input,hint){if("object"!==DeferredPersistenceStrategy_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==DeferredPersistenceStrategy_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string"),"symbol"===DeferredPersistenceStrategy_typeof(key)?key:String(key)),descriptor)}var arg,key}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===DeferredPersistenceStrategy_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var DeferredPersistenceStrategy=function(_AbstractPersistenceS){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(DeferredPersistenceStrategy,_AbstractPersistenceS);var _super=_createSuper(DeferredPersistenceStrategy);function DeferredPersistenceStrategy(){var _this,quietPeriodInMs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3,maxDeferredTimeInMs=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;return function DeferredPersistenceStrategy_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DeferredPersistenceStrategy),(_this=_super.call(this)).quietPeriodInMs=quietPeriodInMs,_this.maxDeferredTimeInMs=maxDeferredTimeInMs,_this.timer=null,_this.timerStart=0,_this.flushResolve=null,_this.inFlight=!1,_this.pending=null,_this.destroyed=!1,_this}return function DeferredPersistenceStrategy_createClass(Constructor,protoProps,staticProps){return protoProps&&DeferredPersistenceStrategy_defineProperties(Constructor.prototype,protoProps),staticProps&&DeferredPersistenceStrategy_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(DeferredPersistenceStrategy,[{key:"now",value:function now(){return(new Date).getTime()}},{key:"save",value:function save(saveFn){this.pending=saveFn,null!==this.stateChangeCallback&&this.stateChangeCallback(this.inFlight?"inflight":"pending"),this.queueSave()}},{key:"saveImmediate",value:function saveImmediate(saveFn){this.save(saveFn),this.flushPendingChanges()}},{key:"queueSave",value:function queueSave(){var _this2=this,startTimer=function startTimer(){return setTimeout((function(){_this2.timer=null,_this2.persist()}),_this2.quietPeriodInMs)};null!==this.timer?(clearTimeout(this.timer),this.timer=null,this.now()-this.timerStart>this.maxDeferredTimeInMs?this.persist():this.timer=startTimer()):(this.timerStart=this.now(),this.timer=startTimer())}},{key:"persist",value:function persist(){var _this3=this;return new Promise((function(resolve,reject){_this3.inFlight=!0;var saveFn=_this3.pending;_this3.pending=null,null!==_this3.stateChangeCallback&&_this3.stateChangeCallback("inflight"),saveFn(!1).then((function(result){null===_this3.flushResolve?(null!==_this3.successCallback&&_this3.successCallback(),_this3.inFlight=!1,null!==_this3.stateChangeCallback&&_this3.stateChangeCallback(null===_this3.pending?"idle":"pending"),null!==_this3.pending&&_this3.queueSave(),resolve(result)):_this3.flushResolve()})).catch((function(err){null!==_this3.stateChangeCallback&&_this3.stateChangeCallback(null===_this3.pending?"idle":"pending"),_this3.inFlight=!1,null!==_this3.failureCallback&&_this3.failureCallback(err),reject(err)}))}))}},{key:"doDestroy",value:function doDestroy(){return!this.destroyed&&(this.destroyed=!0,this.flushPendingChanges())}},{key:"flushPendingChanges",value:function flushPendingChanges(){var releaseLock=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return null!==this.timer&&clearTimeout(this.timer),null!==this.pending&&(this.pending(releaseLock),!0)}}]),DeferredPersistenceStrategy}(function(){function AbstractPersistenceStrategy(){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AbstractPersistenceStrategy),this.successCallback=null,this.failureCallback=null,this.stateChangeCallback=null,this.writeLockedDocumentId=null,this.courseId=null,this.destroyed=!1,this.lockResult={type:"not_acquired",user:""}}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(AbstractPersistenceStrategy,[{key:"getLockResult",value:function getLockResult(){return this.lockResult}},{key:"releaseLock",value:function releaseLock(){return this.releaseFn()}},{key:"initialize",value:function initialize(lockFn,releaseFn,onSuccess,onFailure,onStateChange){var _this=this;return this.successCallback=onSuccess,this.failureCallback=onFailure,this.stateChangeCallback=onStateChange,this.releaseFn=releaseFn,new Promise((function(resolve,reject){lockFn().then((function(result){_this.lockResult=result,resolve("acquired"===result.type)}))}))}},{key:"destroy",value:function destroy(){this.doDestroy()||this.releaseLock()}}]),AbstractPersistenceStrategy}()),common=(__webpack_require__("./src/data/persistence/media.ts"),__webpack_require__("./src/data/persistence/common.ts"));function intrinsic_typeof(obj){return intrinsic_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},intrinsic_typeof(obj)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==intrinsic_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var writeActivityAttemptState=function(){var _ref4=_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(sectionSlug,attemptGuid,partResponses){var method,url,result,_args4=arguments;return _regeneratorRuntime().wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return method=_args4.length>3&&void 0!==_args4[3]&&_args4[3]?"PUT":"PATCH",url="/state/course/".concat(sectionSlug,"/activity_attempt/").concat(attemptGuid),_context4.next=5,(0,common.$)({url,method,body:JSON.stringify({partInputs:partResponses})});case 5:return result=_context4.sent,_context4.abrupt("return",{result:result.type});case 7:case"end":return _context4.stop()}}),_callee4)})));return function writeActivityAttemptState(_x8,_x9,_x10){return _ref4.apply(this,arguments)}}();function deferredSavePart_typeof(obj){return deferredSavePart_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},deferredSavePart_typeof(obj)}function deferredSavePart_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,(arg=descriptor.key,key=void 0,key=function deferredSavePart_toPrimitive(input,hint){if("object"!==deferredSavePart_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==deferredSavePart_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string"),"symbol"===deferredSavePart_typeof(key)?key:String(key)),descriptor)}var arg,key}function deferredSavePart_createClass(Constructor,protoProps,staticProps){return protoProps&&deferredSavePart_defineProperties(Constructor.prototype,protoProps),staticProps&&deferredSavePart_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}var fakeLock=function fakeLock(){return Promise.resolve({type:"acquired"})},fakeRelease=function fakeRelease(){return Promise.resolve({type:"released"})},Deferred=deferredSavePart_createClass((function Deferred(){var _this=this;!function deferredSavePart_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Deferred),this.promise=new Promise((function(resolve,reject){_this.reject=reject,_this.resolve=resolve}))})),saveQueue=[],createQueue=function createQueue(sectionSlug,attemptGuid){var persist=new DeferredPersistenceStrategy,items=[],queue={result:new Deferred,sectionSlug,attemptGuid,items,persist,state:"idle"};return persist.initialize(fakeLock,fakeRelease,(function(){console.info("Successfully saved ".concat(items.length," parts"),{sectionSlug,attemptGuid}),items.splice(0,items.length),queue.result.resolve({result:"success"}),queue.result=new Deferred}),(function(result){return console.error("Failed to save part ",{sectionSlug,attemptGuid,result})}),(function(state){queue.state=state})),saveQueue.push(queue),queue},deferredSavePart=function deferredSavePart(sectionSlug,attemptGuid,partAttemptGuid,input){var finalize=arguments.length>4&&void 0!==arguments[4]&&arguments[4],item={sectionSlug,attemptGuid,partAttemptGuid,input},queue=function getQueue(sectionSlug,attemptGuid){return saveQueue.find((function(q){return q.sectionSlug===sectionSlug&&q.attemptGuid===attemptGuid&&"inflight"!==q.state}))||createQueue(sectionSlug,attemptGuid)}(sectionSlug,attemptGuid);return function appendQueue(queue,item){var index=queue.items.findIndex((function(i){return function isSamePart(a,b){return a.partAttemptGuid===b.partAttemptGuid}(i,item)}));-1===index?queue.items.push(item):queue.items[index]=item}(queue,item),queue.persist.save((function(){var itemsToSave=queue.items.map((function(item){return{attemptGuid:item.partAttemptGuid,response:item.input}}));return console.info("Saving parts",{sectionSlug,attemptGuid,itemsToSave}),writeActivityAttemptState(sectionSlug,attemptGuid,itemsToSave,finalize)})),queue.result.promise};window.addEventListener("beforeunload",(function(e){if(saveQueue.filter((function(q){return q.items.length>0})).length>0)return function flushAllPartSaveQueues(){var unsavedQueues=saveQueue.filter((function(q){return q.items.length>0&&"inflight"!==q.state}));Promise.all(unsavedQueues.map((function(q){return q.persist.flushPendingChanges(),q.result.promise})))}(),e.preventDefault(),event.returnValue="","Please wait while we save your work"}));var guid=__webpack_require__("./src/utils/guid.ts");var pageSlice=(0,redux_toolkit_esm.oM)({name:"page",initialState:{userId:-1,userName:"Guest",resourceId:-1,sectionSlug:"",pageSlug:"",pageTitle:"",content:null,resourceAttemptGuid:"",resourceAttemptState:{},activityGuidMapping:{},previewMode:!1,isInstructor:!1,enableHistory:!1,showHistory:!1,activityTypes:[],score:0,graded:!1,activeEverapp:"",overviewURL:"",finalizeGradedURL:"",screenIdleTimeOutInSeconds:1800,reviewMode:!1},reducers:{loadPageState:function loadPageState(state,action){var _action$payload,_action$payload$conte,_action$payload$conte2,_action$payload2,_action$payload2$cont,_action$payload2$cont2;state.userId=action.payload.userId,state.userName=action.payload.userName||"Guest",state.resourceId=action.payload.resourceId,state.pageSlug=action.payload.pageSlug,state.pageTitle=action.payload.pageTitle,state.sectionSlug=action.payload.sectionSlug,state.content=action.payload.content,state.enableHistory=(null===(_action$payload=action.payload)||void 0===_action$payload||null===(_action$payload$conte=_action$payload.content)||void 0===_action$payload$conte||null===(_action$payload$conte2=_action$payload$conte.custom)||void 0===_action$payload$conte2?void 0:_action$payload$conte2.allowNavigation)||(null===(_action$payload2=action.payload)||void 0===_action$payload2||null===(_action$payload2$cont=_action$payload2.content)||void 0===_action$payload2$cont||null===(_action$payload2$cont2=_action$payload2$cont.custom)||void 0===_action$payload2$cont2?void 0:_action$payload2$cont2.enableHistory)||!1,state.resourceAttemptGuid=action.payload.resourceAttemptGuid,state.resourceAttemptState=action.payload.resourceAttemptState,state.activityGuidMapping=action.payload.activityGuidMapping,state.previewMode=!!action.payload.previewMode,state.isInstructor=!!action.payload.isInstructor,state.activityTypes=action.payload.activityTypes,state.graded=!!action.payload.graded,state.overviewURL=action.payload.overviewURL,state.finalizeGradedURL=action.payload.finalizeGradedURL,state.screenIdleTimeOutInSeconds=action.payload.screenIdleTimeOutInSeconds,state.reviewMode=action.payload.reviewMode,state.previewMode&&!state.resourceAttemptGuid&&(state.resourceAttemptGuid="preview_".concat((0,guid.Z)())),action.payload.screenIdleTimeOutInSeconds&&(state.screenIdleExpireTime=Date.now()+1e3*action.payload.screenIdleTimeOutInSeconds)},setScore:function setScore(state,action){state.score=action.payload.score},setScreenIdleExpirationTime:function setScreenIdleExpirationTime(state,action){state.screenIdleTimeOutInSeconds&&(state.screenIdleExpireTime=action.payload.screenIdleExpireTime+1e3*state.screenIdleTimeOutInSeconds)},setActiveEverapp:function setActiveEverapp(state,action){state.activeEverapp=action.payload.id},setShowHistory:function setShowHistory(state,action){state.showHistory=action.payload.show}}}),_pageSlice$actions=pageSlice.actions,selectState=(_pageSlice$actions.loadPageState,_pageSlice$actions.setActiveEverapp,_pageSlice$actions.setScore,_pageSlice$actions.setShowHistory,_pageSlice$actions.setScreenIdleExpirationTime,function selectState(state){return state.page}),selectSectionSlug=((0,es.P1)(selectState,(function(state){var _state$content,_state$content$custom;return null===(_state$content=state.content)||void 0===_state$content||null===(_state$content$custom=_state$content.custom)||void 0===_state$content$custom?void 0:_state$content$custom.contentMode})),(0,es.P1)(selectState,(function(state){return state.sectionSlug}))),selectPreviewMode=((0,es.P1)(selectState,(function(state){return state.pageTitle})),(0,es.P1)(selectState,(function(state){return state.pageSlug})),(0,es.P1)(selectState,(function(state){return state.content})),(0,es.P1)(selectState,(function(state){return state.previewMode})));(0,es.P1)(selectState,(function(state){return state.reviewMode})),(0,es.P1)(selectState,(function(state){return state.isInstructor})),(0,es.P1)(selectState,(function(state){return state.enableHistory})),(0,es.P1)(selectState,(function(state){return state.showHistory})),(0,es.P1)(selectState,(function(state){return state.screenIdleTimeOutInSeconds})),(0,es.P1)(selectState,(function(state){return state.screenIdleExpireTime})),(0,es.P1)(selectState,(function(state){return state.resourceAttemptGuid})),(0,es.P1)(selectState,(function(state){return state.activityTypes})),(0,es.P1)(selectState,(function(state){return state.activityGuidMapping})),(0,es.P1)(selectState,(function(state){return state.userId})),(0,es.P1)(selectState,(function(state){return state.userName})),(0,es.P1)(selectState,(function(state){return state.score})),(0,es.P1)(selectState,(function(state){return state.graded})),(0,es.P1)(selectState,(function(state){return state.activeEverapp})),(0,es.P1)(selectState,(function(state){var _state$content2,_state$content2$custo;return!(null!==(_state$content2=state.content)&&void 0!==_state$content2&&null!==(_state$content2$custo=_state$content2.custom)&&void 0!==_state$content2$custo&&_state$content2$custo.themeId)})),(0,es.P1)(selectState,(function(state){return state.overviewURL})),(0,es.P1)(selectState,(function(state){return state.finalizeGradedURL}));pageSlice.reducer;var attempt_name=__webpack_require__("./src/apps/delivery/store/features/attempt/name.ts"),attempt_slice=__webpack_require__("./src/apps/delivery/store/features/attempt/slice.ts");function savePart_typeof(obj){return savePart_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},savePart_typeof(obj)}function savePart_regeneratorRuntime(){savePart_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==savePart_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function savePart_toPropertyKey(arg){var key=function savePart_toPrimitive(input,hint){if("object"!==savePart_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==savePart_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===savePart_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function savePart_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function savePart_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){savePart_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){savePart_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var savePartState=(0,redux_toolkit_esm.hg)("".concat(attempt_name.Z,"/savePartState"),function(){var _ref2=savePart_asyncToGenerator(savePart_regeneratorRuntime().mark((function _callee(payload,_ref){var dispatch,getState,attemptGuid,partAttemptGuid,response,rootState,isPreviewMode,sectionSlug,attemptNumber,updatedPartResponses,attemptRecord,partAttemptRecord,updated,assignScripts,scriptResult;return savePart_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(dispatch=_ref.dispatch,getState=_ref.getState,attemptGuid=payload.attemptGuid,partAttemptGuid=payload.partAttemptGuid,response=payload.response,rootState=getState(),isPreviewMode=selectPreviewMode(rootState),sectionSlug=selectSectionSlug(rootState),attemptNumber=(0,scripting.NA)("session.attemptNumber",scripting.V1),updatedPartResponses=response,!(attemptRecord=(0,attempt_slice.ZE)(rootState,attemptGuid))){_context.next=14;break}if(!(partAttemptRecord=attemptRecord.parts.find((function(p){return p.attemptGuid===partAttemptGuid})))){_context.next=14;break}return updated=_objectSpread(_objectSpread({},attemptRecord),{},{attemptNumber,parts:attemptRecord.parts.map((function(p){var result=_objectSpread({},p);return p.attemptGuid===partAttemptRecord.attemptGuid&&(updatedPartResponses=_objectSpread(_objectSpread({},result.response),updatedPartResponses),result.response=updatedPartResponses),result}))}),_context.next=14,dispatch((0,attempt_slice.wl)({attempt:updated}));case 14:if(assignScripts=(0,scripting.db)(updatedPartResponses),scriptResult=[],Array.isArray(assignScripts)&&assignScripts.forEach((function(variable){var result=(0,scripting.gH)(variable,scripting.V1).result;result&&scriptResult.push(result)})),!isPreviewMode){_context.next=19;break}return _context.abrupt("return",{result:scriptResult});case 19:!1,deferredSavePart(sectionSlug,attemptGuid,partAttemptGuid,updatedPartResponses,false);case 21:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}()),savePartStateToTree=(0,redux_toolkit_esm.hg)("".concat(attempt_name.Z,"/savePartStateToTree"),function(){var _ref4=savePart_asyncToGenerator(savePart_regeneratorRuntime().mark((function _callee2(payload,_ref3){var _attemptRecord$parts$,dispatch,getState,attemptGuid,partAttemptGuid,response,activityTree,rootState,attemptRecord,partId,updates;return savePart_regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(dispatch=_ref3.dispatch,getState=_ref3.getState,attemptGuid=payload.attemptGuid,partAttemptGuid=payload.partAttemptGuid,response=payload.response,activityTree=payload.activityTree,rootState=getState(),attemptRecord=(0,attempt_slice.ZE)(rootState,attemptGuid),partId=null==attemptRecord||null===(_attemptRecord$parts$=attemptRecord.parts.find((function(p){return p.attemptGuid===partAttemptGuid})))||void 0===_attemptRecord$parts$?void 0:_attemptRecord$parts$.partId){_context2.next=7;break}throw new Error("cannot find the partId to update");case 7:return updates=activityTree.map((function(activity){var _attempt$parts$find,attempt=(0,attempt_slice.Kv)(rootState,activity.resourceId);if(!attempt)return Promise.reject("could not find attempt!");var attemptGuid=attempt.attemptGuid,partAttemptGuid=null===(_attempt$parts$find=attempt.parts.find((function(p){return p.partId===partId})))||void 0===_attempt$parts$find?void 0:_attempt$parts$find.attemptGuid;return partAttemptGuid?dispatch(savePartState({attemptGuid,partAttemptGuid,response})):Promise.resolve("does not own part but thats OK")})),_context2.abrupt("return",Promise.all(updates));case 9:case"end":return _context2.stop()}}),_callee2)})));return function(_x3,_x4){return _ref4.apply(this,arguments)}}()),RightMenu=__webpack_require__("./src/apps/authoring/components/RightMenu/RightMenu.tsx"),savePage=__webpack_require__("./src/apps/authoring/store/page/actions/savePage.ts");function acquireLock(project,resource){var params={url:arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"/project/".concat(project,"/lock/").concat(resource,"?fetch_revision=true"):"/project/".concat(project,"/lock/").concat(resource,"?fetch_revision=false"),method:"POST"};return(0,common.$)(params)}var app_name=__webpack_require__("./src/apps/authoring/store/app/name.ts");function locking_typeof(obj){return locking_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},locking_typeof(obj)}function locking_regeneratorRuntime(){locking_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==locking_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function locking_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function locking_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){locking_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){locking_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var acquireEditingLock=(0,redux_toolkit_esm.hg)("".concat(app_name.Z,"/acquireEditingLock"),function(){var _ref2=locking_asyncToGenerator(locking_regeneratorRuntime().mark((function _callee(_,_ref){var getState,rejectWithValue,projectSlug,resourceSlug;return locking_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return getState=_ref.getState,rejectWithValue=_ref.rejectWithValue,projectSlug=selectProjectSlug(getState()),resourceSlug=selectRevisionSlug(getState()),_context.prev=3,_context.next=6,acquireLock(projectSlug,resourceSlug);case 6:if("acquired"===_context.sent.type){_context.next=9;break}return _context.abrupt("return",rejectWithValue({error:"ALREADY_LOCKED",msg:"Error acquiring a lock, most likely due to another user already owning the lock."}));case 9:_context.next=14;break;case 11:return _context.prev=11,_context.t0=_context.catch(3),_context.abrupt("return",rejectWithValue({error:"SERVER_ERROR",server:_context.t0,msg:"Server error attempting to acquire lock, this is most likely a session timeout"}));case 14:case"end":return _context.stop()}}),_callee,null,[[3,11]])})));return function(_x,_x2){return _ref2.apply(this,arguments)}}());(0,redux_toolkit_esm.hg)("".concat(app_name.Z,"/releaseEditingLock"),function(){var _ref4=locking_asyncToGenerator(locking_regeneratorRuntime().mark((function _callee2(_,_ref3){var getState,projectSlug,resourceSlug;return locking_regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return getState=_ref3.getState,projectSlug=selectProjectSlug(getState()),resourceSlug=selectRevisionSlug(getState()),_context2.next=5,resource=resourceSlug,params=void 0,params={url:"/project/".concat(projectSlug,"/lock/").concat(resource),method:"DELETE"},(0,common.$)(params);case 5:if("released"===_context2.sent.type){_context2.next=8;break}throw new Error("releasing lock failed");case 8:case"end":return _context2.stop()}var resource,params}),_callee2)})));return function(_x3,_x4){return _ref4.apply(this,arguments)}}());function slice_typeof(obj){return slice_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},slice_typeof(obj)}function slice_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function slice_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?slice_ownKeys(Object(source),!0).forEach((function(key){slice_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):slice_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function slice_defineProperty(obj,key,value){return(key=function slice_toPropertyKey(arg){var key=function slice_toPrimitive(input,hint){if("object"!==slice_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==slice_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===slice_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var slice_initialState={applicationMode:"expert",editingMode:"page",paths:null,isAdmin:!1,projectSlug:"",revisionSlug:"",leftPanel:!0,rightPanel:!0,topPanel:!0,bottomPanel:!0,visible:!1,hasEditingLock:!1,rightPanelActiveTab:RightMenu.n.LESSON,currentRule:void 0,partComponentTypes:[],activityTypes:[],allObjectives:[],copiedPart:null,readonly:!0,showDiagnosticsWindow:!1,showScoringOverview:!1},slice_slice=(0,redux_toolkit_esm.oM)({name:app_name.M,initialState:slice_initialState,reducers:{changeAppMode:function changeAppMode(state,action){state.editingMode="flowchart"===action.payload.mode?"flowchart":"page",state.applicationMode=action.payload.mode||"flowchart"},changeEditMode:function changeEditMode(state,action){state.editingMode=action.payload.mode},setDebugConfig:function setDebugConfig(state){state.paths={}},setInitialConfig:function setInitialConfig(state,action){state.paths=action.payload.paths||slice_initialState.paths,state.isAdmin=!!action.payload.isAdmin,state.projectSlug=action.payload.projectSlug||slice_initialState.projectSlug,state.revisionSlug=action.payload.revisionSlug||slice_initialState.revisionSlug,state.partComponentTypes=action.payload.partComponentTypes||slice_initialState.partComponentTypes,state.allObjectives=action.payload.allObjectives||slice_initialState.allObjectives,window.partComponentTypes=state.partComponentTypes,state.activityTypes=action.payload.activityTypes||slice_initialState.activityTypes,state.copiedPart=action.payload.copiedPart||slice_initialState.copiedPart,state.applicationMode=action.payload.applicationMode||slice_initialState.applicationMode,state.editingMode="flowchart"===state.applicationMode?"flowchart":"page"},setPanelState:function setPanelState(state,action){void 0!==action.payload.left&&(state.leftPanel=!!action.payload.left),void 0!==action.payload.right&&(state.rightPanel=!!action.payload.right),void 0!==action.payload.top&&(state.topPanel=!!action.payload.top),void 0!==action.payload.bottom&&(state.bottomPanel=!!action.payload.bottom)},setVisible:function setVisible(state,action){state.visible=action.payload.visible},setHasEditingLock:function setHasEditingLock(state,action){state.hasEditingLock=action.payload.hasEditingLock},setRightPanelActiveTab:function setRightPanelActiveTab(state,action){state.rightPanelActiveTab=action.payload.rightPanelActiveTab},setCurrentRule:function setCurrentRule(state,action){var _action$payload$curre,_action$payload,_action$payload$curre2,_action$payload2;state.currentRule=null!==(_action$payload$curre=null==action||null===(_action$payload=action.payload)||void 0===_action$payload||null===(_action$payload$curre2=_action$payload.currentRule)||void 0===_action$payload$curre2?void 0:_action$payload$curre2.id)&&void 0!==_action$payload$curre?_action$payload$curre:null==action||null===(_action$payload2=action.payload)||void 0===_action$payload2?void 0:_action$payload2.currentRule},setCopiedPart:function setCopiedPart(state,action){state.copiedPart=action.payload.copiedPart},setReadonly:function setReadonly(state,action){state.readonly=action.payload.readonly},setShowDiagnosticsWindow:function setShowDiagnosticsWindow(state,action){state.showDiagnosticsWindow=action.payload.show},setShowScoringOverview:function setShowScoringOverview(state,action){state.showScoringOverview=action.payload.show}},extraReducers:function extraReducers(builder){builder.addCase(acquireEditingLock.fulfilled,(function(state){state.hasEditingLock=!0})),builder.addCase(acquireEditingLock.rejected,(function(state){state.hasEditingLock=!1})),builder.addCase(savePage.J.rejected,(function(state){state.hasEditingLock=!1})),builder.addCase("activities/saveActivity/rejected",(function(state){state.hasEditingLock=!1})),builder.addCase(savePartState.rejected,(function(state){state.hasEditingLock=!1})),builder.addCase(savePartStateToTree.rejected,(function(state){state.hasEditingLock=!1}))}}),_slice$actions=slice_slice.actions,setRightPanelActiveTab=(_slice$actions.setInitialConfig,_slice$actions.setPanelState,_slice$actions.setVisible,_slice$actions.setHasEditingLock,_slice$actions.setShowEditingLockErrMsg,_slice$actions.setRightPanelActiveTab),setCurrentRule=_slice$actions.setCurrentRule,setCopiedPart=_slice$actions.setCopiedPart,setDebugConfig=_slice$actions.setDebugConfig,setShowDiagnosticsWindow=(_slice$actions.setReadonly,_slice$actions.setShowDiagnosticsWindow),setShowScoringOverview=(_slice$actions.changeAppMode,_slice$actions.setShowScoringOverview),slice_selectState=(_slice$actions.changeEditMode,function selectState(state){return state[app_name.M]}),selectPaths=(0,es.P1)(slice_selectState,(function(state){return state.paths})),selectProjectSlug=(0,es.P1)(slice_selectState,(function(state){return state.projectSlug})),selectRevisionSlug=(0,es.P1)(slice_selectState,(function(state){return state.revisionSlug})),selectAllObjectives=(0,es.P1)(slice_selectState,(function(state){return state.allObjectives})),selectAllObjectivesMap=(0,es.P1)(selectAllObjectives,(function(objectives){return objectives.reduce((function(acc,obj){return slice_objectSpread(slice_objectSpread({},acc),{},slice_defineProperty({},obj.id,obj))}),{})})),selectRightPanelActiveTab=((0,es.P1)(slice_selectState,(function(state){return state.leftPanel})),(0,es.P1)(slice_selectState,(function(state){return state.rightPanel})),(0,es.P1)(slice_selectState,(function(state){return state.topPanel})),(0,es.P1)(slice_selectState,(function(state){return state.bottomPanel})),(0,es.P1)(slice_selectState,(function(state){return state.rightPanelActiveTab}))),selectCurrentRuleId=(0,es.P1)(slice_selectState,(function(state){return state.currentRule})),selectCopiedPart=((0,es.P1)(selectCurrentRuleId,slice.by,(function(id,activity){var _filter$find,_activity$authoring;return null!==(_filter$find=((null==activity||null===(_activity$authoring=activity.authoring)||void 0===_activity$authoring?void 0:_activity$authoring.rules)||[]).filter((function(rule){return!!rule})).find((function(rule){return rule.id===id})))&&void 0!==_filter$find?_filter$find:id})),(0,es.P1)(slice_selectState,(function(state){return state.copiedPart}))),selectPartComponentTypes=((0,es.P1)(slice_selectState,(function(state){return state.visible})),(0,es.P1)(slice_selectState,(function(state){return state.hasEditingLock})),(0,es.P1)(slice_selectState,(function(state){return state.partComponentTypes}))),slice_selectActivityTypes=(0,es.P1)(slice_selectState,(function(state){return state.activityTypes})),selectReadOnly=(0,es.P1)(slice_selectState,(function(state){return state.readonly})),selectShowDiagnosticsWindow=(0,es.P1)(slice_selectState,(function(state){return state.showDiagnosticsWindow})),selectAppMode=((0,es.P1)(slice_selectState,(function(state){return state.showScoringOverview})),(0,es.P1)(slice_selectState,(function(state){return state.isAdmin})),(0,es.P1)(slice_selectState,(function(state){return state.applicationMode})));(0,es.P1)(slice_selectState,(function(state){return state.editingMode}));const app_slice=slice_slice.reducer},"./src/apps/authoring/store/groups/layouts/deck/actions/setCurrentActivityFromSequence.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{P:()=>setCurrentActivityFromSequence});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),_delivery_store_features_activities_slice__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/apps/delivery/store/features/activities/slice.ts"),_delivery_store_features_groups_actions_sequence__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/delivery/store/features/groups/actions/sequence.ts"),_delivery_store_features_groups_name__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/apps/delivery/store/features/groups/name.ts"),_delivery_store_features_groups_selectors_deck__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/apps/delivery/store/features/groups/selectors/deck.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var setCurrentActivityFromSequence=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_3__.hg)("".concat(_delivery_store_features_groups_name__WEBPACK_IMPORTED_MODULE_4__.Z,"/layouts/deck/setCurrentActivityFromSequence"),function(){var _ref2=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(_regeneratorRuntime().mark((function _callee(sequenceId,_ref){var dispatch,getState,state,sequence,entry;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(dispatch=_ref.dispatch,getState=_ref.getState,state=getState(),sequence=(0,_delivery_store_features_groups_selectors_deck__WEBPACK_IMPORTED_MODULE_2__.nu)(state)){_context.next=6;break}throw console.error("Sequence not found"),new Error("Sequence not found");case 6:if(entry=(0,_delivery_store_features_groups_actions_sequence__WEBPACK_IMPORTED_MODULE_1__.zK)(sequence,sequenceId)){_context.next=10;break}throw console.error("Entry not found"),new Error("Entry not found");case 10:return _context.abrupt("return",dispatch((0,_delivery_store_features_activities_slice__WEBPACK_IMPORTED_MODULE_0__.i6)({activityId:entry.resourceId})));case 11:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}())},"./src/apps/authoring/store/groups/layouts/deck/actions/updateSequenceItemFromActivity.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{O:()=>updateSequenceItem,q:()=>updateSequenceItemFromActivity});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),utils_common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/utils/common.ts"),_delivery_store_features_groups_name__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/apps/delivery/store/features/groups/name.ts"),_delivery_store_features_groups_slice__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/delivery/store/features/groups/slice.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var updateSequenceItemFromActivity=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.hg)("".concat(_delivery_store_features_groups_name__WEBPACK_IMPORTED_MODULE_3__.Z,"/updateSequenceItemFromActivity"),function(){var _ref2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(payload,_ref){var dispatch,_payload$activity,activity,_payload$group,group,clonedGroup;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return dispatch=_ref.dispatch,_payload$activity=payload.activity,activity=void 0===_payload$activity?{}:_payload$activity,_payload$group=payload.group,group=void 0===_payload$group?{}:_payload$group,clonedGroup=(0,utils_common__WEBPACK_IMPORTED_MODULE_0__.d9)(group),clonedGroup.children.find((function(entry){return entry.resourceId===activity.resourceId})).custom.sequenceName=activity.title,dispatch((0,_delivery_store_features_groups_slice__WEBPACK_IMPORTED_MODULE_1__.V9)({group:clonedGroup})),_context.abrupt("return",group);case 7:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}()),updateSequenceItem=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.hg)("".concat(_delivery_store_features_groups_name__WEBPACK_IMPORTED_MODULE_3__.Z,"/updateSequenceItem"),function(){var _ref4=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(payload,_ref3){var dispatch,sequence,group,clonedGroup;return _regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return dispatch=_ref3.dispatch,sequence=payload.sequence,group=payload.group,clonedGroup=(0,utils_common__WEBPACK_IMPORTED_MODULE_0__.d9)(group),clonedGroup.children.find((function(entry){return entry.resourceId===(null==sequence?void 0:sequence.resourceId)})).custom=null==sequence?void 0:sequence.custom,dispatch((0,_delivery_store_features_groups_slice__WEBPACK_IMPORTED_MODULE_1__.V9)({group:clonedGroup})),_context2.abrupt("return",group);case 7:case"end":return _context2.stop()}}),_callee2)})));return function(_x3,_x4){return _ref4.apply(this,arguments)}}())},"./src/apps/authoring/store/history/actions/redo.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{K:()=>redo});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),lodash_reverse__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/reverse.js"),lodash_reverse__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_reverse__WEBPACK_IMPORTED_MODULE_0__),_name__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/apps/authoring/store/history/name.ts"),_slice__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/authoring/store/history/slice.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var redo=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.hg)("".concat(_name__WEBPACK_IMPORTED_MODULE_3__.T,"/redo"),function(){var _ref2=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(_regeneratorRuntime().mark((function _callee(payload,_ref){var getState,dispatch,rootState,present;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:getState=_ref.getState,dispatch=_ref.dispatch,rootState=getState(),present=(0,_slice__WEBPACK_IMPORTED_MODULE_1__.GL)(rootState)||{redo:[]},(0,_slice__WEBPACK_IMPORTED_MODULE_1__.bz)(rootState),lodash_reverse__WEBPACK_IMPORTED_MODULE_0___default()(present.redo).forEach((function(a){dispatch(a)}));case 5:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}())},"./src/apps/authoring/store/history/actions/undo.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Y:()=>undo});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),lodash_reverse__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/reverse.js"),lodash_reverse__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_reverse__WEBPACK_IMPORTED_MODULE_0__),_name__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/apps/authoring/store/history/name.ts"),_slice__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/authoring/store/history/slice.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var undo=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.hg)("".concat(_name__WEBPACK_IMPORTED_MODULE_3__.Z,"/undo"),function(){var _ref2=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(_regeneratorRuntime().mark((function _callee(payload,_ref){var getState,dispatch,rootState,present;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:getState=_ref.getState,dispatch=_ref.dispatch,rootState=getState(),present=(0,_slice__WEBPACK_IMPORTED_MODULE_1__.pr)(rootState)||{undo:[]},lodash_reverse__WEBPACK_IMPORTED_MODULE_0___default()(present.undo).forEach((function(a){dispatch(a)}));case 4:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}())},"./src/apps/authoring/store/history/name.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{T:()=>HistorySlice,Z:()=>__WEBPACK_DEFAULT_EXPORT__});var HistorySlice="history";const __WEBPACK_DEFAULT_EXPORT__=HistorySlice},"./src/apps/authoring/store/history/slice.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{GL:()=>selectRedoAction,NG:()=>selectHasUndo,Z:()=>selectHasRedo,ZP:()=>__WEBPACK_DEFAULT_EXPORT__,bz:()=>selectState,gV:()=>createUndoAction,pr:()=>selectPresentAction});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/reselect/es/index.js"),utils_guid__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/utils/guid.ts"),_actions_redo__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/authoring/store/history/actions/redo.ts"),_actions_undo__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/apps/authoring/store/history/actions/undo.ts"),_name__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/apps/authoring/store/history/name.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var initialState={past:[],present:void 0,future:[]},slice=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_3__.oM)({name:_name__WEBPACK_IMPORTED_MODULE_4__.T,initialState,reducers:{createUndoAction:function createUndoAction(state,action){return state.present&&state.past.unshift(state.present),state.present=_objectSpread(_objectSpread({},action.payload),{},{id:(0,utils_guid__WEBPACK_IMPORTED_MODULE_0__.Z)()}),state.future=[],state}},extraReducers:function extraReducers(builder){builder.addCase(_actions_undo__WEBPACK_IMPORTED_MODULE_2__.Y.fulfilled,(function(state){var future=state.future,present=state.present,past=state.past;present&&future.unshift(present),state.present=past.shift(),state.past=_toConsumableArray(past),state.future=_toConsumableArray(future)})),builder.addCase(_actions_redo__WEBPACK_IMPORTED_MODULE_1__.K.fulfilled,(function(state){var future=state.future,present=state.present,past=state.past;present&&past.unshift(present),state.present=future.shift(),state.past=_toConsumableArray(past),state.future=_toConsumableArray(future)}))}}),createUndoAction=slice.actions.createUndoAction,selectState=function selectState(state){return state[_name__WEBPACK_IMPORTED_MODULE_4__.T]},selectHasUndo=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_5__.P1)(selectState,(function(state){return!!state.present})),selectHasRedo=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_5__.P1)(selectState,(function(state){return state.future.length>0})),selectPresentAction=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_5__.P1)(selectState,(function(state){return state.present})),selectRedoAction=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_5__.P1)(selectState,(function(state){return state.future[0]}));const __WEBPACK_DEFAULT_EXPORT__=slice.reducer},"./src/apps/authoring/store/page/actions/savePage.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{J:()=>savePage});var redux_toolkit_esm=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),lodash=__webpack_require__("./node_modules/lodash/lodash.js"),cloneDeep=__webpack_require__("./node_modules/lodash/cloneDeep.js"),cloneDeep_default=__webpack_require__.n(cloneDeep),slice=__webpack_require__("./src/apps/delivery/store/features/activities/slice.ts"),deck=__webpack_require__("./src/apps/delivery/store/features/groups/selectors/deck.ts"),common=__webpack_require__("./src/data/persistence/common.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function edit(project,resource,pendingUpdate,releaseLock){var update=Object.assign({},pendingUpdate,{releaseLock}),citationRefs=[];traverseContent(update.content.model,(function(key,value){value&&"cite"===value.type&&citationRefs.push(value.bibref)})),update.content.bibrefs=citationRefs;var params={method:"PUT",body:JSON.stringify({update}),url:"/project/".concat(project,"/resource/").concat(resource)};return(0,common.$)(params)}function traverseContent(o,func){for(var i in o)func.apply(this,[i,o[i]]),null!==o[i]&&"object"==_typeof(o[i])&&traverseContent(o[i],func)}var utils_common=__webpack_require__("./src/utils/common.ts"),groups_slice=__webpack_require__("./src/apps/delivery/store/features/groups/slice.ts"),app_slice=__webpack_require__("./src/apps/authoring/store/app/slice.ts"),history_slice=__webpack_require__("./src/apps/authoring/store/history/slice.ts"),persistance_options=__webpack_require__("./src/apps/authoring/store/persistance-options.ts"),page_name=__webpack_require__("./src/apps/authoring/store/page/name.ts"),page_slice=__webpack_require__("./src/apps/authoring/store/page/slice.ts");function savePage_typeof(obj){return savePage_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},savePage_typeof(obj)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==savePage_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==savePage_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==savePage_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===savePage_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var savePage=(0,redux_toolkit_esm.hg)("".concat(page_name.Z,"/savePage"),function(){var _ref2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(payload,_ref){var _payload$customCss,_payload$customScript,_payload$additionalSt,getState,dispatch,_payload$undoable,undoable,projectSlug,revisionSlug,currentPage,model,advancedAuthoring,advancedDelivery,displayApplicationChrome,updatedModel,customUpdate,sequence,allActivities,totalScore,update;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(getState=_ref.getState,dispatch=_ref.dispatch,_payload$undoable=payload.undoable,undoable=void 0!==_payload$undoable&&_payload$undoable,!(0,app_slice.jw)(getState())){_context.next=5;break}return _context.abrupt("return");case 5:if(projectSlug=(0,app_slice.LJ)(getState()),revisionSlug=(0,page_slice.T7)(getState()),currentPage=(0,page_slice.bz)(getState()),model=(0,groups_slice.td)(getState()),advancedAuthoring=void 0!==payload.advancedAuthoring?payload.advancedAuthoring:currentPage.advancedAuthoring,advancedDelivery=void 0!==payload.advancedDelivery?payload.advancedDelivery:currentPage.advancedDelivery,displayApplicationChrome=void 0!==payload.displayApplicationChrome?payload.displayApplicationChrome:currentPage.displayApplicationChrome,updatedModel=(0,utils_common.d9)(model),function removeResourceId(items){items.forEach((function(item){delete item.resourceId,item.children&&removeResourceId(item.children)}))}(updatedModel),(customUpdate=(0,utils_common.d9)(payload.custom||currentPage.custom)).scoreFixed||(sequence=(0,deck.nu)(getState()),allActivities=(0,slice.N3)(getState()),totalScore=sequence.reduce((function(acc,sequenceItem){var _currActivity$content,_currActivity$content2;if(sequenceItem.custom.isLayer||sequenceItem.custom.isBank)return acc;var currActivity=allActivities.find((function(a){return a.id===sequenceItem.resourceId}));return currActivity?acc+((null==currActivity||null===(_currActivity$content=currActivity.content)||void 0===_currActivity$content||null===(_currActivity$content2=_currActivity$content.custom)||void 0===_currActivity$content2?void 0:_currActivity$content2.maxScore)||0):acc}),0),customUpdate.totalScore=totalScore),update={title:payload.title||currentPage.title,objectives:payload.objectives||currentPage.objectives,content:{model:updatedModel,advancedAuthoring,advancedDelivery,displayApplicationChrome,custom:customUpdate,customCss:null!==(_payload$customCss=payload.customCss)&&void 0!==_payload$customCss?_payload$customCss:currentPage.customCss,customScript:null!==(_payload$customScript=payload.customScript)&&void 0!==_payload$customScript?_payload$customScript:currentPage.customScript,additionalStylesheets:null!==(_payload$additionalSt=payload.additionalStylesheets)&&void 0!==_payload$additionalSt?_payload$additionalSt:currentPage.additionalStylesheets},releaseLock:!1},dispatch((0,page_slice.T$)(update.content)),undoable&&dispatch((0,history_slice.gV)({undo:[savePage(cloneDeep_default()(_objectSpread(_objectSpread({},currentPage),{},{undoable:!1})))],redo:[savePage(cloneDeep_default()(_objectSpread(_objectSpread({},payload),{},{undoable:!1})))]})),_edit(projectSlug,revisionSlug,update,dispatch),!payload.immiediate){_context.next=24;break}return _context.next=24,_edit.flush();case 24:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _ref2.apply(this,arguments)}}()),_edit=(0,lodash.debounce)(function(){var _ref3=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(projectSlug,revisionSlug,update,dispatch){var saveResult,newSlug;return _regeneratorRuntime().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,edit(projectSlug,revisionSlug,update,!1);case 2:if("ServerError"!==(saveResult=_context2.sent).type){_context2.next=5;break}throw new Error(saveResult.message);case 5:(newSlug=saveResult.revision_slug)!==revisionSlug&&dispatch((0,page_slice.M8)({revisionSlug:newSlug}));case 7:case"end":return _context2.stop()}}),_callee2)})));return function(_x3,_x4,_x5,_x6){return _ref3.apply(this,arguments)}}(),persistance_options.f,persistance_options.C)},"./src/apps/authoring/store/page/name.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="page"},"./src/apps/authoring/store/page/slice.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{M8:()=>setRevisionSlug,T$:()=>updatePage,T7:()=>selectRevisionSlug,ZP:()=>__WEBPACK_DEFAULT_EXPORT__,bz:()=>selectState,mi:()=>selectResourceId});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/reselect/es/index.js"),_name__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/authoring/store/page/name.ts"),initialState={graded:!1,authorEmail:"",objectives:{attached:[]},title:"New Adaptive Page",revisionSlug:"",resourceId:-1,advancedAuthoring:!0,advancedDelivery:!0,displayApplicationChrome:!1,additionalStylesheets:[],customCss:"",customScript:"",custom:{}},slice=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__.oM)({name:_name__WEBPACK_IMPORTED_MODULE_1__.Z,initialState,reducers:{loadPage:function loadPage(state,action){state.graded=!!action.payload.graded,state.authorEmail=action.payload.authorEmail||initialState.authorEmail,state.title=action.payload.title||initialState.title,state.objectives=action.payload.objectives||initialState.objectives,state.resourceId=action.payload.resourceId||initialState.resourceId,state.revisionSlug=action.payload.revisionSlug||initialState.revisionSlug,state.displayApplicationChrome=action.payload.displayApplicationChrome||initialState.displayApplicationChrome,state.additionalStylesheets=action.payload.additionalStylesheets||initialState.additionalStylesheets,state.customCss=action.payload.customCss||initialState.customCss,state.customScript=action.payload.customScript||initialState.customScript,state.custom=action.payload.custom||initialState.custom},updatePage:function updatePage(state,action){void 0!==action.payload.graded&&(state.graded=action.payload.graded),void 0!==action.payload.authorEmail&&(state.authorEmail=action.payload.authorEmail),void 0!==action.payload.title&&(state.title=action.payload.title),void 0!==action.payload.objectives&&(state.objectives=action.payload.objectives),void 0!==action.payload.custom&&(state.custom=action.payload.custom),void 0!==action.payload.customCss&&(state.customCss=action.payload.customCss),void 0!==action.payload.customScript&&(state.customScript=action.payload.customScript),void 0!==action.payload.additionalStylesheets&&(state.additionalStylesheets=action.payload.additionalStylesheets),void 0!==action.payload.displayApplicationChrome&&(state.displayApplicationChrome=action.payload.displayApplicationChrome)},setIsGraded:function setIsGraded(state,action){state.graded=action.payload.graded},setTitle:function setTitle(state,action){state.title=action.payload.title},setObjectives:function setObjectives(state,action){state.objectives=action.payload.objectives},setRevisionSlug:function setRevisionSlug(state,action){state.revisionSlug=action.payload.revisionSlug}}}),_slice$actions=slice.actions,setRevisionSlug=(_slice$actions.loadPage,_slice$actions.setIsGraded,_slice$actions.setTitle,_slice$actions.setObjectives,_slice$actions.setRevisionSlug),updatePage=_slice$actions.updatePage,selectState=function selectState(state){return state[_name__WEBPACK_IMPORTED_MODULE_1__.Z]},selectResourceId=((0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.P1)(selectState,(function(state){return state.graded})),(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.P1)(selectState,(function(state){return state.title})),(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.P1)(selectState,(function(state){return state.objectives})),(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.P1)(selectState,(function(state){return state.resourceId}))),selectRevisionSlug=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.P1)(selectState,(function(state){return state.revisionSlug}));const __WEBPACK_DEFAULT_EXPORT__=slice.reducer},"./src/apps/authoring/store/parts/name.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{H:()=>PartsSlice,Z:()=>__WEBPACK_DEFAULT_EXPORT__});var PartsSlice="parts";const __WEBPACK_DEFAULT_EXPORT__=PartsSlice},"./src/apps/authoring/store/parts/slice.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{ZP:()=>__WEBPACK_DEFAULT_EXPORT__,ah:()=>setCurrentSelection,e5:()=>selectCurrentSelection});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/reselect/es/index.js"),_name__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/authoring/store/parts/name.ts"),slice=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__.oM)({name:_name__WEBPACK_IMPORTED_MODULE_1__.Z,initialState:{currentSelection:""},reducers:{setCurrentSelection:function setCurrentSelection(state,action){state.currentSelection=action.payload.selection}}}),setCurrentSelection=slice.actions.setCurrentSelection,selectCurrentSelection=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.P1)((function selectState(state){return state[_name__WEBPACK_IMPORTED_MODULE_1__.Z]}),(function(s){return s.currentSelection}));const __WEBPACK_DEFAULT_EXPORT__=slice.reducer},"./src/apps/authoring/store/persistance-options.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{C:()=>SAVE_DEBOUNCE_OPTIONS,f:()=>SAVE_DEBOUNCE_TIMEOUT});var SAVE_DEBOUNCE_TIMEOUT=500,SAVE_DEBOUNCE_OPTIONS={maxWait:1e4,leading:!1}},"./src/apps/delivery/store/features/activities/name.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="activities"},"./src/apps/delivery/store/features/activities/slice.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{N3:()=>selectAllActivities,Xx:()=>upsertActivity,ZP:()=>__WEBPACK_DEFAULT_EXPORT__,Zl:()=>upsertActivities,by:()=>selectCurrentActivity,ho:()=>selectActivityById,i6:()=>setCurrentActivityId,sp:()=>AdvancedFeedbackAnswerType,zT:()=>selectCurrentActivityId});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/reselect/es/index.js"),_name__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/delivery/store/features/activities/name.ts"),AdvancedFeedbackAnswerType=function(AdvancedFeedbackAnswerType){return AdvancedFeedbackAnswerType[AdvancedFeedbackAnswerType.Equal=0]="Equal",AdvancedFeedbackAnswerType[AdvancedFeedbackAnswerType.Between=1]="Between",AdvancedFeedbackAnswerType[AdvancedFeedbackAnswerType.Greater=2]="Greater",AdvancedFeedbackAnswerType[AdvancedFeedbackAnswerType.GreatherEqual=3]="GreatherEqual",AdvancedFeedbackAnswerType[AdvancedFeedbackAnswerType.Less=4]="Less",AdvancedFeedbackAnswerType[AdvancedFeedbackAnswerType.LessEqual=5]="LessEqual",AdvancedFeedbackAnswerType}({}),adapter=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__.HF)(),slice=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__.oM)({name:_name__WEBPACK_IMPORTED_MODULE_1__.Z,initialState:adapter.getInitialState({currentActivityId:""}),reducers:{setActivities:function setActivities(state,action){adapter.setAll(state,action.payload.activities)},upsertActivity:function upsertActivity(state,action){adapter.upsertOne(state,action.payload.activity)},upsertActivities:function upsertActivities(state,action){adapter.upsertMany(state,action.payload.activities)},deleteActivity:function deleteActivity(state,action){adapter.removeOne(state,action.payload.activityId)},deleteActivities:function deleteActivities(state,action){adapter.removeMany(state,action.payload.ids)},setCurrentActivityId:function setCurrentActivityId(state,action){state.currentActivityId=action.payload.activityId}}}),_slice$actions=slice.actions,upsertActivity=(_slice$actions.setActivities,_slice$actions.upsertActivity),upsertActivities=_slice$actions.upsertActivities,setCurrentActivityId=(_slice$actions.deleteActivity,_slice$actions.deleteActivities,_slice$actions.setCurrentActivityId),selectState=function selectState(state){return state[_name__WEBPACK_IMPORTED_MODULE_1__.Z]},selectCurrentActivityId=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.P1)(selectState,(function(state){return state.currentActivityId})),_adapter$getSelectors=adapter.getSelectors(selectState),selectAll=_adapter$getSelectors.selectAll,selectById=_adapter$getSelectors.selectById,selectEntities=(_adapter$getSelectors.selectTotal,_adapter$getSelectors.selectEntities),selectAllActivities=selectAll,selectActivityById=selectById,selectCurrentActivity=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.P1)([selectEntities,selectCurrentActivityId],(function(activities,currentActivityId){return activities[currentActivityId]}));(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.P1)(selectCurrentActivity,(function(activity){return null==activity?void 0:activity.content}));const __WEBPACK_DEFAULT_EXPORT__=slice.reducer},"./src/apps/delivery/store/features/attempt/name.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="attempt"},"./src/apps/delivery/store/features/attempt/slice.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Kv:()=>selectActivityAttemptState,ZE:()=>selectById,wl:()=>upsertActivityAttemptState});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/reselect/es/index.js"),_name__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/delivery/store/features/attempt/name.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var adapter=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__.HF)({selectId:function selectId(item){return item.attemptGuid}}),slice=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__.oM)({name:_name__WEBPACK_IMPORTED_MODULE_1__.Z,initialState:adapter.getInitialState({resourceAttemptGuid:"",extrinsic:{"session.attemptNumber":1,"session.timeOnQuestion":0,"session.timeQuestionStart":0}}),reducers:{setResourceAttemptGuid:function setResourceAttemptGuid(state,action){state.resourceAttemptGuid=action.payload.guid},setExtrinsicState:function setExtrinsicState(state,action){state.extrinsic=action.payload.state},updateExtrinsicState:function updateExtrinsicState(state,action){state.extrinsic=_objectSpread(_objectSpread({},state.extrinsic),action.payload.state)},loadActivityAttemptState:function loadActivityAttemptState(state,action){adapter.setAll(state,action.payload.attempts)},upsertActivityAttemptState:function upsertActivityAttemptState(state,action){var existing=adapter.getSelectors().selectAll(state).filter((function(attempt){return attempt.activityId===action.payload.attempt.activityId&&attempt.attemptGuid!==action.payload.attempt.attemptGuid}));existing.length&&adapter.removeMany(state,existing.map((function(e){return e.attemptGuid}))),adapter.upsertOne(state,action.payload.attempt)}}}),_slice$actions=slice.actions,upsertActivityAttemptState=(_slice$actions.setResourceAttemptGuid,_slice$actions.setExtrinsicState,_slice$actions.updateExtrinsicState,_slice$actions.loadActivityAttemptState,_slice$actions.upsertActivityAttemptState),selectState=function selectState(state){return state[_name__WEBPACK_IMPORTED_MODULE_1__.Z]},_adapter$getSelectors=adapter.getSelectors(selectState),selectAll=_adapter$getSelectors.selectAll,selectById=_adapter$getSelectors.selectById,selectActivityAttemptState=(_adapter$getSelectors.selectTotal,function selectActivityAttemptState(state,activityId){return selectAll(state).find((function(a){return a.activityId===activityId}))});(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.P1)(selectState,(function(state){return state.extrinsic})),slice.reducer},"./src/apps/delivery/store/features/groups/actions/sequence.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Iy:()=>getSequenceLineage,Uv:()=>flattenHierarchy,_y:()=>getHierarchy,wb:()=>findInHierarchy,xw:()=>findInSequenceByResourceId,zK:()=>findInSequence});__webpack_require__("./node_modules/react-redux/es/index.js"),__webpack_require__("./src/apps/delivery/store/features/groups/selectors/deck.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var getHierarchy=function getHierarchy(sequence){var parentId=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return sequence.filter((function(item){var _item$custom;return null===parentId?!item.custom.layerRef:(null===(_item$custom=item.custom)||void 0===_item$custom?void 0:_item$custom.layerRef)===parentId})).map((function(item){var withChildren=_objectSpread(_objectSpread({},item),{},{children:[]});return withChildren.children=getHierarchy(sequence,item.custom.sequenceId),withChildren}))},findInHierarchy=function findInHierarchy(hierarchy,sequenceId){var found=hierarchy.find((function(i){return i.custom.sequenceId===sequenceId}));if(!found)for(var i=0;i<hierarchy.length&&!(found=findInHierarchy(hierarchy[i].children,sequenceId));i++);return found},flattenHierarchy=function flattenHierarchy(hierarchy){return hierarchy.reduce((function(result,item){var childlessEntry=_objectSpread(_objectSpread({},item),{},{children:void 0});return result.push(childlessEntry),item.children&&result.push.apply(result,_toConsumableArray(flattenHierarchy(item.children))),result}),[])},findInSequence=function findInSequence(sequence,sequenceId){var found=sequence.find((function(entry){return entry.custom.sequenceId===sequenceId}));return found||null},findInSequenceByResourceId=function findInSequenceByResourceId(sequence,resourceId){var found=sequence.find((function(entry){return entry.resourceId===resourceId}));return found||null},getSequenceLineage=function getSequenceLineage(sequence,childId){var lineage=[],child=findInSequence(sequence,childId);return child&&(lineage.unshift(child),child.custom.layerRef&&lineage.unshift.apply(lineage,_toConsumableArray(getSequenceLineage(sequence,child.custom.layerRef)))),lineage}},"./src/apps/delivery/store/features/groups/name.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="groups"},"./src/apps/delivery/store/features/groups/selectors/deck.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{d4:()=>selectCurrentSequenceId,kv:()=>selectCurrentActivityTree,nu:()=>selectSequence});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/reselect/es/index.js"),_activities_slice__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/apps/delivery/store/features/activities/slice.ts"),_attempt_slice__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/delivery/store/features/attempt/slice.ts"),_actions_sequence__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/apps/delivery/store/features/groups/actions/sequence.ts"),_slice__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/apps/delivery/store/features/groups/slice.ts");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var selectSequence=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_4__.P1)(_slice__WEBPACK_IMPORTED_MODULE_3__.bz,(function(state){if(-1===state.currentGroupId)return[];var currentGroup=state.entities[state.currentGroupId];return currentGroup?currentGroup.children:[]})),selectCurrentSequenceId=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_4__.P1)([selectSequence,_activities_slice__WEBPACK_IMPORTED_MODULE_0__.zT],(function(sequence,currentActivityId){var _sequence$find;return null===(_sequence$find=sequence.find((function(entry){var testId=entry.custom.sequenceId;return"number"==typeof currentActivityId&&(testId=entry.resourceId||0),testId===currentActivityId})))||void 0===_sequence$find?void 0:_sequence$find.custom.sequenceId})),selectCurrentActivityTree=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_4__.P1)([selectSequence,_activities_slice__WEBPACK_IMPORTED_MODULE_0__.N3,selectCurrentSequenceId],(function(sequence,activities,currentSequenceId){var currentSequenceEntry=sequence.find((function(entry){return entry.custom.sequenceId===currentSequenceId}));return currentSequenceEntry?(0,_actions_sequence__WEBPACK_IMPORTED_MODULE_2__.Iy)(sequence,currentSequenceEntry.custom.sequenceId).map((function(entry){return activities.find((function(a){return a.resourceId===entry.resourceId}))})).filter((function(t){return t})):(console.warn("deck::selectCurrentActivityTree - Current Activity ".concat(JSON.stringify(currentSequenceId)," not found in sequence!")),null)}));(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_4__.P1)((function(state){var currentTree=selectCurrentActivityTree(state),attempts=null==currentTree?void 0:currentTree.map((function(t){return(0,_attempt_slice__WEBPACK_IMPORTED_MODULE_1__.Kv)(state,t.resourceId)}));return[currentTree,attempts]}),(function(_ref){var _ref2=_slicedToArray(_ref,2),currentTree=_ref2[0],attempts=_ref2[1];if(null!=currentTree&&currentTree.length&&null!=attempts&&attempts.length)return currentTree.map((function(activity){return attempts.find((function(a){return a.activityId===activity.resourceId}))}))}))},"./src/apps/delivery/store/features/groups/slice.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ks:()=>selectCurrentGroup,V9:()=>upsertGroup,ZP:()=>__WEBPACK_DEFAULT_EXPORT__,bz:()=>selectState,pY:()=>selectAllGroups,td:()=>selectAll});var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/reselect/es/index.js"),_name__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apps/delivery/store/features/groups/name.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var adapter=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__.HF)(),slice=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__.oM)({name:_name__WEBPACK_IMPORTED_MODULE_1__.Z,initialState:adapter.getInitialState({currentGroupId:-1}),reducers:{setCurrentGroupId:function setCurrentGroupId(state,action){state.currentGroupId=action.payload.groupId},setGroups:function setGroups(state,action){var groups=action.payload.groups.map((function(group,index){var id=void 0!==group.id?group.id:index+1,children=group.children.map((function(child){if("activity-reference"===child.type){var resourceId=child.activity_id||child.activityId||child.resourceId;return _objectSpread(_objectSpread({},child),{},{resourceId})}return child}));return _objectSpread(_objectSpread({},group),{},{id,children})}));adapter.setAll(state,groups),state.currentGroupId=groups[0].id||-1},upsertGroup:function upsertGroup(state,action){adapter.upsertOne(state,action.payload.group)}}}),_slice$actions=slice.actions,upsertGroup=(_slice$actions.setCurrentGroupId,_slice$actions.setGroups,_slice$actions.upsertGroup),selectState=function selectState(state){return state[_name__WEBPACK_IMPORTED_MODULE_1__.Z]},_adapter$getSelectors=adapter.getSelectors(selectState),selectAll=_adapter$getSelectors.selectAll,selectAllGroups=(_adapter$getSelectors.selectById,_adapter$getSelectors.selectTotal,selectAll),selectCurrentGroup=(0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_2__.P1)(selectState,(function(state){return state.entities[state.currentGroupId]}));const __WEBPACK_DEFAULT_EXPORT__=slice.reducer},"./src/components/hooks/useToggle.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{O:()=>useToggle});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var useToggle=function useToggle(){var initialValue=arguments.length>0&&void 0!==arguments[0]&&arguments[0],_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initialValue),2),value=_useState2[0],setValue=_useState2[1];return[value,(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){return setValue((function(v){return!v}))}),[]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){return setValue(!0)}),[]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){return setValue(!1)}),[])]}},"./src/components/parts/janus-mcq/mcq-util.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{q:()=>getNodeText});var getNodeText=function getNodeText(node){if(Array.isArray(node))return node.reduce((function(txt,newNode){return txt+getNodeText(newNode)}),"");var nodeText=node.text||"";return nodeText+=node.children.reduce((function(childrenText,childNode){var txt=childrenText;return txt+=getNodeText(childNode)}),"")}},"./src/data/persistence/activity.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{zh:()=>bulkEdit,Ue:()=>create,eP:()=>edit});var common=__webpack_require__("./src/utils/common.ts"),persistence_common=__webpack_require__("./src/data/persistence/common.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var fixObjectiveParts=function fixObjectiveParts(activity){var _activity$authoring;if(!activity.objectives)return console.info("fixObjectiveParts - No activity.objectives"),activity;var keyCount=Object.keys(activity.objectives).length;if(0===keyCount)return console.info("fixObjectiveParts - No objectives"),activity;if(!Array.isArray(null==activity||null===(_activity$authoring=activity.authoring)||void 0===_activity$authoring?void 0:_activity$authoring.parts))return console.info("fixObjectiveParts - Parts not an array"),activity;if(0===activity.authoring.parts.length)return console.error("fixObjectiveParts - No parts were present in the activity"),activity;var targetKey=Object.values(activity.authoring.parts).map((function(p){return p.id})).filter((function(k){return"__default"!==k}))[0]||"__default",allObjectives=Object.values(activity.objectives).flat();return keyCount>1?(console.warn("fixObjectiveParts - Multiple parts had objectives assigned to them, consolidating."),_objectSpread(_objectSpread({},activity),{},{objectives:_defineProperty({},targetKey,allObjectives)})):_objectSpread(_objectSpread({},activity),{},{objectives:_defineProperty({},targetKey,allObjectives)})};function activity_typeof(obj){return activity_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},activity_typeof(obj)}function create(project,activityTypeSlug,model,objectives){var scope=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"embedded",params={method:"POST",body:JSON.stringify({model,objectives,scope}),url:"/project/".concat(project,"/activity/").concat(activityTypeSlug)};return(0,persistence_common.$)(params)}function bulkEdit(project,resource,updates){updates.forEach((function(u){var citationRefs=[];indexBibrefs(u.content,citationRefs),u.authoring&&indexBibrefs(u.authoring,citationRefs);var objectives=fixObjectiveParts(u).objectives,contentClone=(0,common.d9)(u.content);contentClone.bibrefs=citationRefs,u.content=contentClone,u.objectives=objectives||{}}));var params={method:"PUT",body:JSON.stringify({updates}),url:"/storage/project/".concat(project,"/resource?lock=").concat(resource)};return(0,persistence_common.$)(params)}function indexBibrefs(update,citationRefs){traverseContent(update,(function(key,value){value&&"cite"===value.type&&citationRefs.push(value.bibref)}))}function edit(project,resource,activity,pendingUpdate,releaseLock){var update=Object.assign({},pendingUpdate,{releaseLock});try{update.content=Object.assign({},update.content),void 0!==update.content.authoring&&(update.authoring=update.content.authoring,delete update.content.authoring);var citationRefs=[];indexBibrefs(update.content,citationRefs),update.authoring&&indexBibrefs(update.authoring,citationRefs),update.content.bibrefs=citationRefs,update=fixObjectiveParts(update)}catch(e){throw console.error("activity::edit failed",e),e}var params={method:"PUT",body:JSON.stringify(update),url:"/storage/project/".concat(project,"/resource/").concat(activity,"?lock=").concat(resource)};return(0,persistence_common.$)(params)}function traverseContent(o,func){for(var i in o)func.apply(this,[i,o[i]]),null!==o[i]&&"object"==activity_typeof(o[i])&&traverseContent(o[i],func)}},"./src/data/persistence/common.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$:()=>makeRequest});var fetch=window.fetch;function makeRequest(params){var method=params.method?params.method:"GET",headers=params.headers?params.headers:{"Content-Type":"application/json"},hasTextResult=!!params.hasTextResult&&params.hasTextResult,body=params.body,url=params.url,query=params.query,queryString="";return query&&Object.keys(query).length>0&&(queryString="?"+Object.keys(query).map((function(k){return encodeURIComponent(k)+"="+encodeURIComponent(query[k])})).join("&")),new Promise((function(resolve,reject){return fetch(function getBaseURL(){return window.location.protocol+"//"+window.location.host+"/api/v1"}()+url+queryString,{method,headers,body}).then((function(response){if(response.ok)return resolve(hasTextResult?response.text():response.json());response.text().then((function(text){var message;try{void 0!==(message=JSON.parse(text)).message&&(message=message.message)}catch(e){message=text}return reject({status:response.status,statusText:response.statusText,message})}))})).catch((function(error){return reject({status:error.status,statusText:error.statusText,message:error.message})}))}))}},"./src/data/persistence/media.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Wm:()=>createMedia,xY:()=>fetchMedia});var _common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/data/persistence/common.ts");function createMedia(project,file){var fileName=function getFileName(file){return file.name.slice(0,-1!==file.name.indexOf(".")?file.name.indexOf(".")+1:file.name.length)+(-1!==file.name.indexOf(".")?file.name.substr(file.name.indexOf(".")+1).toLowerCase():"")}(file);return function encodeFile(file){var reader=new FileReader;return file?new Promise((function(resolve,reject){reader.addEventListener("load",(function(){""===reader.result?reject("failed to encode"):null!==reader.result?resolve(reader.result.substr(reader.result.indexOf(",")+1)):reject("failed to encode")}),!1),reader.readAsDataURL(file)})):Promise.reject("file was null")}(file).then((function(encoding){var body={file:encoding,name:fileName},params={method:"POST",body:JSON.stringify(body),url:"/media/project/".concat(project)};return(0,_common__WEBPACK_IMPORTED_MODULE_0__.$)(params)}))}function fetchMedia(project,offset,limit,mimeFilter,urlFilter,searchText,orderBy,order){var params={method:"GET",query:Object.assign({},offset?{offset}:{},limit?{limit}:{},mimeFilter?{mimeFilter}:{},urlFilter?{urlFilter}:{},searchText?{searchText}:{},orderBy?{orderBy}:{},order?{order}:{}),url:"/media/project/".concat(project)};return(0,_common__WEBPACK_IMPORTED_MODULE_0__.$)(params)}},"./src/stories/advanced-authoring/AdvancedAuthorStorybookContext.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>AdvancedAuthorStorybookContext});__webpack_require__("./node_modules/react/index.js");var modalActions,_modalActions,DISPLAY_MODAL,DISMISS_MODAL,DndProvider=__webpack_require__("./node_modules/react-dnd/dist/esm/core/DndProvider.mjs"),esm=__webpack_require__("./node_modules/react-dnd-html5-backend/dist/esm/index.mjs"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),AdvancedAuthoringModal=__webpack_require__("./src/apps/authoring/components/AdvancedAuthoringModal.tsx"),slice=__webpack_require__("./src/apps/authoring/store/app/slice.ts"),redux_toolkit_esm=__webpack_require__("./node_modules/@reduxjs/toolkit/dist/redux-toolkit.esm.js"),redux=__webpack_require__("./node_modules/redux/es/redux.js"),tsmonad=__webpack_require__("./node_modules/tsmonad/dist/tsmonad.js");_modalActions=modalActions||(modalActions={}),DISPLAY_MODAL=_modalActions.DISPLAY_MODAL="DISPLAY_MODAL",DISMISS_MODAL=_modalActions.DISMISS_MODAL="DISMISS_MODAL",_modalActions.display=function display(component){return{type:DISPLAY_MODAL,component}},_modalActions.dismiss=function dismiss(){return{type:DISMISS_MODAL}};var defaultState=tsmonad.Maybe.nothing();var activities_name=__webpack_require__("./src/apps/delivery/store/features/activities/name.ts"),activities_slice=__webpack_require__("./src/apps/delivery/store/features/activities/slice.ts"),groups_name=__webpack_require__("./src/apps/delivery/store/features/groups/name.ts"),groups_slice=__webpack_require__("./src/apps/delivery/store/features/groups/slice.ts"),app_name=__webpack_require__("./src/apps/authoring/store/app/name.ts");var reselect_es=__webpack_require__("./node_modules/reselect/es/index.js"),slice_slice=(0,redux_toolkit_esm.oM)({name:"clipboard",initialState:{item:null,type:null},reducers:{copyItem:function copyItem(state,action){var payload=action.payload,item=payload.item,type=payload.type;state.item=item,state.type=type},pasteItem:function pasteItem(state){state.item=null,state.type=null}}}),_slice$actions=slice_slice.actions,selectState=(_slice$actions.copyItem,_slice$actions.pasteItem,function selectState(state){return state.clipboard});(0,reselect_es.P1)(selectState,(function(state){return state.item})),(0,reselect_es.P1)(selectState,(function(state){return state.type}));const clipboard_slice=slice_slice.reducer;var _combineReducers,history_name=__webpack_require__("./src/apps/authoring/store/history/name.ts"),history_slice=__webpack_require__("./src/apps/authoring/store/history/slice.ts"),page_name=__webpack_require__("./src/apps/authoring/store/page/name.ts"),page_slice=__webpack_require__("./src/apps/authoring/store/page/slice.ts"),parts_name=__webpack_require__("./src/apps/authoring/store/parts/name.ts"),parts_slice=__webpack_require__("./src/apps/authoring/store/parts/slice.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var rootReducer=(0,redux.UY)((_defineProperty(_combineReducers={},app_name.Z,slice.ZP),_defineProperty(_combineReducers,page_name.Z,page_slice.ZP),_defineProperty(_combineReducers,parts_name.Z,parts_slice.ZP),_defineProperty(_combineReducers,groups_name.Z,groups_slice.ZP),_defineProperty(_combineReducers,activities_name.Z,activities_slice.ZP),_defineProperty(_combineReducers,"clipboard",clipboard_slice),_defineProperty(_combineReducers,history_name.Z,history_slice.ZP),_defineProperty(_combineReducers,"media",(function media(){return{}})),_defineProperty(_combineReducers,"modal",(function modal(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:defaultState,action=arguments.length>1?arguments[1]:void 0;switch(action.type){case modalActions.DISMISS_MODAL:return tsmonad.Maybe.nothing();case modalActions.DISPLAY_MODAL:return tsmonad.Maybe.just(action.component);default:return state}})),_combineReducers));const storybook=(0,redux_toolkit_esm.xC)({reducer:rootReducer,middleware:function middleware(getDefaultMiddleware){return getDefaultMiddleware({serializableCheck:{ignoredActions:["history/createUndoAction","history/undo","history/redo","media/RECEIVE_MEDIA_PAGE"],ignoreState:!0}})}});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),AdvancedAuthorStorybookContext=function AdvancedAuthorStorybookContext(_ref){var children=_ref.children,className=_ref.className;return storybook.dispatch((0,slice.qV)({})),(0,jsx_runtime.jsx)("div",{className:"flowchart-editor advanced-authoring storybook h-[450px] ".concat(className),children:(0,jsx_runtime.jsx)(AdvancedAuthoringModal.F0,{children:(0,jsx_runtime.jsx)(DndProvider.W,{backend:esm.PD,children:(0,jsx_runtime.jsx)(es.zt,{store:storybook,children})})})})};AdvancedAuthorStorybookContext.displayName="AdvancedAuthorStorybookContext",AdvancedAuthorStorybookContext.displayName="AdvancedAuthorStorybookContext";try{AdvancedAuthorStorybookContext.displayName="AdvancedAuthorStorybookContext",AdvancedAuthorStorybookContext.__docgenInfo={description:"",displayName:"AdvancedAuthorStorybookContext",props:{className:{defaultValue:null,description:"",name:"className",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/stories/advanced-authoring/AdvancedAuthorStorybookContext.tsx#AdvancedAuthorStorybookContext"]={docgenInfo:AdvancedAuthorStorybookContext.__docgenInfo,name:"AdvancedAuthorStorybookContext",path:"src/stories/advanced-authoring/AdvancedAuthorStorybookContext.tsx#AdvancedAuthorStorybookContext"})}catch(__react_docgen_typescript_loader_error){}},"./src/utils/classNames.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>classNames});var classNames=function classNames(){for(var _len=arguments.length,names=new Array(_len),_key=0;_key<_len;_key++)names[_key]=arguments[_key];return names.filter((function(n){return n})).join(" ")}},"./src/utils/common.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__.d(__webpack_exports__,{d9:()=>clone,Cw:()=>cloneT,GI:()=>isStringArray,m7:()=>parseArray,gx:()=>parseBoolean,Q6:()=>parseNumString});var toObj=function toObj(arr){return arr.reduce((function(p,c){return p[c]=!0,p}),{})},BlockElements=["table","td","tc","ol","ul","dl","math","math_line","code_line","blockquote","code","formula","callout"],TextBlockElements=["p"].concat(["h1","h2","h3","h4","h5","h6"]),MediaElements=["img","youtube","audio","video","iframe"],SemanticChildrenElements=[].concat(BlockElements,MediaElements,_toConsumableArray(TextBlockElements)),tableCell={isVoid:!1,isBlock:!0,isTopLevel:!1,validChildren:toObj(["p","math","formula_inline","formula"].concat(MediaElements))};(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target})({},tableCell),toObj(["li","ol","ul"]),toObj(["input_ref","img","formula_inline","callout_inline"]),toObj(SemanticChildrenElements),toObj([]),toObj(SemanticChildrenElements),toObj([]),toObj(SemanticChildrenElements),toObj(SemanticChildrenElements),toObj([]),toObj([]),toObj([]),toObj([]),toObj([]),toObj(SemanticChildrenElements),toObj(["input_ref","img"]),toObj(["input_ref","img"]),toObj(["input_ref","img"]),toObj(["tr"]),toObj(["td","th","tc"]),toObj([].concat(BlockElements,MediaElements,_toConsumableArray(TextBlockElements),["callout","definition","figure","dialog","conjugation"])),toObj(["math_line"]),toObj(["p"]);function common_typeof(obj){return common_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},common_typeof(obj)}function clone(o){return JSON.parse(JSON.stringify(o))}function cloneT(o){return JSON.parse(JSON.stringify(o))}var parseBoolean=function parseBoolean(input){return void 0!==input&&(!0===input||1===input||"true"===input.toString().toLowerCase()||"on"===input.toString().toLowerCase()||"1"===input.toString().toLowerCase())},isStringArray=function isStringArray(s){return"string"==typeof s&&"["===s.charAt(0)&&"]"===s.charAt(s.length-1)},parseArray=function parseArray(val){if(Array.isArray(val))return val.map((function(item){return parseNumString(item)}));if(isStringArray(val)){try{var json=JSON.parse(val);if(Array.isArray(json))return json}catch(err){}var inner=val.substring(1,val.length-1),isNested=isStringArray(inner);if(isNested)return inner.replace(/\], \[/g,"],\n[").replace(/\],\[/g,"],\n[").split(/,\n/g).map(parseArray);var elements=inner.split(",").map((function(item){return parseNumString(item)})),parsedArray=1===elements.length&&""===elements[0]?[]:elements;return isNested?parsedArray.map(parseArray):parsedArray.map((function(element){return"string"!=typeof element||element.match(/^\s+$/)?element:element.trim()}))}if(!val)return[];if(function isString(val){return"string"==typeof val}(val))return val.split(",").map((function(item){return parseNumString(item)}));if(function isNumber(val){return"number"==typeof val&&!Number.isNaN(val)}(val))return[val];throw new Error("not a valid array")},parseNumString=function parseNumString(item){var itemType=common_typeof(item);return null!=item&&item.length?Number.isNaN(Number(item))?"string"===itemType?item.trim():item:parseFloat(item):item}},"./src/utils/guid.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>guid});var POOL_SIZE=1e3,pool=[];function fillPool(){(function createSome(count){var array=new Uint32Array(count);if(void 0!==window.crypto)window.crypto.getRandomValues(array);else for(var i=0;i<count;i+=1)array[i]=Math.floor(Math.random()*Math.floor(Math.pow(2,32)-1));return array})(POOL_SIZE-pool.length).forEach((function(n){return pool.push(n)}))}function guid(){return pool.length>0?(1,pool.pop()+""):(1,fillPool(),pool.pop()+"")}!function schedule(){return setTimeout((function(){fillPool(),schedule()}),5e3)}(),window.guid=guid},"?d4c0":()=>{}}]);