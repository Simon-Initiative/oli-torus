sections_where_user_is_student: 1 query in total
SELECT * FROM sections AS s0
INNER JOIN enrollments" AS e1 ON s0.id = e1.section_id
INNER JOIN enrollments_context_roles AS e2 ON e1.id = e2.enrollment_id
INNER JOIN users_platform_roles AS u3 ON e1.user_id = u3.user_id
WHERE
  (e1.user_id = $1) AND
  (s0.open_and_free = TRUE) AND
  (s0.status = 'active') AND
  (e2.context_role_id IN ($2) OR u3.platform_role_id IN ($3))

add_instructors part 1: 1 query in total
SELECT e0.*, s1.id FROM enrollments AS e0
INNER JOIN sections AS s1 ON e0.section_id = s1.id
INNER JOIN enrollments_context_roles AS e2 ON e0.id = e2.enrollment_id
WHERE (
  (s1.id IN ($1) AND (e0.status = 'enrolled')) AND
  (e2."context_role_id" = $2)
)

add_instructors part 2: 1 query per each instructor of section
SELECT * FROM users AS WHERE (id = $1)

add_sections_progress: 2 queries per section
SELECT count(c0.id) FROM contained_pages AS c0
WHERE
  (c0.section_id = $1) AND
  (c0.container_id IS NULL)


SELECT r1.user_id, SUM(r1.progress) / $1 FROM contained_pages AS c0
INNER JOIN resource_accesses AS r1 ON ((c0.page_id = r1.resource_id) AND (c0.section_id = r1.section_id)) AND r1.user_id = ANY($2)
WHERE
  (c0.section_id = $3) AND
  (c0.container_id IS NULL)
GROUP BY r1.user_id

user_is_only_student?: 1 query in total
SELECT TRUE FROM enrollments AS e0
INNER JOIN enrollments_context_roles AS e1 ON e0.id = e1.enrollment_id
INNER JOIN users_platform_roles AS u2 ON e0.user_id = u2.user_id
WHERE
  (e0.user_id = $1) AND
  (NOT (e1.context_role_id = ANY($2)) OR NOT (u2.platform_role_id = ANY($3)))
LIMIT 1
